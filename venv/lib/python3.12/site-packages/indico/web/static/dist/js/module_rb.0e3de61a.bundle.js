(self.webpackChunk=self.webpackChunk||[]).push([[1598],{97258:(e,t,n)=>{"use strict";var i={};n.r(i),n.d(i,{canManagersEditRooms:()=>ie,getBookingGracePeriod:()=>re,getBookingReasonRequired:()=>he,getContactEmail:()=>de,getHelpURL:()=>ae,getLanguages:()=>oe,getPrivacyPolicyHTML:()=>ue,getRoomsSpriteToken:()=>te,getTOSHTML:()=>le,getTileServerURL:()=>ne,hasInternalNotesEnabled:()=>me,hasLoadedConfig:()=>ee,hasPrivacyPolicy:()=>ce,hasTOS:()=>se});var o={};n.r(o),n.d(o,{getAllUserRoomPermissions:()=>Vi,getManagedRoomIds:()=>Ki,getRealUserRoomPermissions:()=>Zi,getUnbookableRoomIds:()=>Wi,getUserInfo:()=>zi,hasFavoriteRooms:()=>Qi,hasLoadedUserInfo:()=>Fi,hasOwnedRooms:()=>$i,hasUnbookableRooms:()=>Yi,isCheckingUserRoomPermissions:()=>Gi,isUserAdmin:()=>Hi,isUserAdminOverrideEnabled:()=>Ui,isUserRBAdmin:()=>qi,makeIsFavoriteRoom:()=>Ji});var r={};n.r(r),n.d(r,{getAvailabilityDateRange:()=>Dc,getBookingFormAvailability:()=>Hc,getBookingFormRelatedEvents:()=>Uc,getFilters:()=>gc,getSearchFailedMessage:()=>Ec,getSearchResultIds:()=>Ac,getSearchResultIdsWithoutUnbookable:()=>Vc,getSearchResults:()=>kc,getSearchResultsForMap:()=>Xc,getSearchResultsWithoutUnbookable:()=>Wc,getSuggestedRoomIds:()=>qc,getSuggestions:()=>zc,getTimelineAvailability:()=>Bc,getTimelineDatePicker:()=>jc,getTimelineDateRange:()=>xc,getTotalResultCount:()=>wc,getUnavailableDatePicker:()=>Ic,getUnavailableRoomInfo:()=>Sc,getUnbookableResultCount:()=>Yc,getUnbookableRoomIdsWithMaxAdvanceDays:()=>Gc,hasMoreTimelineData:()=>Nc,isFetchingFormTimeline:()=>Cc,isFetchingTimeline:()=>Pc,isFetchingUnavailableRooms:()=>Oc,isSearchAndPermissionCheckFinished:()=>Zc,isSearchFailed:()=>vc,isSearchFinished:()=>yc,isSearching:()=>bc,isSearchingOrCheckingPermissions:()=>$c,isTimelineVisible:()=>Mc});var a={};n.r(a),n.d(a,{getFilters:()=>pd,getSearchResults:()=>bd,getSearchResultsForMap:()=>yd,isSearching:()=>_d});var s={};n.r(s),n.d(s,{getActiveBookings:()=>N_,getCalendarData:()=>j_,getCalendarFilters:()=>S_,getCalendarView:()=>F_,getDatePickerInfo:()=>x_,getFilters:()=>O_,getLocalFilters:()=>P_,getNumberOfRowsLeft:()=>I_,getRoomFilters:()=>R_,isFetchingActiveBookings:()=>B_,isFetchingCalendar:()=>M_});var l={};n.r(l),n.d(l,{_getAttributes:()=>rg,_getEquipmentTypes:()=>Qf,_getFeatures:()=>Jf,getAllLocations:()=>Wf,getAttributes:()=>ag,getEquipmentTypes:()=>tg,getFeatures:()=>ng,getFilters:()=>Xf,getLocation:()=>Kf,getSettings:()=>lg,hasSettingsLoaded:()=>sg,isFetchingAttributes:()=>og,isFetchingFeaturesOrEquipmentTypes:()=>ig,isFetchingLocations:()=>Yf});n(53348);var c=n(3803),u=n.n(c),d=n(86326),m=n(35623),h=n(67609),p=n(44515),_=n(29079),f=n(87493),g=n.n(f),b=n(97598),y=n.n(b),v=n(88183),E=n.n(v),k=n(49138),A=n(68803),T=n(47279),w=n(71775),L=n(96478),D=n(49528),C=n(59865),O=n(82222);const R=_.Ay.bind(null,{endpoint:"auth.logout",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"logout",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),S=_.Ay.bind(null,{endpoint:"core.admin_dashboard",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),P=_.Ay.bind(null,{endpoint:"core.change_lang",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"change-language",isDynamic:!1}]}]},"/"),M=_.Ay.bind(null,{endpoint:"users.user_dashboard",rules:[{args:["user_id"],converters:{user_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"dashboard",isDynamic:!1},{data:"/",isDynamic:!1}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"dashboard",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),x=_.Ay.bind(null,{endpoint:"users.user_preferences",rules:[{args:["user_id"],converters:{user_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"preferences",isDynamic:!1},{data:"/",isDynamic:!1}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"preferences",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/");function j(){const[e]=(0,C.EV)();return d.createElement(O.ge,{triggerFactory:e=>{let{disabled:t,onClick:n}=e;return d.createElement(k.A.Item,{onClick:n,disabled:t},d.createElement(L.Translate,null,"Impersonate user"))},existing:[],onAddItems:e=>{let{userId:t}=e;return(0,w.f)(t)},favorites:e,withExternalUsers:!1,single:!0,alwaysConfirm:!0})}function I(e){let{userData:t,languages:n,hasLoadedConfig:i,hasLoadedUserInfo:o}=e;if(!(t&&n&&i&&o))return"";const{firstName:r,lastName:a,email:s,language:l,isAdmin:c,avatarURL:u}=t,m=d.createElement(A.A,{avatar:!0,src:u,size:"mini"}),h=d.createElement("div",null,r," ",a,d.createElement("br",null),s),[p,_]=n[l]||[l,null,!1];return d.createElement(k.A,{trigger:m,pointing:"top right"},d.createElement(k.A.Menu,{style:{zIndex:103}},d.createElement(k.A.Header,{content:h}),d.createElement(k.A.Divider,null),d.createElement(k.A.Item,{as:"a",href:M()},d.createElement(L.Translate,null,"My Profile")),d.createElement(k.A.Item,{as:"a",href:x()},d.createElement(L.Translate,null,"My Preferences")),d.createElement(k.A.Header,null,(f=d.createElement(d.Fragment,null,d.createElement(T.A,{name:"globe"})," ",_?`${p} (${_})`:p),d.createElement(k.A,{floating:!0,trigger:f,value:l,selectOnBlur:!1,onChange:(e,t)=>{let{value:n}=t;n!==l&&async function(e){try{await D.indicoAxios.post(P(),E().stringify({lang:e}))}catch(e){return void(0,D.handleAxiosError)(e)}location.reload()}(n)},options:g()(Object.entries(n),(e=>e[1][0])).map((e=>{let[t,[n,i]]=e;return{key:t,text:i?`${n} (${i})`:n,value:t}}))}))),d.createElement(k.A.Divider,null),c&&d.createElement(d.Fragment,null,d.createElement(k.A.Item,{as:"a",href:S()},d.createElement(L.Translate,null,"Administration")),d.createElement(j,null)),d.createElement(k.A.Item,{as:"a",href:R()},d.createElement(L.Translate,null,"Logout"))));var f}I.propTypes={userData:y().shape({firstName:y().string,lastName:y().string,email:y().string,id:y().number,language:y().string,isAdmin:y().bool,avatarURL:y().string}).isRequired,languages:y().object.isRequired,hasLoadedConfig:y().bool.isRequired,hasLoadedUserInfo:y().bool.isRequired};var B="@@router/LOCATION_CHANGE",N="@@router/CALL_HISTORY_METHOD",F=function(e){return function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return{type:N,payload:{method:e,args:n}}}},z=F("push");F("replace"),F("go"),F("goBack"),F("goForward");const q=(0,n(81379).zR)({basename:`${Indico.Urls.BasePath}/rooms`}),H="INIT",U="RESET_PAGE_STATE";function $(e){return{type:U,namespace:e}}function Z(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r=e;null!==t&&(r+=`:${t}`,null!==n&&(r+=`:${JSON.stringify(n)}`));const{location:{pathname:a,search:s}}=q,l=s?E().parse(s.slice(1)):{};i||!l.modal?l.modal=[]:"string"==typeof l.modal&&(l.modal=[l.modal]),l.modal.push(r);const c=E().stringify(l,{allowDots:!0,arrayFormat:"repeat"});return z((o||a)+(l?`?${c}`:""))}var G=n(88996);const V=_.Ay.bind(null,{endpoint:"rb.config",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"config",isDynamic:!1}]}]},"/"),W="config/FETCH_REQUEST",K="config/FETCH_SUCCESS",Y="config/FETCH_ERROR",X="config/CONFIG_RECEIVED",Q="config/SET_ROOMS_SPRITE_TOKEN";function J(){return(0,G.P$)((()=>D.indicoAxios.get(V())),W,[X,K],[Y])}const ee=e=>{let{config:t}=e;return t.request.state===G.X_.SUCCESS},te=e=>{let{config:t}=e;return t.data.roomsSpriteToken},ne=e=>{let{config:t}=e;return t.data.tileServerURL},ie=e=>{let{config:t}=e;return t.data.managersEditRooms},oe=e=>{let{config:t}=e;return t.data.languages},re=e=>{let{config:t}=e;return t.data.gracePeriod},ae=e=>{let{config:t}=e;return t.data.helpURL},se=e=>{let{config:t}=e;return t.data.hasTOS},le=e=>{let{config:t}=e;return t.data.tosHTML},ce=e=>{let{config:t}=e;return t.data.hasPrivacyPolicy},ue=e=>{let{config:t}=e;return t.data.privacyPolicyHTML},de=e=>{let{config:t}=e;return t.data.contactEmail},me=e=>{let{config:t}=e;return t.data.internalNotesEnabled},he=e=>{let{config:t}=e;return t.data.bookingReasonRequired};var pe=n(36111),_e=n(62338),fe=n(24372),ge=n(18757),be=n.n(ge);const ye="filters/SET_PARAMETER",ve="filters/SET";function Ee(e,t,n){return{type:ye,namespace:e,param:t,data:n}}function ke(e,t){return{type:ve,namespace:e,params:t,merge:!(arguments.length>2&&void 0!==arguments[2])||arguments[2]}}function Ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ae(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function we(e,t){let n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>e;return n="function"==typeof t?t:()=>t,function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n(e),o=arguments.length>1?arguments[1]:void 0;switch(o.type){case ye:return o.namespace===e?i(Te(Te({},t),{},{[o.param]:o.data}),o.param):t;case ve:return o.namespace!==e?t:o.merge?Te(Te({},t),o.params):Te(Te({},n(e)),o.params);case U:return o.namespace&&o.namespace!==e?t:n(e);default:return t}}}var Le=n(89952),De=n(11052);const Ce=(e,t,n)=>{if(!e.error&&(e=>{if(!("timeSlot"in e))return!0;const{timeSlot:{startTime:t,endTime:n}}=e;return!(t&&n&&(0,De.toMoment)(t,"HH:mm").isSameOrAfter((0,De.toMoment)(n,"HH:mm")))})(e))return!0;const i={title:L.Translate.string("Something went wrong"),message:L.Translate.string("The provided URL was not properly formatted.")};return n($(t)),n(z("/")),(0,Le.A)(i),!1};function Oe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oe(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class Se extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"state",{})}static getDerivedStateFromProps(e,t){return Re(Re({},t),e)}}(0,pe.A)(Se,"propTypes",{setParentField:y().func.isRequired});const Pe=_.Ay.bind(null,{endpoint:"rb.admin_attributes",rules:[{args:["attribute_id"],converters:{attribute_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"attributes",isDynamic:!1},{data:"/",isDynamic:!1},{data:"attribute_id",isDynamic:!0}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"attributes",isDynamic:!1}]}]},"/"),Me=_.Ay.bind(null,{endpoint:"rb.admin_equipment_types",rules:[{args:["equipment_type_id"],converters:{equipment_type_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"equipment-types",isDynamic:!1},{data:"/",isDynamic:!1},{data:"equipment_type_id",isDynamic:!0}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"equipment-types",isDynamic:!1}]}]},"/"),xe=_.Ay.bind(null,{endpoint:"rb.admin_features",rules:[{args:["feature_id"],converters:{feature_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"features",isDynamic:!1},{data:"/",isDynamic:!1},{data:"feature_id",isDynamic:!0}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"features",isDynamic:!1}]}]},"/"),je=_.Ay.bind(null,{endpoint:"rb.admin_locations",rules:[{args:["location_id"],converters:{location_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"locations",isDynamic:!1},{data:"/",isDynamic:!1},{data:"location_id",isDynamic:!0}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"locations",isDynamic:!1}]}]},"/"),Ie=_.Ay.bind(null,{endpoint:"rb.admin_room",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0}]}]},"/"),Be=_.Ay.bind(null,{endpoint:"rb.admin_rooms",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),Ne=_.Ay.bind(null,{endpoint:"rb.admin_settings",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"settings",isDynamic:!1}]}]},"/"),Fe="admin/FETCH_SETTINGS_REQUEST",ze="admin/FETCH_SETTINGS_SUCCESS",qe="admin/FETCH_SETTINGS_ERROR",He="admin/SETTINGS_RECEIVED",Ue="admin/FETCH_LOCATIONS_REQUEST",$e="admin/FETCH_LOCATIONS_SUCCESS",Ze="admin/FETCH_LOCATIONS_ERROR",Ge="admin/LOCATIONS_RECEIVED",Ve="admin/LOCATION_RECEIVED",We="admin/LOCATION_DELETED",Ke="admin/FETCH_ROOMS_REQUEST",Ye="admin/FETCH_ROOMS_SUCCESS",Xe="admin/FETCH_ROOMS_ERROR",Qe="admin/ROOMS_RECEIVED",Je="admin/ROOM_DELETED",et="admin/FETCH_FEATURES_REQUEST",tt="admin/FETCH_FEATURES_SUCCESS",nt="admin/FETCH_FEATURES_ERROR",it="admin/FEATURES_RECEIVED",ot="admin/FEATURE_RECEIVED",rt="admin/FEATURE_DELETED",at="admin/FETCH_EQUIPMENT_TYPES_REQUEST",st="admin/FETCH_EQUIPMENT_TYPES_SUCCESS",lt="admin/FETCH_EQUIPMENT_TYPES_ERROR",ct="admin/EQUIPMENT_TYPES_RECEIVED",ut="admin/EQUIPMENT_TYPE_RECEIVED",dt="admin/EQUIPMENT_TYPE_DELETED",mt="admin/FETCH_ATTRIBUTES_REQUEST",ht="admin/FETCH_ATTRIBUTES_SUCCESS",pt="admin/FETCH_ATTRIBUTES_ERROR",_t="admin/ATTRIBUTES_RECEIVED",ft="admin/ATTRIBUTE_RECEIVED",gt="admin/ATTRIBUTE_DELETED",bt="admin";function yt(){return(0,G.P$)((()=>D.indicoAxios.get(Ne())),Fe,[He,ze],qe)}function vt(e){return(0,G.HX)((()=>D.indicoAxios.patch(Ne(),e)),null,He)}function Et(){return(0,G.P$)((()=>D.indicoAxios.get(je())),Ue,[Ge,$e],Ze)}function kt(){return(0,G.P$)((()=>D.indicoAxios.get(Be())),Ke,[Qe,Ye],Xe)}function At(){return(0,G.P$)((()=>D.indicoAxios.get(Me())),at,[ct,st],lt)}function Tt(){return(0,G.P$)((()=>D.indicoAxios.get(xe())),et,[it,tt],nt)}function wt(){return(0,G.P$)((()=>D.indicoAxios.get(Pe())),mt,[_t,ht],pt)}function Lt(){return Ee(bt,"text",null)}function Dt(e){return(0,G.HX)((()=>D.indicoAxios.post(Me(),e)),null,ut)}function Ct(e){return(0,G.HX)((()=>D.indicoAxios.post(xe(),e)),null,ot)}function Ot(e){return(0,G.HX)((()=>D.indicoAxios.post(Pe(),e)),null,ft)}function Rt(e){return(0,G.HX)((()=>D.indicoAxios.post(je(),be()(e,"_map_url_template_choice"))),null,Ve)}var St=n(80841),Pt=n(31951),Mt=n(52379),xt=n(94900),jt=n(45967);const It=e=>{let{map:t}=e;return t.areas},Bt=e=>!!ne(e),Nt=(0,jt.Mz)(Bt,(e=>{let{map:t}=e;return t.request===G.X_.STARTED}),It,((e,t,n)=>e&&(t||!!n.length))),Ft=e=>{let{map:t}=e;return t.ui.hoveredRoom},zt=_.Ay.bind(null,{endpoint:"rb.admin_map_areas",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"map-areas",isDynamic:!1}]}]},"/"),qt=_.Ay.bind(null,{endpoint:"rb.map_areas",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"map-areas",isDynamic:!1}]}]},"/"),Ht="map/UPDATE_LOCATION",Ut="map/TOGGLE_SEARCH",$t="map/FETCH_AREAS_REQUEST",Zt="map/FETCH_AREAS_SUCCESS",Gt="map/FETCH_AREAS_ERROR",Vt="map/AREAS_RECEIVED",Wt="map/SET_ROOM_HOVER",Kt="admin/MAP_AREA_CREATED",Yt="admin/MAP_AREA_UPDATED",Xt="admin/MAP_AREA_DELETED";function Qt(e){return{type:Wt,roomId:e}}function Jt(){return async(e,t)=>{if(Bt(t()))return await(0,G.P$)((()=>D.indicoAxios.get(qt())),$t,[Vt,Zt],Gt)(e)}}function en(e){return(0,G.P$)((()=>D.indicoAxios.post(zt(),(0,fe.snakifyKeys)(e))),null,Kt)}function tn(e){return(0,G.P$)((()=>D.indicoAxios.patch(zt(),{areas:(0,fe.snakifyKeys)(e)})),null,Yt)}function nn(e){return(0,G.P$)((()=>D.indicoAxios.delete(zt(),{data:{area_ids:e}})),null,(()=>({type:Xt,ids:e})))}var on=n(55359),rn=n.n(on),an=n(54858),sn=n.n(an),ln=n(78434),cn=n.n(ln),un=n(91185),dn=n(56237),mn=n(16520),hn=n(6209),pn=n(99323),_n=n(23507),fn=n(10470),gn=n(15842),bn=n(77940),yn=n(21863),vn=n.n(yn),En=n(61605),kn=n(2952),An=n(53648);function Tn(e){const t=e.getAllChildMarkers().some((e=>e.options.highlight));return vn().divIcon({html:`<span>${e.getChildCount()}</span>`,className:"marker-cluster marker-cluster-small rb-map-cluster "+(t?"highlight":""),iconSize:vn().point(40,40,!0)})}const wn=vn().divIcon({className:"rb-map-marker",iconSize:[20,20]}),Ln=vn().divIcon({className:"rb-map-marker highlight",iconSize:[20,20]});class Dn extends d.Component{shouldComponentUpdate(e){let{highlight:t}=e;const{highlight:n}=this.props;return t!==n}render(){const{id:e,highlight:t}=this.props;return d.createElement(En.A,(0,bn.A)({key:`${e}-${t}`},this.props))}}(0,pe.A)(Dn,"propTypes",{highlight:y().bool.isRequired,id:y().number.isRequired});class Cn extends d.Component{shouldComponentUpdate(e){let{rooms:t,hoveredRoomId:n}=e;const{rooms:i,hoveredRoomId:o}=this.props;return!cn()(i,t)||n!==o}render(){const{rooms:e,clusterProps:t,hoveredRoomId:n,onRoomClick:i}=this.props;return e.length?d.createElement(An.A,(0,bn.A)({showCoverageOnHover:!1,iconCreateFunction:Tn},t),e.filter((e=>{let{lat:t,lng:n}=e;return!(!t||!n)})).map((e=>d.createElement(Dn,{key:e.id,id:e.id,position:[e.lat,e.lng],icon:e.id===n?Ln:wn,highlight:e.id===n,onClick:()=>i(e)},d.createElement(kn.A,{direction:"top"},d.createElement("span",null,e.name)))))):null}}(0,pe.A)(Cn,"propTypes",{rooms:y().array,clusterProps:y().object,hoveredRoomId:y().number,onRoomClick:y().func.isRequired,actions:y().objectOf(y().func).isRequired}),(0,pe.A)(Cn,"defaultProps",{rooms:[],clusterProps:{},hoveredRoomId:null});const On=(0,p.connect)((e=>({hoveredRoomId:Ft(e)})))(Cn);class Rn extends d.Component{componentDidMount(){const{onLoad:e}=this.props;e()}render(){const{bounds:e,onMove:t,mapRef:n,rooms:i,children:o,tileServerURL:r,onTouch:a,clusterProps:s,onRoomClick:l,actions:c,markerComponent:m}=this.props,h=u()(t,750);return!rn()(e)&&d.createElement("div",{className:"rb-client-js-common-map-___RoomBookingMap-module__map-container___qylSi"},d.createElement(fn.A,{ref:n,bounds:Object.values(e),onMoveend:h,onDragend:e=>{a(),h(e)},onZoomend:e=>{a(),h(e)}},d.createElement(gn.A,{attribution:'© <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',minZoom:"14",maxZoom:"20",url:r}),d.createElement(m,{rooms:i,clusterProps:s,actions:c,onRoomClick:l}),o))}}(0,pe.A)(Rn,"propTypes",{bounds:y().object.isRequired,onMove:y().func.isRequired,onTouch:y().func.isRequired,mapRef:y().object.isRequired,rooms:y().array,onLoad:y().func,children:y().node,tileServerURL:y().string,clusterProps:y().object,markerComponent:y().elementType,onRoomClick:y().func.isRequired,actions:y().objectOf(y().func).isRequired}),(0,pe.A)(Rn,"defaultProps",{rooms:[],onLoad:()=>{},children:null,tileServerURL:"",clusterProps:{},markerComponent:On});const Sn=(0,p.connect)((e=>({tileServerURL:ne(e)})))(h.Ay.component("RoomBookingMap",Rn));var Pn=n(33464),Mn=n(14947);class xn extends Pn.A{componentDidMount(){super.componentDidMount(),this.renderControl()}componentDidUpdate(e){const{classes:t}=this.props;super.componentDidUpdate(e),this.renderControl(),t&&this.leafletElement.getContainer().classList.add(...t.trim().split(" "))}componentWillUnmount(){m.unmountComponentAtNode(this.leafletElement.getContainer())}createLeafletElement(e){const{position:t,classes:n}=e,i=vn().control({position:t});return i.onAdd=()=>{const e=vn().DomUtil.create("div",n);return vn().DomEvent.disableClickPropagation(e),vn().DomEvent.disableScrollPropagation(e),e},i}renderControl(){const e=this.leafletElement.getContainer();m.render(d.Children.only(this.props.children),e)}}(0,pe.A)(xn,"propTypes",{position:y().string.isRequired,classes:y().string}),(0,pe.A)(xn,"defaultProps",{classes:""});const jn=(0,Mn.k0)(xn);var In=n(43057),Bn=n(17156),Nn=n.n(Bn);class Fn{constructor(e,t,n){if(isNaN(e)||isNaN(t)||isNaN(n))throw new TypeError(`invalid vector [${e},${t},${n}]`);this.x=Number(e),this.y=Number(t),this.z=Number(n)}get length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}plus(e){if(!(e instanceof Fn))throw new TypeError("v is not Vector3d object");return new Fn(this.x+e.x,this.y+e.y,this.z+e.z)}minus(e){if(!(e instanceof Fn))throw new TypeError("v is not Vector3d object");return new Fn(this.x-e.x,this.y-e.y,this.z-e.z)}times(e){if(isNaN(e))throw new TypeError(`invalid scalar value ‘${e}’`);return new Fn(this.x*e,this.y*e,this.z*e)}dividedBy(e){if(isNaN(e))throw new TypeError(`invalid scalar value ‘${e}’`);return new Fn(this.x/e,this.y/e,this.z/e)}dot(e){if(!(e instanceof Fn))throw new TypeError("v is not Vector3d object");return this.x*e.x+this.y*e.y+this.z*e.z}cross(e){if(!(e instanceof Fn))throw new TypeError("v is not Vector3d object");const t=this.y*e.z-this.z*e.y,n=this.z*e.x-this.x*e.z,i=this.x*e.y-this.y*e.x;return new Fn(t,n,i)}negate(){return new Fn(-this.x,-this.y,-this.z)}unit(){const e=this.length;if(1==e)return this;if(0==e)return this;const t=this.x/e,n=this.y/e,i=this.z/e;return new Fn(t,n,i)}angleTo(e,t=void 0){if(!(e instanceof Fn))throw new TypeError("v is not Vector3d object");if(!(t instanceof Fn||null==t))throw new TypeError("n is not Vector3d object");const n=null==t||this.cross(e).dot(t)>=0?1:-1,i=this.cross(e).length*n,o=this.dot(e);return Math.atan2(i,o)}rotateAround(e,t){if(!(e instanceof Fn))throw new TypeError("axis is not Vector3d object");const n=t.toRadians(),i=this.unit(),o=e.unit(),r=Math.sin(n),a=Math.cos(n),s=1-a,l=o.x,c=o.y,u=o.z,d=[[s*l*l+a,s*l*c-r*u,s*l*u+r*c],[s*l*c+r*u,s*c*c+a,s*c*u-r*l],[s*l*u-r*c,s*c*u+r*l,s*u*u+a]],m=[d[0][0]*i.x+d[0][1]*i.y+d[0][2]*i.z,d[1][0]*i.x+d[1][1]*i.y+d[1][2]*i.z,d[2][0]*i.x+d[2][1]*i.y+d[2][2]*i.z];return new Fn(m[0],m[1],m[2])}toString(e=3){return`[${this.x.toFixed(e)},${this.y.toFixed(e)},${this.z.toFixed(e)}]`}}Number.prototype.toRadians=function(){return this*Math.PI/180},Number.prototype.toDegrees=function(){return 180*this/Math.PI};const zn=Fn;let qn=" ";class Hn{static get separator(){return qn}static set separator(e){qn=e}static parse(e){if(!isNaN(parseFloat(e))&&isFinite(e))return Number(e);const t=String(e).trim().replace(/^-/,"").replace(/[NSEW]$/i,"").split(/[^0-9.,]+/);if(""==t[t.length-1]&&t.splice(t.length-1),""==t)return NaN;let n=null;switch(t.length){case 3:n=t[0]/1+t[1]/60+t[2]/3600;break;case 2:n=t[0]/1+t[1]/60;break;case 1:n=t[0];break;default:return NaN}return/^-|[WS]$/i.test(e.trim())&&(n=-n),Number(n)}static toDms(e,t="d",n=void 0){if(isNaN(e))return null;if("string"==typeof e&&""==e.trim())return null;if("boolean"==typeof e)return null;if(e==1/0)return null;if(null==e)return null;if(void 0===n)switch(t){case"d":case"deg":n=4;break;case"dm":case"deg+min":n=2;break;case"dms":case"deg+min+sec":n=0;break;default:t="d",n=4}e=Math.abs(e);let i=null,o=null,r=null,a=null;switch(t){default:case"d":case"deg":o=e.toFixed(n),o<100&&(o="0"+o),o<10&&(o="0"+o),i=o+"°";break;case"dm":case"deg+min":o=Math.floor(e),r=(60*e%60).toFixed(n),60==r&&(r=(0).toFixed(n),o++),o=("000"+o).slice(-3),r<10&&(r="0"+r),i=o+"°"+Hn.separator+r+"′";break;case"dms":case"deg+min+sec":o=Math.floor(e),r=Math.floor(3600*e/60)%60,a=(3600*e%60).toFixed(n),60==a&&(a=(0).toFixed(n),r++),60==r&&(r=0,o++),o=("000"+o).slice(-3),r=("00"+r).slice(-2),a<10&&(a="0"+a),i=o+"°"+Hn.separator+r+"′"+Hn.separator+a+"″"}return i}static toLat(e,t,n){const i=Hn.toDms(Hn.wrap90(e),t,n);return null===i?"–":i.slice(1)+Hn.separator+(e<0?"S":"N")}static toLon(e,t,n){const i=Hn.toDms(Hn.wrap180(e),t,n);return null===i?"–":i+Hn.separator+(e<0?"W":"E")}static toBrng(e,t,n){const i=Hn.toDms(Hn.wrap360(e),t,n);return null===i?"–":i.replace("360","0")}static fromLocale(e){const t=123456.789.toLocaleString(),n={thousands:t.slice(3,4),decimal:t.slice(7,8)};return e.replace(n.thousands,"⁜").replace(n.decimal,".").replace("⁜",",")}static toLocale(e){const t=123456.789.toLocaleString(),n={thousands:t.slice(3,4),decimal:t.slice(7,8)};return e.replace(/,([0-9])/,"⁜$1").replace(".",n.decimal).replace("⁜",n.thousands)}static compassPoint(e,t=3){if(![1,2,3].includes(Number(t)))throw new RangeError(`invalid precision ‘${t}’`);e=Hn.wrap360(e);const n=4*2**(t-1);return["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW"][Math.round(e*n/360)%n*16/n]}static wrap90(e){if(-90<=e&&e<=90)return e;const t=e,n=360;return 1*Math.abs(((t-90)%n+n)%n-180)-90}static wrap180(e){if(-180<=e&&e<=180)return e;const t=360;return((360*e/t-180)%t+t)%t-180}static wrap360(e){if(0<=e&&e<360)return e;const t=360;return(360*e/t%t+t)%t}}Number.prototype.toRadians=function(){return this*Math.PI/180},Number.prototype.toDegrees=function(){return 180*this/Math.PI};const Un=Hn,$n=Math.PI;class Zn{constructor(e,t){if(isNaN(e))throw new TypeError(`invalid lat ‘${e}’`);if(isNaN(t))throw new TypeError(`invalid lon ‘${t}’`);this._lat=Un.wrap90(Number(e)),this._lon=Un.wrap180(Number(t))}get lat(){return this._lat}get latitude(){return this._lat}set lat(e){if(this._lat=isNaN(e)?Un.wrap90(Un.parse(e)):Un.wrap90(Number(e)),isNaN(this._lat))throw new TypeError(`invalid lat ‘${e}’`)}set latitude(e){if(this._lat=isNaN(e)?Un.wrap90(Un.parse(e)):Un.wrap90(Number(e)),isNaN(this._lat))throw new TypeError(`invalid latitude ‘${e}’`)}get lon(){return this._lon}get lng(){return this._lon}get longitude(){return this._lon}set lon(e){if(this._lon=isNaN(e)?Un.wrap180(Un.parse(e)):Un.wrap180(Number(e)),isNaN(this._lon))throw new TypeError(`invalid lon ‘${e}’`)}set lng(e){if(this._lon=isNaN(e)?Un.wrap180(Un.parse(e)):Un.wrap180(Number(e)),isNaN(this._lon))throw new TypeError(`invalid lng ‘${e}’`)}set longitude(e){if(this._lon=isNaN(e)?Un.wrap180(Un.parse(e)):Un.wrap180(Number(e)),isNaN(this._lon))throw new TypeError(`invalid longitude ‘${e}’`)}static get metresToKm(){return.001}static get metresToMiles(){return 1/1609.344}static get metresToNauticalMiles(){return 1/1852}toNvector(){const e=this.lat.toRadians(),t=this.lon.toRadians(),n=Math.sin(e),i=Math.cos(e),o=Math.sin(t),r=Math.cos(t);return new Gn(i*r,i*o,n)}greatCircle(e){const t=this.lat.toRadians(),n=this.lon.toRadians(),i=Number(e).toRadians(),o=Math.sin(n)*Math.cos(i)-Math.sin(t)*Math.cos(n)*Math.sin(i),r=-Math.cos(n)*Math.cos(i)-Math.sin(t)*Math.sin(n)*Math.sin(i),a=Math.cos(t)*Math.sin(i);return new zn(o,r,a)}distanceTo(e,t=6371e3){if(!(e instanceof Zn))throw new TypeError(`invalid point ‘${e}’`);if(isNaN(t))throw new TypeError(`invalid radius ‘${t}’`);const n=Number(t),i=this.toNvector(),o=e.toNvector(),r=i.cross(o).length,a=i.dot(o);return Math.atan2(r,a)*n}initialBearingTo(e){if(!(e instanceof Zn))throw new TypeError(`invalid point ‘${e}’`);if(this.equals(e))return NaN;const t=this.toNvector(),n=e.toNvector(),i=new Gn(0,0,1),o=t.cross(n),r=t.cross(i),a=o.angleTo(r,t);return Un.wrap360(a.toDegrees())}finalBearingTo(e){if(!(e instanceof Zn))throw new TypeError(`invalid point ‘${e}’`);return Un.wrap360(e.initialBearingTo(this)+180)}midpointTo(e){if(!(e instanceof Zn))throw new TypeError(`invalid point ‘${e}’`);const t=this.toNvector(),n=e.toNvector(),i=t.plus(n);return new Gn(i.x,i.y,i.z).toLatLon()}intermediatePointTo(e,t){if(!(e instanceof Zn))throw new TypeError(`invalid point ‘${e}’`);if(isNaN(t))throw new TypeError(`invalid fraction ‘${t}’`);const n=this.toNvector(),i=e.toNvector(),o=n.cross(i).length,r=n.dot(i),a=Math.atan2(o,r)*Number(t),s=Math.sin(a),l=Math.cos(a),c=n.cross(i).unit().cross(n),u=n.times(l).plus(c.times(s));return new Gn(u.x,u.y,u.z).toLatLon()}intermediatePointOnChordTo(e,t){if(!(e instanceof Zn))throw new TypeError(`invalid point ‘${e}’`);const n=this.toNvector(),i=e.toNvector(),o=n.plus(i.minus(n).times(Number(t)));return new Gn(o.x,o.y,o.z).toLatLon()}destinationPoint(e,t,n=6371e3){const i=this.toNvector(),o=e/n,r=Number(t).toRadians(),a=new Gn(0,0,1).cross(i).unit(),s=i.cross(a),l=a.times(Math.sin(r)),c=s.times(Math.cos(r)).plus(l),u=i.times(Math.cos(o)),d=c.times(Math.sin(o)),m=u.plus(d);return new Gn(m.x,m.y,m.z).toLatLon()}static intersection(e,t,n,i){if(!(e instanceof Zn))throw new TypeError(`invalid path1start ‘${e}’`);if(!(n instanceof Zn))throw new TypeError(`invalid path2start ‘${n}’`);if(!(t instanceof Zn)&&isNaN(t))throw new TypeError(`invalid path1brngEnd ‘${t}’`);if(!(i instanceof Zn)&&isNaN(i))throw new TypeError(`invalid path2brngEnd ‘${i}’`);if(e.equals(n))return new Zn(e.lat,n.lon);const o=e.toNvector(),r=n.toNvector();let a=null,s=null,l=null,c=null;t instanceof Zn?(a=o.cross(t.toNvector()),l="endpoint"):(a=e.greatCircle(t),l="bearing"),i instanceof Zn?(s=r.cross(i.toNvector()),c="endpoint"):(s=n.greatCircle(i),c="bearing");const u=a.cross(s),d=s.cross(a);let m=null,h=null,p=null;switch(l+"+"+c){case"bearing+bearing":switch(h=Math.sign(a.cross(o).dot(u)),p=Math.sign(s.cross(r).dot(u)),h+p){case 2:m=u;break;case-2:m=d;break;case 0:m=o.plus(r).dot(u)>0?d:u}break;case"bearing+endpoint":h=Math.sign(a.cross(o).dot(u)),m=h>0?u:d;break;case"endpoint+bearing":p=Math.sign(s.cross(r).dot(u)),m=p>0?u:d;break;case"endpoint+endpoint":m=o.plus(r).plus(t.toNvector()).plus(i.toNvector()).dot(u)>0?u:d}return new Gn(m.x,m.y,m.z).toLatLon()}crossTrackDistanceTo(e,t,n=6371e3){if(!(e instanceof Zn))throw new TypeError(`invalid pathStart ‘${e}’`);if(!(t instanceof Zn)&&isNaN(t))throw new TypeError(`invalid pathBrngEnd ‘${t}’`);if(this.equals(e))return 0;const i=this.toNvector(),o=Number(n);return((t instanceof Zn?e.toNvector().cross(t.toNvector()):e.greatCircle(t)).angleTo(i)-$n/2)*o}alongTrackDistanceTo(e,t,n=6371e3){if(!(e instanceof Zn))throw new TypeError(`invalid pathStart ‘${e}’`);if(!(t instanceof Zn)&&isNaN(t))throw new TypeError(`invalid pathBrngEnd ‘${t}’`);const i=this.toNvector(),o=Number(n),r=t instanceof Zn?e.toNvector().cross(t.toNvector()):e.greatCircle(t),a=r.cross(i).cross(r);return e.toNvector().angleTo(a,r)*o}nearestPointOnSegment(e,t){let n=null;if(this.isWithinExtent(e,t)&&!e.equals(t)){const i=this.toNvector(),o=e.toNvector(),r=t.toNvector(),a=o.cross(r),s=i.cross(a),l=a.cross(s);n=new Gn(l.x,l.y,l.z).toLatLon()}else{const i=this.distanceTo(e)<this.distanceTo(t)?e:t;n=new Zn(i.lat,i.lon)}return n}isWithinExtent(e,t){if(e.equals(t))return this.equals(e);const n=this.toNvector(),i=e.toNvector(),o=t.toNvector(),r=n.minus(i),a=o.minus(i),s=n.minus(o),l=i.minus(o),c=r.dot(a),u=s.dot(l),d=n.dot(i)>=0&&n.dot(o)>=0;return c>=0&&u>=0&&d}static triangulate(e,t,n,i){const o=e.toNvector(),r=Number(t).toRadians(),a=n.toNvector(),s=Number(i).toRadians(),l=new Gn(0,0,1),c=l.cross(o).unit(),u=o.cross(c),d=c.times(Math.sin(r)),m=u.times(Math.cos(r)).plus(d),h=o.cross(m),p=l.cross(a).unit(),_=a.cross(p),f=p.times(Math.sin(s)),g=_.times(Math.cos(s)).plus(f),b=a.cross(g),y=h.cross(b);return new Gn(y.x,y.y,y.z).toLatLon()}static trilaterate(e,t,n,i,o,r,a=6371e3){const s=e.toNvector(),l=Number(t)/Number(a),c=n.toNvector(),u=Number(i)/Number(a),d=o.toNvector(),m=Number(r)/Number(a),h=c.minus(s).unit(),p=h.dot(d.minus(s)),_=d.minus(s).minus(h.times(p)).unit(),f=c.minus(s).length,g=_.dot(d.minus(s)),b=(l*l-u*u+f*f)/(2*f),y=(l*l-m*m+p*p+g*g)/(2*g)-b*p/g;if(!isFinite(b)||!isFinite(y))return null;const v=s.plus(h.times(b)).plus(_.times(y));return new Gn(v.x,v.y,v.z).toLatLon()}isEnclosedBy(e){if(!(e instanceof Array))throw new TypeError(`isEnclosedBy: polygon must be Array (not ${Vn(e)})`);if(!(e[0]instanceof Zn))throw new TypeError(`isEnclosedBy: polygon must be Array of LatLon (not ${Vn(e[0])})`);if(e.length<3)return!1;const t=e.length,n=this.toNvector(),i=[];for(let o=0;o<t;o++)i[o]=n.minus(e[o].toNvector());i.push(i[0]);let o=0;for(let e=0;e<t;e++)o+=i[e].angleTo(i[e+1],n);return Math.abs(o)>$n}static areaOf(e,t=6371e3){const n=Number(t),i=[];for(let t=0;t<e.length;t++){if(e[t].equals(e[(t+1)%e.length]))continue;const n=e[t].toNvector(),o=e[(t+1)%e.length].toNvector();i.push(n.cross(o))}const o=i.length,r=e[0].toNvector();let a=0;for(let e=0;e<o;e++)a+=i[e].angleTo(i[(e+1)%o],r);return(o*$n-Math.abs(a)-(o-2)*$n)*n*n}static centreOf(e){let t=new Gn(0,0,0);for(let n=0;n<e.length;n++){const i=e[n].toNvector(),o=e[(n+1)%e.length].toNvector(),r=i.cross(o).unit().times(i.angleTo(o)/2);t=t.plus(r)}t.angleTo(e[0].toNvector())>$n/2&&(t=t.negate());return new Gn(t.x,t.y,t.z).toLatLon()}static centerOf(e){return Zn.centreOf(e)}static meanOf(e){let t=new Gn(0,0,0);for(let n=0;n<e.length;n++)t=t.plus(e[n].toNvector());return new Gn(t.x,t.y,t.z).toLatLon()}equals(e){if(!(e instanceof Zn))throw new TypeError(`invalid point ‘${e}’`);return!(Math.abs(this.lat-e.lat)>Number.EPSILON)&&!(Math.abs(this.lon-e.lon)>Number.EPSILON)}toGeoJSON(){return{type:"Point",coordinates:[this.lon,this.lat]}}toString(e="d",t=void 0){if(!["d","dm","dms","n"].includes(e))throw new RangeError(`invalid format ‘${e}’`);if("n"==e)return null==t&&(t=4),`${this.lat.toFixed(t)},${this.lon.toFixed(t)}`;return`${Un.toLat(this.lat,e,t)}, ${Un.toLon(this.lon,e,t)}`}}class Gn extends zn{constructor(e,t,n){const i=new zn(e,t,n).unit();super(i.x,i.y,i.z)}toLatLon(){const e=this.x,t=this.y,n=this.z,i=Math.atan2(n,Math.sqrt(e*e+t*t)),o=Math.atan2(t,e);return new Zn(i.toDegrees(),o.toDegrees())}greatCircle(e){const t=Number(e).toRadians(),n=new zn(0,0,1).cross(this),i=this.cross(n),o=n.times(Math.cos(t)/n.length);return i.times(Math.sin(t)/i.length).minus(o)}toString(e=3){return`[${this.x.toFixed(e)},${this.y.toFixed(e)},${this.z.toFixed(e)}]`}}function Vn(e){return{}.toString.call(e).match(/\s([a-zA-Z0-9]+)/)[1]}const Wn=["hoveredRoomId","actions","room"],Kn=["hoveredRoomId","room","actions"];function Yn(e){return{SW:[e.top_left_latitude,e.top_left_longitude],NE:[e.bottom_right_latitude,e.bottom_right_longitude]}}function Xn(e){const t=e.getBounds();return{SW:Object.values(t.getSouthWest()),NE:Object.values(t.getNorthEast())}}function Qn(e){if(!e.length)return null;const t=e.map((e=>{let{lat:t,lng:n}=e;return new Zn(t,n)})),n=Zn.meanOf(t),i=1.1*Nn()(t.map((e=>n.distanceTo(e)))),o=n.destinationPoint(i,225),r=n.destinationPoint(i,45);return{SW:[o.lat,o.lon],NE:[r.lat,r.lon]}}function Jn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ei(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jn(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class ti extends d.Component{constructor(e){super(e),(0,pe.A)(this,"state",{loading:!0,allRoomsVisible:!1,searchVisible:!1}),(0,pe.A)(this,"onMapLoad",(async()=>{const{mapData:{filterBounds:e},actions:{toggleMapSearch:t}}=this.props;this.updateToMapBounds(),t(!rn()(e),e),this.setState({loading:!1})})),(0,pe.A)(this,"onMove",(e=>{const{searchEnabled:t,actions:{updateLocation:n}}=this.props;n(Xn(e.target),t)})),(0,pe.A)(this,"onTouch",(()=>{this.setState({searchVisible:!0})})),(0,pe.A)(this,"updateToMapBounds",(()=>{const{searchEnabled:e,actions:{updateLocation:t}}=this.props;if(this.mapRef.current){t(Xn(this.mapRef.current.leafletElement),e)}})),(0,pe.A)(this,"showAllRooms",(()=>{const{rooms:e}=this.props;this.setState({areaBounds:Qn(e),allRoomsVisible:!0})})),this.mapRef=d.createRef(),this.contextRef=d.createRef()}static getDerivedStateFromProps(e,t){const{mapData:{bounds:n,filterBounds:i}}=e,o=i||n,r=t.prevProps||e;return cn()(r,e)?ei(ei({areaBounds:o},t),{},{prevProps:r}):ei(ei({},t),{},{areaBounds:o,prevProps:e})}componentDidUpdate(e){const{mapData:{bounds:t},rooms:n}=this.props,{mapData:{bounds:i},rooms:o}=e;t===i&&n===o||sn()((()=>{const{allRoomsVisible:e}=this.state,i=!t||function(e,t){if(!e.length)return null;const n=[new Zn(t.NE[0],t.NE[1]),new Zn(t.NE[0],t.SW[1]),new Zn(t.SW[0],t.SW[1]),new Zn(t.SW[0],t.NE[1])];return e.every((e=>{let{lat:t,lng:i}=e;return new Zn(t,i).isEnclosedBy(n)}))}(n,t);i!==e&&this.setState({allRoomsVisible:!n.length||i})}))}onChangeArea(e){const{areas:t}=this.props;this.setState({areaBounds:Yn(t[e])})}render(){const{searchEnabled:e,rooms:t,areas:n,actions:i,onRoomClick:o,mapData:{bounds:r},actions:{toggleMapSearch:a}}=this.props,{areaBounds:s,loading:l,allRoomsVisible:c,searchVisible:u}=this.state,m=Object.entries(n).map((e=>{let[t,n]=e;return{text:n.name,value:Number(t)}})),h=d.createElement(jn,{position:"topleft",classes:"search-control "+(u||e?"visible":"")},d.createElement(un.A,{label:L.Translate.string("Show only rooms in this area"),checked:e,onChange:(e,t)=>a(t.checked,r),className:"rb-client-js-common-map-___MapController-module__map-control-content___ZgCKy"})),p=!!n.length&&d.createElement(jn,{position:"bottomleft"},d.createElement(k.A,{placeholder:L.Translate.string("Select area"),selection:!0,upward:!0,options:m,value:null,className:"rb-client-js-common-map-___MapController-module__areas-dropdown___X47+n rb-client-js-common-map-___MapController-module__map-control-content___ZgCKy",openOnFocus:!1,onChange:(e,t)=>this.onChangeArea(t.value)})),_=d.createElement(dn.A,{icon:"expand",className:"rb-client-js-common-map-___MapController-module__show-all-button___pxyNe rb-client-js-common-map-___MapController-module__map-control-content___ZgCKy",onClick:this.showAllRooms,disabled:c}),f=d.createElement(jn,{position:"bottomright"},d.createElement(mn.A,{trigger:_,content:L.Translate.string("Zoom out to include all listed rooms")}));return d.createElement("div",{className:"rb-client-js-common-map-___MapController-module__map-context___oBBW5",ref:this.contextRef},d.createElement(hn.A,{context:this.contextRef.current,offset:30},d.createElement(pn.A.Dimmable,null,d.createElement(pn.A,{inverted:!0,active:l,className:"rb-client-js-common-map-___MapController-module__map-dimmer___lWOw9"},d.createElement(_n.A,null)),!!s&&d.createElement(Sn,{mapRef:this.mapRef,bounds:s,rooms:t,onLoad:this.onMapLoad,onMove:this.onMove,onTouch:this.onTouch,onRoomClick:o,actions:i},d.createElement(d.Fragment,null,h,p,f)))))}}function ni(e,t){const n=(e=>t=>{let{[e]:n}=t;return{bounds:n.map.bounds,search:n.map.search,filterBounds:n.filters.bounds}})(e),i=(e=>t=>{let{[e]:n}=t;return n.map.search})(e);return(0,p.connect)((e=>({areas:It(e),rooms:t.getSearchResultsForMap(e),mapData:n(e),searchEnabled:i(e)})),(t=>({actions:{updateLocation:(n,i)=>{t(function(e,t){return{type:Ht,location:t,namespace:e}}(e,n)),i&&t(Ee(e,"bounds",n))},toggleMapSearch:(n,i)=>{t(function(e,t){return{type:Ut,search:t,namespace:e}}(e,n)),t(Ee(e,"bounds",n?i:null))},setFilterParameter:(n,i)=>{t(Ee(e,n,i))}}})))(ti)}function ii(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function oi(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ii(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ii(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}(0,pe.A)(ti,"propTypes",{areas:y().array.isRequired,rooms:y().arrayOf(y().object).isRequired,searchEnabled:y().bool.isRequired,onRoomClick:y().func.isRequired,mapData:y().shape({bounds:y().object,filterBounds:y().object}).isRequired,actions:y().exact({toggleMapSearch:y().func.isRequired,updateLocation:y().func.isRequired,setFilterParameter:y().func.isRequired}).isRequired});const ri={hoveredRoom:null},ai=(0,_e.combineReducers)({request:(0,G.Od)($t,Zt,Gt),areas:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Vt:case Yt:case Kt:return t.data;case Xt:{const{ids:n}=t;return e.filter((e=>!n.includes(e.id)))}default:return e}},ui:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ri,t=arguments.length>1?arguments[1]:void 0;return t.type===Wt?{hoveredRoom:t.roomId}:e}});function si(e){const t={bounds:null,search:!1};return function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t,i=arguments.length>1?arguments[1]:void 0;if(i.type===Vt){const e=i.data.find((e=>e.is_default))||i.data[0];return oi(oi({},n),{},{bounds:e?Yn(e):null})}if(i.namespace!==e)return n;switch(i.type){case Ht:return oi(oi({},n),{},{bounds:i.location});case Ut:return oi(oi({},n),{},{search:i.search});case U:return oi(oi({},n),{},{search:!1});default:return n}}}function li(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ci(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?li(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):li(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const ui=_.Ay.bind(null,{endpoint:"rb.favorite_rooms",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"favorite-rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1},{data:"favorite-rooms",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),di=_.Ay.bind(null,{endpoint:"rb.room_permissions",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"permissions",isDynamic:!1}]}]},"/"),mi=_.Ay.bind(null,{endpoint:"rb.rooms_permissions",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"permissions",isDynamic:!1}]}]},"/"),hi=_.Ay.bind(null,{endpoint:"rb.user_info",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"user",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),pi="user/FETCH_USER_INFO_REQUEST",_i="user/FETCH_USER_INFO_SUCCESS",fi="user/FETCH_USER_INFO_ERROR",gi="user/USER_INFO_RECEIVED",bi="user/FETCH_FAVORITES_REQUEST",yi="user/FETCH_FAVORITES_SUCCESS",vi="user/FETCH_FAVORITES_ERROR",Ei="user/FAVORITES_RECEIVED",ki="user/ADD_FAVORITE_ROOM",Ai="user/DEL_FAVORITE_ROOM",Ti="user/ALL_ROOM_PERMISSIONS_RECEIVED",wi="user/FETCH_ALL_ROOM_PERMISSIONS_REQUEST",Li="user/FETCH_ALL_ROOM_PERMISSIONS_SUCCESS",Di="user/FETCH_ALL_ROOM_PERMISSIONS_ERROR",Ci="user/ROOM_PERMISSIONS_RECEIVED",Oi="user/FETCH_ROOM_PERMISSIONS_REQUEST",Ri="user/FETCH_ROOM_PERMISSIONS_SUCCESS",Si="user/FETCH_ROOM_PERMISSIONS_ERROR",Pi="user/TOGGLE_ADMIN_OVERRIDE";async function Mi(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{t=await D.indicoAxios.request({method:e,url:ui(null!==n?{room_id:n}:{})})}catch(e){return void(0,D.handleAxiosError)(e)}return t}function xi(e){return async t=>{t({type:ki,id:e});await Mi("PUT",e)||t({type:Ai,id:e})}}function ji(e){return async t=>{t({type:Ai,id:e});await Mi("DELETE",e)||t({type:ki,id:e})}}function Ii(e){return(0,G.P$)((()=>D.indicoAxios.get(di({room_id:e}))),Oi,[Ci,Ri],Si,(t=>ci(ci({},t),{},{id:e})))}function Bi(){return(0,G.P$)((()=>D.indicoAxios.get(mi())),wi,[Ti,Li],Di)}function Ni(){return{type:Pi}}const Fi=e=>{let{user:t}=e;return t.requests.info.state===G.X_.SUCCESS},zi=e=>{let{user:t}=e;return t.info},qi=e=>zi(e).isRBAdmin,Hi=e=>zi(e).isAdmin,Ui=e=>zi(e).isAdminOverrideEnabled,$i=e=>zi(e).hasOwnedRooms,Zi=e=>{let{user:t}=e;return t.roomPermissions},Gi=e=>{let{user:t}=e;return t.requests.roomPermissions.state===G.X_.STARTED},Vi=(0,jt.Mz)(Zi,Ui,((e,t)=>e?t&&e.admin?e.admin:e.user:{})),Wi=(0,jt.Mz)(Vi,(e=>Object.entries(e).filter((e=>{let[,t]=e;return!t.book&&!t.prebook})).map((e=>{let[t]=e;return+t})))),Ki=(0,jt.Mz)(Vi,(e=>Object.entries(e).filter((e=>{let[,t]=e;return t.manage})).map((e=>{let[t]=e;return+t})))),Yi=(0,jt.Mz)(Wi,(e=>!!e.length)),Xi=e=>{let{user:t}=e;return t.favorites},Qi=(0,jt.Mz)(Xi,(e=>Object.values(e).some((e=>e)))),Ji=()=>(0,jt.Mz)(Xi,((e,t)=>{let{room:n}=t;return n.id}),((e,t)=>!!e[t]));function eo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function to(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eo(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const no={firstName:"",lastName:"",email:"",avatarURL:"",language:"",isAdmin:!1,isRBAdmin:!1,isAdminOverrideEnabled:!1,hasOwnedRooms:!1},io=(0,_e.combineReducers)({requests:(0,_e.combineReducers)({info:(0,G.Od)(pi,_i,fi),favorites:(0,G.Od)(bi,yi,vi),roomPermissions:(0,G.Od)(Oi,Ri,Si)}),info:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:no,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case gi:{const n=t.data;return to(to({},e),{},{id:n.id,identifier:n.identifier,firstName:n.first_name,lastName:n.last_name,fullName:n.full_name,email:n.email,avatarURL:n.avatar_url,language:n.language,isAdmin:n.is_admin,isRBAdmin:n.is_rb_admin,hasOwnedRooms:n.has_owned_rooms})}case Pi:return to(to({},e),{},{isAdminOverrideEnabled:!e.isAdminOverrideEnabled});default:return e}},favorites:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ei:return t.data.reduce(((e,t)=>to(to({},e),{},{[t]:!0})),{});case ki:return to(to({},e),{},{[t.id]:!0});case Ai:return to(to({},e),{},{[t.id]:!1});default:return e}},roomPermissions:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{admin:null,user:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ti:return t.data;case Ci:{const{id:n,user:i,admin:o}=t.data;return{admin:e.admin?to(to({},e.admin),{},{[n]:o}):null,user:to(to({},e.user),{},{[n]:i})}}default:return e}}});var oo=n(87597),ro=n(45423),ao=n(82054);const so=_.Ay.bind(null,{endpoint:"rb.equipment_types",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"equipment",isDynamic:!1}]}]},"/"),lo=_.Ay.bind(null,{endpoint:"rb.room",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0}]}]},"/"),co=_.Ay.bind(null,{endpoint:"rb.room_attributes",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"attributes",isDynamic:!1}]}]},"/"),uo=_.Ay.bind(null,{endpoint:"rb.room_availability",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"availability",isDynamic:!1}]}]},"/"),mo=_.Ay.bind(null,{endpoint:"rb.rooms",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),ho="rooms/FETCH_EQUIPMENT_TYPES_REQUEST",po="rooms/FETCH_EQUIPMENT_TYPES_SUCCESS",_o="rooms/FETCH_EQUIPMENT_TYPES_ERROR",fo="rooms/EQUIPMENT_TYPES_RECEIVED",go="rooms/ROOM_DETAILS_RECEIVED",bo="rooms/FETCH_ROOM_DETAILS_REQUEST",yo="rooms/FETCH_ROOM_DETAILS_SUCCESS",vo="rooms/FETCH_ROOM_DETAILS_ERROR",Eo="rooms/ROOMS_RECEIVED",ko="rooms/FETCH_ROOMS_REQUEST",Ao="rooms/FETCH_ROOMS_SUCCESS",To="rooms/FETCH_ROOMS_ERROR",wo="rooms/AVAILABILITY_RECEIVED",Lo="rooms/FETCH_AVAILABILITY_REQUEST",Do="rooms/FETCH_AVAILABILITY_SUCCESS",Co="rooms/FETCH_AVAILABILITY_ERROR",Oo="rooms/ATTRIBUTES_RECEIVED",Ro="rooms/FETCH_ATTRIBUTES_REQUEST",So="rooms/FETCH_ATTRIBUTES_SUCCESS",Po="rooms/FETCH_ATTRIBUTES_ERROR";function Mo(){return(0,G.P$)((()=>D.indicoAxios.get(so())),ho,[fo,po],_o)}function xo(){return(0,G.P$)((()=>D.indicoAxios.get(mo())),ko,[Eo,Ao],To)}function jo(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return async n=>{n(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return async(n,i)=>{const{rooms:{availability:o}}=i();if(t||!(e in o))return await(0,G.P$)((()=>D.indicoAxios.get(uo({room_id:e}))),Lo,[wo,Do],Co,(t=>({id:e,availability:(0,fe.camelizeKeys)(t)})))(n)}}(e,t)),n(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return async(n,i)=>{const{rooms:{attributes:o}}=i();if(t||!(e in o))return await(0,G.P$)((()=>D.indicoAxios.get(co({room_id:e}))),Ro,[Oo,So],Po,(t=>({id:e,attributes:t})))(n)}}(e,t))}}const Io=e=>Z("room-details",e),Bo=e=>Z("room-details-book",e);var No=n(72495),Fo=n.n(No),zo=n(68373),qo=n.n(zo);const Ho=["availableEquipment"],Uo=["id"];function $o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Zo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$o(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Go=e=>{let{rooms:t}=e;return t.equipmentTypes},Vo=(0,jt.Mz)(Go,(e=>e.filter((e=>e.used)))),Wo=(0,jt.Mz)(Vo,(e=>{const t={};return e.forEach((e=>{let{name:n,features:i}=e;i.forEach((e=>{e.name in t||(t[e.name]=Zo(Zo({},e),{},{equipment:[]})),t[e.name].equipment.push(n)}))})),t})),Ko=(0,jt.Mz)(Vo,Wo,((e,t)=>e.filter((e=>e.features.every((e=>t[e.name].equipment.length>1)))).map((e=>e.name)).sort())),Yo=(0,jt.Mz)(Wo,(e=>(e=Object.values(e).map((e=>qo()(e,["icon","name","title"]))),g()(e,"title")))),Xo=(0,jt.Mz)((e=>{let{rooms:t}=e;return t.rooms}),Go,Vi,qi,ie,me,((e,t,n,i,o,r)=>(t=t.reduce(((e,t)=>Zo(Zo({},e),{},{[t.id]:t})),{}),Fo()(e.map((e=>{const{availableEquipment:a}=e,s=(0,In.A)(e,Ho),l={};a.map((e=>t[e])).forEach((e=>{e.features.forEach((t=>{let{id:n}=t,i=(0,In.A)(t,Uo);n in l||(l[n]=Zo(Zo({},i),{},{equipment:[]})),l[n].equipment.push(e.name)}))}));const c=g()(Object.values(l),"title");c.forEach((e=>e.equipment.sort()));const u=n[e.id]||{book:!1,prebook:!1,override:!1,manage:!1};return[e.id,Zo(Zo({},s),{},{equipment:a.map((e=>t[e].name)).sort(),features:c,canUserViewInternalNotes:u.manage&&r,canUserEdit:u.manage&&(i||o),canUserBook:u.book,canUserPrebook:u.prebook,canUserOverride:u.override})]})))))),Qo=(e,t)=>{let{roomId:n}=t;return Xo(e)[n]},Jo=(e,t)=>{let{roomId:n}=t;return(e=>{let{rooms:t}=e;return t.availability})(e)[n]},er=(e,t)=>{let{roomId:n}=t;return(e=>{let{rooms:t}=e;return t.attributes})(e)[n]},tr=(0,jt.Mz)(Jo,er,(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every((e=>void 0!==e))})),nr=(0,jt.Mz)(Xo,(e=>{const t=new Set(Object.values(e).map((e=>e.building)));return Array.from(t).sort(((e,t)=>parseInt(e,10)-parseInt(t,10)))})),ir=(0,jt.Mz)(Xo,(e=>new Map(Object.values(e).map((e=>[e.locationId,e.locationName])))));var or=n(3902),rr=n.n(or),ar=n(29650),sr=n.n(ar),lr=n(14867),cr=n.n(lr);const ur=["dispatch"];function dr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function mr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dr(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hr(e,t){return fr(Object.assign(...Object.entries(t).map((t=>{let[n,i]=t;if("object"==typeof i){const{serializer:t,onlyIf:n}=i;if(i=t,!n(e))return{}}const o=i(e);return void 0===o?{}:{[n]:o}}))))}function pr(e,t,n,i){const o=cr().isMoment(e),r=o?e.clone():cr()(e);return"daily"===t?r.add(1,"weeks"):"week"===i?r.add(4*n,"weeks"):r.add(6*n,"months"),o?r:(0,De.serializeDate)(r)}function _r(e){const{dates:{endDate:t,startDate:n},recurrence:{type:i,interval:o,number:r}}=e;"single"===i&&t?e.dates=mr(mr({},e.dates),{},{endDate:null}):"single"!==i&&n&&!t&&(e.dates=mr(mr({},e.dates),{},{endDate:pr(n,i,r,o)}))}function fr(e){return Object.entries(e).length?Object.assign(...Object.entries(e).map((e=>{let[t,n]=e;return null===n?{}:Array.isArray(n)?{[t]:n.filter((e=>null!==e))}:"object"==typeof n?{[t]:fr(n)}:{[t]:n}}))):{}}function gr(e){return{serialize:t=>sr()(t,e)||null,parse:(t,n)=>{rr()(n,e,t)}}}function br(e,t){return{serialize:n=>{const i=sr()(n,e,null);return i===t?null:i},parse:(t,n)=>{rr()(n,e,t)}}}function yr(e,t,n){return e&&0!==t.filter((t=>n(t).isSame(e,"day"))).length}function vr(e){let{content:t,children:n}=e;const i=d.createElement("span",null,n);return d.createElement(mn.A,{trigger:i,content:t,position:"right center"})}function Er(e){let{type:t,number:n,interval:i}=e,o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t?"single"===t?d.createElement(xt.Responsive.Tablet,{andSmaller:!0,onlyIf:o,orElse:L.Translate.string("Once")},d.createElement(L.Translate,{context:"single booking shortcut"},"S")):"daily"===t?d.createElement(xt.Responsive.Tablet,{andSmaller:!0,onlyIf:o,orElse:L.Translate.string("Daily")},d.createElement(L.Translate,{context:"daily booking shortcut"},"D")):"week"===i?d.createElement(xt.Responsive.Tablet,{andSmaller:!0,onlyIf:o,orElse:L.PluralTranslate.string("Weekly","Every {number} weeks",n,"repetition",{number:n})},d.createElement(L.Translate,{context:"weekly booking shortcut"},d.createElement(L.Param,{name:"number",value:n>1?n:""}),"W")):d.createElement(xt.Responsive.Tablet,{andSmaller:!0,onlyIf:o,orElse:L.PluralTranslate.string("Monthly","Every {number} months",n,"repetition",{number:n})},d.createElement(L.Translate,{context:"monthly booking shortcut"},d.createElement(L.Param,{name:"number",value:n>1?n:""}),"M")):null}function kr(e){const[t,n,i]=e;let o="single",r="1",a="week",s=[];return 1===t?o="daily":2===t?(o="every",a="week",r=n,s=i):3===t&&(o="every",a="month",r=n),{type:o,number:r,interval:a,weekdays:s}}function Ar(e){const t={mon:cr().weekdays(1),tue:cr().weekdays(2),wed:cr().weekdays(3),thu:cr().weekdays(4),fri:cr().weekdays(5),sat:cr().weekdays(6),sun:cr().weekdays(0)};if(null===e||0===e.length)return null;if(e.some((e=>!Object.keys(t).includes(e))))return null;const n=["mon","tue","wed","thu","fri","sat","sun"],i=e.sort(((e,t)=>n.indexOf(e)-n.indexOf(t)));return new Intl.ListFormat(cr().locale(),{style:"long",type:"conjunction"}).format(i.map((e=>t[e])))}vr.propTypes={content:y().object.isRequired,children:y().object},vr.defaultProps={children:null};const Tr={candidates:{label:L.Translate.string("Available"),style:"available"},bookings:{label:L.Translate.string("Booking"),style:"booking"},preBookings:{label:L.Translate.string("Pre-Booking"),style:"pre-booking"},conflicts:{label:L.Translate.string("Conflict"),style:"conflict"},preConflicts:{label:L.Translate.string("Conflict with Pre-Booking"),style:"pre-booking-conflict"},conflictingCandidates:{label:L.Translate.string("Invalid occurrence"),style:"conflicting-candidate"},other:{label:L.Translate.string("Other booking"),style:"other"},rejections:{label:L.Translate.string("Rejected"),style:"rejection"},cancellations:{label:L.Translate.string("Cancelled"),style:"cancellation"},pendingCancellations:{label:L.Translate.string("Will be cancelled"),style:"pending-cancellation"},blockings:{label:L.Translate.string("Blocking"),style:"blocking"},overridableBlockings:{label:L.Translate.string("Blocking (allowed)"),style:"overridable-blocking"},nonbookablePeriods:{label:L.Translate.string("Not bookable"),style:"unbookable"},unbookableHours:{label:L.Translate.string("Not bookable"),style:"unbookable"},concurrentPreBookings:{label:L.Translate.string("Concurrent Pre-Bookings"),style:"concurrent-pre-booking"}},wr=["candidates","bookings","preBookings","concurrentPreBookings","conflicts","preConflicts","conflictingCandidates","rejections","cancellations","pendingCancellations","other","blockings","overridableBlockings","nonbookablePeriods","unbookableHours"];function Lr(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return wr.reduce(((n,i)=>{const o=Tr[i];return!e.includes(i)||t.includes(i)||n.some((e=>e.style===o.style))||n.push(Tr[i]),n}),[])}function Dr(e){return Object.entries(e).reduce(((e,t)=>{let[n,i]=t;return i&&Object.keys(i).length>0&&wr.includes(n)&&e.push(n),e}),[])}const Cr=e=>function(t){let{dates:n,timeSlot:i}=t;const o=void 0===i?"":i[`${e}Time`];let r=n[`${e}Date`];return null===r&&"end"===e&&(r=n.startDate),`${r} ${o||""}`.trimRight()},Or={onlyIf:e=>e.recurrence&&e.recurrence.interval&&e.recurrence.type,serializer:e=>{let{recurrence:{type:t,interval:n}}=e;return"single"===t?"NEVER":"daily"===t?"DAY":{week:"WEEK",month:"MONTH"}[n]}},Rr={onlyIf:e=>"recurrence"in e,serializer:e=>{let{recurrence:{type:t,number:n}}=e;return"single"===t?0:"daily"===t?1:n}},Sr={onlyIf:e=>e.recurrence&&"every"===e.recurrence.type&&e.recurrence.weekdays,serializer:e=>{let{recurrence:{weekdays:t}}=e;return t}},Pr={repeat_frequency:Or,repeat_interval:Rr,recurrence_weekdays:Sr,capacity:e=>{let{capacity:t}=e;return t},favorite:{onlyIf:e=>{let{onlyFavorites:t}=e;return t},serializer:e=>{let{onlyFavorites:t}=e;return t}},equipment:{onlyIf:e=>{let{equipment:t}=e;return t&&t.length},serializer:e=>{let{equipment:t}=e;return t}},feature:{onlyIf:e=>{let{features:t}=e;return t&&t.length},serializer:e=>{let{features:t}=e;return t}},mine:{onlyIf:e=>{let{onlyMine:t}=e;return t},serializer:e=>{let{onlyMine:t}=e;return t}},building:e=>{let{building:t}=e;return t},location_id:e=>{let{locationId:t}=e;return t},text:e=>{let{text:t}=e;return t},division:e=>{let{division:t}=e;return t},start_dt:{onlyIf:e=>e.dates&&e.dates.startDate,serializer:Cr("start")},end_dt:{onlyIf:e=>e.dates,serializer:Cr("end")},sw_lat:{onlyIf:e=>e.bounds&&"SW"in e.bounds,serializer:e=>{let{bounds:{SW:t}}=e;return t[0]}},sw_lng:{onlyIf:e=>e.bounds&&"SW"in e.bounds,serializer:e=>{let{bounds:{SW:t}}=e;return t[1]}},ne_lat:{onlyIf:e=>e.bounds&&"NE"in e.bounds,serializer:e=>{let{bounds:{NE:t}}=e;return t[0]}},ne_lng:{onlyIf:e=>e.bounds&&"NE"in e.bounds,serializer:e=>{let{bounds:{NE:t}}=e;return t[1]}}},Mr=_.Ay.bind(null,{endpoint:"rb.search_rooms",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"search",isDynamic:!1}]}]},"/");function xr(e){const t=`${e}/SEARCH_RESULTS_RECEIVED`,n=`${e}/SEARCH_ROOMS_REQUEST`,i=`${e}/SEARCH_ROOMS_SUCCESS`,o=`${e}/SEARCH_ROOMS_ERROR`;return{SEARCH_RESULTS_RECEIVED:t,SEARCH_ROOMS_REQUEST:n,SEARCH_ROOMS_SUCCESS:i,SEARCH_ROOMS_ERROR:o,searchRooms:function(){return async(r,a)=>{const s=a(),{filters:l}=s[e];if(!Ce(l,e,r))return;const c=hr(l,Pr);return"bookRoom"===e&&Ui(s)&&(c.admin_override_enabled=!0),await(0,G.P$)((()=>D.indicoAxios.get(Mr(),{params:c})),n,[t,i],o)(r)}}}}function jr(e){const t=t=>{let{[e]:n}=t;return n.search.results.rooms},n=(0,jt.Mz)(t,Xo,((e,t)=>e.map((e=>t[e]))));return{getFilters:t=>{let{[e]:n}=t;return n.filters},isSearching:t=>{let{[e]:n}=t;return n.search.request.state===G.X_.STARTED},isSearchFinished:t=>{let{[e]:n}=t;return n.search.request.state===G.X_.SUCCESS},isSearchFailed:t=>{let{[e]:n}=t;return n.search.request.state===G.X_.ERROR},getSearchFailedMessage:t=>{var n;let{[e]:i}=t;return null===(n=i.search.request.error)||void 0===n?void 0:n.message},getSearchResults:n,getSearchResultIds:t,getSearchResultIdsWithoutAvailabilityFilter:t=>{let{[e]:n}=t;return n.search.results.roomsWithoutAvailabilityFilter},getTotalResultCount:t=>{let{[e]:n}=t;return n.search.results.total},getSearchResultsForMap:(0,jt.Mz)(n,(e=>e.filter((e=>null!==e.latitude&&null!==e.longitude)).map((e=>({id:e.id,name:e.name,building:e.building,floor:e.floor,number:e.number,fullName:e.fullName,lat:e.latitude,lng:e.longitude,canUserBook:e.canUserBook}))))),getAvailabilityDateRange:t=>{let{[e]:n}=t;return n.search.results.availabilityDays}}}const Ir={start_dt:Cr("start"),end_dt:Cr("end"),repeat_frequency:Or,repeat_interval:Rr,recurrence_weekdays:Sr,reason:e=>{let{reason:t}=e;return t},user:{onlyIf:e=>{let{usage:t}=e;return"someone"===t},serializer:e=>{let{user:t}=e;return t}},room_id:e=>{let{room:{id:t}}=e;return t},is_prebooking:e=>{let{isPrebooking:t}=e;return t},internal_note:e=>{let{internalNote:t}=e;return t},link_type:e=>{let{linkType:t}=e;return t},link_id:e=>{let{linkId:t}=e;return t},link_back:e=>{let{linkBack:t}=e;return t},extra_fields:e=>{let{extraFields:t}=e;return t}},Br=_.Ay.bind(null,{endpoint:"rb.create_booking",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"booking",isDynamic:!1},{data:"/",isDynamic:!1},{data:"create",isDynamic:!1}]}]},"/"),Nr=_.Ay.bind(null,{endpoint:"rb.events",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"events",isDynamic:!1}]}]},"/"),Fr=_.Ay.bind(null,{endpoint:"rb.search_rooms",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"search",isDynamic:!1}]}]},"/"),zr=_.Ay.bind(null,{endpoint:"rb.suggestions",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"suggestions",isDynamic:!1}]}]},"/"),qr=_.Ay.bind(null,{endpoint:"rb.timeline",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"timeline",isDynamic:!1}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"timeline",isDynamic:!1}]}]},"/"),Hr="bookRoom/CREATE_BOOKING_REQUEST",Ur="bookRoom/CREATE_BOOKING_SUCCESS",$r="bookRoom/CREATE_BOOKING_FAILED",Zr="bookRoom/GET_BOOKING_AVAILABILITY_REQUEST",Gr="bookRoom/GET_BOOKING_AVAILABILITY_SUCCESS",Vr="bookRoom/GET_BOOKING_AVAILABILITY_ERROR",Wr="bookRoom/RESET_BOOKING_AVAILABILITY",Kr="bookRoom/SET_BOOKING_AVAILABILITY",Yr="bookRoom/TOGGLE_TIMELINE_VIEW",Xr="bookRoom/INIT_TIMELINE",Qr="bookRoom/ADD_TIMELINE_ROOMS",Jr="bookRoom/GET_TIMELINE_REQUEST",ea="bookRoom/GET_TIMELINE_SUCCESS",ta="bookRoom/GET_TIMELINE_ERROR",na="bookRoom/TIMELINE_RECEIVED",ia="bookRoom/SET_TIMELINE_MODE",oa="bookRoom/SET_TIMELINE_DATE",ra="bookRoom/GET_UNAVAILABLE_TIMELINE_REQUEST",aa="bookRoom/GET_UNAVAILABLE_TIMELINE_SUCCESS",sa="bookRoom/GET_UNAVAILABLE_TIMELINE_ERROR",la="bookRoom/UNAVAILABLE_TIMELINE_RECEIVED",ca="bookRoom/SET_UNAVAILABLE_NAV_MODE",ua="bookRoom/SET_UNAVAILABLE_NAV_DATE",da="bookRoom/INIT_UNAVAILABLE_TIMELINE",ma="bookRoom/FETCH_SUGGESTIONS_REQUEST",ha="bookRoom/FETCH_SUGGESTIONS_SUCCESS",pa="bookRoom/FETCH_SUGGESTIONS_ERROR",_a="bookRoom/SUGGESTIONS_RECEIVED",fa="bookRoom/RESET_SUGGESTIONS",ga="bookRoom/FETCH_RELATED_EVENTS_REQUEST",ba="bookRoom/FETCH_RELATED_EVENTS_SUCCESS",ya="bookRoom/FETCH_RELATED_EVENTS_ERROR",va="bookRoom/RELATED_EVENTS_RECEIVED",Ea="bookRoom/RESET_RELATED_EVENTS";function ka(){return{type:Wr}}function Aa(e,t){return async(n,i)=>{const o=i(),{dates:r,timeSlot:a,recurrence:s}=t,l=hr({dates:r,timeSlot:a,recurrence:s},Pr);return Ui(o)&&(l.admin_override_enabled=!0),await(0,G.P$)((()=>D.indicoAxios.get(qr({room_id:e.id}),{params:l})),Zr,[Kr,Gr],Vr)(n)}}function Ta(e){return async(t,n)=>{t({type:ra});const i=n(),o=Ui(i),r=hr(e,Pr);let a;r.unavailable=!0,o&&(r.admin_override_enabled=!0);try{a=await D.indicoAxios.get(Fr(),{params:r})}catch(e){const n=(0,D.handleAxiosError)(e);return void t({type:sa,error:n})}const s=a.data.rooms,{dates:l,timeSlot:c,recurrence:u}=e,d=hr({dates:l,timeSlot:c,recurrence:u},Pr);return o&&(d.admin_override_enabled=!0),await(0,G.P$)((()=>D.indicoAxios.post(qr(),{room_ids:s},{params:d})),null,[la,aa],sa)(t)}}function wa(e,t,n,i){return{type:Xr,params:{dates:t,timeSlot:n,recurrence:i},roomIds:e}}function La(e){return{type:Qr,roomIds:e}}function Da(){return async(e,t)=>{const n=t(),{bookRoom:{timeline:{data:{params:i,roomIds:o,availability:r}}}}=n,a=hr(i,Pr);Ui(n)&&(a.admin_override_enabled=!0);const s=r.length,l=o.slice(s,s+20);return l.length?await(0,G.P$)((()=>D.indicoAxios.post(qr(),{room_ids:l},{params:a})),Jr,[na,ea],ta)(e):(console.warn("Tried to fetch timeline for zero rooms"),Promise.reject())}}function Ca(e){return{type:Yr,visible:e}}function Oa(){return async(e,t)=>{const{bookRoom:{filters:n}}=t();if(!Ce(n,"bookRoom",e))return;const i=hr(n,Pr);return await(0,G.P$)((()=>D.indicoAxios.get(zr(),{params:i})),ma,[_a,ha],pa)(e)}}function Ra(){return{type:fa}}const{searchRooms:Sa}=xr("bookRoom"),Pa=function(e){return Z("book-room",e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)},Ma=()=>Z("unavailable-rooms"),xa=(e,t)=>Z("booking-form",e,t);function ja(e){return{type:ia,mode:e}}function Ia(e){return{type:ca,mode:e}}function Ba(e,t){return{type:da,selectedDate:e,mode:t}}function Na(e){const{dates:t,timeSlot:n,recurrence:i}=e,o=hr({dates:t,timeSlot:n,recurrence:i},Pr);return(0,G.P$)((()=>D.indicoAxios.get(Nr(),{params:o})),ga,[va,ba],ya)}function Fa(){return{type:Ea}}const za=_.Ay.bind(null,{endpoint:"rb.booking_details",rules:[{args:["booking_id"],converters:{booking_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"bookings",isDynamic:!1},{data:"/",isDynamic:!1},{data:"booking_id",isDynamic:!0}]}]},"/"),qa=_.Ay.bind(null,{endpoint:"rb.booking_occurrence_link",rules:[{args:["booking_id","date","event_id"],converters:{booking_id:"IntegerConverter",event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"bookings",isDynamic:!1},{data:"/",isDynamic:!1},{data:"booking_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"date",isDynamic:!0},{data:"/",isDynamic:!1},{data:"link",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0}]}]},"/"),Ha=_.Ay.bind(null,{endpoint:"rb.booking_occurrence_state_actions",rules:[{args:["action","booking_id","date"],converters:{action:"AnyConverter",booking_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"bookings",isDynamic:!1},{data:"/",isDynamic:!1},{data:"booking_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"date",isDynamic:!0},{data:"/",isDynamic:!1},{data:"action",isDynamic:!0}]}]},"/"),Ua=_.Ay.bind(null,{endpoint:"rb.booking_state_actions",rules:[{args:["action","booking_id"],converters:{action:"AnyConverter",booking_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"bookings",isDynamic:!1},{data:"/",isDynamic:!1},{data:"booking_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"action",isDynamic:!0}]}]},"/"),$a=_.Ay.bind(null,{endpoint:"rb.delete_booking",rules:[{args:["booking_id"],converters:{booking_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"bookings",isDynamic:!1},{data:"/",isDynamic:!1},{data:"booking_id",isDynamic:!0}]}]},"/"),Za=_.Ay.bind(null,{endpoint:"rb.update_booking",rules:[{args:["booking_id"],converters:{booking_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"bookings",isDynamic:!1},{data:"/",isDynamic:!1},{data:"booking_id",isDynamic:!0}]}]},"/"),Ga="bookings/BOOKING_DETAILS_RECEIVED",Va="bookings/FETCH_BOOKING_DETAILS_REQUEST",Wa="bookings/FETCH_BOOKING_DETAILS_SUCCESS",Ka="bookings/FETCH_BOOKING_DETAILS_ERROR",Ya="bookings/BOOKING_STATE_CHANGE_REQUEST",Xa="bookings/BOOKING_STATE_CHANGE_SUCCESS",Qa="bookings/BOOKING_STATE_CHANGE_ERROR",Ja="bookings/BOOKING_STATE_UPDATED",es="bookings/DELETE_BOOKING_SUCCESS",ts="bookings/UPDATED_BOOKING_RECEIVED",ns="bookings/BOOKING_OCCURRENCE_STATE_UPDATED";function is(e){return(0,G.P$)((()=>D.indicoAxios.get(za({booking_id:e}))),Va,[Ga,Wa],Ka)}const os=e=>Z("booking-details",e);function rs(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,G.P$)((()=>D.indicoAxios.post(Ua({booking_id:e,action:t}),n)),Ya,[Ja,Xa],Qa)}function as(e){return(0,G.P$)((()=>D.indicoAxios.delete($a({booking_id:e}))),"bookings/DELETE_BOOKING_REQUEST",es,"bookings/DELETE_BOOKING_ERROR")}function ss(e,t){return(0,G.HX)((()=>D.indicoAxios.patch(Za({booking_id:e}),t)),"bookings/UPDATE_BOOKING_REQUEST",["bookings/UPDATE_BOOKING_SUCCESS",ts],"bookings/UPDATE_BOOKING_ERROR",{booking_reason:"reason"})}function ls(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return(0,G.P$)((()=>D.indicoAxios.post(Ha({booking_id:e,date:t,action:n}),i)),"bookings/BOOKING_OCCURRENCE_STATE_CHANGE_REQUEST",[ns,"bookings/BOOKING_OCCURRENCE_STATE_CHANGE_SUCCESS"],"bookings/BOOKING_OCCURRENCE_STATE_CHANGE_ERROR")}function cs(e,t,n,i,o){const r={};return i&&(r.admin_override_enabled=!0),(0,G.P$)((()=>D.indicoAxios.post(qa({booking_id:e,date:t,event_id:n}),null,{params:r})),"bookings/BOOKING_OCCURRENCE_LINK_CHANGE_REQUEST",["bookings/BOOKING_OCCURRENCE_LINK_UPDATED",()=>(o&&o(),{type:"bookings/BOOKING_OCCURRENCE_LINK_CHANGE_SUCCESS"})],"bookings/BOOKING_OCCURRENCE_LINK_CHANGE_ERROR")}function us(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ds(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?us(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):us(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ms(e,t){return e.map((e=>{const n=(e.bookings||[]).filter((e=>e.reservation.id!==t));return ds(ds({},e),{},{bookings:n})}))}const hs=(0,_e.combineReducers)({requests:(0,_e.combineReducers)({equipmentTypes:(0,G.Od)(ho,po,_o),rooms:(0,G.Od)(ko,Ao,To),availability:(0,G.Od)(Lo,Do,Co),attributes:(0,G.Od)(Ro,So,Po)}),equipmentTypes:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return t.type===fo?(0,fe.camelizeKeys)(t.data):e},rooms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Eo:return(0,fe.camelizeKeys)(t.data);case go:return[...e.filter((e=>e.id!==t.data.id)),(0,fe.camelizeKeys)(t.data)];default:return e}},availability:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case wo:{const{id:n,availability:i}=t.data;return ds(ds({},e),{},{[n]:i})}case Ur:{const{calendarData:{bookings:n},roomId:i}=(0,fe.camelizeKeys)(t.data);if(!n)return e;const{[i]:o}=e,r=o.map((e=>{if(!(e.day in n))return e;const t=e.bookings||[];return ds(ds({},e),{},{bookings:[...t,...n[e.day]]})}));return ds(ds({},e),{},{[i]:r})}case Ja:{const{booking:{id:n,roomId:i,state:o}}=(0,fe.camelizeKeys)(t.data);if("rejected"===o||"cancelled"===o){const{[i]:t}=e;return t?ds(ds({},e),{},{[i]:ms(t,n)}):e}return e}case es:{const{roomId:n,bookingId:i}=(0,fe.camelizeKeys)(t.data),{[n]:o}=e;return o?ds(ds({},e),{},{[n]:ms(o,i)}):e}default:return e}},attributes:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(t.type===Oo){const{id:n,attributes:i}=t.data;return ds(ds({},e),{},{[n]:i})}return e}}),ps=e=>{let{roomId:t,fetchDetails:n,children:i}=e;return d.createElement(xt.Preloader,{checkCached:e=>tr(e,{roomId:t}),action:()=>n(t,!0),dimmer:d.createElement(pn.A,{active:!0,page:!0},d.createElement(_n.A,null)),alwaysLoad:!0},i)};ps.propTypes={roomId:y().number.isRequired,fetchDetails:y().func.isRequired,children:y().func.isRequired};const _s=(0,p.connect)(null,(e=>(0,_e.bindActionCreators)({fetchDetails:jo},e)))(ps);function fs(){return fs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},fs.apply(this,arguments)}function gs(e,t,n,i){n[i]=fs({},e[t],{name:i,change:e[i]&&e[i].change,blur:e[i]&&e[i].blur,focus:e[i]&&e[i].focus,lastFieldState:void 0}),n[i].change||delete n[i].change,n[i].blur||delete n[i].blur,n[i].focus||delete n[i].focus}var bs=function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},ys=function(e,t,n){var i=e[0],o=e[1],r=e[2];(0,n.changeValue)(t,i,(function(e){var t=[].concat(e||[]);return t.splice(o,0,r),t}));var a=new RegExp("^"+bs(i)+"\\[(\\d+)\\](.*)"),s={};Object.keys(t.fields).forEach((function(e){var n=a.exec(e);if(n){var r=Number(n[1]);if(r>=o){var l=i+"["+(r+1)+"]"+n[2];return void gs(t.fields,e,s,l)}}s[e]=t.fields[e]})),t.fields=s},vs=function(e,t,n){var i,o=e[0],r=e[1],a=n.changeValue,s=n.getIn,l=n.setIn;a(t,o,(function(e){if(!e)return e;var t=[].concat(e);return i=t[r],t.splice(r,1),t.length>0?t:void 0}));var c=new RegExp("^"+bs(o)+"\\[(\\d+)\\](.*)"),u={};return Object.keys(t.fields).forEach((function(e){var n=c.exec(e);if(n){var i=Number(n[1]);if(i===r){if(e===o+"["+r+"]"){var a="formState.submitErrors."+o,d=s(t,a);Array.isArray(d)&&(d.splice(r,1),t=l(t,a,d))}return}if(i>r){var m=o+"["+(i-1)+"]"+n[2];return void gs(t.fields,e,u,m)}}u[e]=t.fields[e]})),t.fields=u,i};const Es={insert:ys,concat:function(e,t,n){var i=e[0],o=e[1];(0,n.changeValue)(t,i,(function(e){return e?[].concat(e,o):o}))},move:function(e,t,n){var i=e[0],o=e[1],r=e[2],a=n.changeValue;if(o!==r){a(t,i,(function(e){var t=[].concat(e||[]),n=t[o];return t.splice(o,1),t.splice(r,0,n),t}));var s,l,c,u={},d=new RegExp("^"+bs(i)+"\\[(\\d+)\\](.*)");o>r?(s=r,l=o,c=1):(s=o,l=r,c=-1),Object.keys(t.fields).forEach((function(e){var n=d.exec(e);if(n){var a=Number(n[1]);if(a===o){var m=i+"["+r+"]"+n[2];return void gs(t.fields,e,u,m)}if(s<=a&&a<=l){var h=i+"["+(a+c)+"]"+n[2];return void gs(t.fields,e,u,h)}}u[e]=t.fields[e]})),t.fields=u}},pop:function(e,t,n){var i=e[0],o=(0,n.getIn)(t.formState.values,i);return o&&o.length>0?vs([i,o.length-1],t,n):void 0},push:function(e,t,n){var i=e[0],o=e[1];(0,n.changeValue)(t,i,(function(e){return e?[].concat(e,[o]):[o]}))},remove:vs,removeBatch:function(e,t,n){var i=e[0],o=e[1],r=n.changeValue;if(0===o.length)return[];var a=[].concat(o);a.sort();for(var s=a.length-1;s>0;s-=1)a[s]===a[s-1]&&a.splice(s,1);var l=[];r(t,i,(function(e){if(l=o.map((function(t){return e&&e[t]})),!e)return e;for(var t=[].concat(e),n=a.length-1;n>=0;n-=1){var i=a[n];t.splice(i,1)}return t.length>0?t:void 0}));var c=new RegExp("^"+bs(i)+"\\[(\\d+)\\](.*)"),u={};return Object.keys(t.fields).forEach((function(e){var n=c.exec(e);if(n){var o=Number(n[1]),r=function(e,t){for(var n=0,i=e.length-1,o=0;n<=i;){if(e[o=Math.floor((n+i)/2)]===t)return o;e[o]>t?i=o-1:n=o+1}return~n}(a,o);if(r>=0)return;if(o>a[0]){var s=i+"["+(o-~r)+"]"+n[2];return void gs(t.fields,e,u,s)}}u[e]=t.fields[e]})),t.fields=u,l},shift:function(e,t,n){var i=e[0];return vs([i,0],t,n)},swap:function(e,t,n){var i=e[0],o=e[1],r=e[2],a=n.changeValue;if(o!==r){a(t,i,(function(e){var t=[].concat(e||[]),n=t[o];return t[o]=t[r],t[r]=n,t}));var s=i+"["+o+"]",l=i+"["+r+"]",c={};Object.keys(t.fields).forEach((function(e){if(e.substring(0,s.length)===s){var n=e.substring(s.length),i=l+n;gs(t.fields,e,c,i)}else if(e.substring(0,l.length)===l){var o=e.substring(l.length),r=s+o;gs(t.fields,e,c,r)}else c[e]=t.fields[e]})),t.fields=c}},unshift:function(e,t,n){var i=e[0],o=e[1];return ys([i,0,o],t,n)},update:function(e,t,n){var i=e[0],o=e[1],r=e[2];(0,n.changeValue)(t,i,(function(e){var t=[].concat(e||[]);return t.splice(o,1,r),t}))}};var ks=n(42430),As=n(35813),Ts=n(92117),ws=n(6423),Ls=n(43361),Ds=n(54877),Cs=n(89152),Os=n(68820);function Rs(e){let{active:t,favoriteUsersController:n}=e;return d.createElement(Ls.A.Pane,{active:t},d.createElement(ro.A,null,d.createElement(L.Translate,null,"Contact")),d.createElement(Os.FinalPrincipal,{name:"owner",favoriteUsersController:n,label:L.Translate.string("Owner"),allowNull:!0,required:!0}),d.createElement(ws.A.Group,{widths:"equal"},d.createElement(Cs.FinalInput,{fluid:!0,name:"key_location",label:L.Translate.string("Where is the key?")}),d.createElement(Cs.FinalInput,{fluid:!0,name:"telephone",label:L.Translate.string("Telephone")})),d.createElement(ro.A,null,d.createElement(L.Translate,null,"Information")),d.createElement(ws.A.Group,{widths:"equal"},d.createElement(Cs.FinalInput,{fluid:!0,type:"number",name:"capacity",label:L.Translate.string("Capacity"),min:"1",validate:Cs.validators.min(1),required:!0}),d.createElement(Cs.FinalInput,{fluid:!0,name:"division",label:L.Translate.string("Division")})),d.createElement(Cs.FinalTextArea,{name:"comments",label:L.Translate.string("Comments"),description:L.Translate.string("You may use Markdown for formatting.")}))}function Ss(e){let{active:t,roomNameFormat:n}=e;const i=(e,t)=>e.includes(`{${t}}`);return d.createElement(Ls.A.Pane,{active:t},d.createElement(ro.A,null,d.createElement(L.Translate,null,"Location")),d.createElement(Cs.FinalInput,{fluid:!0,name:"verbose_name",label:L.Translate.string("Name"),required:!1,nullIfEmpty:!0}),d.createElement(ws.A.Group,{widths:"four"},d.createElement(ws.A.Field,{width:8},d.createElement(Cs.FinalInput,{name:"site",label:L.Translate.string("Site"),required:i(n,"site")})),d.createElement(Cs.FinalInput,{name:"building",label:L.Translate.string("Building"),required:i(n,"building")}),d.createElement(Cs.FinalInput,{name:"floor",label:L.Translate.string("Floor"),required:i(n,"floor")}),d.createElement(Cs.FinalInput,{name:"number",label:L.Translate.string("Number"),required:i(n,"number")})),d.createElement(ws.A.Group,{widths:"equal"},d.createElement(Cs.FinalInput,{fluid:!0,type:"number",name:"surface_area",label:L.Translate.string("Surface Area (m²)"),min:"0",validate:Cs.validators.optional(Cs.validators.min(0))}),d.createElement(Cs.FinalInput,{fluid:!0,type:"text",name:"latitude",label:L.Translate.string("Latitude"),parse:e=>Cs.parsers.number(e,!1),validate:Cs.validators.optional(Cs.validators.number())}),d.createElement(Cs.FinalInput,{fluid:!0,type:"text",name:"longitude",label:L.Translate.string("Longitude"),parse:e=>Cs.parsers.number(e,!1),validate:Cs.validators.optional(Cs.validators.number())})))}function Ps(e){let{active:t,defaults:n}=e;return d.createElement(Ls.A.Pane,{active:t},d.createElement(ro.A,null,d.createElement(L.Translate,null,"Notifications")),d.createElement(Os.FinalEmailList,{name:"notification_emails",label:L.Translate.string("Notification emails")}),d.createElement(ws.A.Group,{grouped:!0},d.createElement(Cs.FinalCheckbox,{name:"notifications_enabled",label:L.Translate.string("Reminders enabled")}),d.createElement(Cs.FinalCheckbox,{name:"end_notifications_enabled",label:L.Translate.string("Reminders of finishing bookings enabled")})),d.createElement(Cs.FieldCondition,{when:"notifications_enabled"},d.createElement(ro.A,{as:"h5"},d.createElement(L.Translate,null,"How many days in advance booking reminders should be sent")),d.createElement(ws.A.Group,{widths:"equal"},d.createElement(Cs.FinalInput,{fluid:!0,name:"notification_before_days",placeholder:n.notification_before_days&&String(n.notification_before_days),label:L.Translate.string("Single/Daily"),type:"number",min:"1",max:"30",validate:Cs.validators.optional(Cs.validators.range(1,30))}),d.createElement(Cs.FinalInput,{fluid:!0,name:"notification_before_days_weekly",placeholder:n.notification_before_days_weekly&&String(n.notification_before_days_weekly),label:L.Translate.string("Weekly"),type:"number",min:"1",max:"30",validate:Cs.validators.optional(Cs.validators.range(1,30))}),d.createElement(Cs.FinalInput,{fluid:!0,name:"notification_before_days_monthly",placeholder:n.notification_before_days_monthly&&String(n.notification_before_days_monthly),label:L.Translate.string("Monthly"),type:"number",min:"1",max:"30",validate:Cs.validators.optional(Cs.validators.range(1,30))}))),d.createElement(Cs.FieldCondition,{when:"end_notifications_enabled"},d.createElement(ro.A,{as:"h5"},d.createElement(L.Translate,null,"How many days before the end of a booking should reminders be sent")),d.createElement(ws.A.Group,{widths:"equal"},d.createElement(Cs.FinalInput,{fluid:!0,name:"end_notification_daily",placeholder:n.end_notification_daily&&String(n.end_notification_daily),label:L.Translate.string("Daily"),type:"number",min:"1",max:"30",validate:Cs.validators.optional(Cs.validators.range(1,30))}),d.createElement(Cs.FinalInput,{fluid:!0,name:"end_notification_weekly",placeholder:n.end_notification_weekly&&String(n.end_notification_weekly),label:L.Translate.string("Weekly"),type:"number",min:"1",max:"30",validate:Cs.validators.optional(Cs.validators.range(1,30))}),d.createElement(Cs.FinalInput,{fluid:!0,name:"end_notification_monthly",placeholder:n.end_notification_monthly&&String(n.end_notification_monthly),label:L.Translate.string("Monthly"),type:"number",min:"1",max:"30",validate:Cs.validators.optional(Cs.validators.range(1,30))}))))}Rs.propTypes={active:y().bool,favoriteUsersController:y().array.isRequired},Rs.defaultProps={active:!0},Ss.propTypes={active:y().bool,roomNameFormat:y().string.isRequired},Ss.defaultProps={active:!0},Ps.propTypes={active:y().bool,defaults:y().shape({notification_before_days:y().number,notification_before_days_weekly:y().number,notification_before_days_monthly:y().number,end_notification_daily:y().number,end_notification_weekly:y().number,end_notification_monthly:y().number})},Ps.defaultProps={active:!0,defaults:y().shape({notification_before_days:null,notification_before_days_weekly:null,notification_before_days_monthly:null,end_notification_daily:null,end_notification_weekly:null,end_notification_monthly:null})};var Ms=n(71902),xs=n(30397);const js=["value","onChange"],Is=["name"],Bs=["ArrowUp","ArrowDown","Up","Down"],Ns="06:00";function Fs(e){const t=e.hours(),n=e.minutes();return 1===t&&0===n?L.Translate.string("1 hour"):0!==t?L.Translate.string("{time} hours",{time:t+n/60}):L.Translate.string("{time} min",{time:n})}class zs extends d.Component{constructor(e){super(e),(0,pe.A)(this,"updateStartTime",((e,t,n,i,o,r)=>{if("keydown"===e.type&&Bs.includes(e.key))return void this.setState({startSearchQuery:t});let a;const{onChange:s,minTime:l}=this.props;if(a="click"===e.type?cr()(t,["HH:mm","Hmm"]):cr()(r,["HH:mm","Hmm"]),!a.isValid())return void this.setState({startSearchQuery:(0,De.serializeTime)(n)});if(a<cr()(l,"HH:mm"))return void this.setState({startSearchQuery:(0,De.serializeTime)(n)});let c=(0,De.toMoment)(i,"HH:mm");c.isSameOrBefore(a,"minute")?(c=cr()(a).add(o),c>cr()().endOf("day")&&(c=cr()().endOf("day"),a.isSame(c,"minute")&&(a=cr()(c).subtract(o)))):o=cr().duration(c.diff(a)),this.setState({startTime:a,endTime:c,startSearchQuery:(0,De.serializeTime)(a),endSearchQuery:(0,De.serializeTime)(c),duration:o}),s(a,c)})),(0,pe.A)(this,"updateEndTime",((e,t,n,i,o,r)=>{if("keydown"===e.type&&Bs.includes(e.key))return void this.setState({endSearchQuery:t});let a;if(a="click"===e.type?cr()(t,["HH:mm","Hmm"]):cr()(r,["HH:mm","Hmm"]),!a.isValid())return void this.setState({endSearchQuery:(0,De.serializeTime)(n)});let s=(0,De.toMoment)(i,"HH:mm");const{onChange:l,minTime:c}=this.props;if(a<cr()(c,"HH:mm"))this.setState({endSearchQuery:(0,De.serializeTime)(n)});else{if(a.isSameOrBefore(s,"minute")){if(s=cr()(a).subtract(o),s<cr()().startOf("day"))s=cr()().startOf("day"),a.isSame(s,"minute")&&(a=cr()(s).add(o));else if(s<cr()(s,"HH:mm"))return void this.setState({endSearchQuery:(0,De.serializeTime)(n)})}else o=cr().duration(a.diff(s));this.setState({startTime:s,endTime:a,startSearchQuery:(0,De.serializeTime)(s),endSearchQuery:(0,De.serializeTime)(a),duration:o}),l(s,a)}})),(0,pe.A)(this,"onStartSearchChange",(e=>{this.setState({startSearchQuery:e.target.value})})),(0,pe.A)(this,"onEndSearchChange",(e=>{this.setState({endSearchQuery:e.target.value})}));const{startTime:t,endTime:n}=this.props,i=cr().duration(n.diff(t)),o=(0,De.serializeTime)(cr()(t)),r=(0,De.serializeTime)(cr()(n));this.state={startTime:t,endTime:n,duration:i,startSearchQuery:o,endSearchQuery:r}}shouldComponentUpdate(e,t){return t!==this.state||!cn()(this.props,e)}render(){const{startTime:e,endTime:t,duration:n,startSearchQuery:i,endSearchQuery:o}=this.state,{disabled:r,minTime:a}=this.props,s=function(e){const t=[],n=cr()().endOf("day"),i=cr()(Ns,"HH:mm");for(;i<n;){const n=cr()(i),o=(0,De.serializeTime)(n);n>=cr()(e,"HH:mm")&&t.push({key:o,value:o,text:o}),i.add(30,"m")}return t}(a||Ns),l=function(e){const t=[],n=cr()().endOf("day"),i=cr()(e).add(30,"m");let o;for(;i<n;){o=Fs(cr().duration(i.diff(e)));const n=(0,De.serializeTime)(cr()(i)),r=d.createElement("div",{className:"rb-client-js-components-___TimeRangePicker-module__end-time-item___CcoUx"},n," ",d.createElement("span",{className:"rb-client-js-components-___TimeRangePicker-module__duration___NpHjo"},"(",o,")"));t.push({key:n,value:n,text:r}),i.add(30,"m")}return t}(e);return d.createElement("div",{className:"rb-client-js-components-___TimeRangePicker-module__time-range-picker___RLBw6"},d.createElement(k.A,{options:s,search:()=>s,icon:null,selection:!0,className:"rb-client-js-components-___TimeRangePicker-module__start-time-dropdown___WUKry",searchQuery:i,onSearchChange:this.onStartSearchChange,value:(0,De.serializeTime)(e),disabled:r,onChange:(o,r)=>{let{value:a}=r;this.updateStartTime(o,a,e,t,n,i)}}),d.createElement(k.A,{options:l,search:()=>l,icon:null,selection:!0,className:"rb-client-js-components-___TimeRangePicker-module__end-time-dropdown___0c5+2",searchQuery:o,onSearchChange:this.onEndSearchChange,value:(0,De.serializeTime)(t),disabled:r,onChange:(i,r)=>{let{value:a}=r;this.updateEndTime(i,a,t,e,n,o)}}))}}function qs(e){let{value:t,onChange:n}=e,i=(0,In.A)(e,js);const o=(0,De.toMoment)(t.startTime,"HH:mm"),r=(0,De.toMoment)(t.endTime,"HH:mm");return d.createElement(zs,(0,bn.A)({startTime:o,endTime:r,onChange:(e,t)=>{n({startTime:(0,De.serializeTime)(e),endTime:(0,De.serializeTime)(t)})}},i))}function Hs(e){let{name:t}=e,n=(0,In.A)(e,Is);return d.createElement(Cs.FinalField,(0,bn.A)({name:t,component:qs,isEqual:cn()},n))}(0,pe.A)(zs,"propTypes",{startTime:y().object.isRequired,endTime:y().object.isRequired,onChange:y().func.isRequired,disabled:y().bool,minTime:y().string}),(0,pe.A)(zs,"defaultProps",{disabled:!1,minTime:"00:00"}),qs.propTypes={value:y().exact({startTime:y().string.isRequired,endTime:y().string.isRequired}).isRequired,onChange:y().func.isRequired},Hs.propTypes={name:y().string.isRequired};function Us(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function $s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Us(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Us(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class Zs extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"handleTimesChange",((e,t)=>{let{startTime:n,endTime:i}=e;const{value:o,onChange:r}=this.props;r(o.map(((e,o)=>o===t?$s($s({},e),{},{start_time:(0,De.serializeTime)(n),end_time:(0,De.serializeTime)(i)}):e)))})),(0,pe.A)(this,"handleRemoveTimes",(e=>{const{onChange:t,value:n}=this.props;t(n.filter(((t,n)=>n!==e)))})),(0,pe.A)(this,"renderEntry",((e,t)=>{const{start_time:n,end_time:i}=e,o=(0,xs.Ak)();return d.createElement("div",{key:o,className:"flex-container"},d.createElement(zs,{startTime:cr()(n,"HH:mm"),endTime:cr()(i,"HH:mm"),onChange:(e,n)=>this.handleTimesChange({startTime:e,endTime:n},t)}),d.createElement(T.A,{floated:"right",name:"remove",className:"delete-button",onClick:()=>this.handleRemoveTimes(t)}))}))}render(){const{value:e,onChange:t}=this.props;return d.createElement(d.Fragment,null,d.createElement(dn.A,{type:"button",className:"room-edit-modal-add-btn",icon:!0,labelPosition:"left",onClick:()=>t([...e,{start_time:"08:00",end_time:"17:00"}])},d.createElement(T.A,{name:"plus"}),d.createElement(L.Translate,null,"Add new Daily Availability")),e&&e.map(this.renderEntry),0===e.length&&d.createElement("div",null,d.createElement(L.Translate,null,"No daily availability found")))}}(0,pe.A)(Zs,"propTypes",{onChange:y().func.isRequired,value:y().arrayOf(y().object)}),(0,pe.A)(Zs,"defaultProps",{value:[]});var Gs=n(85668),Vs=n.n(Gs),Ws=n(53225);class Ks extends d.Component{get generateEquipmentOptions(){const{value:e,equipmentTypes:t}=this.props;return t.filter((t=>!e.includes(t.id))).map((e=>({key:e.id,text:e.name,value:e.id})))}render(){const{onChange:e,onFocus:t,onBlur:n,value:i,equipmentTypes:o,label:r}=this.props,a=Vs()(o,"id"),s=this.generateEquipmentOptions;return d.createElement(d.Fragment,null,d.createElement(k.A,{button:!0,text:r,className:"icon",floating:!0,labeled:!0,icon:"add",options:s,search:!0,onFocus:t,onBlur:n,disabled:0===s.length,selectOnBlur:!1,value:null,onChange:(t,n)=>{e([...i,n.value])}}),d.createElement(Ws.A,{key:"equipment",divided:!0},i&&i.map((t=>d.createElement(Ws.A.Item,{key:t},d.createElement(Ws.A.Content,{floated:"right"},d.createElement(T.A,{className:"rb-client-js-common-rooms-edit-___EquipmentList-module__equipment-button___u8Mba",name:"remove",onClick:()=>{e(i.filter((e=>e!==t)))}})),d.createElement(Ws.A.Content,null,a[t].name))))),0===i.length&&d.createElement("div",null,d.createElement(L.Translate,null,"No equipment found")))}}(0,pe.A)(Ks,"propTypes",{onChange:y().func.isRequired,onFocus:y().func.isRequired,onBlur:y().func.isRequired,value:y().array.isRequired,label:y().string.isRequired,equipmentTypes:y().arrayOf(y().object).isRequired});const Ys=(0,p.connect)((e=>({equipmentTypes:Go(e)})))(Ks);var Xs=n(12611);function Qs(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Js(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qs(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qs(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class el extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"handleAddDates",(()=>{const{value:e,onChange:t}=this.props;t([...e,{start_dt:(0,De.serializeDate)(cr()()),end_dt:(0,De.serializeDate)(cr()())}]),this.setTouched()})),(0,pe.A)(this,"handleRemoveDates",(e=>{const{value:t,onChange:n}=this.props;n(t.filter(((t,n)=>n!==e))),this.setTouched()})),(0,pe.A)(this,"handleDatesChange",((e,t)=>{let{startDate:n,endDate:i}=e;const{value:o,onChange:r}=this.props;r(o.map(((e,o)=>o===t?Js(Js({},e),{},{start_dt:(0,De.serializeDate)(n),end_dt:(0,De.serializeDate)(i)}):e))),this.setTouched()})),(0,pe.A)(this,"setTouched",(()=>{const{onFocus:e,onBlur:t}=this.props;e(),t()})),(0,pe.A)(this,"renderEntry",((e,t)=>{const{start_dt:n,end_dt:i}=e,o=(0,xs.Ak)();return d.createElement("div",{key:o,className:"flex-container"},d.createElement(Os.DateRangePicker,{small:!0,minimumNights:0,anchorDirection:Xs.ANCHOR_RIGHT,startDate:null===n?null:cr()(n),endDate:null===i?null:cr()(i),onDatesChange:e=>this.handleDatesChange(e,t)}),d.createElement(T.A,{floated:"right",name:"remove",className:"delete-button",onClick:()=>this.handleRemoveDates(t)}))}))}render(){const{value:e}=this.props;return d.createElement(d.Fragment,null,d.createElement(dn.A,{type:"button",className:"room-edit-modal-add-btn",icon:!0,labelPosition:"left",onClick:this.handleAddDates},d.createElement(T.A,{name:"plus"}),d.createElement(L.Translate,null,"Add new Nonbookable Periods")),e&&e.map(this.renderEntry),0===e.length&&d.createElement("div",null,d.createElement(L.Translate,null,"No non-bookable periods found")))}}function tl(e){let{active:t,showEquipment:n,globalAttributes:i}=e;const o=(0,d.useMemo)((()=>i?Fo()(i.map((e=>[e.name,e.title]))):[]),[i]);return d.createElement(Ls.A.Pane,{active:t},d.createElement(ro.A,null,d.createElement(L.Translate,null,"Availability")),d.createElement(ws.A.Group,null,d.createElement(Cs.FinalField,{name:"bookable_hours",component:Zs,isEqual:cn()}),d.createElement(Cs.FinalField,{name:"nonbookable_periods",component:el,isEqual:cn()})),d.createElement(ro.A,null,d.createElement(L.Translate,null,"Equipment and custom attributes")),d.createElement(ws.A.Group,null,n&&d.createElement(Cs.FinalField,{name:"available_equipment",component:Ys,isEqual:cn(),componentLabel:L.Translate.string("Add new equipment")}),i&&i.length>0&&d.createElement(Ms.ED,{name:"attributes",isEqual:cn()},(e=>{let{fields:t}=e;if(!t.value)return null;const n=new Set(t.value.map((e=>e.name))),r=i.map((e=>({key:e.name,text:e.title,value:e.name}))).filter((e=>!n.has(e.key)));return d.createElement("div",null,d.createElement(k.A,{className:"icon room-edit-modal-add-btn",button:!0,text:L.Translate.string("Add new attributes"),floating:!0,labeled:!0,icon:"add",options:r,search:!0,disabled:0===r.length,selectOnBlur:!1,value:null,onChange:(e,n)=>{let{value:i}=n;t.push({value:null,name:i})}}),t.map(((e,n)=>d.createElement(Cs.FinalInput,{key:e,name:`${e}.value`,label:o[t.value[n].name],required:!0,icon:{name:"remove",color:"red",link:!0,onClick:()=>t.remove(n)}}))),0===t.length&&d.createElement("div",null,d.createElement(L.Translate,null,"No custom attributes defined")))}))),d.createElement(ro.A,null,d.createElement(L.Translate,null,"Options")),d.createElement(ws.A.Group,{widths:"equal"},d.createElement(Cs.FinalInput,{fluid:!0,type:"number",name:"max_advance_days",label:L.Translate.string("Maximum advance time for bookings (days)"),min:"1",validate:Cs.validators.optional(Cs.validators.min(1))}),d.createElement(Cs.FinalInput,{fluid:!0,type:"number",name:"booking_limit_days",label:L.Translate.string("Max duration of a booking (day)"),min:"1",validate:Cs.validators.optional(Cs.validators.min(1))})),d.createElement(ws.A.Group,{grouped:!0},d.createElement(Cs.FinalCheckbox,{name:"is_reservable",label:L.Translate.string("Bookable")}),d.createElement(Cs.FinalCheckbox,{name:"reservations_need_confirmation",label:L.Translate.string("Require confirmation (pre-bookings)")})))}function nl(e){let{active:t,permissionManager:n,permissionInfo:i,favoriteUsersController:o}=e;return d.createElement(Ls.A.Pane,{active:t},d.createElement(ro.A,null,d.createElement(L.Translate,null,"Permissions")),d.createElement(ws.A.Field,null,d.createElement("h5",null,d.createElement(L.Translate,null,"Booking Mode")),d.createElement("p",{className:"field-description"},d.createElement(L.Translate,null,"Restricted rooms can only be booked by users defined in the room ACL")),d.createElement(ws.A.Group,null,d.createElement(Cs.FinalRadio,{name:"protection_mode",value:"public",label:L.Translate.string("Public")}),d.createElement(Cs.FinalRadio,{name:"protection_mode",value:"protected",label:L.Translate.string("Restricted")}))),n&&i&&d.createElement(Cs.FinalField,{name:"acl_entries",component:Os.ACLField,favoriteUsersController:o,label:L.Translate.string("Permissions"),permissions:!1,readAccessAllowed:!1,isEqual:cn(),withGroups:!0,permissionInfo:i,permissionManager:n}))}(0,pe.A)(el,"propTypes",{onFocus:y().func.isRequired,onBlur:y().func.isRequired,onChange:y().func.isRequired,value:y().array}),(0,pe.A)(el,"defaultProps",{value:[]}),tl.propTypes={active:y().bool,showEquipment:y().bool,globalAttributes:y().arrayOf(y().shape({name:y().string,title:y().string}))},tl.defaultProps={active:!0,showEquipment:!1,globalAttributes:[]},nl.propTypes={active:y().bool,permissionInfo:y().shape({permissions:y().object,tree:y().object,default:y().string}),permissionManager:y().shape({setPermissionForId:y().func.isRequired}),favoriteUsersController:y().array.isRequired},nl.defaultProps={active:!0,permissionInfo:null,permissionManager:null};var il=n(72956);const ol=_.Ay.bind(null,{endpoint:"rb.admin_room_photo",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"photo",isDynamic:!1}]}]},"/");function rl(e){let{roomId:t,hasPhoto:n,setRoomsSpriteToken:i}=e;const[o,r]=(0,d.useState)(null),[a,s]=(0,d.useState)(!1),[l,c]=(0,d.useState)(!1);(0,d.useEffect)((()=>{c(n)}),[n]);const u=(0,d.useCallback)((e=>{r(e[0]),c(!0)}),[]),m=(0,d.useRef)(),h=d.createElement(dn.A,{disabled:a,type:"button",icon:"upload",content:L.Translate.string("Upload"),className:"rb-client-js-common-rooms-edit-___RoomPhoto-module__upload-icon___GVnrw",size:"small",onClick:()=>{m.current&&m.current.open()}}),p=d.createElement(dn.A,{disabled:a||!o,loading:a,type:"button",icon:"check",content:L.Translate.string("Save"),className:"rb-client-js-common-rooms-edit-___RoomPhoto-module__save-icon___fGY5q",size:"small",onClick:async()=>{s(!0);const e=new FormData;e.append("photo",o);const n={headers:{"content-type":"multipart/form-data"}};let a;try{a=await D.indicoAxios.post(ol({room_id:t}),e,n)}catch(e){return(0,D.handleAxiosError)(e),void s(!1)}r(null),s(!1),c(!0),i(a.data.rooms_sprite_token)}}),_=d.createElement(dn.A,{disabled:!l||a,loading:a,type:"button",icon:"trash",content:L.Translate.string("Delete"),className:"rb-client-js-common-rooms-edit-___RoomPhoto-module__remove-icon___6fFCf",size:"small",onClick:async()=>{s(!0);try{await D.indicoAxios.delete(ol({room_id:t}))}catch(e){(0,D.handleAxiosError)(e)}c(!1),r(null),s(!1)}}),f=d.createElement(dn.A,{disabled:a,type:"button",icon:"dont",content:L.Translate.string("Cancel"),size:"small",onClick:()=>{r(null),c(n)}}),g=d.createElement("div",{className:"rb-client-js-common-rooms-edit-___RoomPhoto-module__photo-actions___fbT9K"},o?d.createElement(d.Fragment,null,d.createElement(mn.A,{trigger:p,content:L.Translate.string("Save photo")}),d.createElement(mn.A,{trigger:f,content:L.Translate.string("Cancel photo upload")})):d.createElement(d.Fragment,null,d.createElement(mn.A,{trigger:h,content:L.Translate.string("Upload a new photo")}),d.createElement(mn.A,{trigger:_,content:L.Translate.string("Delete existing photo")}))),b=d.createElement("div",null,l?d.createElement(pn.A.Dimmable,null,d.createElement(pn.A,{active:a},d.createElement(_n.A,null)),d.createElement(A.A,{className:"img",src:o?URL.createObjectURL(o):`${ol({room_id:t})}?_=${+Date.now()}`})):d.createElement(L.Translate,null,"No photo found."));return d.createElement(il.Ay,{ref:m,onDrop:u,multiple:!1,noClick:!0,noKeyboard:!0,accept:"image/*"},(e=>{let{getRootProps:t,getInputProps:n}=e;return d.createElement("section",null,d.createElement("div",(0,bn.A)({},t(),{className:"rb-client-js-common-rooms-edit-___RoomPhoto-module__dropzone___gQEEE "+(t()&&t().className||"")}),d.createElement("input",n()),b,g))}))}rl.propTypes={roomId:y().number.isRequired,hasPhoto:y().bool,setRoomsSpriteToken:y().func.isRequired},rl.defaultProps={hasPhoto:!1};const al=(0,p.connect)(null,{setRoomsSpriteToken:function(e){return{type:Q,token:e}}})(rl);function sl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ll(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sl(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function cl(e){let{fields:t}=e;const{errors:n,submitErrors:i}=(0,ks.useFormState)({errors:!0,submitErrors:!0});return Object.keys(ll(ll({},n),i)).some((e=>t.includes(e)))?d.createElement(T.A,{circular:!0,inverted:!0,name:"warning",size:"small",color:"red",style:{margin:"0 0 0 10px"}}):null}cl.propTypes={fields:y().arrayOf(y().string).isRequired};const ul=["attributes","bookable_hours","nonbookable_periods","available_equipment"];function dl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ml(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dl(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const hl=_.Ay.bind(null,{endpoint:"rb.admin_attributes",rules:[{args:["attribute_id"],converters:{attribute_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"attributes",isDynamic:!1},{data:"/",isDynamic:!1},{data:"attribute_id",isDynamic:!0}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"attributes",isDynamic:!1}]}]},"/"),pl=_.Ay.bind(null,{endpoint:"rb.admin_locations",rules:[{args:["location_id"],converters:{location_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"locations",isDynamic:!1},{data:"/",isDynamic:!1},{data:"location_id",isDynamic:!0}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"locations",isDynamic:!1}]}]},"/"),_l=_.Ay.bind(null,{endpoint:"rb.admin_room",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0}]}]},"/"),fl=_.Ay.bind(null,{endpoint:"rb.admin_room_attributes",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"attributes",isDynamic:!1}]}]},"/"),gl=_.Ay.bind(null,{endpoint:"rb.admin_room_availability",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"availability",isDynamic:!1}]}]},"/"),bl=_.Ay.bind(null,{endpoint:"rb.admin_rooms",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),yl=_.Ay.bind(null,{endpoint:"rb.admin_update_room_attributes",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"attributes",isDynamic:!1}]}]},"/"),vl=_.Ay.bind(null,{endpoint:"rb.admin_update_room_availability",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"availability",isDynamic:!1}]}]},"/"),El=_.Ay.bind(null,{endpoint:"rb.admin_update_room_equipment",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"admin",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"equipment",isDynamic:!1}]}]},"/"),kl=_.Ay.bind(null,{endpoint:"rb.notification_settings",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"config",isDynamic:!1},{data:"/",isDynamic:!1},{data:"notifications",isDynamic:!1}]}]},"/");function Al(e){let{roomId:t,locationId:n,onClose:i,afterCreation:o}=e;const r=(0,C.EV)(),[a,s]=(0,Ds.HI)(),l=(0,p.useSelector)(Go),c=(0,p.useDispatch)(),{data:u}=(0,C.Ku)(hl()),[m,h]=(0,d.useState)(null),[_,f]=(0,d.useState)(null),[g,b]=(0,d.useState)("basic-details"),[y,v]=(0,d.useState)(!1),[E,k]=(0,d.useState)({acl_entries:[],available_equipment:[],notification_emails:[],notifications_enabled:!0,end_notifications_enabled:!0,is_reservable:!0,reservations_need_confirmation:!1,protection_mode:"public",has_photo:!1}),[A,T]=(0,d.useState)([]),[w,O]=(0,d.useState)({bookable_hours:[],nonbookable_periods:[]}),[R,S]=(0,d.useState)({}),[P,M]=(0,d.useState)(""),x=void 0===t,j=async e=>{let t;try{t=await D.indicoAxios.get(e)}catch(e){return void(0,D.handleAxiosError)(e)}return t.data},I=(0,d.useCallback)((async()=>{const e=await Promise.all([j(_l({room_id:t})),j(fl({room_id:t})),j(gl({room_id:t})),j(kl())]);[k,T,O,S].forEach(((t,n)=>t(e[n])))}),[t]),B=(0,d.useMemo)((()=>[{key:"basic-details",menuItem:d.createElement(L.Translate,null,"Basic Details"),pane:d.createElement(Rs,{key:"basic-details",favoriteUsersController:r}),fields:["owner","key_location","telephone","capacity","division","comments"]},{key:"location",menuItem:d.createElement(L.Translate,null,"Location"),pane:d.createElement(Ss,{key:"location",roomNameFormat:P}),fields:["verbose_name","site","building","floor","number","surface_area","latitude","longitude"]},{key:"permissions",menuItem:d.createElement(L.Translate,null,"Permissions"),pane:d.createElement(nl,{key:"permissions",permissionManager:a,permissionInfo:s,favoriteUsersController:r}),fields:["protection_mode","acl_entries"]},{key:"notifications",menuItem:d.createElement(L.Translate,null,"Notifications"),pane:d.createElement(Ps,{key:"notifications",defaults:R}),fields:["notification_emails","notifications_enabled","end_notifications_enabled","notification_before_days","notification_before_days_weekly","notification_before_days_monthly","end_notification_daily","end_notification_weekly","end_notification_monthly"]},{key:"options",menuItem:d.createElement(L.Translate,null,"Options"),pane:d.createElement(tl,{key:"options",showEquipment:!!l,globalAttributes:u}),fields:["bookable_hours","nonbookable_periods","available_equipment","attributes","is_reservable","reservations_need_confirmation","max_advance_days","booking_limit_days"]}].map((e=>ml(ml({},e),{},{menuItem:d.createElement(As.A.Item,{key:e.key},e.menuItem," ",e.key!==g&&d.createElement(cl,{fields:e.fields}))})))),[l,r,u,s,a,g,R,P]),N=(0,d.useCallback)((async()=>{var e;v(!0),null!==(t||m)&&_&&await Promise.all([c((e=t,(0,G.P$)((()=>D.indicoAxios.get(lo({room_id:e}))),bo,[go,yo],vo))),c(Mo()),c(jo(t,!0)),c(Ii(t))]),i(_||o)}),[c,i,t,m,_,o]);(0,d.useEffect)((()=>{(async()=>{v(!0),x||I().then((()=>v(!1)));const e=await j(pl({location_id:n}));M(e.room_name_format),v(!1)})()}),[x,I,n]);return m?d.createElement(Al,{roomId:m,locationId:n,onClose:i,afterCreation:!0}):E&&w&&A?d.createElement(ks.Form,{onSubmit:async(e,i)=>{const o=(0,Cs.getChangedValues)(e,i),{attributes:r,bookable_hours:a,nonbookable_periods:s,available_equipment:l}=o,c=(0,In.A)(o,ul);try{let e;if(x){const t=ml({},c);t.location_id=n,e=await D.indicoAxios.post(bl(),t)}else rn()(c)||await D.indicoAxios.patch(_l({room_id:t}),c);if(l&&await D.indicoAxios.post(El({room_id:t}),{available_equipment:l}),r&&await D.indicoAxios.post(yl({room_id:t}),{attributes:r}),a||s){const n={bookableHours:a,nonbookablePeriods:s};await D.indicoAxios.post(vl({room_id:x?e.data.id:t}),(0,fe.snakifyKeys)(n))}x?h(e.data.id):(f(!0),I())}catch(e){return(0,Cs.handleSubmitError)(e)}},initialValues:ml(ml(ml({},E),w),{},{attributes:A}),initialValuesEqual:cn(),render:e=>{const{handleSubmit:n,hasValidationErrors:i,pristine:r,submitting:a,dirty:s}=e;return y?d.createElement(pn.A,{active:!0,page:!0},d.createElement(_n.A,null)):d.createElement(Ts.A,{open:!0,onClose:N,size:"large",centered:!1,closeIcon:!0},d.createElement(Ts.A.Header,null,x?d.createElement(L.Translate,null,"Add Room"):d.createElement(L.Translate,null,"Edit Room Details")),d.createElement(Ts.A.Content,null,d.createElement(oo.A,{className:"rb-client-js-common-rooms-edit-___RoomEditModal-module__submit-message___MMgjk",positive:!0,hidden:!o||_},d.createElement(L.Translate,null,"Room has been successfully created.")),d.createElement(ks.FormSpy,{subscription:{submitSucceeded:!0,modifiedSinceLastSubmit:!0}},(e=>{let{submitSucceeded:t,modifiedSinceLastSubmit:n}=e;return d.createElement(oo.A,{className:"rb-client-js-common-rooms-edit-___RoomEditModal-module__submit-message___MMgjk",positive:!0,hidden:!t||n},d.createElement(L.Translate,null,"Room has been successfully updated."))})),d.createElement(ks.FormSpy,{subscription:{submitFailed:!0}},(t=>{let{submitFailed:n}=t;return d.createElement(oo.A,{className:"rb-client-js-common-rooms-edit-___RoomEditModal-module__submit-message___MMgjk",negative:!0,hidden:!n||s},d.createElement("p",null,d.createElement(L.Translate,null,"Room could not be updated.")),d.createElement(dn.A,{type:"button",icon:"undo",size:"mini",color:"red",content:L.Translate.string("Reset form"),onClick:()=>e.form.reset()}))})),d.createElement(Mt.A,{columns:"equal"},!x&&d.createElement(Mt.A.Column,{width:4},d.createElement(al,{roomId:t,hasPhoto:E&&E.has_photo})),d.createElement(Mt.A.Column,null,d.createElement(ws.A,{id:"room-form",onSubmit:n},d.createElement(Ls.A,{renderActiveOnly:!1,panes:B,onTabChange:(e,t)=>{let{activeIndex:n}=t;b(B[n].key)}}))))),d.createElement(Ts.A.Actions,null,d.createElement(ks.FormSpy,{subscription:{submitSucceeded:!0}},(e=>{let{submitSucceeded:t}=e;return d.createElement(dn.A,{onClick:N},t?d.createElement(L.Translate,null,"Close"):d.createElement(L.Translate,null,"Cancel"))})),d.createElement(dn.A,{type:"submit",form:"room-form",disabled:r||a||i,loading:a,primary:!0},d.createElement(L.Translate,null,"Save"))))},subscription:{submitting:!0,hasValidationErrors:!0,pristine:!0,dirty:!0},mutators:ml({},Es),validate:e=>{if(!!e.latitude!=!!e.longitude){const e=L.Translate.string("Both latitude and longitude need to be set (or omitted).");return{latitude:e,longitude:e}}}}):null}Al.propTypes={roomId:y().number,locationId:y().number.isRequired,onClose:y().func.isRequired,afterCreation:y().bool},Al.defaultProps={roomId:void 0,afterCreation:!1};const Tl=Al;var wl=n(50528),Ll=n(54219);class Dl extends d.Component{render(){const{children:e,content:t,hoverContent:n}=this.props;return d.createElement("div",{className:"rb-client-js-components-___DimmableImage-module__dimmable-image___c3hS1"},e,d.createElement(xt.Responsive.Tablet,{andLarger:!0,orElse:d.createElement("div",{className:"rb-client-js-components-___DimmableImage-module__hover-content___0odVB"},n)},d.createElement("div",{className:"rb-client-js-components-___DimmableImage-module__content___grUtC"},t),d.createElement("div",{className:"rb-client-js-components-___DimmableImage-module__hover-content___0odVB"},n)))}}function Cl(e){let{feature:t,color:n,size:i}=e;const{icon:o,title:r,equipment:a}=t,s=d.createElement(T.A,{name:o,color:n,size:i});return 1===a.length&&a[0]===r?d.createElement(mn.A,{trigger:s,content:r,position:"top center"}):d.createElement(mn.A,{trigger:s,position:"top center"},r," (",a.filter((e=>e!==r)).join(", "),")")}function Ol(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}(0,pe.A)(Dl,"propTypes",{children:y().node.isRequired,content:y().node,hoverContent:y().node}),(0,pe.A)(Dl,"defaultProps",{content:null,hoverContent:null}),Cl.propTypes={feature:y().shape({icon:y().string.isRequired,title:y().string.isRequired,equipment:y().arrayOf(y().string).isRequired}).isRequired,color:y().string.isRequired,size:y().string},Cl.defaultProps={size:void 0};const Rl=_.Ay.bind(null,{endpoint:"rb.sprite",rules:[{args:["version"],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms-sprite-",isDynamic:!1},{data:"version",isDynamic:!0},{data:".jpg",isDynamic:!1}]},{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms-sprite.jpg",isDynamic:!1}]}]},"/"),Sl=290,Pl=170;class Ml extends d.Component{constructor(e){super(e),this.containerRef=d.createRef(),this.state={}}componentDidMount(){this.setState({contHeight:this.containerRef.current.offsetHeight,contWidth:this.containerRef.current.offsetWidth})}render(){const{pos:e,width:t,height:n,styles:i,roomsSpriteToken:o,fillVertical:r,onClick:a}=this.props,{contWidth:s,contHeight:l}=this.state,c={backgroundImage:`url(${Rl({version:o})})`,backgroundPosition:`-${Sl*e}px 0`,backgroundRepeat:"no-repeat",width:Sl,height:Pl,transformOrigin:"top left"};if(r){const e=l/Pl;Object.assign(c,{transform:`translateX(${-(Sl*e-s)/2}px) scale(${e})`})}else{const e=s/Sl;Object.assign(c,{transform:`translateY(${-(Pl*e-l)/2}px) scale(${e})`})}const u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ol(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ol(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({overflow:"hidden",width:t,height:n},i);return d.createElement("div",{style:u,ref:this.containerRef},d.createElement("div",{style:c,className:"img",onClick:a}))}}(0,pe.A)(Ml,"propTypes",{roomsSpriteToken:y().string.isRequired,pos:y().number.isRequired,height:y().oneOfType([y().number,y().string]),width:y().oneOfType([y().number,y().string]),styles:y().object,fillVertical:y().bool,onClick:y().func}),(0,pe.A)(Ml,"defaultProps",{width:Sl,height:Pl,styles:{},fillVertical:!1,onClick:null});const xl=(0,p.connect)((e=>({roomsSpriteToken:te(e)})))(Ml),jl=["room","children","isFavorite","showFavoriteButton","addFavoriteRoom","delFavoriteRoom","isCheckingUserRoomPermissions"];class Il extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"renderCardImage",((e,t,n)=>{const{showFavoriteButton:i}=this.props,o=d.createElement(xl,{pos:e.spritePosition});if(void 0!==n&&0!==n.length||i){const e=d.createElement("div",{className:"rb-client-js-components-___Room-module__icons-wrapper___RyACi"},n,i&&this.renderFavoriteButton());return d.createElement(Dl,{content:t,hoverContent:e},o)}return d.createElement("div",{className:"rb-client-js-components-___Room-module__room-image___junl0"},d.createElement("div",{className:"rb-client-js-components-___Room-module__room-extra-info___f6qsm"},t),o)})),(0,pe.A)(this,"renderRoomStatus",(()=>{const{room:{isReservable:e,canUserBook:t,canUserPrebook:n},isCheckingUserRoomPermissions:i}=this.props;return e?i?d.createElement(mn.A,{key:"check-pending",trigger:d.createElement(_n.A,{active:!0,inline:!0,size:"tiny"}),content:L.Translate.string("Checking permissions..."),position:"top center",hideOnScroll:!0}):t||n?null:d.createElement(mn.A,{key:"not-authorized",trigger:d.createElement(T.A,{name:"lock",color:"red"}),content:L.Translate.string("This space is not publicly available"),position:"top center",hideOnScroll:!0}):d.createElement(mn.A,{key:"not-bookable",trigger:d.createElement(T.A,{name:"dont",color:"red"}),content:L.Translate.string("This space is not bookable"),position:"top center",hideOnScroll:!0})}))}shouldComponentUpdate(e){const{isFavorite:t,isCheckingUserRoomPermissions:n,room:i,children:o}=e,{isFavorite:r,isCheckingUserRoomPermissions:a,room:s,children:l}=this.props;return t!==r||n!==a||!cn()(s,i)||!cn()(o,l)}renderFavoriteButton(){const{addFavoriteRoom:e,delFavoriteRoom:t,room:n,isFavorite:i}=this.props,o=d.createElement(dn.A,{icon:"star",color:i?"yellow":"teal",circular:!0,onClick:()=>(i?t:e)(n.id)}),r=i?L.Translate.string("Remove from favorites"):L.Translate.string("Add to favorites");return d.createElement(Os.ResponsivePopup,{trigger:o,content:r,position:"top center"})}render(){const e=this.props,{room:t,children:n,isFavorite:i,showFavoriteButton:o,addFavoriteRoom:r,delFavoriteRoom:a,isCheckingUserRoomPermissions:s}=e,l=(0,In.A)(e,jl),{content:c,actions:u}=xt.Slot.split(n);return d.createElement(wl.A,(0,bn.A)({className:"rb-client-js-components-___Room-module__room-card___WlYI6 "+(l&&l.className||"")},l),i&&d.createElement(Ll.A,{corner:"right",icon:"star",color:"yellow"}),this.renderCardImage(t,c,u),d.createElement(wl.A.Content,null,d.createElement(Os.TooltipIfTruncated,{useEventTarget:!0},d.createElement(wl.A.Header,{className:"rb-client-js-components-___Room-module__room-title___LWLWO"},t.fullName)),d.createElement(wl.A.Meta,{style:{fontSize:"0.8em"}},t.division),d.createElement(wl.A.Description,{className:"rb-client-js-components-___Room-module__room-description___PxwLd"},t.comments&&d.createElement(Os.TooltipIfTruncated,null,d.createElement("div",{className:"rb-client-js-components-___Room-module__room-comments___YbOx9"},d.createElement(xt.Markdown,{allowedElements:["br"],unwrapDisallowed:!0},t.comments))))),d.createElement(wl.A.Content,{className:"rb-client-js-components-___Room-module__room-content___a78ZW",extra:!0},d.createElement(T.A,{name:"user"})," ",t.capacity||L.Translate.string("Not specified"),d.createElement("span",{className:"rb-client-js-components-___Room-module__room-details___ibniW"},t.features.map((e=>d.createElement(Cl,{key:e.name,feature:e,color:"green"}))),this.renderRoomStatus())))}}(0,pe.A)(Il,"propTypes",{room:y().object.isRequired,children:y().node,showFavoriteButton:y().bool,isFavorite:y().bool.isRequired,isCheckingUserRoomPermissions:y().bool.isRequired,addFavoriteRoom:y().func.isRequired,delFavoriteRoom:y().func.isRequired}),(0,pe.A)(Il,"defaultProps",{showFavoriteButton:!1,children:null});const Bl=(0,p.connect)((()=>{const e=Ji();return(t,n)=>({isFavorite:e(t,n),isCheckingUserRoomPermissions:Gi(t)})}),(e=>(0,_e.bindActionCreators)({addFavoriteRoom:xi,delFavoriteRoom:ji},e)))(Il),Nl=["room"];class Fl extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"RoomComponent",function(e){const t={};class n extends d.Component{shouldComponentUpdate(e){let{hoveredRoomId:t,actions:n,room:i}=e,o=(0,In.A)(e,Wn);const r=this.props,{hoveredRoomId:a,room:s,actions:l}=r,c=(0,In.A)(r,Kn);return t===i.id||a===i.id||!cn()(i,s)||!cn()(o,c)}render(){const{hoveredRoomId:n,actions:i,room:o}=this.props;return t[o.id]||(t[o.id]=d.createRef()),d.createElement(e,{room:o,onMouseEnter:()=>{o.id!==n&&i.setRoomHover(o.id)},onMouseLeave:()=>{null!==n&&i.setRoomHover(null)}})}}return(0,pe.A)(n,"propTypes",{hoveredRoomId:y().number,actions:y().object.isRequired,room:y().object.isRequired,inSelectionMode:y().bool,selectedRooms:y().object}),(0,pe.A)(n,"defaultProps",{hoveredRoomId:null,inSelectionMode:!1,selectedRooms:{}}),(0,p.connect)((e=>({hoveredRoomId:Ft(e)})),(e=>({actions:(0,_e.bindActionCreators)({setRoomHover:Qt},e)})))(n)}((e=>{let{room:t}=e,n=(0,In.A)(e,Nl);const{onSelectRoom:i,selectedRooms:o,inSelectionMode:r,children:a}=this.props;if(r){const e={compact:!0,size:"tiny"};return t.id in o?(e.icon="check",e.primary=!0):e.icon="check",d.createElement(Bl,(0,bn.A)({key:t.id,room:t},n),d.createElement(xt.Slot,null,d.createElement(dn.A,(0,bn.A)({className:"rb-client-js-common-rooms-___RoomRenderer-module__selection-add-btn___K2MwT "+(e&&e.className||""),onClick:()=>!!i&&i(t)},e))))}return d.createElement(Bl,(0,bn.A)({key:t.id,room:t,showFavoriteButton:!0},n),a?a(t):null)})))}render(){const{rooms:e,inSelectionMode:t,selectedRooms:n}=this.props;return d.createElement(wl.A.Group,null,e.map((e=>d.createElement(this.RoomComponent,{key:e.id,room:e,inSelectionMode:t,selectedRooms:n}))))}}(0,pe.A)(Fl,"propTypes",{rooms:y().array.isRequired,onSelectRoom:y().func,selectedRooms:y().object,inSelectionMode:y().bool,children:y().func}),(0,pe.A)(Fl,"defaultProps",{onSelectRoom:null,selectedRooms:{},inSelectionMode:!1,children:null});const zl=h.Ay.component("RoomRenderer",Fl);var ql=n(44697),Hl=n.n(ql),Ul=n(57427);const $l=["permissions"],Zl=["permissions","occurrences"];function Gl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Vl(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gl(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Wl=(0,jt.Mz)(((e,t)=>{let{bookingId:n}=t;return e.bookings.details[n]}),Ui,((e,t)=>{if(!e)return e;const{permissions:n,occurrences:i}=e,o=(0,In.A)(e,Zl),r=t&&n.admin?n.admin:n.user,a=function(e,t){const n=Fo()(Object.entries(e.bookings).map((e=>{let[n,i]=e;return i=i.map((e=>{const{permissions:n}=e,i=(0,In.A)(e,$l);if(!n)return i;const o=t&&n.admin?n.admin:n.user;return Vl(Vl({},i),o)})),[n,i]})));return Vl(Vl({},e),{},{bookings:n})}(i,t);return Vl(Vl(Vl({},o),r),{},{occurrences:a})})),Kl=(0,jt.Mz)(Wl,Xo,((e,t)=>Vl(Vl({},e),{},{room:t[e.roomId]}))),Yl=e=>{let{bookings:t}=e;return t.requests.changePrebookingState.state===G.X_.STARTED},Xl=(0,jt.Mz)(Kl,(e=>{let{startDt:t,endDt:n}=e;return cr()().isBetween(t,n,"day")})),Ql=(0,jt.Mz)(Kl,(e=>{let{occurrences:{bookings:t}}=e;return Object.values(t).reduce(((e,t)=>e+(t.length?1:0)),0)}));function Jl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ec(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jl(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const tc=(0,_e.combineReducers)({requests:(0,_e.combineReducers)({details:(0,G.Od)(Va,Wa,Ka),changePrebookingState:(0,G.Od)(Ya,Xa,Qa)}),details:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ga:{const n=(0,fe.camelizeKeys)(t.data);return ec(ec({},e),{},{[n.id]:n})}case Ja:{const n=(0,fe.camelizeKeys)(t.data.booking);return ec(ec({},e),{},{[n.id]:ec(ec({},e[n.id]),n)})}case es:{const{bookingId:n}=(0,fe.camelizeKeys)(t.data),i=ec({},e);return delete i[n],ec({},i)}case ts:{const{booking:n}=(0,fe.camelizeKeys)(t.data);return ec(ec({},e),{},{[n.id]:n})}default:return e}}}),nc=e=>{let{bookingId:t,component:n,fetchDetails:i,onClose:o,cancelDate:r}=e;return d.createElement(xt.Preloader,{key:t,checkCached:e=>((e,t)=>{let{bookingId:n}=t;return void 0!==Wl(e,{bookingId:n})})(e,{bookingId:t}),action:()=>i(t),dimmer:d.createElement(pn.A,{active:!0,page:!0},d.createElement(_n.A,null)),alwaysLoad:!0},(()=>d.createElement(n,{bookingId:t,onClose:o,cancelDate:r})))};nc.propTypes={bookingId:y().number.isRequired,fetchDetails:y().func.isRequired,component:y().elementType.isRequired,onClose:y().func.isRequired,cancelDate:y().string},nc.defaultProps={cancelDate:null};const ic=(0,p.connect)(null,(e=>(0,_e.bindActionCreators)({fetchDetails:is},e)))(nc);var oc=n(25616),rc=n.n(oc),ac=n(84938),sc=n.n(ac);const lc=_.Ay.bind(null,{endpoint:"rb.linked_object_data",rules:[{args:["id","type"],converters:{id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"link-info",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"id",isDynamic:!0}]}]},"/"),cc="linking/SET_OBJECT",uc="linking/CLEAR_OBJECT";function dc(){return{type:uc}}const mc=e=>{let{linking:t}=e;return null!==t.type},hc=e=>{let{linking:t}=e;return null!==t.type?t:null},pc=y().shape({type:y().oneOf(["event","contribution","sessionBlock"]).isRequired,id:y().number.isRequired,title:y().string.isRequired,eventURL:y().string.isRequired,eventTitle:y().string.isRequired,ownRoomId:y().number,ownRoomName:y().string,startDt:y().string,endDt:y().string});function _c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function fc(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_c(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const{getFilters:gc,isSearching:bc,isSearchFinished:yc,isSearchFailed:vc,getSearchFailedMessage:Ec,getSearchResults:kc,getSearchResultIds:Ac,getSearchResultIdsWithoutAvailabilityFilter:Tc,getTotalResultCount:wc,getSearchResultsForMap:Lc,getAvailabilityDateRange:Dc}=jr("bookRoom"),Cc=e=>{let{bookRoom:t}=e;return t.bookingForm.requests.timeline.state===G.X_.STARTED},Oc=e=>{let{bookRoom:t}=e;return t.unavailableRooms.request.state===G.X_.STARTED},Rc=(e,t)=>e.map((e=>{let[n,i]=e;return[n,fc(fc({},i),{},{room:t[i.roomId]})]})),Sc=(0,jt.Mz)((e=>{let{bookRoom:t}=e;return t.unavailableRooms.data}),Xo,Rc),Pc=e=>{let{bookRoom:t}=e;return t.timeline.request.state===G.X_.STARTED},Mc=e=>{let{bookRoom:t}=e;return t.timeline.data.isVisible},xc=e=>{let{bookRoom:t}=e;return t.timeline.datePicker.dateRange},jc=e=>{let{bookRoom:t}=e;return t.timeline.datePicker},Ic=e=>{let{bookRoom:t}=e;return t.unavailableRooms.datePicker},Bc=(0,jt.Mz)((e=>{let{bookRoom:t}=e;return t.timeline.data.availability}),Xo,Rc),Nc=(0,jt.Mz)(Bc,(e=>{let{bookRoom:t}=e;return t.timeline.data.roomIds}),((e,t)=>t.length>e.length)),Fc=e=>{let{bookRoom:t}=e;return t.suggestions.data},zc=(0,jt.Mz)(Fc,Xo,Wi,((e,t,n)=>{const i=new Set(n);return e.filter((e=>!i.has(e.room_id))).map((e=>fc(fc({},e),{},{room:t[e.room_id]})))})),qc=(0,jt.Mz)(Fc,Wi,((e,t)=>{const n=new Set(t);return e.filter((e=>!n.has(e.room_id))).map((e=>e.room_id))})),Hc=e=>{let{bookRoom:t}=e;return t.bookingForm.availability},Uc=e=>{let{bookRoom:t}=e;return t.bookingForm.relatedEvents},$c=(0,jt.Mz)(bc,Gi,((e,t)=>e||t)),Zc=(0,jt.Mz)(yc,Gi,((e,t)=>e&&!t)),Gc=(0,jt.Mz)(Wi,Xo,gc,((e,t,n)=>{let{dates:{startDate:i}}=n;const o=Object.entries(t).filter((e=>{let[,t]=e;return!t.canUserOverride&&t.maxAdvanceDays})).filter((e=>{let[,t]=e;return cr()(i)>cr()().add(t.maxAdvanceDays,"days")})).map((e=>{let[t]=e;return+t}));return[...new Set([...o,...e])]})),Vc=(0,jt.Mz)(Ac,Gc,((e,t)=>{const n=new Set(t);return e.filter((e=>!n.has(e)))})),Wc=(0,jt.Mz)(Vc,Xo,((e,t)=>e.map((e=>t[e])))),Kc=(0,jt.Mz)(Tc,Gc,((e,t)=>{const n=new Set(t);return e.filter((e=>!n.has(e))).length})),Yc=(0,jt.Mz)(Tc,Kc,((e,t)=>e.length-t)),Xc=(0,jt.Mz)(Lc,Gc,((e,t)=>{const n=new Set(t);return e.filter((e=>!n.has(e.id)))}));var Qc=n(68511),Jc=n(12776),eu=n(503),tu=n(51582),nu=n.n(tu);function iu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ou(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iu(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ru(e,t){return"recurrence"===t&&_r(e),e}function au(e){const t={text:null,building:null,capacity:null,onlyFavorites:!1,onlyMine:!1,equipment:[],features:[],bounds:null,division:null,error:!1};return"bookRoom"===e?Object.assign(t,{recurrence:{type:null,number:null,interval:null},dates:{startDate:null,endDate:null},timeSlot:{startTime:null,endTime:null}}):"calendar"===e&&Object.assign(t,{myBookings:!1,hideUnused:!1,showInactive:!1}),"roomList"!==e&&"calendar"!==e||Object.assign(t,{onlyAuthorized:!1}),t}function su(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n={rooms:[],roomsWithoutAvailabilityFilter:[],total:0},i=xr(e);return(0,_e.combineReducers)(ou({search:(0,_e.combineReducers)({request:(0,G.Od)(i.SEARCH_ROOMS_REQUEST,i.SEARCH_ROOMS_SUCCESS,i.SEARCH_ROOMS_ERROR),results:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n,o=arguments.length>1?arguments[1]:void 0;switch(o.type){case i.SEARCH_RESULTS_RECEIVED:return(0,fe.camelizeKeys)(o.data);case i.SEARCH_ROOMS_ERROR:case Je:return n;case Ur:{if("bookRoom"!==e)return t;const{data:{room_id:n,booking:{is_accepted:i}}}=o,{rooms:r}=t;return i?ou(ou({},t),{},{rooms:r.filter((e=>e!==n))}):t}default:return t}}}),filters:we(e,au,ru),map:si(e)},t))}function lu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function cu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lu(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const uu={recurrence:{validator:Jc.Nc.isIn(["single","daily","every"]),stateField:"filters.recurrence.type"},weekdays:{validator:()=>!0,stateField:{serialize:e=>{var t;let{filters:n}=e;return null==n||null===(t=n.recurrence)||void 0===t?void 0:t.weekdays},parse:(e,t)=>{Array.isArray(e)||(e=[e]),t.filters||(t.filters={}),t.filters.recurrence||(t.filters.recurrence={}),t.filters.recurrence.weekdays=[...new Set(e)]}}},number:{validator:Jc.Nc.isInt({min:1,max:99}),sanitizer:Jc.Nc.toInt(),stateField:"filters.recurrence.number"},interval:{validator:Jc.Nc.isIn(["week","month"]),stateField:"filters.recurrence.interval"},sd:{validator:Jc.Nc.isDate(),stateField:"filters.dates.startDate"},ed:{validator:Jc.Nc.isDate(),stateField:"filters.dates.endDate"},st:{validator:Jc.Nc.isTime(),stateField:"filters.timeSlot.startTime"},et:{validator:Jc.Nc.isTime(),stateField:"filters.timeSlot.endTime"},favorite:{validator:Jc.Nc.isBoolean(),sanitizer:Jc.Nc.toBoolean(),stateField:gr("filters.onlyFavorites")},mine:{validator:Jc.Nc.isBoolean(),sanitizer:Jc.Nc.toBoolean(),stateField:gr("filters.onlyMine")},authorized:{validator:Jc.Nc.isBoolean(),sanitizer:Jc.Nc.toBoolean(),stateField:gr("filters.onlyAuthorized")},capacity:{validator:Jc.Nc.isInt({min:1}),sanitizer:Jc.Nc.toInt(),stateField:"filters.capacity"},eq:{validator:()=>!0,stateField:{serialize:e=>{let{filters:{equipment:t}}=e;return t},parse:(e,t)=>{Array.isArray(e)||(e=[e]),t.filters||(t.filters={}),t.filters.equipment=e}}},feat:{validator:()=>!0,stateField:{serialize:e=>{let{filters:{features:t}}=e;return t},parse:(e,t)=>{Array.isArray(e)||(e=[e]),t.filters||(t.filters={}),t.filters.features=e}}},building:{stateField:"filters.building"},location_id:{sanitizer:Jc.Nc.toInt(),stateField:"filters.locationId"},text:{stateField:"filters.text"},division:{stateField:"filters.division"},sw_lat:{validator:Jc.Nc.isFloat({min:-90,max:90}),sanitizer:Jc.Nc.toFloat(),stateField:"filters.bounds.SW[0]"},sw_lng:{validator:Jc.Nc.isFloat({min:-180,max:180}),sanitizer:Jc.Nc.toFloat(),stateField:"filters.bounds.SW[1]"},ne_lat:{validator:Jc.Nc.isFloat({min:-90,max:90}),sanitizer:Jc.Nc.toFloat(),stateField:"filters.bounds.NE[0]"},ne_lng:{validator:Jc.Nc.isFloat({min:-180,max:180}),sanitizer:Jc.Nc.toFloat(),stateField:"filters.bounds.NE[1]"}};const du=(0,Jc.GP)(uu,((e,t)=>{if(t.type===H||t.type===B){let e,n;t.type===H?(e=q.location.pathname,n=q.location.search):(e=t.payload.location.pathname,n=t.payload.location.search);const i=function(e,t){for(const n in e)if(new RegExp(n).test(t))return e[n]}({"^/book":"bookRoom","^/rooms":"roomList"},e);return i?{namespace:i,queryString:n.slice(1)}:null}return null}),(function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t?nu()({},e,{[t]:{filters:cu(cu({},au(t)),{},{error:n||e[t].filters.error})}}):e}));var mu=n(64771);const hu=["children","startHour","endHour","data","onClickCandidate","onClickReservation","setSelectable","dayBased","hideRecurringTooltip"],pu={"./TimelineItem.module.scss":{"timeline-item":"rb-client-js-common-timeline-___TimelineItem-module__timeline-item___OfTTY","timeline-occurrence":"rb-client-js-common-timeline-___TimelineItem-module__timeline-occurrence___cVyxT","overflow-right":"rb-client-js-common-timeline-___TimelineItem-module__overflow-right___9sJnP","overflow-left":"rb-client-js-common-timeline-___TimelineItem-module__overflow-left___NmsLI","editable-timeline-canvas":"rb-client-js-common-timeline-___TimelineItem-module__editable-timeline-canvas___AwRyr","editable-timeline-slot":"rb-client-js-common-timeline-___TimelineItem-module__editable-timeline-slot___tEqV4","editable-timeline-time-popup":"rb-client-js-common-timeline-___TimelineItem-module__editable-timeline-time-popup___mi6Uk","popup-center":"rb-client-js-common-timeline-___TimelineItem-module__popup-center___Dx+DT",allowed:"rb-client-js-common-timeline-___TimelineItem-module__allowed___mG2VM","header-center":"rb-client-js-common-timeline-___TimelineItem-module__header-center___Ey5u5","concurrent-pre-booking-list":"rb-client-js-common-timeline-___TimelineItem-module__concurrent-pre-booking-list___CWhqg"}},_u={candidates:"available",preBookings:"pre-booking",preConflicts:"pre-booking-conflict",bookings:"booking",conflicts:"conflict",blockings:"blocking",overridableBlockings:"overridable-blocking",nonbookablePeriods:"unbookable-periods",unbookableHours:"unbookable-hours",cancellations:"cancellation",pendingCancellations:"pending-cancellations",rejections:"rejection",conflictingCandidates:"conflicting-candidates",concurrentPreBookings:"concurrent-pre-booking",other:"other"},fu={candidates:"candidate",blockings:"blocking",overridableBlockings:"overridable-blocking",bookings:"booking",nonbookablePeriods:"unbookable-periods",unbookableHours:"unbookable-hours",preBookings:"pre-booking",cancellations:"cancellation",pendingCancellations:"pending-cancellations",rejections:"rejection",conflictingCandidates:"conflicting-candidates",concurrentPreBookings:"concurrent-pre-booking",other:"other"},gu=new Set(["booking","pre-booking","cancellation","rejection"]),bu=["other","conflictingCandidates","cancellations","preBookings","concurrentPreBookings","rejections","bookings","preConflicts","conflicts","candidates","overridableBlockings","blockings","nonbookablePeriods","unbookableHours","pendingCancellations"];function yu(e,t){let{reservation:n,startTime:i,endTime:o,startDt:r,endDt:a}=t,s="";return n&&(s+=`${n.id}-`),`${e}-${s}${r||i}-${a||o}`}class vu extends d.Component{constructor(){var e;super(...arguments),e=this,(0,pe.A)(this,"calculateWidth",((e,t)=>{const{startHour:n,endHour:i}=this.props;let o=60*e.hours()+e.minutes(),r=60*t.hours()+t.minutes();return o<60*n&&(o=60*n),r>60*i&&(r=60*i),(r-o)/(60*(i-n))*100})),(0,pe.A)(this,"calculatePosition",(e=>{const{startHour:t,endHour:n}=this.props,i=60*t;let o=60*e.hours()+e.minutes()-i;return o<0?o=0:o>=60*(n-t)&&(o=60*(n-t)-5),o/(60*(n-t))*100})),(0,pe.A)(this,"renderMessagePopup",((e,t,n,i)=>{const{dayBased:o,hideRecurringTooltip:r}=this.props;const a=i&&i.recurrenceWeekdays&&i.recurrenceWeekdays.length>0;return o&&!e?null:d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineItem-module__popup-center___Dx+DT"},!o&&d.createElement("div",null,t.format("LT")," - ",n.format("LT")),d.createElement("div",null,e),i&&i.isRepeating&&!r&&d.createElement(oo.A,{info:!0,style:{marginBottom:0,padding:"0.7rem"},attached:a?"top":null},d.createElement(oo.A.Content,null,d.createElement(oo.A.Header,{style:{fontSize:"1em"}},d.createElement(L.Param,{name:"recurrenceFrequency",value:(s=i.repeatFrequency,l=i.repeatInterval,"DAY"===s?L.PluralTranslate.string("Recurs daily","Recurs every {count} days",l,{count:l}):"WEEK"===s?L.Translate.string("Recurs weekly"):"MONTH"===s?L.PluralTranslate.string("Recurs monthly","Recurs every {count} months",l,{count:l}):"")})),d.createElement(L.Translate,null,"From ",d.createElement(L.Param,{name:"startTime",value:cr()(i.startDt).format("L")})," to"," ",d.createElement(L.Param,{name:"endTime",value:cr()(i.endDt).format("L")})))),a&&!r&&d.createElement(oo.A,{color:"violet",size:"small",style:{marginTop:0,padding:"0.5rem"},attached:"bottom"},d.createElement(oo.A.Content,null,d.createElement(L.Translate,null,"Every"," ",d.createElement(L.Param,{name:"weekdays",value:Ar(i.recurrenceWeekdays)})))));var s,l})),(0,pe.A)(this,"renderOccurrence",(function(t){let n,i,o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";const{startDt:s,endDt:l,startTime:c,endTime:u,reservation:m,reservations:h,reason:p,rejectionReason:_,bookable:f}=t,{startHour:g,endHour:b,onClickCandidate:y,onClickReservation:v,room:E,actions:{openBookingDetails:k}}=e.props;"blocking"===a||"overridable-blocking"===a?(n=cr()(g,"HH:mm"),i=24===b?cr()("23:59","HH:mm"):cr()(b,"HH:mm")):"unbookable-hours"===a?(n=cr()(c,"HH:mm"),i=cr()(u,"HH:mm")):(n=cr()(s,"YYYY-MM-DD HH:mm"),i=cr()(l,"YYYY-MM-DD HH:mm"));const A=e.calculateWidth(n,i),T=e.calculatePosition(n);if("blocking"===a)o=d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineItem-module__popup-center___Dx+DT"},L.Translate.string("Space blocked: {reason}",{reason:p}));else if("overridable-blocking"===a)o=d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineItem-module__popup-center___Dx+DT"},d.createElement("div",null,L.Translate.string("Space blocked: {reason}",{reason:p})),d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineItem-module__allowed___mG2VM"},L.Translate.string("(You are allowed to make a booking)")));else if("unbookable-periods"===a)o=d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineItem-module__popup-center___Dx+DT"},L.Translate.string("Not possible to book in this period"));else if("unbookable-hours"===a)o=d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineItem-module__popup-center___Dx+DT"},d.createElement("div",null,L.Translate.string("Not possible to book between:")),d.createElement("div",null,n.format("LT")," - ",i.format("LT")));else if("cancellation"===a)o=d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineItem-module__popup-center___Dx+DT"},d.createElement("strong",null,d.createElement(L.Translate,null,"Cancelled")),!!_&&d.createElement("div",null,L.Translate.string("Reason: {reason}",{reason:_})));else if("pending-cancellations"===a)o=d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineItem-module__popup-center___Dx+DT"},d.createElement("strong",null,d.createElement(L.Translate,null,"This occurrence will be cancelled")));else if("rejection"===a)o=d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineItem-module__popup-center___Dx+DT"},d.createElement("strong",null,d.createElement(L.Translate,null,"Rejected")),!!_&&d.createElement("div",null,L.Translate.string("Reason: {reason}",{reason:_})));else if("conflicting-candidates"===a)o=d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineItem-module__popup-center___Dx+DT"},d.createElement("strong",null,d.createElement(L.Translate,null,"This occurrence is conflicting with an existing booking")));else if("concurrent-pre-booking"===a){let t;(0,De.fullyOverlaps)(h)&&(t=d.createElement("div",null,d.createElement(L.Translate,null,"Full overlap between two pre-bookings:"),d.createElement(Ws.A,{className:"rb-client-js-common-timeline-___TimelineItem-module__concurrent-pre-booking-list___CWhqg"},h.map((e=>{let{id:t,bookingReason:n,bookedForName:i,startDt:o,endDt:r}=e;return d.createElement(Ws.A.Item,{key:t},d.createElement("a",{onClick:()=>k(t)},d.createElement(L.Translate,null,d.createElement(L.Param,{name:"time",value:`${(0,De.serializeTime)(o)} - ${(0,De.serializeTime)(r)} `})," ","by ",d.createElement(L.Param,{name:"bookedForName",value:i})," (",d.createElement(L.Param,{name:"bookingReason",value:n,wrapper:d.createElement("em",null)}),")")))}))))),o=e.renderMessagePopup(t,n,i)}else{let t;m?t=m.bookingReason:f&&(t=E.canUserBook?L.Translate.string("Click to book it"):L.Translate.string("Click to pre-book it")),o=e.renderMessagePopup(t,n,i,m)}const w=y&&f&&"candidate"===a||v&&gu.has(a),D=["blocking","overridable-blocking","unbookable-periods","unbookable-hours"],C=!D.includes(a)&&60*n.hours()+n.minutes()<60*g,O=`timeline-occurrence ${!D.includes(a)&&60*i.hours()+i.minutes()>60*b?"overflow-right":""} ${C?"overflow-left":""}`,R=d.createElement("div",{onClick:()=>{y&&f&&"candidate"===a?y(E):v&&gu.has(a)&&v(m.id)},style:{left:`${T}%`,width:`${A}%`},className:(`${r} ${w?"clickable":""}`?`${r} ${w?"clickable":""} `:"")+(0,mu.A)(O,pu,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})}),S=w?Os.ResponsivePopup:mn.A;return d.createElement(S,{className:"rb-client-js-common-timeline-___TimelineItem-module__header-center___Ey5u5",trigger:R,content:o,position:"bottom center",header:m&&m.bookedForName,disabled:!o,hideOnScroll:!0,hoverable:!0})})),(0,pe.A)(this,"renderOccurrences",(()=>{const{data:e}=this.props;return bu.filter((t=>t in e)).map((t=>e[t].map((e=>d.createElement(d.Fragment,{key:yu(t,e)},this.renderOccurrence(e,_u[t]||"default",fu[t]))))))}))}render(){const e=this.props,{children:t,startHour:n,endHour:i,data:o,onClickCandidate:r,onClickReservation:a,setSelectable:s,dayBased:l,hideRecurringTooltip:c}=e,u=(0,In.A)(e,hu);return d.createElement("div",(0,bn.A)({className:"rb-client-js-common-timeline-___TimelineItem-module__timeline-item___OfTTY "+(u&&u.className||"")},u),t,this.renderOccurrences())}}(0,pe.A)(vu,"propTypes",{startHour:y().number.isRequired,endHour:y().number.isRequired,data:y().object.isRequired,room:y().object.isRequired,onClickCandidate:y().func,onClickReservation:y().func,children:y().node,setSelectable:y().func,dayBased:y().bool,actions:y().exact({openBookingDetails:y().func.isRequired}).isRequired,hideRecurringTooltip:y().bool}),(0,pe.A)(vu,"defaultProps",{onClickCandidate:null,onClickReservation:null,children:[],setSelectable:null,dayBased:!1,hideRecurringTooltip:!1});const Eu=(0,p.connect)(null,(e=>({actions:(0,_e.bindActionCreators)({openBookingDetails:e=>Z("booking-details",e,null,!0)},e)})))(h.Ay.component("TimelineItem",vu)),ku=["onAddSlot","setSelectable"];class Au extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"state",{isEditing:!1,canvasRef:null,slotRef:null,hintPosition:null}),(0,pe.A)(this,"handleMouseDown",(e=>{const{hours:t,minutes:n,pixels:i}=this.calcSlotPosition(e),o=`${t}:${n.toString().padStart(2,"0")}`;this.setSelectable(!1),this.setState({isEditing:!0,slotStartTime:o,slotStartPx:i,slotEndPx:i,slotOriginTime:o,slotOriginPx:i,isCancelling:!1})})),(0,pe.A)(this,"handleMouseMove",(e=>{const{isEditing:t,slotOriginTime:n,slotOriginPx:i,canvasRef:o,slotRef:r}=this.state;if(e.target===o||e.target===r){if(this.setState({hintPosition:this.calcSlotPosition(e),isCancelling:!1}),t){const{hours:t,minutes:o,pixels:r}=this.calcSlotPosition(e),a=`${t}:${o.toString().padStart(2,"0")}`;r-i>0?this.setState({slotStartTime:n,slotEndTime:a,slotStartPx:i,slotEndPx:r}):this.setState({slotStartTime:a,slotEndTime:n,slotStartPx:r,slotEndPx:i})}}else this.scheduleCancel()})),(0,pe.A)(this,"handleMouseUp",(e=>{const{isEditing:t,slotStartTime:n,slotEndTime:i,isCancelling:o}=this.state,{onAddSlot:r,room:a}=this.props;e.stopPropagation(),t&&!o&&(this.setNotEditing(),n!==i&&i&&r({slotStartTime:`0${n}`.slice(-5),slotEndTime:`0${i}`.slice(-5),room:a}))})),(0,pe.A)(this,"handleMouseEnter",(e=>{const{canvasRef:t}=this.state;e.target===t&&(this.setState({hintPosition:this.calcSlotPosition(e),isCancelling:!1}),e.stopPropagation())})),(0,pe.A)(this,"handleMouseLeave",(()=>{this.scheduleCancel()})),(0,pe.A)(this,"setCanvasRef",(e=>{this.setState({canvasRef:e})})),(0,pe.A)(this,"setSlotRef",(e=>{this.setState({slotRef:e})}))}componentDidMount(){document.addEventListener("mouseup",this.handleMouseUp)}componentWillUnmount(){document.removeEventListener("mouseup",this.handleMouseUp)}calcSlotPosition(e){const{startHour:t,endHour:n}=this.props,{canvasRef:i}=this.state,o=i.getBoundingClientRect(),r=60*(n-t),a=(e.pageX-o.x)/o.width*r,s=15*Math.round(a/15);return{pixels:s/r*o.width,hours:Math.floor(s/60)+t,minutes:s%60}}setSelectable(e){const{setSelectable:t}=this.props;t&&t(e)}setNotEditing(){this.setSelectable(!0),this.setState({isEditing:!1,slotStartTime:null,slotEndTime:null,slotStartPx:null,slotEndPx:null})}scheduleCancel(){this.setState({isCancelling:!0,hintPosition:null}),setTimeout((()=>{const{isCancelling:e}=this.state;e&&this.setNotEditing()}),1e3)}renderTimeLabels(e,t,n){const{slotRef:i}=this.state;return 0===e?d.createElement(mn.A,{context:i,content:L.Translate.string("Drag the mouse to create a booking"),position:"top center",size:"mini",open:!0}):e<50?d.createElement(mn.A,{key:`${t}:${n}`,context:i,content:`${t} - ${n}`,size:"mini",position:"bottom center",open:!0}):d.createElement(d.Fragment,null,d.createElement(mn.A,{key:t,context:i,content:t,position:"top left",size:"mini",open:!0}),d.createElement(mn.A,{key:n,context:i,content:n,position:"bottom right",size:"mini",open:!0}))}render(){const{isEditing:e,slotStartPx:t,slotEndPx:n,slotStartTime:i,slotRef:o,slotEndTime:r,canvasRef:a,hintPosition:s}=this.state,l=this.props,{onAddSlot:c,setSelectable:u}=l,m=(0,In.A)(l,ku),{room:{canUserBook:h}}=this.props,p=n-t;let _;return _=h?L.Translate.string("Tip: click and drag to book!"):L.Translate.string("Tip: click and drag to pre-book!"),d.createElement(Eu,(0,bn.A)({},m,{onMouseDown:this.handleMouseDown,onMouseEnter:this.handleMouseEnter}),d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineItem-module__editable-timeline-canvas___AwRyr",onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,ref:this.setCanvasRef},e&&d.createElement("div",{style:{left:t,width:p||15},className:"rb-client-js-common-timeline-___TimelineItem-module__editable-timeline-slot___tEqV4",ref:this.setSlotRef}),!e&&a&&null!==s&&d.createElement(mn.A,{header:`${s.hours}:${s.minutes.toString().padStart(2,"0")}`,content:_,position:"top left",offset:[s.pixels,0],context:a,size:"mini",className:"rb-client-js-common-timeline-___TimelineItem-module__editable-timeline-time-popup___mi6Uk",open:!0})),e&&o&&this.renderTimeLabels(p,i,r))}}(0,pe.A)(Au,"propTypes",{startHour:y().number.isRequired,endHour:y().number.isRequired,onAddSlot:y().func.isRequired,room:y().object.isRequired,setSelectable:y().func}),(0,pe.A)(Au,"defaultProps",{setSelectable:null});var Tu=n(95355),wu=n.n(Tu),Lu=n(98502),Du=n(33971),Cu=n(78905);const Ou=y().shape({label:y().string.isRequired,color:y().string,style:y().string}),Ru={"./TimelineLegend.module.scss":{legend:"rb-client-js-common-timeline-___TimelineLegend-module__legend___PjFdt",compact:"rb-client-js-common-timeline-___TimelineLegend-module__compact___CfYZH",labels:"rb-client-js-common-timeline-___TimelineLegend-module__labels___UMkqz",text:"rb-client-js-common-timeline-___TimelineLegend-module__text___zPWac",available:"rb-client-js-common-timeline-___TimelineLegend-module__available___mDb+1","conflicting-candidate":"rb-client-js-common-timeline-___TimelineLegend-module__conflicting-candidate___zpXuR",booking:"rb-client-js-common-timeline-___TimelineLegend-module__booking___36kxb",conflict:"rb-client-js-common-timeline-___TimelineLegend-module__conflict___9u-3j","pre-booking":"rb-client-js-common-timeline-___TimelineLegend-module__pre-booking___sxVIr","pre-booking-conflict":"rb-client-js-common-timeline-___TimelineLegend-module__pre-booking-conflict___WlOCw","concurrent-pre-booking":"rb-client-js-common-timeline-___TimelineLegend-module__concurrent-pre-booking___ARcZZ",cancellation:"rb-client-js-common-timeline-___TimelineLegend-module__cancellation___32k9Q",unbookable:"rb-client-js-common-timeline-___TimelineLegend-module__unbookable___1KPL0","pending-cancellation":"rb-client-js-common-timeline-___TimelineLegend-module__pending-cancellation___0vovJ",blocking:"rb-client-js-common-timeline-___TimelineLegend-module__blocking___q2KSE","overridable-blocking":"rb-client-js-common-timeline-___TimelineLegend-module__overridable-blocking___5-9bh",rejection:"rb-client-js-common-timeline-___TimelineLegend-module__rejection___sylcy",other:"rb-client-js-common-timeline-___TimelineLegend-module__other___9uuJ8"}};function Su(e){let{labels:t,aside:n,compact:i}=e;return i?t.length?d.createElement(Ws.A,{className:"rb-client-js-common-timeline-___TimelineLegend-module__legend___PjFdt rb-client-js-common-timeline-___TimelineLegend-module__compact___CfYZH"},t.map((e=>{let{label:t,style:n}=e;return d.createElement(Ws.A.Item,{key:t},d.createElement(Ws.A.Content,{className:"rb-client-js-common-timeline-___TimelineLegend-module__labels___UMkqz"},d.createElement(Ll.A,{className:(0,mu.A)(`compact ${n||""}`,Ru,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})}),d.createElement("span",{className:"rb-client-js-common-timeline-___TimelineLegend-module__text___zPWac"},t)))}))):d.createElement(L.Translate,null,"No occurrences"):d.createElement(Ul.A,{className:"rb-client-js-common-timeline-___TimelineLegend-module__legend___PjFdt",basic:!0},d.createElement(Ll.A.Group,{as:"span",size:"medium",className:"rb-client-js-common-timeline-___TimelineLegend-module__labels___UMkqz"},t.map((e=>{let{label:t,style:n}=e;return d.createElement(Ll.A,{key:t,className:(0,mu.A)(n||"",Ru,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})},t)}))),n)}Su.propTypes={labels:y().arrayOf(Ou).isRequired,aside:y().node,compact:y().bool},Su.defaultProps={aside:null,compact:!1};function Pu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Mu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pu(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const xu=e=>{const{availability:t,availabilityLoading:n,room:i,title:o,filters:r,roomAvailability:a,actions:{fetchAvailability:s}}=e;(0,d.useEffect)((()=>{rn()(a)&&s(i,r)}),[s,r,i,a]);const l=!rn()(t)&&!n,c=l?t.dateRange:[],u=l?c.map((e=>((e,t)=>n=>{let{bookings:i,preBookings:o,candidates:r,conflictingCandidates:a,nonbookablePeriods:s,unbookableHours:l,blockings:c,overridableBlockings:u,conflicts:m,preConflicts:h,concurrentPreBookings:p}=n;return{availability:{candidates:(r[e]||[]).map((e=>Mu(Mu({},e),{},{bookable:!1})))||[],conflictingCandidates:(a[e]||[]).map((e=>Mu(Mu({},e),{},{bookable:!1})))||[],preBookings:o[e]||[],bookings:i[e]||[],conflicts:m[e]||[],preConflicts:h[e]||[],nonbookablePeriods:s[e]||[],unbookableHours:l||[],blockings:c[e]||[],overridableBlockings:u[e]||[],concurrentPreBookings:p[e]||[]},label:d.createElement(d.Fragment,null,d.createElement("span",{className:"rb-client-js-components-___WeekdayInformation-module__weekday___ohBFC"},cr()(e).format("ddd"))," ",(0,De.serializeDate)(e,"L")),key:e,room:t}})(e,i)(t))):[],m=l?(e=>Lr(Dr(e)))(t):[];return d.createElement(d.Fragment,null,d.createElement(Ts.A.Header,{className:"legend-header"},o,d.createElement(mn.A,{trigger:d.createElement(T.A,{name:"info circle",className:"legend-info-icon"}),content:d.createElement(Su,{labels:m,compact:!0})})),d.createElement(Ts.A.Content,null,d.createElement($u,{rows:u,fixedHeight:u.length>1?"70vh":null,isLoading:!l})))};xu.propTypes={room:y().object.isRequired,availability:y().object,availabilityLoading:y().bool.isRequired,filters:y().object.isRequired,roomAvailability:y().object,title:y().node.isRequired,actions:y().exact({fetchAvailability:y().func.isRequired}).isRequired},xu.defaultProps={availability:{},roomAvailability:{}};const ju=(0,p.connect)((e=>({filters:gc(e),availability:Hc(e),availabilityLoading:Cc(e)})),(e=>({actions:(0,_e.bindActionCreators)({fetchAvailability:Aa},e)})))(d.memo(xu)),Iu=e=>{const{open:t,title:n,onClose:i,roomAvailability:o,room:r}=e;return d.createElement(Ts.A,{open:t,onClose:i,size:"large",closeIcon:!0},d.createElement(ju,{room:r,roomAvailability:o,title:n||r.name}))};Iu.propTypes={open:y().bool,title:y().node,onClose:y().func,roomAvailability:y().object,room:y().object.isRequired},Iu.defaultProps={open:!1,title:"",onClose:()=>{},roomAvailability:{}};const Bu=Iu,Nu={"./RowActionsDropdown.module.scss":{"actions-dropdown":"rb-client-js-common-timeline-___RowActionsDropdown-module__actions-dropdown___HQ8ue","dropdown-button":"rb-client-js-common-timeline-___RowActionsDropdown-module__dropdown-button___f3CLT",open:"rb-client-js-common-timeline-___RowActionsDropdown-module__open___PTv6v","rejection-form":"rb-client-js-common-timeline-___RowActionsDropdown-module__rejection-form___swSJD","form-description":"rb-client-js-common-timeline-___RowActionsDropdown-module__form-description___YNFOr"}};class Fu extends d.Component{constructor(e){var t;super(e),t=this,(0,pe.A)(this,"state",{actionInProgress:!1,activeConfirmation:null,activeRoomTimeline:!1,dropdownOpen:!1}),(0,pe.A)(this,"hideConfirm",(()=>{this.setState({activeConfirmation:null})})),(0,pe.A)(this,"showConfirm",(e=>{this.setState({activeConfirmation:e})})),(0,pe.A)(this,"showRoomTimeline",(()=>{this.setState({activeRoomTimeline:!0})})),(0,pe.A)(this,"hideRoomTimeline",(()=>{this.setState({activeRoomTimeline:!1})})),(0,pe.A)(this,"changeOccurrenceState",(async function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{date:i,booking:{id:o},actions:{changeBookingOccurrenceState:r,fetchBookingDetails:a}}=t.props,s=(0,De.serializeDate)(i);t.setState({actionInProgress:!0}),await r(o,s,e,n),await a(o),t.setState({actionInProgress:!1})})),(0,pe.A)(this,"handleButtonClick",(()=>{this.setState({dropdownOpen:!0})})),(0,pe.A)(this,"renderRejectionForm",(e=>{let{handleSubmit:t,hasValidationErrors:n,submitSucceeded:i,submitting:o,pristine:r}=e;const{date:a}=this.props,s=(0,De.serializeDate)(a,"L");return d.createElement(ws.A,{className:"rb-client-js-common-timeline-___RowActionsDropdown-module__rejection-form___swSJD",onSubmit:t},d.createElement("div",{className:"rb-client-js-common-timeline-___RowActionsDropdown-module__form-description___YNFOr"},d.createElement(L.Translate,null,"Are you sure you want to reject this occurrence (",d.createElement(L.Param,{name:"date",value:s}),")?")),d.createElement(Cs.FinalTextArea,{name:"reason",placeholder:L.Translate.string("Provide the rejection reason"),disabled:i,rows:2,required:!0,autoFocus:!0}),d.createElement(dn.A,{type:"submit",disabled:o||r||n||i,loading:o,floated:"right",primary:!0},d.createElement(L.Translate,null,"Reject")))})),this.dropdownIconRef=d.createRef()}render(){const{activeConfirmation:e,activeRoomTimeline:t,actionInProgress:n,dropdownOpen:i}=this.state,{booking:o,date:r,room:a}=this.props,s=(0,De.serializeDate)(r,"L");let l,c;const u=d.createElement(ks.Form,{onSubmit:e=>this.changeOccurrenceState("reject",e),render:this.renderRejectionForm});if(o&&({canCancel:l,canReject:c}=o.occurrences.bookings[(0,De.serializeDate)(r)][0]),!l&&!c&&!a)return null;const m=i?"dropdown-button open":"dropdown-button",h=d.createElement(dn.A,{loading:n,className:(0,mu.A)(m,Nu,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})},d.createElement(dn.A.Content,null,d.createElement(T.A,{name:"ellipsis horizontal",size:"large"})));return d.createElement("div",{className:"rb-client-js-common-timeline-___RowActionsDropdown-module__actions-dropdown___HQ8ue"},d.createElement(Os.PopoverDropdownMenu,{onOpen:this.handleButtonClick,onClose:()=>this.setState({dropdownOpen:!1}),open:i,trigger:h,placement:"bottom"},l&&d.createElement(k.A.Item,{icon:"times",text:L.Translate.string("Cancel occurrence"),onClick:()=>this.showConfirm("cancel")}),c&&d.createElement(k.A.Item,{icon:"times circle",text:L.Translate.string("Reject occurrence"),onClick:()=>this.showConfirm("reject")}),a&&d.createElement(k.A.Item,{icon:"list",text:L.Translate.string("Show room timeline"),onClick:()=>this.showRoomTimeline(a)})),d.createElement(Cu.A,{header:L.Translate.string("Confirm cancellation"),content:L.Translate.string("Are you sure you want to cancel this occurrence ({serializedDate})?",{serializedDate:s}),confirmButton:d.createElement(dn.A,{content:L.Translate.string("Cancel occurrence"),negative:!0}),cancelButton:L.Translate.string("Close"),open:"cancel"===e,onCancel:this.hideConfirm,onConfirm:()=>{this.changeOccurrenceState("cancel"),this.hideConfirm()}}),d.createElement(Cu.A,{header:L.Translate.string("Confirm rejection"),content:u,confirmButton:null,cancelButton:L.Translate.string("Close"),open:"reject"===e,onCancel:this.hideConfirm}),a&&d.createElement(Bu,{open:t,onClose:this.hideRoomTimeline,room:a}))}}(0,pe.A)(Fu,"propTypes",{booking:y().object,date:y().object,room:y().object,actions:y().exact({changeBookingOccurrenceState:y().func.isRequired,fetchBookingDetails:y().func.isRequired}).isRequired}),(0,pe.A)(Fu,"defaultProps",{booking:null,date:null,room:null});const zu=(0,p.connect)(null,(e=>({actions:(0,_e.bindActionCreators)({changeBookingOccurrenceState:ls,fetchBookingDetails:is},e)})))(Fu),qu={"./TimelineContent.module.scss":{"timeline-header":"rb-client-js-common-timeline-___TimelineContent-module__timeline-header___gv7jz","timeline-header-labels":"rb-client-js-common-timeline-___TimelineContent-module__timeline-header-labels___lrNFW","timeline-header-label":"rb-client-js-common-timeline-___TimelineContent-module__timeline-header-label___mK+WJ","timeline-label-text":"rb-client-js-common-timeline-___TimelineContent-module__timeline-label-text___pnioP","timeline-header-actions":"rb-client-js-common-timeline-___TimelineContent-module__timeline-header-actions___Dmtux","timeline-lines":"rb-client-js-common-timeline-___TimelineContent-module__timeline-lines___ZwaoX","timeline-divider":"rb-client-js-common-timeline-___TimelineContent-module__timeline-divider___fh1yb","timeline-content":"rb-client-js-common-timeline-___TimelineContent-module__timeline-content___ScKSK","timeline-row":"rb-client-js-common-timeline-___TimelineContent-module__timeline-row___vNqjJ","timeline-row-label":"rb-client-js-common-timeline-___TimelineContent-module__timeline-row-label___UfE9B",label:"rb-client-js-common-timeline-___TimelineContent-module__label___MnKBK",gutter:"rb-client-js-common-timeline-___TimelineContent-module__gutter___cUWi+","split-label":"rb-client-js-common-timeline-___TimelineContent-module__split-label___Oyzwo","sub-label":"rb-client-js-common-timeline-___TimelineContent-module__sub-label___6qe5Q","timeline-row-content":"rb-client-js-common-timeline-___TimelineContent-module__timeline-row-content___gDsJj","timeline-row-actions":"rb-client-js-common-timeline-___TimelineContent-module__timeline-row-actions___MKvW2","timeline-item-placeholder":"rb-client-js-common-timeline-___TimelineContent-module__timeline-item-placeholder___6FiKW","timeline-loader":"rb-client-js-common-timeline-___TimelineContent-module__timeline-loader___QjThv","auto-sizer-wrapper":"rb-client-js-common-timeline-___TimelineContent-module__auto-sizer-wrapper___MKg6w","daily-timeline":"rb-client-js-common-timeline-___TimelineContent-module__daily-timeline___yc5KC","rotate-icon":"rb-client-js-common-timeline-___TimelineContent-module__rotate-icon___F0WV8",rotate90:"rb-client-js-common-timeline-___TimelineContent-module__rotate90___WAE+z"}};function Hu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Uu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hu(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class $u extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"state",{selectable:!0}),(0,pe.A)(this,"onClickLabel",(e=>{const{onClickLabel:t}=this.props;return!!t&&(()=>t(e))})),(0,pe.A)(this,"getEditableItem",(e=>{const{onAddSlot:t,hideRecurrence:n}=this.props,i=t&&(e.canUserBook||e.canUserPrebook);return{ItemClass:i?Au:Eu,itemProps:i?{onAddSlot:t}:{hideRecurringTooltip:n}}})),(0,pe.A)(this,"renderRowLabel",((e,t)=>d.createElement(h.Ay,(0,bn.A)({id:"TimelineContent.rowLabel",room:t},e),d.createElement(Zu,e)))),(0,pe.A)(this,"hasOccurrenceActions",(e=>Object.values(e.occurrences.bookings).some((e=>{let[t]=e;return t&&(t.canCancel||t.canReject)})))),(0,pe.A)(this,"renderRowActions",((e,t)=>{const{booking:n,rowActions:i}=this.props;let o={};return i.occurrence&&n&&e.bookings.length&&(o={date:(0,De.toMoment)(e.bookings[0].startDt),booking:n}),i.roomTimeline&&(o=Uu(Uu({},o),{},{room:t})),d.createElement(zu,o)})),(0,pe.A)(this,"renderDefaultHeader",((e,t,n)=>{const{hourStep:i,longLabel:o,trim12hMins:r}=this.props,a=o?200:150,s=!(0,De.localeUses24HourTime)(cr().locale().replace("_","-"))&&r;return d.createElement(d.Fragment,null,d.createElement("div",{style:{width:a}}),d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-header-labels___lrNFW"},wu()(0,e+i,i).map(((n,i)=>d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-header-label___mK+WJ",key:`timeline-header-${n}`,style:{position:"absolute",left:n/e*100+"%"}},d.createElement("span",{className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-label-text___pnioP"},cr()({hours:t[i]}).format(s?"hA":"LT")))))),n&&d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-header-actions___Dmtux"}))})),(0,pe.A)(this,"renderTimelineItemPlaceholders",(function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return wu()(0,10).map((t=>d.createElement(Du.A,(0,bn.A)({},e,{key:t,className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-item-placeholder___6FiKW "+(e&&e.className||""),fluid:!0}),d.createElement(Du.A.Paragraph,null,d.createElement(Du.A.Line,null)))))}))}shouldComponentUpdate(e,t){return!cn()(this.props,e)||!cn()(this.state,t)}get hasActions(){const{booking:e,rowActions:t}=this.props,n=!!t.occurrence&&this.hasOccurrenceActions(e);return t.roomTimeline||n}renderTimelineRow(e,t,n){let{availability:i,label:o,verboseLabel:r,room:a}=e,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const{minHour:l,maxHour:c,onClickCandidate:u,onClickReservation:m,longLabel:h,gutterAllowed:p}=this.props,_=!rn()(i.conflicts),{ItemClass:f,itemProps:g}=this.getEditableItem(a),b={label:o,verboseLabel:r,longLabel:h,gutterAllowed:p,onClickLabel:this.onClickLabel(a.id)};return d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-row___vNqjJ",key:t,style:s},this.renderRowLabel(b,a),d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-row-content___gDsJj"},d.createElement(f,(0,bn.A)({startHour:l,endHour:c,data:i,room:a,onClickReservation:m,onClickCandidate:()=>{u&&!_&&u(a)},setSelectable:e=>{this.setState({selectable:e})}},g))),n&&d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-row-actions___MKvW2"},this.renderRowActions(i,a)))}renderDividers(e,t){const n=100/e;return wu()(0,e+t,t).map((e=>d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-divider___fh1yb",style:{left:e*n+"%"},key:`divider-${e}`})))}renderHeader(){const{selectable:e}=this.state,{renderHeader:t,maxHour:n,minHour:i,hourStep:o}=this.props,r=n-i,a=wu()(i,n+o,o);return d.createElement("div",{className:(e?"":(e?"":"timeline-non-selectable")+" ")+"rb-client-js-common-timeline-___TimelineContent-module__timeline-header___gv7jz"},t?t():this.renderDefaultHeader(r,a,this.hasActions))}renderList(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const{rows:r,hourStep:a,longLabel:s,isLoading:l}=this.props,{selectable:c}=this.state,u=s?200:150,m=t?70:0;return d.createElement(d.Fragment,null,d.createElement("div",{className:(c?"":(c?"":"timeline-non-selectable")+" ")+"rb-client-js-common-timeline-___TimelineContent-module__timeline-content___ScKSK",style:{width:n}},d.createElement("div",{style:{left:u,width:`calc(100% - ${u}px - ${m}px - 2em)`},className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-lines___ZwaoX"},this.renderDividers(e,a)),d.createElement("div",null,d.createElement(Lu.B8,(0,bn.A)({width:n,height:i||50*r.length,rowCount:r.length,overscanRowCount:15,rowHeight:50,noRowsRenderer:this.renderTimelineItemPlaceholders,rowRenderer:e=>{let{index:n,style:i,key:o}=e;return this.renderTimelineRow(r[n],o,t,i)}},o,{tabIndex:null})))),0!==r.length&&l&&this.renderTimelineItemPlaceholders({style:{width:n}}))}render(){const{rows:e,lazyScroll:t,fixedHeight:n,isLoading:i,maxHour:o,minHour:r}=this.props,a=t?Qc.Ay:d.Fragment,s=t||{},l=o-r,c=this.hasActions,u=d.createElement(Lu.PG,null,(e=>{let{height:t,isScrolling:n,onChildScroll:i,scrollTop:o}=e;return d.createElement(Lu.t$,{disableHeight:!0},(e=>{let{width:r}=e;return this.renderList(l,c,r,t,{isScrolling:n,scrollTop:o,onScroll:i,autoHeight:!0})}))})),m=d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__daily-timeline___yc5KC"},(i||!!e.length)&&this.renderHeader(),d.createElement(a,s,n?(e=>d.createElement("div",{style:{height:e},className:"rb-client-js-common-timeline-___TimelineContent-module__auto-sizer-wrapper___MKg6w"},d.createElement(Lu.t$,null,(e=>{let{width:t}=e;return this.renderList(l,c,t)}))))(n):u));return d.createElement(xt.Responsive.Portrait,{orElse:m},d.createElement(xt.Responsive.Phone,{andSmaller:!0,orElse:m},d.createElement(oo.A,{icon:!0,info:!0},d.createElement(T.A,{name:"mobile alternate",className:"rb-client-js-common-timeline-___TimelineContent-module__rotate-icon___F0WV8"}),d.createElement(oo.A.Content,null,d.createElement(L.Translate,null,"Please turn your device horizontally to view this page.")))))}}function Zu(e){let{label:t,verboseLabel:n,longLabel:i,onClickLabel:o,gutterAllowed:r,gutter:a,gutterTooltip:s}=e;const l=i?200:150,c=r&&a,u=n?d.createElement("span",{className:"rb-client-js-common-timeline-___TimelineContent-module__split-label___Oyzwo"},d.createElement("div",null,t),d.createElement(Os.TooltipIfTruncated,null,d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__sub-label___6qe5Q"},d.createElement("small",null,n)))):d.createElement("span",null,t),m=d.createElement("div",{className:(0,mu.A)("label "+(c?"gutter":""),qu,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})},o?d.createElement("a",{onClick:o},u):u);return d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-row-label___UfE9B",style:{minWidth:l,maxWidth:l}},c&&s?d.createElement(mn.A,{trigger:m,content:s,position:"left center"}):m)}(0,pe.A)($u,"propTypes",{rows:y().array.isRequired,onClickCandidate:y().func,onClickReservation:y().func,longLabel:y().bool,onClickLabel:y().func,isLoading:y().bool,lazyScroll:y().object,minHour:y().number,maxHour:y().number,hourStep:y().number,showUnused:y().bool,fixedHeight:y().string,onAddSlot:y().func,renderHeader:y().func,rowActions:y().objectOf(y().bool),booking:y().object,gutterAllowed:y().bool,hideRecurrence:y().bool,trim12hMins:y().bool}),(0,pe.A)($u,"defaultProps",{onClickCandidate:null,onClickReservation:null,longLabel:!1,onClickLabel:null,isLoading:!1,lazyScroll:null,minHour:6,maxHour:22,hourStep:2,showUnused:!0,fixedHeight:null,onAddSlot:null,renderHeader:null,rowActions:{occurrence:!1,roomTimeline:!1},booking:null,gutterAllowed:!1,hideRecurrence:!1,trim12hMins:!1}),Zu.propTypes={label:y().oneOfType([y().string,y().node]).isRequired,verboseLabel:y().string,longLabel:y().bool,gutterAllowed:y().bool,gutter:y().bool,gutterTooltip:y().string,onClickLabel:y().oneOfType([y().func,y().bool])},Zu.defaultProps={longLabel:!1,verboseLabel:null,gutterAllowed:!1,gutter:!1,gutterTooltip:"",onClickLabel:null};var Gu=n(96228),Vu=n.n(Gu);const Wu="rb-client-js-common-timeline-___WeeklyTimelineContent-module__timeline-header-label___-qLRE",Ku="rb-client-js-common-timeline-___WeeklyTimelineContent-module__weekend___tdzgk",Yu={baseStyle:{"timeline-header":"rb-client-js-common-timeline-___TimelineContent-module__timeline-header___gv7jz","timeline-header-labels":"rb-client-js-common-timeline-___TimelineContent-module__timeline-header-labels___lrNFW","timeline-header-label":"rb-client-js-common-timeline-___TimelineContent-module__timeline-header-label___mK+WJ","timeline-label-text":"rb-client-js-common-timeline-___TimelineContent-module__timeline-label-text___pnioP","timeline-header-actions":"rb-client-js-common-timeline-___TimelineContent-module__timeline-header-actions___Dmtux","timeline-lines":"rb-client-js-common-timeline-___TimelineContent-module__timeline-lines___ZwaoX","timeline-divider":"rb-client-js-common-timeline-___TimelineContent-module__timeline-divider___fh1yb","timeline-content":"rb-client-js-common-timeline-___TimelineContent-module__timeline-content___ScKSK","timeline-row":"rb-client-js-common-timeline-___TimelineContent-module__timeline-row___vNqjJ","timeline-row-label":"rb-client-js-common-timeline-___TimelineContent-module__timeline-row-label___UfE9B",label:"rb-client-js-common-timeline-___TimelineContent-module__label___MnKBK",gutter:"rb-client-js-common-timeline-___TimelineContent-module__gutter___cUWi+","split-label":"rb-client-js-common-timeline-___TimelineContent-module__split-label___Oyzwo","sub-label":"rb-client-js-common-timeline-___TimelineContent-module__sub-label___6qe5Q","timeline-row-content":"rb-client-js-common-timeline-___TimelineContent-module__timeline-row-content___gDsJj","timeline-row-actions":"rb-client-js-common-timeline-___TimelineContent-module__timeline-row-actions___MKvW2","timeline-item-placeholder":"rb-client-js-common-timeline-___TimelineContent-module__timeline-item-placeholder___6FiKW","timeline-loader":"rb-client-js-common-timeline-___TimelineContent-module__timeline-loader___QjThv","auto-sizer-wrapper":"rb-client-js-common-timeline-___TimelineContent-module__auto-sizer-wrapper___MKg6w","daily-timeline":"rb-client-js-common-timeline-___TimelineContent-module__daily-timeline___yc5KC","rotate-icon":"rb-client-js-common-timeline-___TimelineContent-module__rotate-icon___F0WV8",rotate90:"rb-client-js-common-timeline-___TimelineContent-module__rotate90___WAE+z"},style:{"timeline-day-divider":"rb-client-js-common-timeline-___WeeklyTimelineContent-module__timeline-day-divider___vODmG",weekend:"rb-client-js-common-timeline-___WeeklyTimelineContent-module__weekend___tdzgk","timeline-row-content":"rb-client-js-common-timeline-___WeeklyTimelineContent-module__timeline-row-content___MatZI","timeline-header-labels":"rb-client-js-common-timeline-___WeeklyTimelineContent-module__timeline-header-labels___nzC1w","timeline-header-label":"rb-client-js-common-timeline-___WeeklyTimelineContent-module__timeline-header-label___-qLRE","timeline-label-text":"rb-client-js-common-timeline-___WeeklyTimelineContent-module__timeline-label-text___ITYKU"}};class Xu extends $u{get dates(){const{rows:e}=this.props;return e.length?e[0].availability.map((e=>{let[t]=e;return t})):[]}get weekendDays(){return this.dates.filter((e=>[6,7].includes((0,De.toMoment)(e,"YYYY-MM-DD").isoWeekday()))).map((e=>this.dates.findIndex((t=>t===e))))}renderTimelineRow(e,t,n){let{availability:i,room:o,label:r,verboseLabel:a}=e,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const{minHour:l,maxHour:c,longLabel:u,onClickCandidate:m,onClickReservation:h,gutterAllowed:p}=this.props,_=i.some((e=>{let[,{conflicts:t}]=e;return!!t.length})),{ItemClass:f,itemProps:g}=this.getEditableItem(o),b={label:r,verboseLabel:a,longLabel:u,gutterAllowed:p,onClickLabel:this.onClickLabel(o.id)};return d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-row___vNqjJ",key:t,style:s},this.renderRowLabel(b,o),d.createElement("div",{className:"rb-client-js-common-timeline-___WeeklyTimelineContent-module__timeline-row-content___MatZI"},i.map((e=>{let[t,n]=e;return d.createElement(f,(0,bn.A)({key:t,startHour:l,endHour:c,data:n,room:o,onClickReservation:h,onClickCandidate:()=>{m&&!_&&m(o)},setSelectable:e=>{this.setState({selectable:e})}},g))}))),this.hasActions&&d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-row-actions___MKvW2"},this.renderRowActions(i,o)))}renderDividers(){const e=this.dates.length,t=100/e,{dateRange:n}=this.props,i=this.dates.filter((e=>0!==n.length&&!n.includes(e))).map((e=>this.dates.findIndex((t=>t===e))));return Vu()(e,(e=>{const n=this.weekendDays.includes(e)&&!i.includes(e),o="style.timeline-day-divider";return d.createElement("div",{style:{left:e*t+"%",width:`${t}%`},key:`day-divider-${e}`,className:((0,xt.toClasses)({hidden:i.includes(e),visible:!i.includes(e)})?(0,xt.toClasses)({hidden:i.includes(e),visible:!i.includes(e)})+" ":"")+(0,mu.A)(n?`${o} style.weekend`:o,Yu,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})})}))}renderHeader(){const{longLabel:e,selectable:t,setDate:n,setMode:i}=this.props,o=e?200:150;return d.createElement("div",{className:(t?"":(t?"":"timeline-non-selectable")+" ")+"rb-client-js-common-timeline-___TimelineContent-module__timeline-header___gv7jz"},d.createElement("div",{style:{minWidth:o}}),d.createElement("div",{className:"rb-client-js-common-timeline-___WeeklyTimelineContent-module__timeline-header-labels___nzC1w"},this.dates.map(((e,t)=>{const o=this.weekendDays.includes(t);return d.createElement("div",{className:`${Wu} monthly ${o?Ku:""}`,key:`timeline-header-${e}`},d.createElement("span",{className:"rb-client-js-common-timeline-___WeeklyTimelineContent-module__timeline-label-text___ITYKU",onClick:()=>{n(e),i("days")}},(0,De.toMoment)(e,"YYYY-MM-DD").format("D")))}))),this.hasActions&&d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-header-actions___Dmtux"}))}}var Qu=n(764),Ju=n.n(Qu);function ed(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function td(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ed(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ed(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class nd extends $u{get dates(){const{rows:e}=this.props,[t]=e;return t?t.availability.map((e=>{let[t]=e;return t})):[]}renderTimelineRow(e,t,n){let{availability:i,room:o,label:r,verboseLabel:a}=e,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const{minHour:l,maxHour:c,longLabel:u,onClickReservation:m,onClickCandidate:h,gutterAllowed:p}=this.props,_=i.some((e=>{let[,{conflicts:t}]=e;return!!t.length})),{ItemClass:f,itemProps:g}=this.getEditableItem(o),b={label:r,verboseLabel:a,longLabel:u,gutterAllowed:p,onClickLabel:this.onClickLabel(o.id)};return d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-row___vNqjJ",key:t,style:s},this.renderRowLabel(b,o),d.createElement("div",{className:"rb-client-js-common-timeline-___WeeklyTimelineContent-module__timeline-row-content___MatZI"},i.map((e=>{let[t,n]=e;return d.createElement(f,(0,bn.A)({key:t,startHour:l,endHour:c,data:n,room:o,onClickReservation:m,onClickCandidate:()=>{h&&!_&&h(o)},setSelectable:e=>{this.setState({selectable:e})}},g))}))),this.hasActions&&d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-row-actions___MKvW2"},this.renderRowActions(i,o)))}renderDividers(e,t){const{rows:n}=this.props,i=100/7;if(!n.length)return null;const{dateRange:o}=this.props,r=this.dates.filter((e=>0!==o.length&&!o.includes(e))).map((e=>this.dates.findIndex((t=>t===e))));return Vu()(7,(n=>d.createElement("div",{className:((0,xt.toClasses)({hidden:r.includes(n),visible:!r.includes(n)})?(0,xt.toClasses)({hidden:r.includes(n),visible:!r.includes(n)})+" ":"")+"rb-client-js-common-timeline-___WeeklyTimelineContent-module__timeline-day-divider___vODmG",style:{left:n*i+"%",width:`${i}%`},key:`day-divider-${n}`},r.includes(n)||super.renderDividers(e,t))))}renderHeader(){const{longLabel:e,selectable:t,setDate:n,setMode:i}=this.props,o=e?200:150;return d.createElement("div",{className:(t?"":(t?"":"timeline-non-selectable")+" ")+"rb-client-js-common-timeline-___TimelineContent-module__timeline-header___gv7jz"},d.createElement("div",{style:{minWidth:o}}),d.createElement("div",{className:"rb-client-js-common-timeline-___WeeklyTimelineContent-module__timeline-header-labels___nzC1w"},Ju()(this.dates,((e,t)=>d.createElement("div",{className:`${Wu} weekly`,key:`timeline-header-${t}`},d.createElement("span",{className:"rb-client-js-common-timeline-___WeeklyTimelineContent-module__timeline-label-text___ITYKU",onClick:()=>{n(e),i("days")}},(0,De.toMoment)(e,"YYYY-MM-DD").format("ddd D MMM")))))),this.hasActions&&d.createElement("div",{className:"rb-client-js-common-timeline-___TimelineContent-module__timeline-header-actions___Dmtux"}))}}(0,pe.A)(nd,"propTypes",td(td({},$u.propTypes),{},{dateRange:y().array.isRequired}));function id(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function od(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?id(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):id(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class rd extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"hasUsage",(e=>["preBookings","bookings","candidates"].some((t=>!rn()(e[t]))))),(0,pe.A)(this,"renderTimeline",(()=>{const{extraContent:e,onClickCandidate:t,onClickReservation:n,availability:i,isLoading:o,onAddSlot:r,longLabel:a,onClickLabel:s,lazyScroll:l,datePicker:{minHour:c,maxHour:u,hourStep:m,mode:h,dateRange:p},showUnused:_,fixedHeight:f,emptyMessage:g,roomTimelineAction:b,setDate:y,setMode:v}=this.props;let E=$u,k=this.calcDailyRows(i);const A={};return"weeks"===h?(E=nd,k=this.calcWeeklyRows(i)):"months"===h&&(E=Xu,k=this.calcMonthlyRows(i)),"weeks"!==h&&"months"!==h||(A.dateRange=p),_||(k=this.filterUnused(k,h)),k.length||o?d.createElement("div",{className:"rb-client-js-common-timeline-___Timeline-module__timeline___FOu-+"},e,d.createElement(E,(0,bn.A)({},A,{rows:k,minHour:c,maxHour:u,hourStep:m,onClickCandidate:t,onClickReservation:n,onAddSlot:r,longLabel:a,onClickLabel:s,isLoading:o,lazyScroll:l,showUnused:_,fixedHeight:f,rowActions:{roomTimeline:b},setDate:y,setMode:v,gutterAllowed:!0}))):g}))}_getDayRowSerializer(e){const{bookingAllowed:t,datePicker:{dateRange:n}}=this.props;return i=>{let{candidates:o,conflictingCandidates:r,concurrentPreBookings:a,preBookings:s,bookings:l,preConflicts:c,conflicts:u,blockings:d,overridableBlockings:m,nonbookablePeriods:h,unbookableHours:p,cancellations:_,rejections:f}=i;const g=!!(u[e]||[]).length;return{candidates:o[e]?[od(od({},o[e][0]),{},{bookable:t&&!g})]:[],conflictingCandidates:r[e]||[],concurrentPreBookings:a[e]||[],preBookings:s[e]||[],bookings:l[e]||[],conflicts:u[e]||[],preConflicts:c[e]||[],blockings:d[e]||[],overridableBlockings:m[e]||[],nonbookablePeriods:h[e]||[],unbookableHours:(0===n.length||n.includes(e))&&p||[],cancellations:_[e]||[],rejections:f[e]||[]}}}calcDailyRows(){const{availability:e,datePicker:{selectedDate:t}}=this.props;return e.map((e=>{let[,t]=e;return t})).map((e=>({availability:this._getDayRowSerializer(t)(e),label:e.room.name,verboseLabel:e.room.verboseName,key:e.room.id,room:e.room})))}calcWeeklyRows(){const{availability:e,datePicker:{selectedDate:t}}=this.props,n=(0,De.toMoment)(t,"YYYY-MM-DD").startOf("week"),i=[...Array(7).keys()].map((e=>(0,De.serializeDate)(n.clone().add(e,"days"))));return e.length?e.map((e=>{let[,t]=e;const{room:n}=t;return{availability:i.map((e=>[e,this._getDayRowSerializer(e)(t)])),label:n.name,verboseLabel:n.verboseName,key:n.id,room:n}})):[]}calcMonthlyRows(){const{availability:e,datePicker:{selectedDate:t}}=this.props,n=(0,De.toMoment)(t,"YYYY-MM-DD"),i=n.clone().startOf("month"),o=n.clone().endOf("month"),r=(0,De.dayRange)(i,o).map((e=>e.format("YYYY-MM-DD")));return e.length?e.map((e=>{let[,t]=e;const{room:n}=t;return{availability:r.map((e=>[e,this._getDayRowSerializer(e)(t)])),label:n.name,verboseLabel:n.verboseName,key:n.id,room:n}})):[]}filterUnused(e,t){return"days"===t?e.filter((e=>{let{availability:t}=e;return this.hasUsage(t)})):e.filter((e=>{let{availability:t}=e;return t.some((e=>{let[,t]=e;return this.hasUsage(t)}))}))}render(){const{emptyMessage:e,isLoading:t,availability:n}=this.props;return t||n.length?this.renderTimeline():e}}(0,pe.A)(rd,"propTypes",{availability:y().array.isRequired,datePicker:y().object.isRequired,bookingAllowed:y().bool,isLoading:y().bool,onAddSlot:y().func,onClickLabel:y().func,onClickCandidate:y().func,onClickReservation:y().func,longLabel:y().bool,emptyMessage:y().node,lazyScroll:y().object,extraContent:y().node,showUnused:y().bool,fixedHeight:y().string,roomTimelineAction:y().bool,setDate:y().func.isRequired,setMode:y().func.isRequired}),(0,pe.A)(rd,"defaultProps",{emptyMessage:d.createElement(oo.A,{warning:!0},d.createElement(L.Translate,null,"No occurrences found")),onClickCandidate:null,onClickReservation:null,bookingAllowed:!1,extraContent:null,isLoading:!1,onAddSlot:null,longLabel:!1,onClickLabel:null,lazyScroll:null,showUnused:!0,fixedHeight:null,roomTimelineAction:!1});class ad extends d.Component{constructor(e){super(e),(0,pe.A)(this,"state",{datePickerVisible:!1}),(0,pe.A)(this,"calendarDisabledDate",(e=>{const{dateRange:t}=this.props;return!!e&&(0!==t.length&&!yr(e,t,De.toMoment))})),(0,pe.A)(this,"onSelect",(e=>{const{mode:t,dateRange:n}=this.props;(0===n.length||yr(e,n,De.toMoment))&&(e="weeks"===t?e.clone().startOf("week"):"months"===t?e.clone().startOf("month"):e.clone(),this.setDateWithMode(e,t,!0)),this.onClose()})),(0,pe.A)(this,"changeSelectedDate",(e=>{const{selectedDate:t,dateRange:n,onDateChange:i,mode:o}=this.props,r="next"===e?1:-1;if(0===n.length||"days"!==o)i(this.selectedDate.clone().add(r,o));else{const e=n.findIndex((e=>e===t))+r;i((0,De.toMoment)(n[e]))}})),(0,pe.A)(this,"handleModeChange",(e=>{const{onModeChange:t}=this.props;t(e),this.setDateWithMode(this.selectedDate,e)})),(0,pe.A)(this,"onOpen",(()=>{this.setState({datePickerVisible:!0})})),(0,pe.A)(this,"onClose",(()=>{this.setState({datePickerVisible:!1})})),(0,pe.A)(this,"render",(()=>{const{dateRange:e,disabled:t,isLoading:n}=this.props;return d.createElement("div",{className:"rb-client-js-common-timeline-___DateNavigator-module__date-navigator___7T9Hw"},this.renderModeSwitcher(t||n),this.renderNavigator(t||n||1===e.length))}));const{mode:t}=this.props;this.setDateWithMode(this.selectedDate,t)}componentDidUpdate(e){const{mode:t,selectedDate:n}=this.props,{mode:i,selectedDate:o}=e;i===t&&o===n||this.setDateWithMode(this.selectedDate,t)}get selectedDate(){const{selectedDate:e}=this.props;return(0,De.toMoment)(e,"YYYY-MM-DD")}get dateBounds(){const{dateRange:e,mode:t}=this.props;return e.length?[(0,De.toMoment)(e[0],"YYYY-MM-DD").startOf(t),(0,De.toMoment)(e[e.length-1],"YYYY-MM-DD").startOf(t)]:null}setDateWithMode(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{onDateChange:i,dateRange:o}=this.props;let r;if("weeks"===t?r=e.clone().startOf("week"):"months"===t?r=e.clone().startOf("month"):(r=e.clone(),this.dateBounds&&-1===o.indexOf((0,De.serializeDate)(e))&&(r=(0,De.toMoment)(o[0],"YYYY-MM-DD"))),this.dateBounds){const[e,t]=this.dateBounds;r.isAfter(t)?r=t.clone():r.isBefore(e)&&(r=e.clone())}!n&&r.isSame(e)||i(r)}renderModeSwitcher(e){const{mode:t}=this.props;return!!t&&d.createElement(dn.A.Group,{size:"tiny",className:"rb-client-js-common-timeline-___DateNavigator-module__date-navigator-item___-U1VP"},d.createElement(dn.A,{content:L.Translate.string("Day"),onClick:()=>this.handleModeChange("days"),primary:"days"===t,disabled:e}),d.createElement(dn.A,{content:L.Translate.string("Week"),onClick:()=>this.handleModeChange("weeks"),primary:"weeks"===t,disabled:e}),d.createElement(dn.A,{content:L.Translate.string("Month"),onClick:()=>this.handleModeChange("months"),primary:"months"===t,disabled:e}))}isValidChange(e,t){if(!this.dateBounds)return!0;const[n,i]=this.dateBounds,o=this.selectedDate.clone().add(e,t);return!o.isAfter(i)&&!o.isBefore(n)}renderNavigator(e){const{mode:t}=this.props,{datePickerVisible:n}=this.state,i=d.createElement(mn.A,{on:"click",position:"bottom left",open:n,onOpen:this.onOpen,onClose:this.onClose,trigger:d.createElement(dn.A,{primary:!0,disabled:e},"days"===t&&this.selectedDate.format("L"),"months"===t&&this.selectedDate.format("MMMM YYYY"),"weeks"===t&&L.Translate.string("Week of {date}",{date:this.selectedDate.format("MMM Do YYYY")})),content:d.createElement("div",{className:"ui form"},d.createElement(Os.CalendarSingleDatePicker,{date:this.selectedDate,onDateChange:this.onSelect,disabledDate:this.calendarDisabledDate,noBorder:!0})),hideOnScroll:!0}),o=e||!this.isValidChange(-1,t),r=e||!this.isValidChange(1,t);return d.createElement(dn.A.Group,{size:"tiny",className:"rb-client-js-common-timeline-___DateNavigator-module__date-navigator-item___-U1VP"},d.createElement(dn.A,{icon:"left arrow",onClick:()=>this.changeSelectedDate("prev"),disabled:o}),i,d.createElement(dn.A,{icon:"right arrow",onClick:()=>this.changeSelectedDate("next"),disabled:r}))}}function sd(e){let{datePicker:t,legendLabels:n,onDateChange:i,onModeChange:o,disableDatePicker:r,isLoading:a}=e;const{isPhone:s,isPortrait:l}=(0,xt.useResponsive)();return!(s&&l)&&d.createElement(Su,{labels:n,aside:d.createElement(ad,(0,bn.A)({},t,{isLoading:a,disabled:r||a,onDateChange:i,onModeChange:o}))})}function ld(e){let{withImage:t}=e;return d.createElement(wl.A,null,t&&d.createElement(Du.A,null,d.createElement(Du.A.Image,null)),d.createElement(wl.A.Content,null,d.createElement(Du.A,null,d.createElement(Du.A.Header,null,d.createElement(Du.A.Line,{length:"very short"}),d.createElement(Du.A.Line,{length:"medium"})),d.createElement(Du.A.Paragraph,null,d.createElement(Du.A.Line,{length:"short"})))),d.createElement(wl.A.Content,{extra:!0},d.createElement(Du.A,null,d.createElement(Du.A.Line,{length:"short"}))))}function cd(e){let{count:t,className:n,itemsPerRow:i,withImage:o}=e;const r=n?{className:n}:{};return d.createElement(wl.A.Group,(0,bn.A)({},r,{itemsPerRow:i,stackable:!0}),wu()(0,t).map((e=>d.createElement(ld,{key:e,withImage:o}))))}(0,pe.A)(ad,"propTypes",{selectedDate:y().string.isRequired,mode:y().string.isRequired,dateRange:y().array.isRequired,onDateChange:y().func.isRequired,onModeChange:y().func.isRequired,isLoading:y().bool,disabled:y().bool}),(0,pe.A)(ad,"defaultProps",{isLoading:!1,disabled:!1}),sd.propTypes={datePicker:y().object.isRequired,legendLabels:y().arrayOf(Ou).isRequired,onDateChange:y().func.isRequired,onModeChange:y().func.isRequired,disableDatePicker:y().bool,isLoading:y().bool},sd.defaultProps={isLoading:!1,disableDatePicker:!1},ld.propTypes={withImage:y().bool},ld.defaultProps={withImage:!0},cd.propTypes={count:y().number.isRequired,className:y().string,itemsPerRow:y().number,withImage:y().bool},cd.defaultProps={className:null,itemsPerRow:null,withImage:!0},ld.Group=cd;var ud=n(24831),dd=n(51479);class md extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"updateTextFilter",(e=>{const{actions:{setFilterParameter:t}}=this.props;t("text",e||null)}))}render(){const{filters:{text:e},disabled:t}=this.props;let n;return n=e?d.createElement(T.A,{link:!0,name:"remove",onClick:()=>this.updateTextFilter(null)}):d.createElement(T.A,{name:"search"}),d.createElement("div",{className:"rb-client-js-components-___SearchBar-module__room-filters___JnpBp"},d.createElement(ud.DebounceInput,{element:dd.A,size:"large",className:"rb-client-js-components-___SearchBar-module__text-filter___cqWRZ",icon:n,debounceTimeout:400,onChange:e=>this.updateTextFilter(e.target.value),value:e||"",disabled:t}))}}(0,pe.A)(md,"propTypes",{filters:y().object.isRequired,disabled:y().bool,actions:y().exact({setFilterParameter:y().func.isRequired}).isRequired}),(0,pe.A)(md,"defaultProps",{disabled:!1});const hd=(e,t)=>(0,p.connect)((e=>({filters:t.getFilters(e)})),(t=>({actions:(0,_e.bindActionCreators)({setFilterParameter:(t,n)=>Ee(e,t,n)},t)})))(md),{getFilters:pd,isSearching:_d,getSearchResults:fd,getSearchResultsForMap:gd}=jr("roomList"),bd=(0,jt.Mz)(fd,pd,Wi,((e,t,n)=>{let{onlyAuthorized:i}=t;if(!i)return e;const o=new Set(n);return e.filter((e=>!o.has(e.id)))})),yd=(0,jt.Mz)(gd,pd,Wi,((e,t,n)=>{let{onlyAuthorized:i}=t;if(!i)return e;const o=new Set(n);return e.filter((e=>!o.has(e.id)))})),vd={timeframe:{onlyIf:e=>{let{timeframe:t}=e;return!!t},serializer:e=>{let{timeframe:t}=e;return t}},my_rooms:{onlyIf:e=>{let{myRooms:t}=e;return t},serializer:e=>{let{myRooms:t}=e;return t}},mine:{onlyIf:e=>{let{myBlockings:t}=e;return t},serializer:e=>{let{myBlockings:t}=e;return t}},room_ids:{onlyIf:e=>{let{rooms:t}=e;return t&&t.length},serializer:e=>{let{rooms:t}=e;return t.map((e=>e.id))}},allowed:{onlyIf:e=>{let{allowed:t}=e;return!!t},serializer:e=>{let{allowed:t}=e;return t}},reason:{onlyIf:e=>{let{reason:t}=e;return!!t},serializer:e=>{let{reason:t}=e;return t}},start_date:{onlyIf:e=>{let{dates:t}=e;return t&&t.startDate},serializer:Cr("start")},end_date:{onlyIf:e=>{let{dates:t}=e;return t&&t.endDate},serializer:Cr("end")}},Ed=_.Ay.bind(null,{endpoint:"rb.blocking",rules:[{args:["blocking_id"],converters:{blocking_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"blockings",isDynamic:!1},{data:"/",isDynamic:!1},{data:"blocking_id",isDynamic:!0}]}]},"/"),kd=_.Ay.bind(null,{endpoint:"rb.blocking_actions",rules:[{args:["action","blocking_id","room_id"],converters:{action:"AnyConverter",blocking_id:"IntegerConverter",room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"blockings",isDynamic:!1},{data:"/",isDynamic:!1},{data:"blocking_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"action",isDynamic:!0}]}]},"/"),Ad=_.Ay.bind(null,{endpoint:"rb.blockings",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"blockings",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),Td=_.Ay.bind(null,{endpoint:"rb.create_blocking",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"blockings",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),wd=_.Ay.bind(null,{endpoint:"rb.delete_blocking",rules:[{args:["blocking_id"],converters:{blocking_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"blockings",isDynamic:!1},{data:"/",isDynamic:!1},{data:"blocking_id",isDynamic:!0}]}]},"/"),Ld=_.Ay.bind(null,{endpoint:"rb.update_blocking",rules:[{args:["blocking_id"],converters:{blocking_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"blockings",isDynamic:!1},{data:"/",isDynamic:!1},{data:"blocking_id",isDynamic:!0}]}]},"/"),Dd="blockings/FETCH_BLOCKINGS_REQUEST",Cd="blockings/FETCH_BLOCKINGS_SUCCESS",Od="blockings/FETCH_BLOCKINGS_ERROR",Rd="blockings/BLOCKINGS_RECEIVED",Sd="blockings/FETCH_BLOCKING_REQUEST",Pd="blockings/FETCH_BLOCKING_SUCCESS",Md="blockings/FETCH_BLOCKING_ERROR",xd="blockings/BLOCKING_RECEIVED",jd="blockings/CREATE_BLOCKING_REQUEST",Id="blockings/CREATE_BLOCKING_SUCCESS",Bd="blockings/CREATE_BLOCKING_ERROR",Nd="blockings/CHANGE_BLOCKING_STATE_REQUEST",Fd="blockings/CHANGE_BLOCKING_STATE_SUCCESS",zd="blockings/CHANGE_BLOCKING_STATE_ERROR",qd="blockings/DELETE_BLOCKING_REQUEST",Hd="blockings/DELETE_BLOCKING_SUCCESS",Ud="blockings/DELETE_BLOCKING_ERROR",$d="blockings";function Zd(){return async(e,t)=>{const{blockings:{filters:n}}=t(),i=hr(n,vd);return await(0,G.P$)((()=>D.indicoAxios.get(Ad(),{params:i})),Dd,[Rd,Cd],Od)(e)}}function Gd(e){return async t=>await(0,G.P$)((()=>D.indicoAxios.get(Ed({blocking_id:e}))),Sd,[xd,Pd],Md)(t)}function Vd(e,t){return Ee($d,e,t)}function Wd(e){const t=hr(e,vd);return(0,G.HX)((()=>D.indicoAxios.post(Td(),t)),jd,Id,Bd,{start_date:"dates",end_date:"dates"})}function Kd(e,t){delete t.dates;const n=hr(t,vd);return(0,G.HX)((()=>D.indicoAxios.patch(Ld({blocking_id:e}),n)),"blockings/UPDATE_BLOCKING_REQUEST",[xd,"blockings/UPDATE_BLOCKING_SUCCESS"],"blockings/UPDATE_BLOCKING_ERROR")}function Yd(e,t){const n={blocking_id:e,room_id:t,action:"accept"};return(0,G.HX)((()=>D.indicoAxios.post(kd(n))),Nd,Fd,zd)}function Xd(e,t,n){const i={blocking_id:e,room_id:t,action:"reject"};return(0,G.HX)((()=>D.indicoAxios.post(kd(i),{reason:n})),Nd,Fd,zd)}function Qd(e){return(0,G.HX)((()=>D.indicoAxios.delete(wd({blocking_id:e}))),qd,Hd,Ud)}function Jd(e){return Z("blocking-details",e,null,!1,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)}const em=["permissions"];function tm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function nm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tm(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const im=(0,jt.Mz)((e=>{let{blockings:t}=e;return t.blockings}),Ui,((e,t)=>Fo()(Object.entries(e).map((e=>{let[n,i]=e;const{permissions:o}=i,r=(0,In.A)(i,em),a=t&&o.admin?o.admin:o.user;return[n,nm(nm({},r),a)]}))))),om=(e,t)=>{let{blockingId:n}=t;return im(e)[n]},rm=e=>{let{blockings:t}=e;return t.requests.blockings.state===G.X_.STARTED},am=e=>{let{blockings:t}=e;return t.filters};class sm extends d.Component{renderCardHeader(){const{blocking:e}=this.props,{blockedRooms:t}=e;return 1===t.length?t[0].room.name:L.PluralTranslate.string("{count} room","{count} rooms",t.length,{count:t.length})}renderDate(){const{blocking:{startDate:e,endDate:t}}=this.props;return e===t?cr()(e).format("ll"):d.createElement(d.Fragment,null,cr()(e).format("ll")," - ",cr()(t).format("ll"))}render(){const{blocking:e,onClick:t}=this.props,{blockedRooms:n}=e;return d.createElement(wl.A,{onClick:t,className:"rb-client-js-modules-blockings-___BlockingCard-module__blocking-item___F2wKC",key:e.id},d.createElement("div",{className:"image"},d.createElement(xl,{key:n[0].room.id,pos:n[0].room.spritePosition})),d.createElement(wl.A.Content,null,d.createElement(wl.A.Header,null,this.renderCardHeader()),d.createElement(wl.A.Meta,null,this.renderDate()),d.createElement(wl.A.Description,null,d.createElement(Os.TooltipIfTruncated,null,d.createElement("div",{className:"rb-client-js-modules-blockings-___BlockingCard-module__blocking-reason___eERt8"},e.reason)))),d.createElement(wl.A.Content,{extra:!0},d.createElement(L.Translate,null,"Created by ",d.createElement(L.Param,{name:"createdBy",value:e.createdBy}))))}}(0,pe.A)(sm,"propTypes",{blocking:y().object.isRequired,onClick:y().func.isRequired});const lm={recent:L.Translate.string("Active and future"),year:L.Translate.string("All blockings this year"),all:L.Translate.string("All blockings")};class cm extends d.Component{render(){const{filters:{myBlockings:e,myRooms:t,timeframe:n},actions:{setFilterParameter:i}}=this.props,o=Object.entries(lm).map((e=>{let[t,n]=e;return{text:n,value:t}}));return d.createElement("div",{className:"filter-row"},d.createElement("div",{className:"filter-row-filters"},d.createElement(k.A,{text:n?lm[n]:L.Translate.string("Filter by date"),className:(0,xt.toClasses)({primary:!!n}),options:o,direction:"right",value:n,onChange:(e,t)=>{let{value:n}=t;return i("timeframe",n)},button:!0,floating:!0}),d.createElement(dn.A.Group,null,d.createElement(Os.ResponsivePopup,{trigger:d.createElement(dn.A,{content:L.Translate.string("Blockings in my rooms"),primary:t,onClick:()=>i("myRooms",!t)}),content:L.Translate.string("Show only blockings in my rooms")}),d.createElement(Os.ResponsivePopup,{trigger:d.createElement(dn.A,{content:L.Translate.string("My blockings"),primary:e,onClick:()=>i("myBlockings",!e)}),content:L.Translate.string("Show only my blockings")}))))}}(0,pe.A)(cm,"propTypes",{filters:y().shape({myBlockings:y().bool.isRequired,myRooms:y().bool.isRequired,timeframe:y().oneOf(["recent","year","all"])}).isRequired,actions:y().exact({setFilterParameter:y().func.isRequired}).isRequired});const um=(0,p.connect)((e=>({filters:am(e)})),(e=>({actions:(0,_e.bindActionCreators)({setFilterParameter:Vd},e)})))(cm);class dm extends d.Component{constructor(e){super(e),(0,pe.A)(this,"renderBlocking",(e=>{const{actions:{openBlockingDetails:t}}=this.props;return d.createElement(sm,{key:e.id,blocking:e,onClick:()=>t(e.id)})})),(0,pe.A)(this,"renderContent",(()=>{const{isFetching:e,blockings:t}=this.props,n=Object.values(t);return e?d.createElement(ld.Group,{count:10,className:"blockings-placeholders"}):0!==n.length?d.createElement(wl.A.Group,{className:"rb-client-js-modules-blockings-___BlockingList-module__blockings-list___jxI+w"},n.map(this.renderBlocking)):d.createElement(oo.A,{info:!0},d.createElement(L.Translate,null,"There are no blockings."))})),this.contextRef=d.createRef()}componentDidMount(){const{actions:{fetchBlockings:e}}=this.props;e()}componentDidUpdate(e){let{filters:t}=e;const{filters:n,actions:{fetchBlockings:i}}=this.props;t!==n&&i()}render(){return d.createElement("div",{ref:this.contextRef},d.createElement(Pt.A,{className:"rb-client-js-modules-blockings-___BlockingList-module__blockings-container___bWdQF",fluid:!0},d.createElement(Os.StickyWithScrollBack,{context:this.contextRef.current},d.createElement(um,null)),this.renderContent()))}}(0,pe.A)(dm,"propTypes",{blockings:y().object.isRequired,isFetching:y().bool.isRequired,filters:y().object.isRequired,actions:y().exact({fetchBlockings:y().func.isRequired,openBlockingDetails:y().func.isRequired}).isRequired});const mm=(0,p.connect)((e=>({blockings:im(e),isFetching:rm(e),filters:am(e)})),(e=>({actions:(0,_e.bindActionCreators)({fetchBlockings:Zd,openBlockingDetails:Jd},e)})))(dm),hm=["name"],pm=_.Ay.bind(null,{endpoint:"rb.locations",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"locations",isDynamic:!1}]}]},"/");class _m extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"state",{isFetchingLocations:!1,locations:[],selectedLocation:null,selectedRoom:null}),(0,pe.A)(this,"removeItem",(e=>{const{onChange:t,value:n}=this.props,i=n.filter((t=>t.id!==e.id));this.setTouched(),t(i)})),(0,pe.A)(this,"renderRoomItem",(e=>{const{disabled:t,readOnly:n,renderRoomActions:i}=this.props;return d.createElement(Ws.A.Item,{key:e.id},d.createElement("div",{className:"image-wrapper",style:{width:55,height:25}},d.createElement(xl,{pos:e.spritePosition,width:"100%",height:"100%",fillVertical:!0})),d.createElement(Ws.A.Content,null,d.createElement(Ws.A.Header,null,e.fullName)),d.createElement(Ws.A.Content,{className:"rb-client-js-components-___RoomSelector-module__room-actions___4ACiY"},i(e),!n&&d.createElement(T.A,{name:"remove",disabled:t,onClick:()=>!t&&this.removeItem(e)})))})),(0,pe.A)(this,"setTouched",(()=>{const{onFocus:e,onBlur:t}=this.props;e(),t()}))}componentDidMount(){this.setState({isFetchingLocations:!0},(async()=>{const{data:e}=await(async()=>{let e;try{e=await D.indicoAxios.get(pm())}catch(e){return void(0,D.handleAxiosError)(e)}return(0,fe.camelizeKeys)(e)})();this.setState({locations:e,isFetchingLocations:!1,selectedLocation:1===e.length?e[0]:null})}))}shouldComponentUpdate(e,t){const{disabled:n,readOnly:i,value:o}=this.props,{disabled:r,readOnly:a,value:s}=e;return t!==this.state||r!==n||a!==i||!cn()(s,o)}render(){const{onChange:e,onFocus:t,onBlur:n,readOnly:i,value:o}=this.props,{locations:r,selectedLocation:a,selectedRoom:s,isFetchingLocations:l}=this.state,c=r.map((e=>({text:e.name,value:e.id})));let u=[];return a&&(u=a.rooms.filter((e=>-1===o.findIndex((t=>t.id===e.id)))).map((e=>({text:e.fullName,value:e.id})))),d.createElement(Mt.A,{className:"rb-client-js-components-___RoomSelector-module__room-selector___w+uPP"},d.createElement(Mt.A.Row,null,!i&&d.createElement(d.Fragment,null,d.createElement(Mt.A.Column,{width:5},d.createElement(k.A,{placeholder:L.Translate.string("Location"),options:c,value:a&&a.id,loading:l,onChange:(e,t)=>{const n=r.find((e=>e.id===t.value));this.setState({selectedLocation:n})},onFocus:t,onBlur:n,fluid:!0,search:!0,selection:!0})),d.createElement(Mt.A.Column,{width:9},d.createElement(k.A,{placeholder:L.Translate.string("Room"),disabled:!a,options:u,value:s&&s.id,onChange:(e,t)=>{const n=a.rooms.find((e=>e.id===t.value));this.setState({selectedRoom:n})},onFocus:t,onBlur:n,fluid:!0,search:!0,selection:!0})),d.createElement(Mt.A.Column,{width:2},d.createElement(dn.A,{floated:"right",icon:"plus",type:"button",disabled:!s,onClick:()=>{this.setState({selectedRoom:null}),e([...o,s])},primary:!0})))),d.createElement(Mt.A.Row,{className:"rb-client-js-components-___RoomSelector-module__selected-rooms-row___khmJX"},d.createElement(Mt.A.Column,null,0!==o.length&&d.createElement(Ul.A,null,d.createElement(Ws.A,{className:"rb-client-js-components-___RoomSelector-module__rooms-list___AwRxD",verticalAlign:"middle",relaxed:!0},o.map(this.renderRoomItem))),0===o.length&&d.createElement(oo.A,{info:!0},d.createElement(L.Translate,null,"There are no rooms selected.")))))}}function fm(e){let{name:t}=e,n=(0,In.A)(e,hm);return d.createElement(Cs.FinalField,(0,bn.A)({name:t,component:_m,isEqual:cn()},n))}(0,pe.A)(_m,"propTypes",{onChange:y().func.isRequired,onFocus:y().func.isRequired,onBlur:y().func.isRequired,value:y().array.isRequired,disabled:y().bool,readOnly:y().bool,renderRoomActions:y().func}),(0,pe.A)(_m,"defaultProps",{disabled:!1,readOnly:!1,renderRoomActions:()=>{}}),fm.propTypes={name:y().string.isRequired,readOnly:y().bool},fm.defaultProps={readOnly:!1};function gm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function bm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?gm(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ym(e){let{dates:t,reason:n,rooms:i}=e;const o={};return t&&Object.values(t).every((e=>e))||(o.dates=L.Translate.string("Please choose a valid period.")),n||(o.reason=L.Translate.string("Please provide the reason for the blocking.")),i&&i.length||(o.rooms=L.Translate.string("Please choose at least one room for this blocking.")),o}class vm extends d.Component{constructor(e){super(e),(0,pe.A)(this,"handleSubmit",(async e=>{const{actions:{createBlocking:t,updateBlocking:n},blocking:{id:i}}=this.props,{mode:o}=this.state;let r;if("create"===o?r=await t(e):"edit"===o&&(r=await n(i,e)),r.error)return r.error;this.setState({newBlocking:r.data})})),(0,pe.A)(this,"renderRoomState",(e=>{const{managedRoomIds:t,blocking:{id:n},actions:{acceptBlocking:i,rejectBlocking:o}}=this.props,{state:r}=e,{mode:a}=this.state;if(!e.state)return null;const{rejectionReason:s,rejectedBy:l}=e,c={accepted:{name:"check circle",color:"green"},rejected:{name:"dont",color:"red"},pending:{name:"question circle",color:"orange"}}[r];let u;u="accepted"===r?L.Translate.string("Blocking has been accepted"):"pending"===r?L.Translate.string("Pending approval by a room manager"):d.createElement(d.Fragment,null,d.createElement(L.Translate,null,"Booking rejected by ",d.createElement(L.Param,{name:"rejectedBy",value:l,wrapper:d.createElement("strong",null)})),d.createElement("br",null),d.createElement(L.Translate,null,"Reason: ",d.createElement(L.Param,{name:"rejectionReason",value:s,wrapper:d.createElement("strong",null)})));return d.createElement("div",{className:"rb-client-js-modules-blockings-___BlockingModal-module__blocking-actions___VMR4h"},"view"===a&&"pending"===r&&t.has(e.id)&&d.createElement(d.Fragment,null,d.createElement(mn.A,{trigger:d.createElement(T.A,{name:"check",color:"green",size:"large",className:"rb-client-js-modules-blockings-___BlockingModal-module__action___Vc-DS",onClick:()=>i(n,e.id)}),position:"bottom center",content:L.Translate.string("Accept blocking"),flowing:!0}),d.createElement(mn.A,{trigger:d.createElement(T.A,{name:"dont",color:"red",size:"large",className:"rb-client-js-modules-blockings-___BlockingModal-module__action___Vc-DS"}),position:"bottom center",on:"click",flowing:!0},d.createElement(ks.Form,{onSubmit:t=>{let{reason:i}=t;return o(n,e.id,i)},render:e=>{let{handleSubmit:t,hasValidationErrors:n,submitSucceeded:i,submitting:o,pristine:r}=e;return d.createElement(ws.A,{className:"rb-client-js-modules-blockings-___BlockingModal-module__rejection-form___XXP-G",onSubmit:t},d.createElement(Cs.FinalTextArea,{name:"reason",placeholder:L.Translate.string("Provide the rejection reason"),disabled:i,rows:2,required:!0}),d.createElement(dn.A,{type:"submit",disabled:o||r||n||i,loading:o,floated:"right",primary:!0},d.createElement(L.Translate,null,"Reject")))}}))),d.createElement(mn.A,{trigger:d.createElement(T.A,(0,bn.A)({size:"large"},c)),position:"right center",content:u,flowing:!0}))})),(0,pe.A)(this,"renderSubmitButton",(e=>{let{hasValidationErrors:t,pristine:n,submitting:i,submitSucceeded:o}=e;const{mode:r}=this.state;return d.createElement(dn.A,{type:"submit",form:"blocking-form",disabled:i||t||n||o,loading:i,primary:!0},"edit"===r?d.createElement(L.Translate,null,"Update blocking"):d.createElement(L.Translate,null,"Block selected spaces"))})),(0,pe.A)(this,"renderHeaderText",(()=>{const{mode:e}=this.state;return"view"===e?d.createElement(L.Translate,null,"Blocking details"):"edit"===e?d.createElement(L.Translate,null,"Edit blocking"):d.createElement(L.Translate,null,"Block selected spaces")})),(0,pe.A)(this,"deleteBlocking",(()=>{const{blocking:{id:e},actions:{deleteBlocking:t},onClose:n}=this.props;t(e),n()})),(0,pe.A)(this,"renderModalContent",(e=>{const{onClose:t,blocking:n,actions:{openBlockingDetails:i}}=this.props,{submitSucceeded:o}=e,{mode:r,deletionConfirmOpen:a,newBlocking:s}=this.state,l="view"===r?{}:{onSubmit:e.handleSubmit,success:o},c=!!n.id&&n.canEdit,u=!!n.id&&n.canDelete,m=d.createElement("a",{onClick:()=>i(s.id)});return d.createElement(d.Fragment,null,d.createElement(Ts.A.Header,{className:"rb-client-js-modules-blockings-___BlockingModal-module__blocking-modal-header___3sWIZ"},this.renderHeaderText(),d.createElement("span",null,c&&d.createElement(dn.A,{icon:"pencil",primary:"edit"===r,onClick:()=>{"edit"===r?(e.form.reset(),this.setState({mode:"view"})):this.setState({mode:"edit"})},circular:!0}),u&&d.createElement(d.Fragment,null,d.createElement(dn.A,{icon:"trash",color:"red",onClick:()=>this.setState({deletionConfirmOpen:!0}),circular:!0}),d.createElement(Cu.A,{header:L.Translate.string("Confirm deletion"),content:L.Translate.string("Are you sure you want to delete this blocking?"),confirmButton:d.createElement(dn.A,{content:L.Translate.string("Delete"),negative:!0}),cancelButton:L.Translate.string("Cancel"),open:a,onConfirm:this.deleteBlocking,onCancel:()=>this.setState({deletionConfirmOpen:!1})})))),d.createElement(Ts.A.Content,null,d.createElement(ws.A,(0,bn.A)({id:"blocking-form"},l),d.createElement(Mt.A,{stackable:!0},d.createElement(Mt.A.Column,{width:8},"create"!==r&&d.createElement(oo.A,{icon:!0,info:!0,floating:!0},d.createElement(T.A,{name:"user"}),d.createElement(oo.A.Content,null,d.createElement(L.Translate,null,"Blocking created by ",d.createElement(L.Param,{name:"createdBy",value:n.createdBy})))),d.createElement(oo.A,{icon:!0,info:!0},d.createElement(T.A,{name:"lightbulb"}),d.createElement(oo.A.Content,null,d.createElement(L.Translate,null,'When blocking rooms nobody but you, the rooms\' managers and those users/groups you specify in the "Allowed users/groups" list will be able to create bookings for the specified rooms in the given timeframe. You can also block rooms you do not own - however, those blockings have to be approved by the owners of those rooms.'))),d.createElement(oo.A,{negative:!0,icon:!0},d.createElement(T.A,{name:"warning sign"}),d.createElement(oo.A.Content,null,d.createElement(L.Translate,null,"Please take into account that rooms blockings should only be used for short term events and never for long-lasting periods. If you wish to somehow mark a room as unusable, please ask its owner to set it as such."))),d.createElement(Os.FinalDatePeriod,{name:"dates",label:L.Translate.string("Period"),required:"create"===r,readOnly:"create"!==r||o,allowNull:!0}),d.createElement(Cs.FinalTextArea,{name:"reason",label:L.Translate.string("Reason"),placeholder:L.Translate.string("Provide reason for blocking"),readOnly:"view"===r,disabled:o,required:"view"!==r})),d.createElement(Mt.A.Column,{width:8},d.createElement(C.HM,null,(e=>d.createElement(Os.FinalPrincipalList,{name:"allowed",withGroups:!0,favoriteUsersController:e,label:L.Translate.string("Authorized users/groups"),readOnly:"view"===r,disabled:o}))),d.createElement(fm,{name:"rooms",label:"create"===r?L.Translate.string("Rooms to block"):L.Translate.string("Blocked rooms"),required:"view"!==r,renderRoomActions:this.renderRoomState,disabled:o,readOnly:"view"===r}),"view"===r&&this.hasManagedPendingRooms&&d.createElement(oo.A,{icon:!0,info:!0},d.createElement(T.A,{name:"info"}),d.createElement(L.Translate,null,"You can accept and reject blockings for your rooms on the list by using the action buttons on the right side of the room name.")),"edit"===r?d.createElement(oo.A,{success:!0},d.createElement(L.Translate,null,"The blocking has been successfully updated.")):d.createElement(oo.A,{success:!0},d.createElement(oo.A.Header,null,d.createElement(L.Translate,null,"The blocking has been successfully created.")),d.createElement(L.Translate,null,"You can consult your blocking"," ",d.createElement(L.Param,{name:"link",wrapper:m},"here"),".")))))),d.createElement(Ts.A.Actions,null,"view"!==r&&this.renderSubmitButton(e),d.createElement(dn.A,{type:"button",onClick:t},d.createElement(L.Translate,null,"Close"))))}));const{mode:t}=this.props;this.state={deletionConfirmOpen:!1,newBlocking:null,mode:t}}get hasManagedPendingRooms(){const{managedRoomIds:e,blocking:{blockedRooms:t}}=this.props;return t.some((t=>"pending"===t.state&&e.has(t.room.id)))}render(){const{onClose:e,blocking:{blockedRooms:t,allowed:n,startDate:i,endDate:o,reason:r}}=this.props,{mode:a}=this.state,s="view"===a?{onSubmit(){}}:{validate:ym,onSubmit:this.handleSubmit},l="create"!==a?{startDate:i,endDate:o}:null,c=t.map((e=>{let{room:t,state:n,rejectionReason:i,rejectedBy:o}=e;return bm(bm({},t),{},{state:n,rejectionReason:i,rejectedBy:o})}));return d.createElement(Ts.A,{open:!0,onClose:e,size:"large",closeIcon:!0},d.createElement(ks.Form,(0,bn.A)({},s,{render:this.renderModalContent,initialValues:{rooms:c,dates:l,allowed:n||[],reason:r},initialValuesEqual:cn(),subscription:{submitting:!0,hasValidationErrors:!0,pristine:!0,submitSucceeded:!0}})))}}(0,pe.A)(vm,"propTypes",{onClose:y().func.isRequired,managedRoomIds:y().object.isRequired,mode:y().oneOf(["view","edit","create"]),blocking:y().shape({id:y().number,blockedRooms:y().array,allowed:y().array,startDate:y().string,endDate:y().string,reason:y().string,createdBy:y().string,canDelete:y().bool,canEdit:y().bool}),actions:y().exact({createBlocking:y().func.isRequired,updateBlocking:y().func.isRequired,acceptBlocking:y().func.isRequired,rejectBlocking:y().func.isRequired,deleteBlocking:y().func.isRequired,openBlockingDetails:y().func.isRequired}).isRequired}),(0,pe.A)(vm,"defaultProps",{mode:"view",blocking:{id:null,blockedRooms:[],allowed:[],startDate:null,endDate:null,reason:""}});const Em=(0,p.connect)((e=>({managedRoomIds:new Set(Ki(e))})),(e=>({actions:(0,_e.bindActionCreators)({createBlocking:Wd,updateBlocking:Kd,acceptBlocking:Yd,rejectBlocking:Xd,deleteBlocking:Qd,openBlockingDetails:e=>Jd(e,"/blockings")},e)})))(vm);function km(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Am(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?km(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):km(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Tm=()=>({myBlockings:!1,myRooms:!1,timeframe:"recent"}),wm=(0,_e.combineReducers)({requests:(0,_e.combineReducers)({blockings:(0,G.Od)(Dd,Cd,Od),blocking:(0,G.Od)(Sd,Pd,Md),create:(0,G.Od)(jd,Id,Bd),blockingState:(0,G.Od)(Nd,Fd,zd),delete:(0,G.Od)(qd,Hd,Ud)}),blockings:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Rd:return t.data.reduce(((e,t)=>Am(Am({},e),{},{[t.id]:(0,fe.camelizeKeys)(t)})),{});case xd:return Am(Am({},e),{},{[t.data.id]:(0,fe.camelizeKeys)(t.data)});case Fd:{const{blocking:n}=(0,fe.camelizeKeys)(t.data);return Am(Am({},e),{},{[n.id]:n})}case Hd:{const{blockingId:n}=(0,fe.camelizeKeys)(t.data);return be()(e,n)}default:return e}},filters:we($d,Tm)}),Lm=["blockingId","component"];function Dm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Cm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dm(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class Om extends d.Component{componentDidMount(){const{blocking:e,blockingId:t,actions:{fetchBlocking:n}}=this.props;e||n(t)}render(){const{blocking:e,componentProps:t,component:n}=this.props;return e?d.createElement(n,(0,bn.A)({},t,{blocking:e})):d.createElement(pn.A,{active:!0,page:!0},d.createElement(_n.A,null))}}(0,pe.A)(Om,"propTypes",{blockingId:y().number.isRequired,component:y().elementType.isRequired,componentProps:y().object,blocking:y().object,actions:y().exact({fetchBlocking:y().func.isRequired}).isRequired}),(0,pe.A)(Om,"defaultProps",{blocking:void 0,componentProps:{}});const Rm=(0,p.connect)(((e,t)=>{let{blockingId:n}=t;return{blocking:om(e,{blockingId:n})}}),(e=>({actions:(0,_e.bindActionCreators)({fetchBlocking:Gd},e)})),((e,t,n)=>{const{blockingId:i,component:o}=n;return Cm(Cm({blockingId:i,component:o,componentProps:(0,In.A)(n,Lm)},e),t)}))(Om),Sm={"blocking-details":(e,t)=>d.createElement(Rm,{blockingId:t,component:Em,onClose:e})},{searchRooms:Pm}=xr("roomList");function Mm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function xm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mm(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const jm={"./FilterDropdown.module.scss":{"filter-dropdown":"rb-client-js-common-filters-___FilterDropdown-module__filter-dropdown___MuR0h","filter-dropdown-actions":"rb-client-js-common-filters-___FilterDropdown-module__filter-dropdown-actions___8xNNz","filter-dropdown-button":"rb-client-js-common-filters-___FilterDropdown-module__filter-dropdown-button___98FUh","filter-dropdown-button-counter":"rb-client-js-common-filters-___FilterDropdown-module__filter-dropdown-button-counter___tOyRK","filter-dropdown-footer":"rb-client-js-common-filters-___FilterDropdown-module__filter-dropdown-footer___0nK3b"}};class Im extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"state",{}),(0,pe.A)(this,"setFieldValue",((e,t)=>new Promise((n=>{this.setState((n=>xm(xm({},n),{},{fieldValues:xm(xm({},n.fieldValues),{},{[e]:t})})),(()=>{n()}))})))),(0,pe.A)(this,"setRenderedValue",(e=>{const{renderValue:t}=this.props,n=t(e);this.setState({renderedValue:n})})),(0,pe.A)(this,"hasValuesChanged",(()=>{const{initialValues:e}=this.props,{fieldValues:t}=this.state;return!cn()(e,t)})),(0,pe.A)(this,"handleClose",(()=>{const{onClose:e,setGlobalState:t}=this.props,{fieldValues:n}=this.state;this.hasValuesChanged()&&(this.setRenderedValue(n),t(n)),e()})),(0,pe.A)(this,"handleOpen",(()=>{const{onOpen:e}=this.props;e()}))}static getDerivedStateFromProps(e,t){const n=t.prevProps,{defaults:i,initialValues:o,renderValue:r}=e,a=function(e,t){return Object.assign(...Object.entries(t).map((t=>{let[n,i]=t;return null===i&&void 0!==e[n]?[n,e[n]]:[n,i]})).map((e=>{let[t,n]=e;return{[t]:n}})))}(i,o),s=r(o);return cn()(n,e)?xm(xm({fieldValues:a,renderedValue:s},t),{},{prevProps:e}):xm(xm({},t),{},{fieldValues:a,renderedValue:s,prevProps:e})}resetFields(e){this.setState({fieldValues:e})}render(){const{title:e,form:t,renderTrigger:n,counter:i,open:o,onClose:r,disabled:a}=this.props,{renderedValue:s,fieldValues:l}=this.state;return d.createElement(mn.A,{position:"bottom left",className:"rb-client-js-common-filters-___FilterDropdown-module__filter-dropdown___MuR0h",style:{maxWidth:"unset"},trigger:n(e,s,i,a),on:"click",open:o,onClose:r,onOpen:this.handleOpen},t(l,this.setFieldValue,this.handleClose),d.createElement(dn.A.Group,{size:"small",floated:"right",className:"rb-client-js-common-filters-___FilterDropdown-module__filter-dropdown-actions___8xNNz"},d.createElement(dn.A,{content:L.Translate.string("Apply"),onClick:this.handleClose,disabled:!this.hasValuesChanged(),positive:!0,compact:!0}),d.createElement(dn.A,{content:L.Translate.string("Cancel"),onClick:r,compact:!0})))}}(0,pe.A)(Im,"propTypes",{title:y().element.isRequired,form:y().func.isRequired,renderValue:y().func.isRequired,renderTrigger:y().func,setGlobalState:y().func.isRequired,initialValues:y().object,defaults:y().object,counter:y().bool,open:y().bool,onOpen:y().func.isRequired,onClose:y().func.isRequired,disabled:y().bool}),(0,pe.A)(Im,"defaultProps",{initialValues:{},defaults:{},renderTrigger:(e,t,n,i)=>d.createElement(dn.A,{primary:null!==t,disabled:i,className:(0,mu.A)(n?"filter-dropdown-button-counter":"filter-dropdown-button",jm,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})},null===t?e:t,d.createElement(T.A,{name:"angle down"})),counter:!1,open:!1,disabled:!1});const Bm=["name"],Nm=d.createContext();function Fm(e){let{name:t}=e,n=(0,In.A)(e,Bm);return d.createElement(Nm.Consumer,null,(e=>{let{state:i,onDropdownOpen:o,onDropdownClose:r}=e;return d.createElement(Im,(0,bn.A)({open:i[t],onOpen:()=>o(t),onClose:()=>r(t)},n))}))}Fm.propTypes={name:y().string.isRequired};class zm extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"state",{}),(0,pe.A)(this,"onDropdownOpen",(e=>{this.setState((t=>Object.assign({},...Object.keys(t).map((e=>({[e]:null}))),{[e]:!0})))})),(0,pe.A)(this,"onDropdownClose",(e=>{this.setState({[e]:!1})}))}render(){const{children:e}=this.props;return d.createElement(Nm.Provider,{value:{onDropdownOpen:this.onDropdownOpen,onDropdownClose:this.onDropdownClose,state:this.state}},e)}}function qm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}(0,pe.A)(zm,"propTypes",{children:y().node.isRequired});class Hm extends Se{constructor(e){super(e),(0,pe.A)(this,"setBuilding",(e=>{const{setParentField:t}=this.props;this.setState({building:e},(()=>{t("building",e)}))}));const{building:t}=this.props;this.state={building:t}}render(){const{buildings:e}=this.props,{building:t}=this.state,n=e.map((e=>({text:L.Translate.string("Building {buildingNumber}",{buildingNumber:e}),value:e})));return d.createElement(ws.A.Group,null,d.createElement(ws.A.Dropdown,{options:n,value:t,placeholder:L.Translate.string("Building"),onChange:(e,t)=>{let{value:n}=t;return this.setBuilding(n||null)},closeOnChange:!0,closeOnBlur:!0,search:!0,selection:!0,clearable:!0}))}}(0,pe.A)(Hm,"propTypes",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qm(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({buildings:y().array.isRequired,building:y().string},Se.propTypes)),(0,pe.A)(Hm,"defaultProps",{building:null});class Um extends Se{setCapacity(e){const{setParentField:t}=this.props;t("capacity",e),this.setState({capacity:e})}render(){const{capacity:e}=this.state,t=d.createElement(T.A,{name:"close",onClick:()=>this.setCapacity(null),link:!0});return d.createElement("div",{className:"rb-client-js-modules-roomList-filters-___CapacityForm-module__capacity-form___T9IL9"},d.createElement(dd.A,{type:"number",placeholder:L.Translate.string("Min. Capacity"),min:"1",step:"1",icon:e?t:null,value:e||"",onChange:(e,t)=>{let{value:n}=t;this.setCapacity(n?Math.abs(+n):null)}}))}}var $m=n(81618),Zm=n.n($m),Gm=n(75313);function Vm(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}class Wm extends Se{constructor(e){super(e),(0,pe.A)(this,"handleClick",(()=>{const{showEquipment:e}=this.state;this.setState({showEquipment:!e})}));const{availableEquipment:t,availableFeatures:n,selectedEquipment:i,selectedFeatures:o}=e;this.state={equipment:t.filter((e=>i.includes(e))),features:n.map((e=>e.name)).filter((e=>o.includes(e))),showEquipment:!!i.length}}setEquipment(e,t){const{setParentField:n}=this.props;this.setState((n=>{const i=Zm()(n.equipment,e);return t&&i.push(e),{equipment:i}}),(()=>{n("equipment",this.state.equipment)}))}setFeature(e,t){const{setParentField:n}=this.props;this.setState((n=>{const i=Zm()(n.features,e);return t&&i.push(e),{features:i}}),(()=>{n("features",this.state.features)}))}render(){const{availableEquipment:e,availableFeatures:t}=this.props,{equipment:n,features:i,showEquipment:o}=this.state;return d.createElement(ws.A.Group,null,t.map((e=>d.createElement(ws.A.Checkbox,{checked:i.includes(e.name),key:e.name,label:d.createElement("label",null,d.createElement(T.A,{name:e.icon}),d.createElement("strong",null,e.title)),onChange:(t,n)=>{let{checked:i}=n;this.setFeature(e.name,i)}}))),!!t.length&&!!e.length&&d.createElement(Gm.A,{className:"rb-client-js-modules-roomList-filters-___EquipmentForm-module__equipment-accordion___7pFNK"},d.createElement(Gm.A.Title,{active:o,index:0,onClick:this.handleClick},d.createElement(T.A,{name:"dropdown"}),d.createElement(L.Translate,null,"See detailed equipment")),d.createElement(Gm.A.Content,{active:o},e.map((e=>d.createElement(ws.A.Checkbox,{checked:n.includes(e),key:e,label:e,onChange:(t,n)=>{let{checked:i}=n;this.setEquipment(e,i)}}))))),!t.length&&e.map((e=>d.createElement(ws.A.Checkbox,{checked:n.includes(e),key:e,label:e,onChange:(t,n)=>{let{checked:i}=n;this.setEquipment(e,i)}}))))}}function Km(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}(0,pe.A)(Wm,"propTypes",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Vm(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vm(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({selectedEquipment:y().arrayOf(y().string).isRequired,selectedFeatures:y().arrayOf(y().string).isRequired,availableEquipment:y().arrayOf(y().string).isRequired,availableFeatures:y().arrayOf(y().shape({name:y().string.isRequired,title:y().string.isRequired})).isRequired},Se.propTypes));class Ym extends Se{constructor(){super(...arguments),(0,pe.A)(this,"setLocation",(e=>{const{setParentField:t}=this.props;t("locationId",e)}))}render(){const{locations:e,location:t}=this.props,n=Array.from(e,(e=>{let[t,n]=e;return{text:n,value:t}}));return d.createElement(ws.A.Group,null,d.createElement(ws.A.Dropdown,{options:n,value:t,placeholder:L.Translate.string("Location"),onChange:(e,t)=>{let{value:n}=t;return this.setLocation(n||null)},closeOnChange:!0,closeOnBlur:!0,search:!0,selection:!0,clearable:!0}))}}(0,pe.A)(Ym,"propTypes",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Km(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Km(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({locations:y().object.isRequired,location:y().number},Se.propTypes)),(0,pe.A)(Ym,"defaultProps",{location:null});const Xm=(0,p.connect)((e=>({filters:pd(e),hasOwnedRooms:$i(e),hasFavoriteRooms:Qi(e),hasUnbookableRooms:Yi(e)})))(class extends Se{render(){const{filters:{onlyFavorites:e,onlyMine:t,onlyAuthorized:n},onlyFavorites:i,onlyMine:o,onlyAuthorized:r,hasFavoriteRooms:a,hasOwnedRooms:s,setParentField:l,showOnlyAuthorizedFilter:c,disabled:u,hasUnbookableRooms:m,hideFavoritesFilter:h}=this.props;return d.createElement(d.Fragment,null,!h&&d.createElement("div",{className:"rb-client-js-modules-roomList-filters-___ShowOnlyForm-module__show-only-filter___jA7Mm"},d.createElement(un.A,{onChange:(e,t)=>{let{checked:n}=t;return l("onlyFavorites",n)},disabled:!e&&!a||u,checked:i,toggle:!0}),d.createElement(T.A,{name:"star"}),d.createElement("span",null,d.createElement(L.Translate,null,"My favorite rooms"))),(s||t)&&d.createElement("div",{className:"rb-client-js-modules-roomList-filters-___ShowOnlyForm-module__show-only-filter___jA7Mm"},d.createElement(un.A,{onChange:(e,t)=>{let{checked:n}=t;return l("onlyMine",n)},disabled:u,checked:o,toggle:!0}),d.createElement(T.A,{name:"user"}),d.createElement("span",null,d.createElement(L.Translate,null,"Rooms I manage"))),c&&(m||n)&&d.createElement("div",{className:"rb-client-js-modules-roomList-filters-___ShowOnlyForm-module__show-only-filter___jA7Mm"},d.createElement(un.A,{onChange:(e,t)=>{let{checked:n}=t;return l("onlyAuthorized",n)},disabled:u,checked:r,toggle:!0}),d.createElement(T.A,{name:"lock open"}),d.createElement("span",null,d.createElement(L.Translate,null,"Rooms I am authorized to book"))))}}),Qm=["capacity","onlyFavorites","onlyMine","onlyAuthorized","equipment","features","building","locationId"],Jm=e=>{let{capacity:t}=e;return null===t?null:d.createElement("span",null,d.createElement(T.A,{name:"user"}),t)},eh=e=>{let{equipment:t,features:n}=e;const i=t.length+n.length;return i?d.createElement(d.Fragment,null,d.createElement(xt.Responsive.Tablet,{andLarger:!0,orElse:d.createElement(T.A,{name:"wrench"})},d.createElement(L.Translate,null,"Equipment")),d.createElement(Ll.A,{circular:!0,horizontal:!0,className:"white rb-client-js-modules-roomList-___RoomFilterBar-module__filter-bar-button-label___i93R8",size:"tiny"},i)):null},th=e=>{let{locationName:t}=e;return t?d.createElement(d.Fragment,null,d.createElement(T.A,{name:"map pin"}),t):null},nh=e=>{let{building:t}=e;return t?d.createElement(d.Fragment,null,d.createElement(T.A,{name:"building"}),d.createElement(xt.Responsive.Tablet,{andLarger:!0,orElse:t},d.createElement(L.Translate,null,"Building ",d.createElement(L.Param,{name:"building",value:t})))):null};class ih extends d.Component{render(){const e=this.props,{equipmentTypes:t,features:n,buildings:i,extraButtons:o,hideOptions:r,disabled:a,showOnlyAuthorizedFilter:s,hasOwnedRooms:l,filters:{capacity:c,onlyFavorites:u,onlyMine:m,onlyAuthorized:p,equipment:_,features:f,building:g,locationId:b},actions:{setFilterParameter:y,setFilters:v},locations:E}=e,k=(0,In.A)(e.filters,Qm),A=E.size>1,w=r.favorites&&!l&&!m&&!s,D=(e,t)=>d.createElement(xt.Responsive.Desktop,{andLarger:!0,orElse:t},e),C=(!!t.length||!!n.length)&&d.createElement(Fm,{name:"equipment",title:D(L.Translate.string("Equipment"),d.createElement(T.A,{name:"wrench"})),form:(e,i)=>d.createElement(Wm,{setParentField:i,selectedEquipment:e.equipment,selectedFeatures:e.features,availableEquipment:t,availableFeatures:n}),counter:!0,setGlobalState:v,initialValues:{equipment:_,features:f},renderValue:eh,disabled:a}),O=E.get(b);return d.createElement(dn.A.Group,{size:"small",className:"rb-client-js-modules-bookRoom-___BookingFilterBar-module__recurrence-bar___YocdZ"},d.createElement(dn.A,{icon:"filter",as:"div",disabled:!0}),d.createElement(zm,null,!r.location&&A&&d.createElement(Fm,{name:"locationId",title:D(L.Translate.string("Location"),d.createElement(T.A,{name:"map pin"})),form:(e,t)=>{let{locationId:n}=e;return d.createElement(Ym,{setParentField:t,locations:E,location:n})},setGlobalState:e=>y("locationId",e.locationId),initialValues:{locationId:b,locationName:O},renderValue:th,disabled:a}),!r.building&&d.createElement(Fm,{name:"building",title:D(L.Translate.string("Building"),d.createElement(T.A,{name:"building"})),form:(e,t)=>{let{building:n}=e;return d.createElement(Hm,{setParentField:t,buildings:i,building:n})},setGlobalState:e=>y("building",e.building),initialValues:{building:g},renderValue:nh,disabled:a}),!r.capacity&&d.createElement(Fm,{name:"capacity",title:D(L.Translate.string("Min. Capacity"),d.createElement(T.A,{name:"user"})),form:(e,t)=>{let{capacity:n}=e;return d.createElement(Um,{setParentField:t,capacity:n})},setGlobalState:e=>y("capacity",e.capacity),initialValues:{capacity:c},renderValue:Jm,disabled:a}),!r.equipment&&C,d.createElement(h.Ay,{id:"RoomFilterBar.extraFilters",setFilter:y,filters:k,disabled:a}),!w&&d.createElement(Fm,{name:"room-different",title:D(L.Translate.string("Show only..."),"..."),form:(e,t)=>d.createElement(Xm,(0,bn.A)({},e,{setParentField:t,showOnlyAuthorizedFilter:s,hideFavoritesFilter:r.favorites,disabled:a})),setGlobalState:v,renderValue:e=>{const t=Object.entries({onlyFavorites:"star",onlyMine:"user",onlyAuthorized:"lock open"}).filter((t=>{let[n]=t;return e[n]})).map((e=>{let[t,n]=e;return d.createElement(T.A,{key:t,name:n})}));return 0!==t.length?t:null},initialValues:{onlyFavorites:u,onlyMine:m,onlyAuthorized:p},disabled:a}),o))}}(0,pe.A)(ih,"propTypes",{equipmentTypes:y().arrayOf(y().string).isRequired,features:y().arrayOf(y().shape({icon:y().string.isRequired,name:y().string.isRequired,title:y().string.isRequired})).isRequired,buildings:y().array.isRequired,showOnlyAuthorizedFilter:y().bool,extraButtons:y().node,hasOwnedRooms:y().bool.isRequired,filters:y().shape({building:y().string,locationId:y().number,capacity:y().number,equipment:y().array,onlyFavorites:y().bool,onlyMine:y().bool,onlyAuthorized:y().bool,features:y().arrayOf(y().string).isRequired}).isRequired,actions:y().shape({setFilterParameter:y().func,setFilters:y().func}).isRequired,hideOptions:y().objectOf(y().bool),disabled:y().bool,locations:y().object.isRequired}),(0,pe.A)(ih,"defaultProps",{showOnlyAuthorizedFilter:!0,extraButtons:null,hideOptions:{},disabled:!1});const oh=(e,t)=>(0,p.connect)((e=>({filters:t.getFilters(e),equipmentTypes:Ko(e),features:Yo(e),buildings:nr(e),locations:ir(e),hasOwnedRooms:$i(e)})),(t=>({actions:(0,_e.bindActionCreators)({setFilterParameter:(t,n)=>Ee(e,t,n),setFilters:t=>ke(e,t)},t)})))(h.Ay.component("RoomFilterBar",ih)),rh=["onlyAuthorized"],ah=["onlyAuthorized"];function sh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function lh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sh(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const ch=hd("roomList",a),uh=ni("roomList",a),dh=oh("roomList",a);class mh extends d.Component{constructor(e){super(e),(0,pe.A)(this,"state",{selectionMode:null,selection:{},numVisibleRooms:20}),(0,pe.A)(this,"closeModal",(()=>{const{pushState:e}=this.props;e("/rooms",!0),this.clearSelectionMode()})),(0,pe.A)(this,"clearSelectionMode",(()=>{this.setState({selectionMode:null,selection:{}})})),(0,pe.A)(this,"setSelectionMode",(e=>()=>{this.setState({selectionMode:e,selection:{}})})),(0,pe.A)(this,"hasMoreRooms",(()=>{const{numVisibleRooms:e}=this.state,{results:t}=this.props;return e<t.length})),(0,pe.A)(this,"loadMoreRooms",(()=>{const{numVisibleRooms:e}=this.state;this.setState({numVisibleRooms:e+20})})),(0,pe.A)(this,"onSelectRoom",(e=>{const{selection:t}=this.state;if(e.id in t){const n=lh({},t);delete n[e.id],this.setState({selection:n})}else this.setState({selection:lh(lh({},t),{},{[e.id]:e})})})),this.contextRef=d.createRef()}componentDidMount(){const{actions:{searchRooms:e}}=this.props;e()}componentDidUpdate(e){const{filters:{onlyAuthorized:t}}=e,n=(0,In.A)(e.filters,rh),i=this.props,{filters:{onlyAuthorized:o},actions:{searchRooms:r}}=i,a=(0,In.A)(i.filters,ah);cn()(n,a)?t!==o&&this.setState({numVisibleRooms:20}):(r(),this.setState({numVisibleRooms:20}))}get visibleRooms(){const{numVisibleRooms:e}=this.state,{results:t}=this.props;return t.slice(0,e)}render(){const{results:e,showMap:t,pushState:n,isSearching:i,actions:{openRoomDetails:o},hideActionsDropdown:r}=this.props,{selectionMode:a,selection:s}=this.state,l=[{text:L.Translate.string("Block rooms"),value:"block-rooms",onClick:this.setSelectionMode("blocking"),icon:"lock"},{text:L.Translate.string("Export bookings"),value:"export-bookings",onClick:this.setSelectionMode("export"),icon:"file excel"}];return d.createElement(Mt.A,{columns:2},d.createElement(Mt.A.Column,{computer:t?11:16,mobile:16},d.createElement("div",{className:"ui rb-client-js-modules-roomList-___RoomList-module__room-list___XsURB",ref:this.contextRef},d.createElement(Os.StickyWithScrollBack,{context:this.contextRef.current},d.createElement("div",{className:"filter-row"},d.createElement("div",{className:"filter-row-filters"},d.createElement(dh,null),d.createElement(ch,null)),!r&&d.createElement(xt.Responsive.Tablet,{andLarger:!0},d.createElement("div",{className:"rb-client-js-modules-roomList-___RoomList-module__actions___ihYcN"},a?d.createElement(d.Fragment,null,d.createElement(dn.A,{icon:"check",disabled:0===Object.keys(s).length,onClick:()=>{"blocking"===a?n("/rooms/blocking/create"):"export"===a&&n("/rooms/bookings/export")},primary:!0,circular:!0}),d.createElement(dn.A,{icon:"cancel",onClick:this.clearSelectionMode,circular:!0})):d.createElement(k.A,{text:L.Translate.string("Actions"),className:"small",options:l,direction:"left",button:!0,floating:!0}))))),d.createElement("div",{className:"rb-client-js-modules-roomList-___RoomList-module__results-count___9j3-2"},0===e.length&&!i&&L.Translate.string("There are no rooms matching the criteria"),0!==e.length&&d.createElement(L.PluralTranslate,{count:e.length},d.createElement(L.Singular,null,"There is ",d.createElement(L.Param,{name:"count",value:e.length})," match"),d.createElement(L.Plural,null,"There are ",d.createElement(L.Param,{name:"count",value:e.length})," matches"))),i?d.createElement(ld.Group,{count:20}):d.createElement(Qc.Ay,{hasMore:this.hasMoreRooms(),loadMore:this.loadMoreRooms},d.createElement(zl,{rooms:this.visibleRooms,selectedRooms:s,inSelectionMode:!!a,onSelectRoom:this.onSelectRoom},(e=>{let{id:t}=e;return d.createElement(xt.Slot,{name:"actions"},d.createElement(Os.ResponsivePopup,{trigger:d.createElement(dn.A,{icon:"search",onClick:()=>o(t),primary:!0,circular:!0}),content:L.Translate.string("See details"),position:"top center"}))}))))),t&&d.createElement(xt.Responsive.Desktop,{andLarger:!0},d.createElement(Mt.A.Column,{computer:5,only:"computer"},d.createElement(uh,{onRoomClick:e=>{let{id:t}=e;return o(t)}}))),d.createElement(St.Route,{exact:!0,path:"/rooms/blocking/create",render:()=>{const e={blockedRooms:Object.values(s).map((e=>({room:(0,fe.camelizeKeys)(e)})))};return d.createElement(Em,{mode:"create",blocking:e,onClose:this.closeModal})}}),d.createElement(St.Route,{exact:!0,path:"/rooms/bookings/export",render:()=>{const e=Object.values(s).map((e=>lh({},e)));return d.createElement(Vp,{rooms:e,onClose:this.closeModal})}}))}}(0,pe.A)(mh,"propTypes",{filters:y().object.isRequired,results:y().arrayOf(y().object).isRequired,isSearching:y().bool.isRequired,showMap:y().bool.isRequired,pushState:y().func.isRequired,actions:y().exact({searchRooms:y().func.isRequired,openRoomDetails:y().func.isRequired}).isRequired,hideActionsDropdown:y().bool}),(0,pe.A)(mh,"defaultProps",{hideActionsDropdown:!1});const hh=(0,p.connect)((e=>({filters:pd(e),results:bd(e),isSearching:_d(e),showMap:Nt(e),queryString:(0,Jc.SG)(e.roomList,uu)})),(e=>({dispatch:e,actions:(0,_e.bindActionCreators)({searchRooms:Pm,openRoomDetails:Io},e)})),((e,t,n)=>{const{dispatch:i}=t,o=(0,In.A)(t,ur);return mr(mr(mr(mr({},n),e),o),{},{pushState(t){arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(t+=`?${e.queryString}`),i(z(t))}})}))(h.Ay.component("RoomList",mh)),ph=su("roomList");function _h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function fh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_h(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class gh extends Se{static getDerivedStateFromProps(e,t){let{startDate:n,endDate:i}=e;return fh({startDate:t.startDate||(0,De.toMoment)(n),endDate:t.endDate||(0,De.toMoment)(i)},t)}setDates(e,t){return new Promise((n=>{const{setParentField:i}=this.props;i("startDate",(0,De.serializeDate)(e)),i("endDate",(0,De.serializeDate)(t)),this.setState({startDate:e,endDate:t},(()=>{n()}))}))}disabledDate(e){if(e)return e.isBefore(cr()(),"day")}render(){const{isRange:e,disabledDate:t}=this.props,{startDate:n,endDate:i}=this.state;return e?d.createElement(Os.CalendarRangeDatePicker,{startDate:n,endDate:i,onDatesChange:async e=>{let{startDate:t,endDate:n}=e;await this.setDates(t,n)},disabledDate:t||this.disabledDate,noBorder:!0}):d.createElement(Os.CalendarSingleDatePicker,{date:n,yearsBefore:0,yearsAfter:1,onDateChange:async e=>{await this.setDates(e,null)},disabledDate:t||this.disabledDate,noBorder:!0})}}function bh(e){let{startDate:t,endDate:n}=e;return t=t?cr()(t):null,n=n?cr()(n):null,t||n?n?d.createElement(xt.Responsive.Tablet,{andLarger:!0,orElse:`${t.format("D MMM")} - ${n.format("D MMM")}`},`${t.format("ddd D MMM")} - ${n.format("ddd D MMM")}`):d.createElement(xt.Responsive.Tablet,{andLarger:!0,orElse:t.format("D MMM")},t.format("ddd D MMM")):null}(0,pe.A)(gh,"propTypes",fh({startDate:y().string,endDate:y().string,isRange:y().bool.isRequired,disabledDate:y().func},Se.propTypes)),(0,pe.A)(gh,"defaultProps",{startDate:null,endDate:null,disabledDate:null});var yh=n(51273),vh=n(96819);const Eh=["name"];function kh(e){let{onChange:t,value:n,disabled:i,requireOneSelected:o}=e;const r=cr().weekdays(!0).map((e=>({value:cr()().day(e).locale("en").format("ddd").toLowerCase(),text:cr()().isoWeekday(e).format("ddd")})));return d.createElement("div",null,d.createElement(dn.A.Group,null,r.map((e=>d.createElement(dn.A,{type:"button",key:e.value,value:e.value,compact:!0,disabled:i,primary:n.includes(e.value),onClick:()=>(e=>{const r=n.includes(e);if(i||o&&r&&1===n.length)return;let a;a=r?n.filter((t=>t!==e)):[...n,e],a.sort(),t(a)})(e.value)},e.text)))))}kh.propTypes={onChange:y().func.isRequired,value:y().arrayOf(y().string),disabled:y().bool,requireOneSelected:y().bool},kh.defaultProps={value:[],disabled:!1,requireOneSelected:!1};const Ah=kh;function Th(e){let{name:t}=e,n=(0,In.A)(e,Eh);return d.createElement(Cs.FinalField,(0,bn.A)({name:t,component:kh,isEqual:Cs.unsortedArraysEqual},n))}Th.propTypes={name:y().string.isRequired};function wh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}class Lh extends Se{componentDidUpdate(){this.preselectWeekdayToday()}constructor(e){super(e),this.onTypeChange=e=>{this.stateChanger("type")(e.target.value)},this.onTypeChange=this.stateChanger("type"),this.onNumberChange=this.stateChanger("number",(e=>Math.abs(parseInt(e,10)))),this.onIntervalChange=this.stateChanger("interval"),this.onWeekdaysChange=this.stateChanger("weekdays")}stateChanger(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e;const{setParentField:n}=this.props;return(i,o)=>{let{value:r}=o;r=t(r),n(e,r),this.setState({[e]:r})}}preselectWeekdayToday(){const{weekdays:e,type:t,interval:n}=this.state,i=cr()().locale("en").format("ddd").toLocaleLowerCase();"week"!==n?e.length>0&&this.props.setParentField("weekdays",[]):0===e.length&&"every"===t?(this.setState({weekdays:[i]}),this.props.setParentField("weekdays",[i])):e.length>0&&"every"!==t&&this.props.setParentField("weekdays",[])}render(){const{type:e,interval:t,number:n,weekdays:i}=this.state,o=[{value:"week",text:L.PluralTranslate.string("Week","Weeks",n)},{value:"month",text:L.PluralTranslate.string("Month","Months",n)}];return d.createElement(ws.A,null,d.createElement(ws.A.Field,null,d.createElement(yh.A,{value:"single",name:"type",checked:"single"===e,label:L.Translate.string("Single booking"),onChange:this.onTypeChange})),d.createElement(ws.A.Field,{style:{marginBottom:"0.5em"}},d.createElement(yh.A,{value:"daily",name:"type",checked:"daily"===e,label:L.Translate.string("Daily"),onChange:this.onTypeChange})),d.createElement(ws.A.Group,{inline:!0,className:"rb-client-js-modules-bookRoom-filters-___RecurrenceForm-module__recurrence-every___e08jt",style:{marginBottom:"1em"}},d.createElement(ws.A.Field,null,d.createElement(yh.A,{value:"every",name:"type",checked:"every"===e,label:L.Translate.string("Every"),onChange:this.onTypeChange})),d.createElement(ws.A.Field,null,d.createElement(dd.A,{value:n,type:"number",min:"1",max:"99",step:"1",disabled:"every"!==e,onChange:this.onNumberChange})),d.createElement(ws.A.Field,{style:{paddingRight:0}},d.createElement(vh.A,{value:t,disabled:"every"!==e,onChange:this.onIntervalChange,options:o}))),"every"===e&&"week"===t&&d.createElement(ws.A.Field,{className:"rb-client-js-modules-bookRoom-filters-___RecurrenceForm-module__weekday-recurrence-section___HAGgE",inline:!0},d.createElement("label",null,d.createElement(L.Translate,null,"Recurring every")),d.createElement(kh,{onChange:e=>this.onWeekdaysChange(null,{value:e}),value:i,disabled:"every"!==e,requireOneSelected:!0})))}}(0,pe.A)(Lh,"propTypes",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?wh(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({type:y().string,interval:y().string,number:y().number,weekdays:y().arrayOf(y().string)},Se.propTypes)),(0,pe.A)(Lh,"defaultProps",{type:null,interval:null,number:null,weekdays:[]});function Dh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ch(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Dh(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class Oh extends Se{static getDerivedStateFromProps(e,t){let{startTime:n,endTime:i}=e;return Ch({startTime:(0,De.toMoment)(n,"HH:mm"),endTime:(0,De.toMoment)(i,"HH:mm")},t)}constructor(e){super(e),(0,pe.A)(this,"setTimes",(async(e,t)=>{const{setParentField:n}=this.props,{startTime:i,endTime:o}=this.state;e===i&&t===o||(await n("startTime",(0,De.serializeTime)(e)),await n("endTime",(0,De.serializeTime)(t)),this.setState({startTime:e,endTime:t}))})),this.formRef=d.createRef()}render(){const{startTime:e,endTime:t}=this.state,{minTime:n}=this.props;return d.createElement("div",{ref:this.formRef},d.createElement(zs,{startTime:e,endTime:t,onChange:this.setTimes,minTime:n}))}}function Rh(e){let{startTime:t,endTime:n}=e;return t||n?n?`${t} - ${n}`:t:null}(0,pe.A)(Oh,"propTypes",Ch({startTime:y().string,endTime:y().string,minTime:y().string},Se.propTypes)),(0,pe.A)(Oh,"defaultProps",{startTime:null,endTime:null,bookingGracePeriod:1});class Sh extends d.Component{render(){const{dayBased:e,filters:{recurrence:t,dates:n,timeSlot:i},actions:{setFilterParameter:o},isAdminOverrideEnabled:r,bookingGracePeriod:a}=this.props,s=(0,De.getMinimumBookingStartTime)((0,De.createDT)(n.startDate,"00:00"),r,a);return d.createElement(dn.A.Group,{size:"small",className:"rb-client-js-modules-bookRoom-___BookingFilterBar-module__recurrence-bar___YocdZ"},d.createElement(dn.A,{icon:"calendar alternate outline",as:"div",disabled:!0}),d.createElement(zm,null,d.createElement(h.Ay,{id:"BookingFilterBar.recurrence"},d.createElement(Fm,{name:"recurrence",title:d.createElement(L.Translate,null,"Recurrence"),form:(e,t)=>d.createElement(Lh,(0,bn.A)({setParentField:t},e)),setGlobalState:e=>{let{type:t,number:n,interval:i,weekdays:r}=e;o("recurrence",{type:t,number:n,interval:i,weekdays:r})},initialValues:t,defaults:{type:"single",number:1,interval:"week",weekdays:[]},renderValue:Er})),d.createElement(Fm,{name:"dates",title:d.createElement(L.Translate,null,"Date"),form:(e,i)=>d.createElement(gh,(0,bn.A)({setParentField:i,isRange:"single"!==t.type,disabledDate:e=>!(0,De.isBookingStartDateValid)(e,r,a)},n)),setGlobalState:o.bind(void 0,"dates"),initialValues:n,renderValue:bh}),!e&&d.createElement(Fm,{name:"timeSlot",title:d.createElement(L.Translate,null,"Time"),form:(e,t)=>d.createElement(Oh,(0,bn.A)({setParentField:t,minTime:s},e)),setGlobalState:o.bind(void 0,"timeSlot"),initialValues:i,renderValue:Rh})))}}(0,pe.A)(Sh,"propTypes",{dayBased:y().bool,isAdminOverrideEnabled:y().bool.isRequired,filters:y().shape({recurrence:y().shape({number:y().number,type:y().string,interval:y().string,weekdays:y().arrayOf(y().string)}).isRequired,dates:y().shape({startDate:y().string,endDate:y().string}).isRequired,timeSlot:y().shape({startTime:y().string,endTime:y().string})}).isRequired,actions:y().shape({setFilterParameter:y().func}).isRequired,bookingGracePeriod:y().number}),(0,pe.A)(Sh,"defaultProps",{dayBased:!1,bookingGracePeriod:null});const Ph=(0,p.connect)((e=>({filters:gc(e),isAdminOverrideEnabled:Ui(e),bookingGracePeriod:re(e)})),(e=>({actions:{setFilterParameter:(t,n)=>{e(Ee("bookRoom",t,n))}}})))(h.Ay.component("BookingFilterBar",Sh));function Mh(e){let{onClick:t,overrides:n,icon:i,text:o,tooltip:r}=e;const a=d.createElement(oo.A,{className:"rb-client-js-modules-bookRoom-___BookingSuggestion-module__suggestion-text___oaQnE",size:"mini",onClick:t.bind(void 0,n),warning:!0,compact:!0},d.createElement(oo.A.Header,null,d.createElement(T.A,{name:i})," ",o));return d.createElement(mn.A,{trigger:a,content:r,position:"right center"})}Mh.propTypes={onClick:y().func.isRequired,overrides:y().object,icon:y().string.isRequired,text:xt.IndicoPropTypes.i18n.isRequired,tooltip:xt.IndicoPropTypes.i18n.isRequired},Mh.defaultProps={overrides:null};class xh extends d.PureComponent{getStartTimeSuggestionText(e){return e<0?d.createElement(L.PluralTranslate,{count:e},d.createElement(L.Singular,null,"One minute earlier"),d.createElement(L.Plural,null,d.createElement(L.Param,{name:"count",value:Math.abs(e)})," minutes earlier")):d.createElement(L.PluralTranslate,{count:e},d.createElement(L.Singular,null,"One minute later"),d.createElement(L.Plural,null,d.createElement(L.Param,{name:"count",value:e})," minutes later"))}renderSuggestionText(e,t){let{time:n,duration:i,skip:o,shorten:r}=t;const{onClick:a}=this.props;return d.createElement(d.Fragment,null,n&&d.createElement(Mh,{onClick:a,overrides:{time:n},icon:"clock",text:this.getStartTimeSuggestionText(n),tooltip:L.Translate.string("We'll change your booking's starting time to make it fit")}),i&&n&&d.createElement("div",null,d.createElement(Ll.A,{color:"brown",circular:!0},L.Translate.string("or"))),i&&d.createElement(Mh,{onClick:a,overrides:{duration:i},icon:"hourglass full",text:L.PluralTranslate.string("One minute shorter","{duration} minutes shorter",i,{duration:i}),tooltip:L.Translate.string("We'll shorten your booking to make it fit")}),o&&d.createElement(Mh,{onClick:a,icon:"calendar times",text:L.PluralTranslate.string("Skip one day","Skip {skip} days",o,{skip:o}),tooltip:L.PluralTranslate.string("We'll skip one occurrence to avoid any conflicts","We'll skip {skip} occurrences to avoid any conflicts",o,{skip:o})}),r&&d.createElement(Mh,{onClick:a,overrides:{shorten:r},icon:"calendar times",text:L.PluralTranslate.string("Shorten by one day","Shorten by {shorten} days",r,{shorten:r}),tooltip:L.Translate.string("Bookings in this room cannot last this long and will be shortened accordingly")}))}render(){const{room:e,suggestions:t}=this.props;return d.createElement(Bl,{key:e.id,room:e},d.createElement(xt.Slot,null,d.createElement(Mt.A,{centered:!0,className:"rb-client-js-modules-bookRoom-___BookingSuggestion-module__suggestion___eZCf8",columns:3},d.createElement(Mt.A.Column,{verticalAlign:"middle",width:14},this.renderSuggestionText(e,t)))))}}function jh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ih(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?jh(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}(0,pe.A)(xh,"propTypes",{room:y().object.isRequired,suggestions:y().shape({time:y().number,duration:y().number,skip:y().number,shorten:y().number}).isRequired,onClick:y().func.isRequired});const Bh={datePicker:y().object.isRequired,availability:y().array.isRequired};class Nh extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"state",{}),(0,pe.A)(this,"handleBook",(e=>{let{id:t,canUserBook:n}=e;const{actions:{openBookingForm:i}}=this.props;i(t,{isPrebooking:!n})}))}render(){const{isLoading:e,lazyScroll:t,showEmptyMessage:n,clickable:i,datePicker:o,fixedHeight:r,actions:{openRoomDetails:a},availability:s,bookingAllowed:l,filters:{recurrence:c},onClickReservation:u,setDate:m,setMode:h}=this.props,p=n?d.createElement(oo.A,{warning:!0},d.createElement(L.Translate,null,"There are no rooms matching the criteria.")):null;return o.selectedDate&&d.createElement(rd,{lazyScroll:t,availability:s,bookingAllowed:l,datePicker:o,emptyMessage:p,onClickCandidate:i?this.handleBook:null,onClickLabel:i?a:null,onClickReservation:u,setDate:m,setMode:h,isLoading:e,fixedHeight:r,roomTimelineAction:"single"!==c.type})}}(0,pe.A)(Nh,"propTypes",Ih(Ih({},Bh),{},{clickable:y().bool,lazyScroll:y().object,isLoading:y().bool.isRequired,showEmptyMessage:y().bool,bookingAllowed:y().bool,actions:y().exact({openRoomDetails:y().func.isRequired,openBookingForm:y().func.isRequired}).isRequired,fixedHeight:y().string,onClickReservation:y().func,setDate:y().func.isRequired,setMode:y().func.isRequired})),(0,pe.A)(Nh,"defaultProps",{clickable:!1,lazyScroll:null,showEmptyMessage:!0,bookingAllowed:!1,fixedHeight:null,onClickReservation:null});const Fh=(0,p.connect)((e=>({filters:gc(e)})),(e=>({actions:(0,_e.bindActionCreators)({openRoomDetails:Bo,openBookingForm:xa},e)})))(Nh);class zh extends d.Component{componentDidMount(){const{actions:{initTimeline:e,fetchTimeline:t,fetchRoomSuggestions:n},filters:{dates:i,timeSlot:o,recurrence:r},roomIds:a,suggestedRoomIds:s,searchFinished:l,showSuggestions:c}=this.props;e(a,i,o,r),a.length&&t(),s.length?this.processSuggestedRooms():l&&c&&n()}componentDidUpdate(e){const{suggestedRoomIds:t,filters:n,searchFinished:i,isAdminOverrideEnabled:o}=e,{actions:{initTimeline:r,fetchTimeline:a,fetchRoomSuggestions:s},filters:l,roomIds:c,suggestedRoomIds:u,searchFinished:d,showSuggestions:m,isAdminOverrideEnabled:h}=this.props,{dates:p,timeSlot:_,recurrence:f}=l;cn()(n,l)||r([],p,_,f),d&&((o!==h||!i&&d)&&(r(c,p,_,f),c.length&&a(),m&&s()),!cn()(t,u)&&u.length&&this.processSuggestedRooms())}processSuggestedRooms(){const{actions:{fetchTimeline:e,addTimelineRooms:t},roomIds:n,suggestedRoomIds:i}=this.props;t(i),n.length||e()}render(){const{isLoading:e,hasMoreTimelineData:t,availability:n,datePicker:i,actions:{fetchTimeline:o},filters:{dates:{startDate:r}}}=this.props,a={hasMore:t,loadMore:o,isFetching:e};return d.createElement(Fh,{lazyScroll:a,isLoading:e,availability:n,datePicker:i,defaultDate:r,showEmptyMessage:!1,bookingAllowed:!0,clickable:!0})}}(0,pe.A)(zh,"propTypes",Ih(Ih({},Bh),{},{isLoading:y().bool.isRequired,searchFinished:y().bool.isRequired,hasMoreTimelineData:y().bool.isRequired,isAdminOverrideEnabled:y().bool.isRequired,filters:y().shape({dates:y().object.isRequired,timeSlot:y().object.isRequired,recurrence:y().object.isRequired}).isRequired,actions:y().exact({fetchTimeline:y().func.isRequired,initTimeline:y().func.isRequired,addTimelineRooms:y().func.isRequired,fetchRoomSuggestions:y().func.isRequired}).isRequired,showSuggestions:y().bool})),(0,pe.A)(zh,"defaultProps",{showSuggestions:!0});const qh=(0,p.connect)((e=>({availability:Bc(e),datePicker:jc(e),isLoading:Pc(e),searchFinished:Zc(e),roomIds:Vc(e),suggestedRoomIds:qc(e),hasMoreTimelineData:Nc(e),isAdminOverrideEnabled:Ui(e),filters:gc(e)})),(e=>({actions:(0,_e.bindActionCreators)({initTimeline:wa,fetchTimeline:Da,addTimelineRooms:La,fetchRoomSuggestions:Oa},e)})))(zh),Hh={selectedDate:null,dateRange:[],minHour:6,maxHour:22,hourStep:2,mode:"days"};function Uh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function $h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Uh(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Zh={availability:[],isVisible:!1,roomIds:[],params:null},Gh=su("bookRoom",{timeline:(0,_e.combineReducers)({request:(0,G.Od)(Jr,ea,ta),datePicker:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Hh,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ia:return $h($h({},e),{},{mode:t.mode});case oa:return $h($h({},e),{},{selectedDate:t.date});case Xr:return $h($h({},e),{},{dateRange:[],selectedDate:t.params.dates.startDate});case na:return $h($h({},e),{},{dateRange:t.data.date_range});default:return e}},data:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Zh,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Yr:return $h($h({},e),{},{isVisible:t.visible});case U:return"bookRoom"===t.namespace?$h($h({},e),{},{isVisible:!1}):e;case Xr:return $h($h({},e),{},{availability:[],params:t.params,roomIds:t.roomIds});case Qr:return $h($h({},e),{},{roomIds:e.roomIds.concat(t.roomIds)});case na:return $h($h({},e),{},{availability:e.availability.concat((0,fe.camelizeKeys)(t.data.availability))});case Ur:{const{data:{room_id:n,booking:{is_accepted:i}}}=t,{roomIds:o,availability:r}=e;if(!i){const t=r.map((e=>{let[t,i]=e;return t===n?[t,$h($h({},i),{},{preConflicts:i.candidates})]:[t,i]}));return $h($h({},e),{},{availability:t})}return $h($h({},e),{},{roomIds:o.filter((e=>e!==n)),availability:r.filter((e=>{let[t]=e;return t!==n}))})}default:return e}}}),unavailableRooms:(0,_e.combineReducers)({request:(0,G.Od)(ra,aa,sa),datePicker:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Hh,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ca:return $h($h({},e),{},{mode:t.mode});case ua:return $h($h({},e),{},{selectedDate:t.date});case da:return $h($h({},e),{},{selectedDate:t.selectedDate,mode:t.mode});case la:return $h($h({},e),{},{dateRange:t.data.date_range});default:return e}},data:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ra:return[];case la:return(0,fe.camelizeKeys)(t.data.availability);default:return e}}}),suggestions:(0,_e.combineReducers)({request:(0,G.Od)(ma,ha,pa),data:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case fa:return[];case _a:return t.data;default:return e}}}),bookingForm:(0,_e.combineReducers)({requests:(0,_e.combineReducers)({booking:(0,G.Od)(Hr,Ur,$r),timeline:(0,G.Od)(Zr,Gr,Vr),relatedEvents:(0,G.Od)(ga,ba,ya)}),availability:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Wr:return null;case Kr:return $h($h({},(0,fe.camelizeKeys)(t.data.availability)),{},{dateRange:t.data.date_range});default:return e}},relatedEvents:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case va:return(0,fe.camelizeKeys)(t.data);case Ea:return[];default:return e}}})}),Vh={timeline:{validator:Jc.Nc.isBoolean(),sanitizer:Jc.Nc.toBoolean(),stateField:gr("timeline.data.isVisible")},mode:{validator:Jc.Nc.isIn(["days","weeks","months"]),stateField:br("timeline.datePicker.mode","days")}},Wh={"/book":[{listen:[ye,ve],select:e=>{let{bookRoom:{filters:t}}=e;return{filters:t}},serialize:uu},{listen:[Yr,ia],select:e=>{let{bookRoom:{timeline:t}}=e;return{timeline:t}},serialize:Vh}]},Kh=(0,Jc.GP)(Vh,((e,t)=>t.type===H?{namespace:"bookRoom",queryString:q.location.search.slice(1)}:null),((e,t)=>t?nu()({},e,{[t]:{timeline:{data:Zh}}}):e));class Yh extends d.Component{renderRoomTotal(e){const t=d.createElement(Ll.A,{horizontal:!0,size:"small"},e),n=d.createElement(T.A,{name:"filter"}),i=d.createElement(As.A.Item,{as:"span"},d.createElement(xt.Responsive.Desktop,{andLarger:!0,orElse:d.createElement(d.Fragment,null,n,t)},n,d.createElement(L.Translate,null,"Total",d.createElement(L.Param,{name:"count",value:t}))));return d.createElement(mn.A,{trigger:i},d.createElement(L.Translate,null,"Number of spaces that match your filtering criteria."))}renderRoomAvailable(e){const t=d.createElement(Ll.A,{color:"teal",horizontal:!0,size:"small"},e),n=d.createElement(T.A,{name:"calendar alternate outline"}),i=d.createElement(As.A.Item,{active:!0,as:"span"},d.createElement(xt.Responsive.Desktop,{andLarger:!0,orElse:d.createElement(d.Fragment,null,n,t)},n,d.createElement(L.Translate,null,"Available",d.createElement(L.Param,{name:"count",value:t}))));return d.createElement(mn.A,{trigger:i},d.createElement(L.Translate,null,"Spaces that are free on that time slot."))}renderUnavailable(e){const{actions:{openUnavailableRooms:t}}=this.props,n=d.createElement(Ll.A,{color:"red",horizontal:!0,size:"small"},e),i=d.createElement(T.A,{name:"remove"}),o=d.createElement(As.A.Item,{link:!0,onClick:t},d.createElement(xt.Responsive.Desktop,{andLarger:!0,orElse:d.createElement(d.Fragment,null,i,n)},i,d.createElement(L.Translate,null,"Unavailable",d.createElement(L.Param,{name:"count",value:n}))));return d.createElement(mn.A,{trigger:o},d.createElement(L.Translate,null,"Spaces unavailable during that time slot (click for details)."))}renderUnbookable(e){const t=d.createElement(Ll.A,{color:"red",horizontal:!0,size:"small"},e),n=d.createElement(T.A,{name:"lock"}),i=d.createElement(As.A.Item,{as:"span"},d.createElement(xt.Responsive.Desktop,{andLarger:!0,orElse:d.createElement(d.Fragment,null,n,t)},n,d.createElement(L.Translate,null,"Unauthorized"),t));return d.createElement(mn.A,{trigger:i},d.createElement(L.Translate,null,"Spaces you are not authorized to book."))}renderSearchFailed(){const{searchFailedMessage:e}=this.props;return d.createElement(oo.A,{icon:"times circle outline",error:!0,content:e})}renderNoRooms(){return d.createElement(oo.A,{icon:"times circle outline",error:!0,content:L.Translate.string("No known spaces match your query")})}renderNoMatching(){return d.createElement(oo.A,{icon:"warning sign",warning:!0,content:L.Translate.string("No spaces are available during that time slot"),className:"rb-client-js-modules-bookRoom-___BookRoom-module__message-nothing___tDcD5"})}render(){const{isSearching:e,isSearchFailed:t,available:n,totalMatchingFilters:i,unbookable:o}=this.props,r=i-n-o,a={display:e||i>0?"inline-flex":"none"};return d.createElement("div",{className:"rb-client-js-modules-bookRoom-___BookRoom-module__results-count___je5Di"},d.createElement(As.A,{icon:!0,className:(!e?"":(e?"loading":null)+" ")+"rb-client-js-modules-bookRoom-___BookRoom-module__results-count-menu___PWuVC",style:a},e?d.createElement("div",{className:"rb-client-js-modules-bookRoom-___BookRoom-module__loading-indicator___xLZ+7"},d.createElement("div",{className:"bar"}),d.createElement("div",{className:"bar"}),d.createElement("div",{className:"bar"})):!!i&&d.createElement(d.Fragment,null,this.renderRoomTotal(i),this.renderRoomAvailable(n),!!r&&this.renderUnavailable(r),!!o&&this.renderUnbookable(o))),t?this.renderSearchFailed():e?null:d.createElement(d.Fragment,null,i>0&&0===n&&this.renderNoMatching(),0===i&&this.renderNoRooms()))}}(0,pe.A)(Yh,"propTypes",{isSearching:y().bool.isRequired,isSearchFailed:y().bool.isRequired,searchFailedMessage:y().string,available:y().number,totalMatchingFilters:y().number,unbookable:y().number,actions:y().exact({openUnavailableRooms:y().func.isRequired}).isRequired}),(0,pe.A)(Yh,"defaultProps",{searchFailedMessage:null,available:null,totalMatchingFilters:null,unbookable:null});const Xh=(0,p.connect)((e=>({isSearching:bc(e),isSearchFailed:vc(e),searchFailedMessage:Ec(e)})),(e=>({actions:(0,_e.bindActionCreators)({openUnavailableRooms:Ma},e)})))(Yh);function Qh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Jh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qh(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const ep=hd("bookRoom",r),tp=ni("bookRoom",r),np=oh("bookRoom",r);class ip extends d.Component{constructor(){var e;super(...arguments),e=this,(0,pe.A)(this,"state",{maxVisibleRooms:20,suggestionsRequested:!1}),(0,pe.A)(this,"hasMoreRooms",(function(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const{maxVisibleRooms:n,suggestionsRequested:i}=e.state,{results:o,searchFinished:r}=e.props;return!!r&&(n<o.length||t&&!i)})),(0,pe.A)(this,"loadMoreRooms",(()=>{const{actions:{fetchRoomSuggestions:e},showSuggestions:t}=this.props,{maxVisibleRooms:n}=this.state;this.hasMoreRooms(!1)?this.setState({maxVisibleRooms:n+20}):t&&(this.setState({suggestionsRequested:!0}),e())})),(0,pe.A)(this,"renderMainContent",(()=>{const{isSearching:e,isTimelineVisible:t,showSuggestions:n,labels:i}=this.props,{actions:{openRoomDetails:o}}=this.props,r=e=>d.createElement(dn.A,{circular:!0,icon:"check",color:"green",onClick:()=>this.openBookingForm(e.id)}),a=e=>{let{id:t}=e;return d.createElement(dn.A,{primary:!0,circular:!0,icon:"search",onClick:()=>o(t)})};return t?d.createElement("div",{className:"rb-client-js-modules-bookRoom-___BookRoom-module__available-room-list___rs0uk",ref:e=>this.handleContextRef(e,"timelineRef")},this.renderFilters("timelineRef"),d.createElement(qh,{showSuggestions:n})):d.createElement("div",{className:"ui rb-client-js-modules-bookRoom-___BookRoom-module__available-room-list___rs0uk",ref:e=>this.handleContextRef(e,"tileRef")},this.renderFilters("tileRef"),e?d.createElement(ld.Group,{count:20}):d.createElement(d.Fragment,null,d.createElement(Qc.Ay,{hasMore:this.hasMoreRooms(),loadMore:this.loadMoreRooms},d.createElement(zl,{rooms:this.visibleRooms},(e=>d.createElement(xt.Slot,{name:"actions"},e.canUserBook&&d.createElement(Os.ResponsivePopup,{trigger:r(e),content:i.bookButton,position:"top center",hideOnScroll:!0}),e.canUserPrebook&&d.createElement(T.A.Group,{onClick:()=>this.openBookingForm(e.id,null,!0)},d.createElement(Os.ResponsivePopup,{trigger:d.createElement(dn.A,{circular:!0,icon:"check",color:"orange"}),content:i.preBookButton,position:"top center",hideOnScroll:!0}),d.createElement(T.A,{corner:!0,name:"wait",className:"rb-client-js-modules-bookRoom-___BookRoom-module__prebooking-corner-icon___u8WxG"})),d.createElement(Os.ResponsivePopup,{trigger:a(e),content:i.detailsButton,position:"top center",hideOnScroll:!0}))))),this.renderSuggestions()))})),(0,pe.A)(this,"renderSuggestions",(()=>{const{suggestions:t}=this.props;if(t.length)return d.createElement("div",{className:"rb-client-js-modules-bookRoom-___BookRoom-module__suggestions-container___frQju"},d.createElement(eu.A,{horizontal:!0},d.createElement(T.A,{name:"magic",className:"rb-client-js-modules-bookRoom-___BookRoom-module__divider-icon___GfFK-",circular:!0})),d.createElement(ro.A,{className:"rb-client-js-modules-bookRoom-___BookRoom-module__header___xABLO"},d.createElement(L.Translate,null,"Here are some alternatives we've found for you!")),d.createElement(wl.A.Group,null,t.map((t=>{let{room:n,suggestions:i}=t;return d.createElement(xh,{key:n.id,room:n,suggestions:i,onClick:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e.openBookingForm(n.id,t,!n.canUserBook)}})}))))})),(0,pe.A)(this,"switchToRoomList",(()=>{const{actions:{toggleTimelineView:e},isTimelineVisible:t}=this.props;t&&(e(!1),this.setState({timelineRef:null}),this.restartSearch())})),(0,pe.A)(this,"switchToTimeline",(()=>{const{actions:{toggleTimelineView:e},isTimelineVisible:t}=this.props;!t&&this.timelineButtonEnabled&&(e(!0),this.setState({tileRef:null}))})),(0,pe.A)(this,"handleContextRef",((e,t)=>{if(t in this.state){const{[t]:e}=this.state;if(null!==e)return}this.setState({[t]:e})}))}componentDidMount(){const{actions:{searchRooms:e}}=this.props;e()}componentDidUpdate(e){const{filters:t,isAdminOverrideEnabled:n}=e,{filters:i,isAdminOverrideEnabled:o}=this.props;n===o&&cn()(t,i)||this.restartSearch()}componentWillUnmount(){const{actions:{clearTextFilter:e}}=this.props;e()}restartSearch(){const{actions:{searchRooms:e,resetRoomSuggestions:t}}=this.props;e(),t(),this.setState({maxVisibleRooms:20,suggestionsRequested:!1})}openBookingForm(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{actions:{openBookingForm:i},filters:{dates:o,timeSlot:r,recurrence:a}}=this.props;if(!t)return void i(e,{isPrebooking:n});const s={dates:o,timeSlot:r,recurrence:a};if(t.time){const{startTime:e,endTime:n}=r;s.timeSlot={startTime:(0,De.serializeTime)(cr()(e,"HH:mm").add(t.time,"minutes")),endTime:(0,De.serializeTime)(cr()(n,"HH:mm").add(t.time,"minutes"))}}else if(t.duration){const{startTime:e,endTime:n}=r;s.timeSlot={startTime:e,endTime:(0,De.serializeTime)(cr()(n,"HH:mm").subtract(t.duration,"minutes"))}}else if(t.shorten){const{startDate:e,endDate:n}=o;s.dates={startDate:e,endDate:(0,De.serializeDate)(cr()(n,"YYYY-MM-DD").subtract(t.shorten,"days"))}}i(e,Jh(Jh({},s),{},{isPrebooking:n}))}getLegendLabels(e){const t=e.reduce(((e,t)=>{let[,n]=t;return Hl()(e,Dr(n))}),[]);return Lr(t)}renderFilters(e){const{[e]:t}=this.state,{isSearching:n,totalResultCount:i,unbookableResultCount:o,results:r,isTimelineVisible:a,actions:s,datePicker:l,timelineAvailability:c}=this.props,{selectedDate:u}=l;return d.createElement(Os.StickyWithScrollBack,{context:t,responsive:!0},d.createElement("div",{className:"filter-row"},d.createElement("div",{className:"filter-row-filters"},d.createElement(Ph,null),d.createElement(np,{showOnlyAuthorizedFilter:!1}),d.createElement(ep,null)),this.renderViewSwitch()),d.createElement(Xh,{available:r.length,totalMatchingFilters:i,isFetching:n,unbookable:o}),a&&u&&d.createElement(sd,{datePicker:l,disableDatePicker:n,onDateChange:s.setDate,onModeChange:s.setTimelineMode,legendLabels:this.getLegendLabels(c),isLoading:n}))}get visibleRooms(){const{maxVisibleRooms:e}=this.state,{results:t}=this.props;return t.slice(0,e)}get timelineButtonEnabled(){const{results:e,suggestions:t}=this.props;return!(!e.length&&!t.length)}renderViewSwitch(){const{isTimelineVisible:e}=this.props,t=(0,xt.toClasses)({active:e,disabled:!this.timelineButtonEnabled}),n=d.createElement(dn.A,{icon:d.createElement(T.A,{name:"grid layout",className:"rb-client-js-modules-bookRoom-___BookRoom-module__switcher-icon___UrL8q"}),className:(0,xt.toClasses)({active:!e}),onClick:this.switchToRoomList,size:"small",circular:!0}),i=d.createElement(dn.A,{icon:d.createElement(T.A,{name:"calendar outline",className:"rb-client-js-modules-bookRoom-___BookRoom-module__switcher-icon___UrL8q",disabled:!this.timelineButtonEnabled}),className:t,onClick:this.switchToTimeline,size:"small",circular:!0});return d.createElement("div",{className:"rb-client-js-modules-bookRoom-___BookRoom-module__view-icons___ubZrp"},d.createElement(xt.Responsive.Tablet,{andLarger:!0,orElse:e?n:i},d.createElement("span",{className:"rb-client-js-modules-bookRoom-___BookRoom-module__icons-wrapper___Nifk3"},e?d.createElement(mn.A,{trigger:n,content:L.Translate.string("List view")}):n,e?i:d.createElement(mn.A,{trigger:i,content:L.Translate.string("Timeline view")}))))}render(){const{showMap:e}=this.props;return d.createElement(Mt.A,{columns:2},d.createElement(Mt.A.Column,{computer:e?11:16,mobile:16},this.renderMainContent()),e&&d.createElement(xt.Responsive.Desktop,{andLarger:!0},d.createElement(Mt.A.Column,{computer:5,only:"computer"},d.createElement(tp,{onRoomClick:e=>{let{id:t,canUserBook:n}=e;return this.openBookingForm(t,null,!n)}}))))}}(0,pe.A)(ip,"propTypes",{results:y().arrayOf(y().object).isRequired,isSearching:y().bool.isRequired,searchFinished:y().bool.isRequired,isTimelineVisible:y().bool.isRequired,totalResultCount:y().number.isRequired,unbookableResultCount:y().number.isRequired,filters:y().object.isRequired,suggestions:y().arrayOf(y().object).isRequired,showMap:y().bool.isRequired,isAdminOverrideEnabled:y().bool.isRequired,timelineAvailability:y().array.isRequired,actions:y().exact({clearTextFilter:y().func.isRequired,searchRooms:y().func.isRequired,fetchRoomSuggestions:y().func.isRequired,resetRoomSuggestions:y().func.isRequired,toggleTimelineView:y().func.isRequired,openRoomDetails:y().func.isRequired,openBookingForm:y().func.isRequired,setDate:y().func.isRequired,setTimelineMode:y().func.isRequired}).isRequired,datePicker:y().object.isRequired,showSuggestions:y().bool,labels:y().shape({bookButton:xt.IndicoPropTypes.i18n,preBookButton:xt.IndicoPropTypes.i18n,detailsButton:xt.IndicoPropTypes.i18n})}),(0,pe.A)(ip,"defaultProps",{showSuggestions:!0,labels:{bookButton:d.createElement(L.Translate,null,"Book Room"),preBookButton:d.createElement(L.Translate,null,"Pre-Book Room"),detailsButton:d.createElement(L.Translate,null,"See details")}});const op=(0,p.connect)((e=>({isTimelineVisible:Mc(e),filters:gc(e),results:Wc(e),suggestions:zc(e),totalResultCount:wc(e),unbookableResultCount:Yc(e),isSearching:$c(e),searchFinished:Zc(e),queryString:(0,Jc.SG)(e.bookRoom,uu,Vh),showMap:Nt(e),dateRange:xc(e),datePicker:jc(e),isAdminOverrideEnabled:Ui(e),timelineAvailability:Bc(e)})),(e=>({actions:(0,_e.bindActionCreators)({searchRooms:Sa,clearTextFilter:()=>Ee("bookRoom","text",null),fetchRoomSuggestions:Oa,resetRoomSuggestions:Ra,toggleTimelineView:Ca,openRoomDetails:Bo,openBookingForm:xa,setDate:e=>function(e){return{type:oa,date:e}}((0,De.serializeDate)(e)),setTimelineMode:ja},e)})))(h.Ay.component("BookRoom",ip));function rp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ap(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?rp(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class sp extends d.Component{static get defaultProps(){return{children:null,buttonCaption:d.createElement(L.Translate,null,"Search"),onChange:()=>{},buttonDisabled:!1,dayBased:!1,hideOptions:{},defaults:{},bookingGracePeriod:null}}constructor(e){super(e),(0,pe.A)(this,"updateIntervalOptions",(()=>{const{hideOptions:e}=this.props,{recurrence:t}=this.state;if(!e.recurringWeekly&&!e.recurringMonthly)return null;e.recurringWeekly&&"month"!==t.interval&&this.updateInterval("month"),e.recurringMonthly&&"week"!==t.interval&&this.updateInterval("week")})),(0,pe.A)(this,"updateDates",((e,t)=>{this.setState({dates:{startDate:e,endDate:t}},(()=>{this.triggerChange()}))})),(0,pe.A)(this,"updateBookingType",(e=>{const{recurrence:{number:t,interval:n,weekdays:i}}=this.state,o=ap(ap({},this.state),{},{recurrence:{type:e,number:t,interval:n,weekdays:i}});_r(o),this.setState(o,(()=>{this.triggerChange()}))})),(0,pe.A)(this,"updateNumber",(e=>{const{recurrence:{type:t,interval:n,weekdays:i}}=this.state;this.setState({number:e}),this.setState({recurrence:{type:t,number:parseInt(e,10),interval:n,weekdays:i}},(()=>{this.triggerChange()}))})),(0,pe.A)(this,"updateInterval",(e=>{const{recurrence:{type:t,number:n,weekdays:i}}=this.state,o="month"===e?[]:i;this.setState({recurrence:{type:t,number:n,interval:e,weekdays:o}},(()=>{this.triggerChange()}))})),(0,pe.A)(this,"updateTimes",((e,t)=>{this.setState({timeSlot:{startTime:e,endTime:t}},(()=>{this.triggerChange()}))})),(0,pe.A)(this,"updateRecurrenceWeekdays",(e=>{const{recurrence:{type:t,number:n,interval:i}}=this.state;this.setState({recurrence:{type:t,number:n,interval:i,weekdays:e}},(()=>{this.triggerChange()}))})),(0,pe.A)(this,"onSearch",(e=>{const{onSearch:t}=this.props;t(this.serializedState),e.preventDefault()})),(0,pe.A)(this,"preselectWeekday",(()=>{const{recurrence:e}=this.state,t=cr()().locale("en").format("ddd").toLocaleLowerCase();if(e.weekdays.includes(t))return;const n=[...e.weekdays,t];this.setState({recurrence:ap(ap({},e),{},{weekdays:n})}),this.triggerChange()})),(0,pe.A)(this,"getRecurrenceOptions",(()=>{const{hideOptions:e}=this.props,{recurrence:t}=this.state;return e.recurringWeekly&&e.recurringMonthly?null:e.recurringWeekly?[{text:L.PluralTranslate.string("Month","Months",t.number),value:"month"}]:e.recurringMonthly?[{text:L.PluralTranslate.string("Week","Weeks",t.number),value:"week"}]:[{text:L.PluralTranslate.string("Week","Weeks",t.number),value:"week"},{text:L.PluralTranslate.string("Month","Months",t.number),value:"month"}]}));const t=cr()().startOf("hour").add(1,"h"),n=cr()().startOf("hour").add(2,"h"),i=t>cr()().endOf("day"),{defaults:o}=e;this.state=nu()({recurrence:{type:"single",number:1,interval:"week",weekdays:[]},dates:{startDate:i?cr()().add(1,"d"):cr()(),endDate:null},timeSlot:{startTime:t,endTime:i?n:(0,De.initialEndTime)(n)}},o)}componentDidMount(){this.triggerChange()}componentDidUpdate(){const{recurrence:e}=this.state;"every"===e.type&&"week"===e.interval&&0===e.weekdays.length&&this.preselectWeekday()}triggerChange(){const{onChange:e}=this.props;e(this.serializedState)}get serializedState(){const{dayBased:e}=this.props,{timeSlot:{startTime:t,endTime:n},dates:{startDate:i,endDate:o},recurrence:r}=this.state,a={recurrence:r,dates:{startDate:(0,De.serializeDate)(i),endDate:(0,De.serializeDate)(o)},weekdays:r.weekdays};return e||(a.timeSlot={startTime:(0,De.serializeTime)(t),endTime:(0,De.serializeTime)(n)}),a}render(){const{timeSlot:{startTime:e,endTime:t},recurrence:{type:n,number:i,interval:o,weekdays:r},dates:{startDate:a,endDate:s}}=this.state,{buttonCaption:l,buttonDisabled:c,children:u,dayBased:m,hideOptions:h,isAdminOverrideEnabled:p,bookingGracePeriod:_}=this.props,f=(0,De.isBookingStartDTValid)((0,De.createDT)(a,e),p,_),g=2!==["single","daily","recurring"].filter((e=>h[e])).length,b=(0,De.getMinimumBookingStartTime)((0,De.toMoment)(a),p,_),y=h.recurringWeekly&&h.recurringMonthly;return d.createElement(ws.A,null,g&&d.createElement(ws.A.Group,{inline:!0,className:"rb-client-js-components-___BookingBootstrapForm-module__booking-type-field___Ph9h8"},!h.single&&d.createElement(ws.A.Radio,{label:L.Translate.string("Single booking"),name:"type",value:"single",checked:"single"===n,onChange:(e,t)=>{let{value:n}=t;return this.updateBookingType(n)}}),!h.daily&&d.createElement(ws.A.Radio,{label:L.Translate.string("Daily booking"),name:"type",value:"daily",checked:"daily"===n,onChange:(e,t)=>{let{value:n}=t;return this.updateBookingType(n)}}),!y&&d.createElement(ws.A.Radio,{label:L.Translate.string("Recurring booking"),name:"type",value:"every",checked:"every"===n,onChange:(e,t)=>{let{value:n}=t;return this.updateBookingType(n)}})),"every"===n&&d.createElement(ws.A.Group,{inline:!0,className:"rb-client-js-components-___BookingBootstrapForm-module__recurrence-field___-7oHd"},d.createElement("label",null,L.Translate.string("Every")),d.createElement(ws.A.Input,{type:"number",value:i,min:"1",max:"99",step:"1",onChange:(e,t)=>this.updateNumber(t.value)}),h.recurringWeekly||h.recurringMonthly?d.createElement("label",null,this.getRecurrenceOptions().map((e=>e.text))):d.createElement(vh.A,{value:o,options:this.getRecurrenceOptions(),disabled:y,onChange:(e,t)=>this.updateInterval(t.value)}),this.updateIntervalOptions()),["every","daily"].includes(n)&&d.createElement(ws.A.Group,{inline:!0},d.createElement(Os.DateRangePicker,{startDate:a,endDate:s,onDatesChange:e=>{let{startDate:t,endDate:n}=e;return this.updateDates(t,n)},isOutsideRange:e=>!(0,De.isBookingStartDateValid)(e,p,_),withFullScreenPortal:window.innerHeight<730})),"single"===n&&d.createElement(ws.A.Group,{inline:!0},d.createElement(Os.SingleDatePicker,{date:a,yearsBefore:0,yearsAfter:1,onDateChange:e=>this.updateDates(e,null),disabledDate:e=>!(0,De.isBookingStartDateValid)(e,p,_),withFullScreenPortal:window.innerHeight<730})),!m&&d.createElement(ws.A.Group,{inline:!0},d.createElement(zs,{startTime:e,endTime:t,onChange:this.updateTimes,minTime:b})),"every"===n&&"week"===o&&d.createElement(ws.A.Group,{inline:!0,style:{marginLeft:"1em",marginRight:"1em"}},d.createElement(L.Translate,{as:"label"},"Recurring every"),d.createElement(Ah,{onChange:this.updateRecurrenceWeekdays,value:r})),u,d.createElement(dn.A,{primary:!0,disabled:c||!f,onClick:this.onSearch},l))}}(0,pe.A)(sp,"propTypes",{onSearch:y().func.isRequired,onChange:y().func,buttonCaption:y().object,children:y().node,buttonDisabled:y().bool,dayBased:y().bool,hideOptions:y().objectOf(y().bool),defaults:y().object,isAdminOverrideEnabled:y().bool.isRequired,bookingGracePeriod:y().number});const lp=(0,p.connect)((e=>({isAdminOverrideEnabled:Ui(e),bookingGracePeriod:re(e)})))(h.Ay.component("BookingBootstrapForm",sp)),cp={"photo-dimmable-width":"rb-client-js-components-___RoomBasicDetails-module__photo-dimmable-width___KHK2-","photo-width":"rb-client-js-components-___RoomBasicDetails-module__photo-width___KfWOp","photo-dimmer":"rb-client-js-components-___RoomBasicDetails-module__photo-dimmer___QrDvw","feature-box":"rb-client-js-components-___RoomBasicDetails-module__feature-box___vezFR","feature-entries":"rb-client-js-components-___RoomBasicDetails-module__feature-entries___lOZ55","photo-column":"rb-client-js-components-___RoomBasicDetails-module__photo-column___v0g6v","image-container":"rb-client-js-components-___RoomBasicDetails-module__image-container___Uqixh",clickable:"rb-client-js-components-___RoomBasicDetails-module__clickable___oDcjv","data-column":"rb-client-js-components-___RoomBasicDetails-module__data-column___DvmDh","room-basic-details":"rb-client-js-components-___RoomBasicDetails-module__room-basic-details___x27xE"},up=_.Ay.bind(null,{endpoint:"rb.room_photo",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:".jpg",isDynamic:!1}]}]},"/");function dp(e){let{room:{features:t}}=e;return t.length?d.createElement("div",{className:"rb-client-js-components-___RoomBasicDetails-module__feature-box___vezFR"},d.createElement("div",{className:"rb-client-js-components-___RoomBasicDetails-module__feature-entries___lOZ55"},t.map((e=>d.createElement(Cl,{key:e.name,feature:e,color:"teal",size:"large",classes:cp["feature-entry"]}))))):null}function mp(e){let{name:t,text:n}=e;return d.createElement(mn.A,{content:n,trigger:d.createElement(T.A,{name:t})})}dp.propTypes={room:y().shape({features:y().array.isRequired}).isRequired},mp.propTypes={name:y().string.isRequired,text:y().string.isRequired};class hp extends d.PureComponent{constructor(){super(...arguments),(0,pe.A)(this,"state",{imageModalOpen:!1,imageLoaded:!1})}renderImage(){const{room:e}=this.props,{imageModalOpen:t,imageLoaded:n}=this.state,i=e.hasPhoto,o=d.createElement(xl,{className:"rb-client-js-components-___RoomBasicDetails-module__clickable___oDcjv",pos:e.spritePosition,height:"100%",width:"100%",fillVertical:!0,onClick:i?()=>this.setState({imageModalOpen:!0}):void 0});return i?d.createElement(d.Fragment,null,d.createElement(Ts.A,{closeIcon:!0,open:t,onClose:()=>this.setState({imageModalOpen:!1,imageLoaded:!1})},d.createElement(Ts.A.Content,{image:!0,className:"rb-client-js-components-___RoomBasicDetails-module__photo-dimmer___QrDvw"},d.createElement(pn.A.Dimmable,{className:"rb-client-js-components-___RoomBasicDetails-module__photo-dimmable-width___KHK2-"},d.createElement(pn.A,{active:!n,inverted:!0},d.createElement(_n.A,null)),d.createElement(A.A,{className:"rb-client-js-components-___RoomBasicDetails-module__photo-width___KfWOp",wrapped:!0,onLoad:()=>this.setState({imageLoaded:!0}),src:up({room_id:e.id})})))),d.createElement("div",{className:"rb-client-js-components-___RoomBasicDetails-module__image-container___Uqixh rb-client-js-components-___RoomBasicDetails-module__clickable___oDcjv"},o,d.createElement(dp,{room:e}))):d.createElement("div",{className:"rb-client-js-components-___RoomBasicDetails-module__image-container___Uqixh"},o,d.createElement(dp,{room:e}))}render(){const{room:e}=this.props,{ownerName:t,latitude:n,longitude:i,division:o,mapURL:r,locationName:a,surfaceArea:s,capacity:l,telephone:c,fullName:u,site:m}=e;return d.createElement(Mt.A,{columns:2,stackable:!0},d.createElement(Mt.A.Column,{textAlign:"center",className:"rb-client-js-components-___RoomBasicDetails-module__photo-column___v0g6v"},this.renderImage()),d.createElement(Mt.A.Column,{className:"rb-client-js-components-___RoomBasicDetails-module__data-column___DvmDh"},d.createElement(ro.A,null,u,d.createElement(ro.A.Subheader,null,o)),d.createElement("ul",{className:"rb-client-js-components-___RoomBasicDetails-module__room-basic-details___x27xE"},d.createElement("li",{className:"has-icon"},a&&d.createElement(d.Fragment,null,d.createElement(mp,{name:"map pin",text:L.Translate.string("Location")}),a)),d.createElement("li",{className:"has-icon"},m&&d.createElement(d.Fragment,null,d.createElement(mp,{name:"street view",text:L.Translate.string("Site")}),m)),d.createElement("li",{className:"has-icon"},d.createElement(mp,{name:"id badge outline",text:L.Translate.string("Room Owner")}),t),d.createElement("li",{className:"has-icon"},c&&d.createElement(d.Fragment,null,d.createElement(mp,{name:"phone",text:L.Translate.string("Phone number")}),c)),d.createElement("li",{className:"has-icon"},l&&d.createElement(d.Fragment,null,d.createElement(mp,{name:"users",text:L.Translate.string("Capacity")}),d.createElement(L.PluralTranslate,{count:l},d.createElement(L.Singular,null,"1"," ",d.createElement(L.Param,{name:"label",wrapper:d.createElement("label",null)},"seat")),d.createElement(L.Plural,null,d.createElement(L.Param,{name:"count",value:l})," ",d.createElement(L.Param,{name:"label",wrapper:d.createElement("label",null)},"seats"))))),d.createElement("li",{className:"has-icon"},s&&d.createElement(d.Fragment,null,d.createElement(mp,{name:"cube",text:L.Translate.string("Surface Area")}),s," ",d.createElement("label",null,"m²"))),d.createElement("li",{className:"has-icon"},n&&d.createElement(d.Fragment,null,d.createElement(mp,{name:"location arrow",text:L.Translate.string("Geographical Coordinates")}),d.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:r},new Zn(n,i).toString("dms",2)))))))}}(0,pe.A)(hp,"propTypes",{room:y().object.isRequired});const pp=["dispatch"];function _p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function fp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_p(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gp(e){let{availability:{numDaysAvailable:t,allDaysAvailable:n}}=e;return n?d.createElement(oo.A,{color:"green"},d.createElement(T.A,{name:"check"}),d.createElement(L.Translate,null,"The space will be free on the selected time slot(s)")):t?d.createElement(oo.A,{color:"yellow"},d.createElement(T.A,{name:"warning sign"}),d.createElement(L.Translate,null,"The space won't be available on one or more days")):d.createElement(oo.A,{color:"red"},d.createElement(oo.A.Header,null,d.createElement(T.A,{name:"remove"}),d.createElement(L.Translate,null,"Space cannot be booked.")),d.createElement(L.Translate,null,"One or more bookings would conflict with yours."))}gp.propTypes={availability:y().object.isRequired};class bp extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"state",{pastDTChosen:!1}),(0,pe.A)(this,"handleCloseModal",(()=>{const{onClose:e,actions:{resetCollisions:t}}=this.props;t(),e()})),(0,pe.A)(this,"handleBook",(e=>{const{room:t,actions:{openBookingForm:n},isPrebooking:i}=this.props;n(t.id,fp(fp({},e),{},{isPrebooking:i}))})),(0,pe.A)(this,"onFiltersChange",(e=>{const{refreshCollisions:t,isAdminOverrideEnabled:n,bookingGracePeriod:i}=this.props,{dates:{startDate:o},timeSlot:r}=e;if(t(e),!o)return void this.setState({pastDTChosen:!0});const a=r&&r.startTime?r.startTime:"00:00",s=(0,De.createDT)(o,a);this.setState({pastDTChosen:!(0,De.isBookingStartDTValid)(s,n,i)})}))}render(){const{room:e,availability:t,availabilityLoading:n,defaults:i,isPrebooking:o,labels:r,isAdminOverrideEnabled:a}=this.props,{pastDTChosen:s}=this.state,l=n||!t||0===t.numDaysAvailable;return d.createElement(Ts.A,{open:!0,onClose:this.handleCloseModal,size:"large",closeIcon:!0},d.createElement(Ts.A.Header,{className:"rb-client-js-common-rooms-___RoomDetailsModal-module__room-details-header___g4ahn"},o?r.preBookTitle:r.bookTitle),d.createElement(Ts.A.Content,null,d.createElement(Mt.A,{stackable:!0},d.createElement(Mt.A.Column,{width:8},d.createElement(hp,{room:e})),d.createElement(Mt.A.Column,{width:8},d.createElement(lp,{buttonCaption:o?r.preBookBtn:r.bookBtn,buttonDisabled:l,onChange:this.onFiltersChange,onSearch:this.handleBook,defaults:i},t&&d.createElement(gp,{availability:t}),s&&!a&&d.createElement(oo.A,{color:"red"},d.createElement(T.A,{name:"dont"}),d.createElement(L.Translate,null,"Bookings in the past are not allowed.")))))))}}(0,pe.A)(bp,"propTypes",{room:y().object.isRequired,refreshCollisions:y().func.isRequired,onClose:y().func,availability:y().object,availabilityLoading:y().bool.isRequired,isAdminOverrideEnabled:y().bool.isRequired,defaults:y().object,actions:y().exact({resetCollisions:y().func.isRequired,openBookingForm:y().func.isRequired}).isRequired,isPrebooking:y().bool,labels:y().shape({bookTitle:xt.IndicoPropTypes.i18n,preBookTitle:xt.IndicoPropTypes.i18n,bookBtn:xt.IndicoPropTypes.i18n,preBookBtn:xt.IndicoPropTypes.i18n}),bookingGracePeriod:y().number}),(0,pe.A)(bp,"defaultProps",{onClose:()=>{},availability:null,defaults:void 0,isPrebooking:!1,labels:{bookTitle:d.createElement(L.Translate,null,"Book Room"),preBookTitle:d.createElement(L.Translate,null,"Pre-Book Room"),bookBtn:d.createElement(L.Translate,null,"Book"),preBookBtn:d.createElement(L.Translate,null,"Pre-Book")},bookingGracePeriod:null});const yp=(0,p.connect)(((e,t)=>{let{roomId:n}=t;return{room:Qo(e,{roomId:n}),availability:e.bookRoom.bookingForm.availability,availabilityLoading:Cc(e),isAdminOverrideEnabled:Ui(e),bookingGracePeriod:re(e)}}),(e=>({actions:(0,_e.bindActionCreators)({resetCollisions:ka,openBookingForm:xa},e),dispatch:e})),((e,t,n)=>{const{room:i}=e,{dispatch:o}=t,r=(0,In.A)(t,pp);return fp(fp(fp(fp({},n),e),r),{},{refreshCollisions(e){o(Aa(i,e))}})}))(bp);var vp=n(50090),Ep=n(18606);function kp(e){let{recurrence:t,dates:{startDate:n,endDate:i},timeSlot:o,onClickOccurrences:r,occurrenceCount:a,recurrenceWeekdays:s}=e;const l=(0,De.toMoment)(n),c=i?(0,De.toMoment)(i):null;let u=null;if(o){const{startTime:e,endTime:t}=o,n=(0,De.toMoment)(e,"HH:mm"),i=t?(0,De.toMoment)(t,"HH:mm"):null;u=d.createElement(Ul.A,null,d.createElement(T.A,{name:"clock"}),d.createElement("strong",null,n.format("LT"))," → ",d.createElement("strong",null,i.format("LT")))}return d.createElement("div",{className:"rb-client-js-components-___TimeInformation-module__booking-time-info___sk1ZU"},d.createElement(Ul.A.Group,null,d.createElement(Ul.A,{color:"teal"},d.createElement("div",null,d.createElement(T.A,{name:"calendar outline"}),c&&!l.isSame(c,"day")?d.createElement(L.Translate,null,d.createElement(L.Param,{name:"startDateDay",wrapper:d.createElement("span",{className:"rb-client-js-components-___WeekdayInformation-module__booking-times-weekday___rnS+k"}),value:l.format("ddd")})," ",d.createElement(L.Param,{name:"startDate",wrapper:d.createElement("strong",null),value:l.format("L")})," — ",d.createElement(L.Param,{name:"endDateDay",wrapper:d.createElement("span",{className:"rb-client-js-components-___WeekdayInformation-module__booking-times-weekday___rnS+k"}),value:c.format("ddd")})," ",d.createElement(L.Param,{name:"endDate",wrapper:d.createElement("strong",null),value:c.format("L")})):d.createElement("strong",null,d.createElement("span",{className:"rb-client-js-components-___WeekdayInformation-module__booking-times-weekday___rnS+k"},l.format("ddd"))," ",l.format("L")))),u,"every"===t.type&&"week"===t.interval&&s&&d.createElement(Ul.A,null,d.createElement("div",null,d.createElement("div",null,d.createElement(T.A,{name:"sync alternate"}),d.createElement(L.Translate,{as:"strong"},"Every"," ",d.createElement(L.Param,{name:"weekdays",value:Ar(s)}))))),d.createElement(Ul.A,null,d.createElement("div",{className:"rb-client-js-components-___TimeInformation-module__occurrences-details___UZAOT"},d.createElement("div",null,d.createElement(T.A,{name:"list"}),d.createElement("strong",null,Er(t,!1),a>1&&d.createElement(d.Fragment,null,", ",d.createElement(L.Translate,null,d.createElement(L.Param,{name:"count",value:a})," occurrences")))),d.createElement(dn.A,{size:"small",basic:!0,color:"teal",onClick:r},d.createElement(T.A,{name:"calendar outline"}),d.createElement(L.Translate,null,"See on timeline"))))))}kp.propTypes={recurrence:y().object.isRequired,dates:y().shape({startDate:y().string.isRequired,endDate:y().string}).isRequired,timeSlot:y().shape({startTime:y().string,endTime:y().string}),onClickOccurrences:y().func.isRequired,occurrenceCount:y().number,recurrenceWeekdays:y().arrayOf(y().string)},kp.defaultProps={timeSlot:null,occurrenceCount:0,recurrenceWeekdays:null};const Ap=h.Ay.component("TimeInformation",kp),Tp=["isPrebooking"];const wp=(0,vp.A)({field:"usage",updates:e=>"someone"!==e?{user:null}:{}});class Lp extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"state",{skipConflicts:!1,bookingConflictsVisible:!1,booking:null,selectedEvent:null,extraFields:null}),(0,pe.A)(this,"submitBooking",(async e=>{const{actions:{createBooking:t},link:n}=this.props;e.event?(e.linkType="event",e.linkId=e.event,e.linkBack=!0):n&&(e.linkType=sc()(n.type),e.linkId=n.id);const{extraFields:i}=this.state;e.extraFields=i;const o=await t(e,this.props);if(o.error)return o.error;this.setState({booking:o.data.booking})})),(0,pe.A)(this,"onClose",(()=>{const{onClose:e}=this.props,{booking:t}=this.state;this.setState({skipConflicts:!1}),e(null!==t)})),(0,pe.A)(this,"showConflicts",(()=>{this.setState({bookingConflictsVisible:!0})})),(0,pe.A)(this,"hideConflicts",(()=>{this.setState({bookingConflictsVisible:!1})})),(0,pe.A)(this,"getEventOption",(e=>{const t=cr()(e.startDt).format("L LT"),n=cr()(e.startDt).isSame(e.endDt,"date"),i=cr()(e.endDt).format("LT"),o=n?`${i}`:`${cr()(e.endDt).format("L")} ${i}`;return{text:e.title,description:`${t} - ${o}`,value:e.id}})),(0,pe.A)(this,"renderEventLink",(e=>e?d.createElement("span",{className:"rb-client-js-modules-bookRoom-___BookRoomModal-module__link-active___Jx-jk"},d.createElement("a",{href:e,target:"_blank",rel:"noopener noreferrer"},d.createElement(T.A,{name:"external",link:!0}))):d.createElement("span",{className:"rb-client-js-modules-bookRoom-___BookRoomModal-module__link-inactive___BIcmf"},d.createElement(T.A,{name:"external"})))),(0,pe.A)(this,"renderEventField",((e,t,n,i)=>{if(e.length>1){const{selectedEvent:i}=this.state;return d.createElement("div",{className:"rb-client-js-modules-bookRoom-___BookRoomModal-module__event-dropdown___aSZcM"},d.createElement(Cs.FinalDropdown,{name:"event",options:e,placeholder:L.Translate.string("Choose an event"),disabled:n,selection:!0,clearable:!0,onChange:e=>{this.setState({selectedEvent:e})}}),this.renderEventLink(t[i]))}{const[o]=e;return d.createElement("div",{className:"rb-client-js-modules-bookRoom-___BookRoomModal-module__event-checkbox___NQTS7"},d.createElement("span",null,d.createElement("strong",null,o.text)),d.createElement("span",{className:"rb-client-js-modules-bookRoom-___BookRoomModal-module__description___xsJJB"},o.description),this.renderEventLink(t[o.value]),d.createElement(un.A,{toggle:!0,disabled:n,className:"rb-client-js-modules-bookRoom-___BookRoomModal-module__checkbox___a7I+3",onChange:(e,t)=>{let{checked:n}=t;i.setEvent(n?o.value:void 0)}}))}})),(0,pe.A)(this,"renderRelatedEventsDropdown",((e,t)=>{const{relatedEvents:n}=this.props;if(!n.length)return;const i=n.map(this.getEventOption),o=Fo()(n.map((e=>[e.id,e.url])));return d.createElement(Ul.A,null,d.createElement("h3",null,d.createElement(T.A,{name:"chain"}),L.Translate.string("Event")),d.createElement("div",{className:"rb-client-js-modules-bookRoom-___BookRoomModal-module__events-segment-description___G7RX3"},d.createElement(L.PluralTranslate,{count:n.length},d.createElement(L.Singular,null,"You have an event taking place during the selected time. If you are booking the room for this event, please select it below. The room of the selected event will automatically be updated."),d.createElement(L.Plural,null,"You have events taking place during the selected time. If you are booking this room for one of your events, please select it below. The room of the selected event will automatically be updated."))),this.renderEventField(i,o,e,t))}))}componentDidMount(){const e=this.props,{actions:{fetchAvailability:t,fetchRelatedEvents:n},room:i,link:o,bookingData:{isPrebooking:r}}=e,a=(0,In.A)(e.bookingData,Tp);t(i,a),o||n(a)}componentWillUnmount(){const{actions:{resetAvailability:e,resetRelatedEvents:t}}=this.props;e(),t()}renderBookingState(e){let{submitSucceeded:t,submitError:n,submitFailed:i}=e;const{bookingData:{isPrebooking:o},actions:{openBookingDetails:r}}=this.props;if(t){const{booking:e}=this.state,t=d.createElement("a",{onClick:()=>r(e.id)});return d.createElement(oo.A,{color:o?"orange":"green"},d.createElement(oo.A.Header,null,o?d.createElement(L.Translate,null,"The space has been successfully pre-booked!"):d.createElement(L.Translate,null,"The space has been successfully booked!")),o?d.createElement(L.Translate,null,"You can consult your pre-booking"," ",d.createElement(L.Param,{name:"link",wrapper:t},"here"),"."):d.createElement(L.Translate,null,"You can consult your booking"," ",d.createElement(L.Param,{name:"link",wrapper:t},"here"),"."))}return i?d.createElement(oo.A,{color:"red"},d.createElement(oo.A.Header,null,d.createElement(L.Translate,null,"Couldn't book the room")),n):null}renderBookingConstraints(e,t){const{skipConflicts:n}=this.state;return d.createElement(d.Fragment,null,d.createElement(oo.A,{color:"yellow",attached:!0,icon:!0},d.createElement(T.A,{name:"warning circle"}),d.createElement(oo.A.Content,null,d.createElement(oo.A.Header,null,d.createElement(L.Translate,null,"Booking conflicts")),d.createElement(L.PluralTranslate,{count:e.length},d.createElement(L.Singular,null,"Your booking conflicts with another existing one."),d.createElement(L.Plural,null,d.createElement(L.Param,{name:"count",value:e.length})," occurrences of your booking conflict with existing bookings.")))),d.createElement(Ul.A,{attached:"bottom"},d.createElement(un.A,{toggle:!0,disabled:t,defaultChecked:n,label:L.Translate.string("I understand, please skip any days with conflicting occurrences."),onChange:(e,t)=>{let{checked:n}=t;this.setState({skipConflicts:n})}})))}get hasLinkConflict(){const{link:e,room:t}=this.props;return!!e&&(null!==e.ownRoomId?e.ownRoomId!==t.id:null!==e.ownRoomName)}get alreadyLinked(){const{link:e,room:t}=this.props;return null!==e&&e.ownRoomId===t.id}renderPrebookingMessage(){const e=d.createElement("strong",{className:"rb-client-js-modules-bookRoom-___BookRoomModal-module__pre-booking-color___Iv8LH"});return d.createElement(oo.A,{icon:!0},d.createElement(T.A,{name:"warning circle"}),d.createElement(oo.A.Content,null,d.createElement(oo.A.Header,null,d.createElement(L.Translate,null,"You are creating a"," ",d.createElement(L.Param,{name:"highlight",wrapper:e},"Pre-Booking"))),d.createElement(L.Translate,null,"A Pre-Booking has to be approved by the room managers before you can use the space in question.")))}renderPreConflictMessage(){const{bookingData:{isPrebooking:e},availability:{preConflicts:t},actions:{openBookingDetails:n}}=this.props,i=d.createElement(Ul.A,{attached:"bottom",className:"rb-client-js-modules-bookRoom-___BookRoomModal-module__pre-conflicts-segment___1tWLf"},d.createElement(Ws.A,null,Object.entries(t).map((e=>{let[t,i]=e;return d.createElement(Ws.A.Item,{key:t},d.createElement(Ws.A.Content,null,d.createElement(Ws.A.Header,null,cr()(t).format("dddd, D MMM YYYY")),d.createElement(Ws.A.Description,null,i.map((e=>{let{reservation:{id:t,bookedForName:i,bookingReason:o,startDt:r,endDt:a}}=e;return d.createElement("div",{key:t},d.createElement("a",{onClick:()=>n(t)},d.createElement(L.Translate,null,d.createElement(L.Param,{name:"time",value:`${(0,De.serializeTime)(r)} - ${(0,De.serializeTime)(a)} `})," ","by ",d.createElement(L.Param,{name:"bookedForName",value:i})," (",d.createElement(L.Param,{name:"bookingReason",value:o,wrapper:d.createElement("em",null)}),")")))})))))}))));return d.createElement(d.Fragment,null,d.createElement(oo.A,{color:e?"yellow":"orange",attached:!0,icon:!0},d.createElement(T.A,{name:"warning circle"}),d.createElement(oo.A.Content,null,d.createElement(oo.A.Header,null,d.createElement(L.Translate,null,"Pre-Booking conflicts")),e?d.createElement(L.Translate,null,"If you create this pre-booking, some of your days may get rejected as they overlap with the following pre-bookings:"):d.createElement(L.Translate,null,"If you create this booking, the following overlapping days of existing pre-bookings will automatically be rejected:"))),i)}renderLink(e,t){const{room:n}=this.props,i={event:L.Translate.string("Assign the room {room} to this event",{room:n.name}),contribution:L.Translate.string("Assign the room {room} to this contribution",{room:n.name}),sessionBlock:L.Translate.string("Assign the room {room} to this session block",{room:n.name})},o={event:d.createElement(L.Translate,null,"Assign the room ",d.createElement(L.Param,{name:"room",wrapper:d.createElement("em",null),value:n.name})," to this event (instead of ",d.createElement(L.Param,{name:"oldRoom",wrapper:d.createElement("em",null),value:e.ownRoomName}),")"),contribution:d.createElement(L.Translate,null,"Assign the room ",d.createElement(L.Param,{name:"room",wrapper:d.createElement("em",null),value:n.name})," to this contribution (instead of"," ",d.createElement(L.Param,{name:"oldRoom",wrapper:d.createElement("em",null),value:e.ownRoomName}),")"),sessionBlock:d.createElement(L.Translate,null,"Assign the room ",d.createElement(L.Param,{name:"room",wrapper:d.createElement("em",null),value:n.name})," to this session block (instead of ",d.createElement(L.Param,{name:"oldRoom",wrapper:d.createElement("em",null),value:e.ownRoomName}),")")},r=this.hasLinkConflict?{children:o[e.type]}:i[e.type];return d.createElement(Up,{link:e},!this.alreadyLinked&&d.createElement(Cs.FinalCheckbox,{name:"linkBack",disabled:t,toggle:!0,label:r}))}render(){var e;const{bookingData:{recurrence:t,dates:n,timeSlot:i,isPrebooking:o},room:r,availability:a,timeInformationComponent:s,defaultTitles:l,link:c,bookingReasonRequired:u,isAdminOverrideEnabled:m,bookingGracePeriod:h}=this.props;if(!r)return null;const p=null===(e={always:!0,never:!1,not_for_events:!c}[u])||void 0===e||e,{skipConflicts:_,bookingConflictsVisible:f}=this.state,g=!!c&&!this.hasLinkConflict,b=a&&a.dateRange.length,y=a&&!!Object.keys(a.conflicts).length,v=a&&!rn()(a.preConflicts),E=(0,De.isBookingStartDTValid)((0,De.createDT)(n.startDate,i&&i.startTime?i.startTime:"00:00"),m,h),k=e=>!E||e.submitting||e.submitSucceeded||e.pristine||e.hasValidationErrors||y&&!_;return d.createElement(Ts.A,{open:!0,onClose:this.onClose,size:"large",closeIcon:!0},d.createElement(ks.Form,{onSubmit:this.submitBooking,validate:e=>function(e,t){let{usage:n,user:i,reason:o}=e;const r={};return n||(r.usage=L.Translate.string("Please choose an option!")),"someone"!==n||i||(r.user=L.Translate.string("Please specify a user")),t&&!o&&(r.reason=L.Translate.string("You need to provide a reason")),o&&o.length<3&&(r.reason=L.Translate.string("Reason must be at least 3 characters")),r}(e,p),decorators:[wp],render:e=>d.createElement(d.Fragment,null,d.createElement(Ts.A.Header,null,o?l.preBooking:l.booking),d.createElement(Ts.A.Content,null,d.createElement(Mt.A,{stackable:!0},d.createElement(Mt.A.Column,{width:8},d.createElement(hp,{room:r}),d.createElement(s,{dates:n,timeSlot:i,recurrence:t,onClickOccurrences:this.showConflicts,occurrenceCount:b,recurrenceWeekdays:t.weekdays})),d.createElement(Mt.A.Column,{width:8},o&&this.renderPrebookingMessage(),c&&this.renderLink(c,e.submitSucceeded),d.createElement(ws.A,{id:"book-room-form",onSubmit:e.handleSubmit},d.createElement(Ul.A,{inverted:!0,color:"blue"},d.createElement("h3",null,d.createElement(T.A,{name:"user"}),d.createElement(L.Translate,null,"Usage")),d.createElement(ws.A.Group,{className:"rb-client-js-modules-bookRoom-___BookRoomModal-module__usage-radio___dqDnh"},d.createElement(Cs.FinalRadio,{name:"usage",value:"myself",label:L.Translate.string("I'll be using it myself"),disabled:e.submitSucceeded}),d.createElement(Cs.FinalRadio,{name:"usage",value:"someone",label:L.Translate.string("I'm booking it for someone else"),disabled:e.submitSucceeded})),d.createElement(Cs.FieldCondition,{when:"usage",is:"someone"},d.createElement(C.HM,null,(t=>d.createElement(Os.FinalPrincipal,{name:"user",favoriteUsersController:t,disabled:e.submitSucceeded,hideErrorWhileActive:!0,withExternalUsers:!0,required:!0})))),d.createElement(Cs.FinalTextArea,{name:"reason",nullIfEmpty:!0,placeholder:L.Translate.string("Reason for booking"),disabled:e.submitSucceeded,required:p})),(0,Ep.renderPluginComponents)("rb-booking-form-extra-fields",{room:r,disabled:e.submitSucceeded||e.submitting,onSubmit:e=>{this.setState({extraFields:e})}}),!c&&!e.submitSucceeded&&this.renderRelatedEventsDropdown(e.submitSucceeded||e.submitting,e.form.mutators)),r.canUserViewInternalNotes&&d.createElement(ws.A,{id:"book-notes-form",onSubmit:e.handleSubmit,style:{paddingTop:"1em"}},d.createElement(Ul.A,{inverted:!0,className:"rb-client-js-modules-bookRoom-___BookRoomModal-module__internal-notes-segment___Kj6W8"},d.createElement("h3",{style:{marginBottom:"0.5em"}},d.createElement(T.A,{name:"clipboard list"}),d.createElement(L.Translate,null,"Internal notes (optional)")),d.createElement(L.Translate,{as:"p"},"Internal notes about the booking are only visible to room managers."),d.createElement(Cs.FinalTextArea,{name:"internalNote",disabled:e.submitSucceeded}))),v&&!e.submitSucceeded&&this.renderPreConflictMessage(),y&&this.renderBookingConstraints(Object.values(a.conflicts),e.submitting||e.submitSucceeded),this.renderBookingState(e),!E&&d.createElement(oo.A,{color:"red"},d.createElement(T.A,{name:"dont"}),d.createElement(L.Translate,null,"Bookings in the past are not allowed."))))),d.createElement(Ts.A.Actions,null,d.createElement(dn.A,{primary:!o,color:o?"orange":null,disabled:k(e),loading:e.submitting,type:"submit",form:"book-room-form",content:o?l.preBooking:l.booking}),d.createElement(dn.A,{type:"button",onClick:this.onClose,content:e.submitSucceeded?L.Translate.string("Close"):L.Translate.string("I've changed my mind!")}),d.createElement(Bu,{open:f,onClose:this.hideConflicts,room:r,roomAvailability:a,title:d.createElement(L.Translate,null,"Bookings")}))),initialValues:{user:null,linkBack:g,extraFields:null},subscription:{submitSucceeded:!0,submitError:!0,submitFailed:!0,submitting:!0,hasValidationErrors:!0,pristine:!0},mutators:{setEvent:(e,t,n)=>{let[i]=e,{changeValue:o}=n;o(t,"event",(()=>i))}}}))}}(0,pe.A)(Lp,"propTypes",{room:y().object,bookingData:y().object.isRequired,onClose:y().func.isRequired,availability:y().object,timeInformationComponent:y().elementType,relatedEvents:y().array.isRequired,link:pc,isAdminOverrideEnabled:y().bool.isRequired,actions:y().exact({createBooking:y().func.isRequired,fetchAvailability:y().func.isRequired,resetAvailability:y().func.isRequired,openBookingDetails:y().func.isRequired,fetchRelatedEvents:y().func.isRequired,resetRelatedEvents:y().func.isRequired}).isRequired,defaultTitles:y().shape({booking:xt.IndicoPropTypes.i18n,preBooking:xt.IndicoPropTypes.i18n}),bookingReasonRequired:y().string.isRequired,bookingGracePeriod:y().number}),(0,pe.A)(Lp,"defaultProps",{room:null,availability:null,timeInformationComponent:Ap,link:null,defaultTitles:{booking:d.createElement(L.Translate,null,"Create Booking"),preBooking:d.createElement(L.Translate,null,"Create Pre-booking")},bookingGracePeriod:null});const Dp=(0,p.connect)(((e,t)=>{let{roomId:n}=t;return{availability:Hc(e),relatedEvents:Uc(e),room:Qo(e,{roomId:n}),link:hc(e),isAdminOverrideEnabled:Ui(e),bookingGracePeriod:re(e),bookingReasonRequired:he(e)}}),(e=>({actions:(0,_e.bindActionCreators)({fetchAvailability:Aa,resetAvailability:ka,fetchRelatedEvents:Na,resetRelatedEvents:Fa,createBooking:(e,t)=>{const{reason:n,internalNote:i,usage:o,user:r,linkType:a,linkId:s,linkBack:l,extraFields:c}=e,{bookingData:{recurrence:u,dates:d,recurrenceWeekdays:m,timeSlot:h,isPrebooking:p},room:_,isAdminOverrideEnabled:f}=t;return function(e,t){const n=hr(e,Ir);return t&&(n.admin_override_enabled=!0),(0,G.HX)((()=>D.indicoAxios.post(Br(),n)),Hr,Ur,$r)}({reason:n,internalNote:i,usage:o,user:r,recurrence:u,recurrenceWeekdays:m,dates:d,timeSlot:h,room:_,linkType:a,linkId:s,linkBack:l,isPrebooking:p,extraFields:c},f)},openBookingDetails:e=>Z("booking-details",e,null,!0)},e)})))(h.Ay.component("BookRoomModal",Lp));class Cp extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"getLegendLabels",(e=>{const t=e.reduce(((e,t)=>{let[,n]=t;return Hl()(e,Dr(n))}),[]);return Lr(t)}))}componentDidMount(){const{actions:{fetchUnavailableRooms:e,initTimeline:t},filters:n,timelineDatePicker:i,isTimelineVisible:o}=this.props,{selectedDate:r,mode:a}=i,s=o&&r?r:n.dates.startDate,l=o&&a?a:"days";e(n),t(s,l)}render(){const{availability:e,actions:t,isFetching:n,onClose:i,datePicker:o}=this.props;if(0===e.length)return d.createElement(pn.A,{active:!0,page:!0},d.createElement(_n.A,null));const r=d.createElement(d.Fragment,null,d.createElement(mn.A,{trigger:d.createElement(T.A,{name:"info circle",className:"legend-info-icon"}),content:d.createElement(Su,{labels:this.getLegendLabels(e),compact:!0})}),d.createElement(ad,(0,bn.A)({},o,{disabled:n||!e.length,onModeChange:t.setMode,onDateChange:t.setDate})));return d.createElement(Ts.A,{open:!0,onClose:i,size:"large",closeIcon:!0},d.createElement(Ts.A.Header,{className:"legend-header"},d.createElement(L.Translate,null,"Unavailable Rooms"),d.createElement(xt.Responsive.Portrait,{orElse:r},d.createElement(xt.Responsive.Tablet,{andLarger:!0},r))),d.createElement(Ts.A.Content,null,d.createElement(Fh,{isLoading:n,availability:e,datePicker:o,fixedHeight:"70vh",onClickReservation:t.openBookingDetails,setMode:t.setMode,setDate:t.setDate})))}}(0,pe.A)(Cp,"propTypes",{datePicker:y().object.isRequired,availability:y().array,filters:y().object.isRequired,isFetching:y().bool.isRequired,timelineDatePicker:y().object.isRequired,isTimelineVisible:y().bool.isRequired,onClose:y().func,actions:y().exact({fetchUnavailableRooms:y().func.isRequired,setDate:y().func.isRequired,setMode:y().func.isRequired,initTimeline:y().func.isRequired,openBookingDetails:y().func.isRequired}).isRequired}),(0,pe.A)(Cp,"defaultProps",{availability:[],onClose:null});const Op=(0,p.connect)((e=>({availability:Sc(e),filters:gc(e),isFetching:Oc(e),datePicker:Ic(e),timelineDatePicker:jc(e),isTimelineVisible:Mc(e)})),(e=>({actions:(0,_e.bindActionCreators)({fetchUnavailableRooms:Ta,setDate:e=>function(e){return{type:ua,date:e}}((0,De.serializeDate)(e)),setMode:Ia,initTimeline:Ba,openBookingDetails:os},e)})))(Cp),Rp=["bookRoomFilters","bookingData"],Sp=["isPrebooking"],Pp=["isPrebooking"];function Mp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function xp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mp(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const jp=(0,p.connect)((e=>({bookRoomFilters:gc(e)})))((e=>{let{bookRoomFilters:{dates:t,timeSlot:n,recurrence:i,weekdays:o},bookingData:{isPrebooking:r}}=e,a=(0,In.A)(e,Rp);return d.createElement(Dp,(0,bn.A)({},a,{bookingData:{dates:t,timeSlot:n,recurrence:i,weekdays:o,isPrebooking:r}}))})),Ip=e=>rn()(e)?void 0:xp(xp({},e),{},{dates:{startDate:(0,De.toMoment)(e.dates.startDate,cr().HTML5_FMT.DATE),endDate:(0,De.toMoment)(e.dates.endDate,cr().HTML5_FMT.DATE)},timeSlot:{startTime:(0,De.toMoment)(e.timeSlot.startTime,cr().HTML5_FMT.TIME),endTime:(0,De.toMoment)(e.timeSlot.endTime,cr().HTML5_FMT.TIME)}}),Bp={"booking-form":(e,t,n)=>{const{isPrebooking:i}=n,o=(0,In.A)(n,Sp);return d.createElement(_s,{roomId:t},(()=>rn()(o)?d.createElement(jp,{roomId:t,onClose:e,bookingData:n}):d.createElement(Dp,{roomId:t,onClose:e,bookingData:n})))},"book-room":(e,t,n)=>{const{isPrebooking:i}=n,o=(0,In.A)(n,Pp);return d.createElement(yp,{roomId:t,onClose:e,defaults:Ip(o),isPrebooking:i})},"unavailable-rooms":e=>d.createElement(Op,{onClose:e})},Np={type:null,id:null,title:null,eventURL:null,eventTitle:null,ownRoomId:null,ownRoomName:null},Fp=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Np,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case cc:return{type:t.objectType,id:t.objectId,title:t.objectTitle,eventURL:t.eventURL,eventTitle:t.eventTitle,ownRoomId:t.ownRoomId,ownRoomName:t.ownRoomName,startDt:t.startDt,endDt:t.endDt};case uc:case Ur:return Np;default:return e}},zp={event:L.Translate.string("Your booking will be linked to an event:"),contribution:L.Translate.string("Your booking will be linked to a contribution:"),sessionBlock:L.Translate.string("Your booking will be linked to a session block:")},qp=e=>{let{visible:t,clear:n,data:i}=e;if(!t)return null;const{type:o,title:r,eventURL:a,eventTitle:s,startDt:l,endDt:c}=i;return d.createElement("header",{className:"rb-client-js-common-linking-___LinkBar-module__link-bar___NZz-U"},d.createElement(T.A,{name:"info circle"}),d.createElement("span",null,zp[o]," ","event"===o?d.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer"},d.createElement("em",null,`${r} (${(0,De.serializeDateTimeRange)(l,c)})`)):d.createElement("span",null,d.createElement("em",null,r)," (",d.createElement("a",{href:a,target:"_blank",rel:"noopener noreferrer"},s),")")),d.createElement("span",{className:"rb-client-js-common-linking-___LinkBar-module__clear___TjWtV",onClick:n},d.createElement(mn.A,{trigger:d.createElement(T.A,{name:"close"})},d.createElement(L.Translate,null,"Exit linking mode"))))};qp.propTypes={visible:y().bool.isRequired,clear:y().func.isRequired,data:pc},qp.defaultProps={data:null};const Hp=(0,p.connect)((e=>({visible:mc(e),data:hc(e)})),(e=>({clear:(0,_e.bindActionCreators)(dc,e)})))(qp);class Up extends d.PureComponent{render(){const{children:e,link:{type:t,title:n,eventURL:i,eventTitle:o}}=this.props,r={event:L.Translate.string("This booking will be linked to an event:"),contribution:L.Translate.string("This booking will be linked to a contribution:"),sessionBlock:L.Translate.string("This booking will be linked to a session block:")};return d.createElement(d.Fragment,null,d.createElement(oo.A,{icon:!0,attached:!!e,color:"teal"},d.createElement(T.A,{name:"linkify"}),d.createElement(oo.A.Content,null,r[t],d.createElement("div",{className:"rb-client-js-common-bookings-___BookingObjectLink-module__object-link___bGlUO"},"event"===t?d.createElement("a",{href:i,target:"_blank",rel:"noopener noreferrer"},d.createElement("em",null,n)):d.createElement("span",null,d.createElement("em",null,n)," (",d.createElement("a",{href:i,target:"_blank",rel:"noopener noreferrer"},o),")")))),!!e&&d.createElement(Ul.A,{attached:"bottom"},e))}}(0,pe.A)(Up,"propTypes",{link:pc.isRequired,children:y().any}),(0,pe.A)(Up,"defaultProps",{children:null});const $p=["rooms","dates"];function Zp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}const Gp=_.Ay.bind(null,{endpoint:"rb.export_bookings",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"bookings",isDynamic:!1},{data:"/",isDynamic:!1},{data:"export",isDynamic:!1}]}]},"/");function Vp(e){let{rooms:t,onClose:n}=e;return d.createElement(Ts.A,{open:!0,onClose:n,size:"tiny",closeIcon:!0},d.createElement(ks.Form,{onSubmit:async e=>{const{rooms:t,dates:{startDate:n,endDate:i}}=e,o=(0,In.A)(e,$p),r=t.map((e=>e.id));let a;try{a=await D.indicoAxios.post(Gp(),(0,fe.snakifyKeys)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zp(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zp(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({roomIds:r,startDate:n,endDate:i},o)))}catch(e){return(0,Cs.handleSubmitError)(e)}location.href=a.data.url},render:e=>d.createElement(d.Fragment,null,d.createElement(Ts.A.Header,null,d.createElement(L.Translate,null,"Export bookings")),d.createElement(Ts.A.Content,null,d.createElement(ws.A,{id:"export-bookings-form",onSubmit:e.handleSubmit},d.createElement("h5",null,d.createElement(L.Translate,null,"File format")),d.createElement(ws.A.Group,null,d.createElement(Cs.FinalRadio,{name:"format",value:"csv",validate:Cs.validators.required,label:"CSV"}),d.createElement(Cs.FinalRadio,{name:"format",value:"xlsx",validate:Cs.validators.required,label:"XLSX"})),d.createElement(Os.FinalDatePeriod,{name:"dates",label:L.Translate.string("Period"),disabledDate:()=>!1,required:!0,allowNull:!0}),d.createElement(fm,{name:"rooms",label:L.Translate.string("Rooms to export"),validate:e=>{if(!e||!e.length)return L.Translate.string("Please choose at least one room.")},required:!0}))),d.createElement(Ts.A.Actions,null,d.createElement(Cs.FinalSubmitButton,{label:L.Translate.string("Export"),form:"export-bookings-form"}),d.createElement(dn.A,{type:"button",onClick:n},d.createElement(L.Translate,null,"Close")))),initialValues:{rooms:t,dates:null},initialValuesEqual:cn(),subscription:{}}))}Vp.propTypes={rooms:y().array.isRequired,onClose:y().func.isRequired};var Wp=n(92464),Kp=n.n(Wp);function Yp(e){let{room:t}=e;return t.keyLocation&&d.createElement(oo.A,{className:"rb-client-js-components-___RoomKeyLocation-module__message-icon___KkBaB",icon:!0},d.createElement(T.A,{name:"key"}),d.createElement(oo.A.Content,null,d.createElement(xt.Markdown,{targetBlank:!0},t.keyLocation)))}function Xp(e){let{links:t}=e;return d.createElement(oo.A,{icon:!0,color:"teal"},d.createElement(T.A,{name:"linkify"}),d.createElement(oo.A.Content,null,d.createElement(L.PluralTranslate,{count:t.length},d.createElement(L.Singular,null,"This booking has ",d.createElement(L.Param,{name:"count",value:t.length})," linked occurrence:"),d.createElement(L.Plural,null,"This booking has ",d.createElement(L.Param,{name:"count",value:t.length})," linked occurrences:")),d.createElement(oo.A,{style:{overflowY:"auto",maxHeight:"5rem",paddingTop:0,paddingBottom:0}},d.createElement("ul",{style:{paddingInlineStart:"0.5rem"}},t.map((e=>d.createElement("li",{key:e.id},d.createElement("span",{style:"valid"!==e.state?{textDecoration:"line-through"}:{}},(0,De.toMoment)(e.startDt).format("L")),":"," ",e.object?d.createElement(d.Fragment,null,d.createElement("a",{href:e.object.url,target:"_blank",rel:"noopener noreferrer"},e.object.title),"event"!==e.type&&d.createElement(d.Fragment,null," ","(",d.createElement("a",{href:e.object.eventURL,target:"_blank",rel:"noopener noreferrer"},e.object.eventTitle),")")):d.createElement(L.Translate,{as:"em"},"Details hidden - no access"))))))))}Yp.propTypes={room:y().object.isRequired},Xp.propTypes={links:y().array.isRequired};const Qp=_.Ay.bind(null,{endpoint:"rb.booking_links_data",rules:[{args:["booking_id"],converters:{booking_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"bookings",isDynamic:!1},{data:"/",isDynamic:!1},{data:"booking_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"links",isDynamic:!1}]}]},"/");function Jp(e){let{id:t}=e;const{data:n,loading:i}=(0,C.Ku)(Qp({booking_id:t}),{camelize:!0});return i?d.createElement(Ul.A,null,d.createElement(Du.A,{fluid:!0},d.createElement(Du.A.Header,{image:!0},d.createElement(Du.A.Line,{length:"full"}),d.createElement(Du.A.Line,{length:"full"})))):n?d.createElement(Xp,{links:n}):null}Jp.propTypes={id:y().number.isRequired};function e_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function t_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?e_(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const n_=_.Ay.bind(null,{endpoint:"rb.booking_link",rules:[{args:["booking_id"],converters:{booking_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"booking",isDynamic:!1},{data:"/",isDynamic:!1},{data:"booking_id",isDynamic:!0}]}]},"/");class i_ extends d.Component{constructor(){var e;super(...arguments),e=this,(0,pe.A)(this,"state",{occurrencesVisible:!1,activeConfirmation:null,acceptanceFormVisible:!1,error:null,preBookingConflicts:{warningVisible:!1,concurrentBookings:[],acceptanceData:null}}),(0,pe.A)(this,"showAcceptanceForm",(()=>{this.setState({acceptanceFormVisible:!0})})),(0,pe.A)(this,"hideAcceptanceForm",(()=>{this.setState({acceptanceFormVisible:!1})})),(0,pe.A)(this,"showOccurrences",(()=>{this.setState({occurrencesVisible:!0})})),(0,pe.A)(this,"hideOccurrences",(()=>{this.setState({occurrencesVisible:!1})})),(0,pe.A)(this,"hidePreBookingWarning",(()=>{this.setState({preBookingConflicts:{warningVisible:!1,concurrentBookings:[],acceptanceData:null}})})),(0,pe.A)(this,"renderBookedFor",(e=>{const{fullName:t,email:n,phone:i}=e;return d.createElement(d.Fragment,null,d.createElement(ro.A,null,d.createElement(T.A,{name:"user"}),d.createElement(L.Translate,null,"Booked for")),d.createElement("div",null,t),i&&d.createElement("div",null,d.createElement(T.A,{name:"phone"}),i),n&&d.createElement("div",null,d.createElement(T.A,{name:"mail"}),n))})),(0,pe.A)(this,"renderPreBookingWarning",(()=>{const{bookingStateChangeInProgress:e}=this.props,{actionInProgress:t,preBookingConflicts:{warningVisible:n,concurrentBookings:i,acceptanceData:o}}=this.state,r=i.map((e=>{const t=e.reservation,n=(0,De.serializeDate)((0,De.toMoment)(e.start_dt),"L LT"),i=(0,De.serializeDate)((0,De.toMoment)(e.end_dt),"LT");return d.createElement(Ws.A.Item,{key:t.id},d.createElement("a",{href:n_({booking_id:t.id}),target:"_blank",rel:"noopener noreferrer"},n," - ",i)," ",d.createElement(L.Translate,null,"by ",d.createElement(L.Param,{name:"user",value:t.booked_for_name}))," ","(",t.booking_reason,")")}));return d.createElement(Ts.A,{open:n,size:"small",onClose:this.hidePreBookingWarning},d.createElement(Ts.A.Header,null,d.createElement(L.Translate,null,"Warning")),d.createElement(Ts.A.Content,null,d.createElement(L.Translate,null,"There is more than one booking request during this time. Accepting this booking will automatically reject the following:"),d.createElement("div",{className:"rb-client-js-common-bookings-___BookingDetails-module__concurrent-reservations___brBp7"},d.createElement(Ws.A,{divided:!0,className:"rb-client-js-common-bookings-___BookingDetails-module__concurrent-reservations-list___1fhwY"},r))),d.createElement(Ts.A.Actions,null,d.createElement(dn.A,{content:L.Translate.string("Close without accepting"),onClick:this.hidePreBookingWarning}),d.createElement(dn.A,{icon:"check circle",onClick:()=>{this.changeState("approve",t_(t_({},o),{},{force:!0})),this.hidePreBookingWarning()},loading:"approve"===t&&e,disabled:e,content:L.Translate.string("Accept anyway"),positive:!0})))})),(0,pe.A)(this,"renderCancelOccurrence",((e,t)=>{const{actions:{openBookingDetails:n}}=this.props,{cancelDate:i}=this.props,o=(0,De.serializeDate)(i,"L");return null===i?null:void 0===e[i]||0===e[i].length?d.createElement(Ts.A,{open:!0,size:"tiny",onClose:()=>n(t)},d.createElement(Ts.A.Header,null,"Cancellation not possible"),d.createElement(Ts.A.Content,null,d.createElement(L.Translate,null,"There is no occurrence on this date (",d.createElement(L.Param,{name:"date",value:o}),").")),d.createElement(Ts.A.Actions,null,d.createElement(dn.A,{content:L.Translate.string("Close"),onClick:()=>n(t)}))):e[i][0].canCancel?d.createElement(Ts.A,{open:!0,size:"tiny",onClose:()=>n(t)},d.createElement(Ts.A.Header,null,d.createElement(L.Translate,null,"Confirm cancellation")),d.createElement(Ts.A.Content,null,d.createElement(L.Translate,null,"Are you sure you want to cancel this occurrence (",d.createElement(L.Param,{name:"date",value:o}),")?")),d.createElement(Ts.A.Actions,null,d.createElement(dn.A,{content:L.Translate.string("Close"),onClick:()=>n(t)}),d.createElement(dn.A,{content:L.Translate.string("Cancel this occurrence"),onClick:async()=>{await this.cancelOccurrence(),n(t)},negative:!0}))):d.createElement(Ts.A,{open:!0,size:"tiny",onClose:()=>n(t)},d.createElement(Ts.A.Header,null,d.createElement(L.Translate,null,"Cancellation not possible")),d.createElement(Ts.A.Content,null,d.createElement(L.Translate,null,"The occurrence you chose (",d.createElement(L.Param,{name:"date",value:o}),") cannot be cancelled.")),d.createElement(Ts.A.Actions,null,d.createElement(dn.A,{content:L.Translate.string("Close"),onClick:()=>n(t)})))})),(0,pe.A)(this,"renderReason",(e=>d.createElement(oo.A,{info:!0,icon:!0,className:"rb-client-js-common-bookings-___BookingDetails-module__message-icon___2d+nH"},d.createElement(T.A,{name:"info"}),d.createElement(oo.A.Content,null,d.createElement(oo.A.Header,null,d.createElement(L.Translate,null,"Booking reason")),e)))),(0,pe.A)(this,"renderNotes",(e=>e?d.createElement(oo.A,{warning:!0,icon:!0,className:"rb-client-js-common-bookings-___BookingDetails-module__message-icon___2d+nH"},d.createElement(T.A,{name:"clipboard list",style:{marginRight:"0.4em"}}),d.createElement(oo.A.Content,null,d.createElement(oo.A.Header,null,d.createElement(L.Translate,null,"Internal notes")),e)):null)),(0,pe.A)(this,"_getRowSerializer",(e=>{const{booking:{room:t}}=this.props;return n=>{let{bookings:i,cancellations:o,rejections:r,other:a}=n;return{availability:{bookings:i[e].map((e=>t_(t_({},e),{},{bookable:!1})))||[],cancellations:o[e]||[],rejections:r[e]||[],other:a[e]||[]},label:d.createElement(d.Fragment,null,d.createElement("span",{className:"rb-client-js-components-___WeekdayInformation-module__weekday___ohBFC"},cr()(e).format("ddd"))," ",cr()(e).format("L")),key:e,room:t}}})),(0,pe.A)(this,"renderTimeline",((e,t)=>{const{booking:n}=this.props,i=t.map((t=>this._getRowSerializer(t)(e)));return d.createElement($u,{rows:i,fixedHeight:i.length>1?"70vh":null,booking:n,rowActions:{occurrence:!0},hideRecurrence:!0,trim12hMins:!0})})),(0,pe.A)(this,"renderBookingHistory",((e,t,n)=>{const{actions:{openBookingDetails:i}}=this.props;if(n){const{fullName:i}=n;e=[...e,{id:"created",timestamp:t,info:["Booking created"],userName:i}]}const o=e.map((e=>{const{id:t,timestamp:n,info:o,userName:r}=e;let a=d.createElement("strong",null,o[0]),s=null,l=o;const c=o[o.length-1].match(/^booking_link:(\d+)$/);c&&(l=o.slice(0,-1),a=d.createElement("a",{href:n_({booking_id:c[1]}),onClick:e=>{e.preventDefault(),i(c[1])}},a)),2===l.length?s=l[1]:l.length>2&&(s=d.createElement("ul",{style:{textAlign:"left"}},l.slice(1).map(((e,t)=>d.createElement("li",{key:t},e)))));const u=(0,De.serializeDate)((0,De.toMoment)(n),"L LT"),m=d.createElement("span",{className:"rb-client-js-common-bookings-___BookingDetails-module__popup-center___MlXyB"},s),h=s?d.createElement(vr,{content:m}):d.createElement("span",null);return d.createElement(Ws.A.Item,{key:t},d.createElement(L.Translate,null,d.createElement(L.Param,{name:"date",value:u,wrapper:d.createElement("span",{className:"rb-client-js-common-bookings-___BookingDetails-module__log-date___o6wKj"})})," - ",d.createElement(L.Param,{name:"info",wrapper:h,value:a})," by"," ",d.createElement(L.Param,{name:"user",value:r})))}));return!!o.length&&d.createElement("div",{className:"rb-client-js-common-bookings-___BookingDetails-module__booking-logs___VoiTi"},d.createElement(ro.A,null,d.createElement(L.Translate,null,"Booking history")),d.createElement(Ws.A,{divided:!0,className:"rb-client-js-common-bookings-___BookingDetails-module__log-list___SJ5Wj"},o))})),(0,pe.A)(this,"renderMessages",((e,t)=>{const n=[];if(t){const{actions:{openBookingDetails:e}}=this.props,i=d.createElement("a",{onClick:()=>e(t)});n.push({id:"success-split",color:"green",header:L.Translate.string("The booking has been successfully split"),message:d.createElement(L.Translate,null,"You can consult your new booking"," ",d.createElement(L.Param,{name:"link",wrapper:i},"here"),".")})}return e&&n.push({id:"error",color:"red",header:L.Translate.string("Operation failed"),message:e.message}),n.map((e=>{let{id:t,header:n,message:i,color:o}=e;return d.createElement(oo.A,{key:t,color:o},d.createElement(oo.A.Header,null,n),i)}))})),(0,pe.A)(this,"renderBookingStatus",(()=>{const{booking:{isPending:e,isAccepted:t,isCancelled:n,isRejected:i,rejectionReason:o}}=this.props;let r,a,s,l;e?(s=d.createElement(T.A,{name:"wait"}),r="yellow",a=L.Translate.string("Pending Confirmation"),l=L.Translate.string("This booking is subject to acceptance by the room owner")):n?(s=d.createElement(T.A,{name:"cancel"}),r="grey",a=L.Translate.string("Cancelled"),l=d.createElement(d.Fragment,null,d.createElement(L.Translate,null,"The booking was cancelled."),!!o&&d.createElement(d.Fragment,null,d.createElement("br",null),d.createElement(L.Translate,null,"Reason:"," ",d.createElement(L.Param,{name:"rejectionReason",value:o,wrapper:d.createElement("strong",null)}))))):i?(s=d.createElement(T.A,{name:"calendar minus"}),r="red",a=L.Translate.string("Rejected"),l=d.createElement(d.Fragment,null,d.createElement(L.Translate,null,"The booking was rejected."),!!o&&d.createElement(d.Fragment,null,d.createElement("br",null),d.createElement(L.Translate,null,"Reason:"," ",d.createElement(L.Param,{name:"rejectionReason",value:o,wrapper:d.createElement("strong",null)}))))):t&&(s=d.createElement(T.A,{name:"checkmark"}),r="green",a=L.Translate.string("Accepted"),l=L.Translate.string("The booking was accepted"));const c=d.createElement(Ll.A,{color:r},s,a);return d.createElement(mn.A,{trigger:c,content:l,position:"bottom center"})})),(0,pe.A)(this,"renderDeleteButton",(()=>{const{activeConfirmation:e}=this.state,{bookingStateChangeInProgress:t}=this.props;return d.createElement(d.Fragment,null,d.createElement(dn.A,{icon:"trash",onClick:()=>this.showConfirm("delete"),disabled:t,negative:!0,circular:!0}),d.createElement(Cu.A,{header:L.Translate.string("Confirm deletion"),content:L.Translate.string("Are you sure you want to delete this booking?"),confirmButton:d.createElement(dn.A,{content:L.Translate.string("Delete"),negative:!0}),cancelButton:L.Translate.string("Cancel"),open:"delete"===e,onCancel:this.hideConfirm,onConfirm:this.deleteBooking}))})),(0,pe.A)(this,"deleteBooking",(()=>{const{actions:{deleteBooking:e},booking:{id:t},onClose:n}=this.props;e(t),n(),this.hideConfirm()})),(0,pe.A)(this,"hideConfirm",(()=>{this.setState({activeConfirmation:null})})),(0,pe.A)(this,"showConfirm",(e=>{this.setState({activeConfirmation:e})})),(0,pe.A)(this,"changeState",(function(t){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{booking:{id:i},actions:{changeBookingState:o}}=e.props,{acceptanceFormVisible:r}=e.state;return e.setState({actionInProgress:t,error:null}),o(i,t,n).then((i=>{let{error:o}=i;o&&("prebooking_collision"===o.message&&"approve"===t?(r&&e.hideAcceptanceForm(),e.setState({preBookingConflicts:{concurrentBookings:o.data,acceptanceData:n,warningVisible:!0}})):e.setState({error:o})),e.setState({actionInProgress:null})}))})),(0,pe.A)(this,"cancelOccurrence",(async()=>{const{cancelDate:e,booking:{id:t},actions:{changeBookingOccurrenceState:n,fetchBookingDetails:i}}=this.props,o=(0,De.serializeDate)(e);this.setState({actionInProgress:!0}),await n(t,o,"cancel"),await i(t),this.setState({actionInProgress:!1})})),(0,pe.A)(this,"getLegendLabels",(e=>Lr(Dr(e),["blockings","overridableBlockings","nonbookablePeriods","unbookableHours"]))),(0,pe.A)(this,"renderActionButtons",((e,t,n,i,o)=>{const{bookingStateChangeInProgress:r}=this.props,{actionInProgress:a,activeConfirmation:s,acceptanceFormVisible:l}=this.state,c=d.createElement(dn.A,{type:"button",icon:"remove circle",color:"red",size:"small",loading:"reject"===a&&r,disabled:r,content:L.Translate.string("Reject booking")}),u=d.createElement(dn.A,{type:"button",icon:"edit outline",className:"rb-client-js-common-bookings-___BookingDetails-module__accept-with-message___-iyAl",disabled:r||l});return d.createElement(Ts.A.Actions,null,e&&d.createElement(d.Fragment,null,d.createElement(dn.A,{type:"button",icon:"cancel",size:"small",onClick:()=>this.showConfirm("cancel"),loading:"cancel"===a&&r,disabled:r,content:L.Translate.string("Cancel booking")}),d.createElement(Ts.A,{open:"cancel"===s,size:"small",onClose:()=>this.hideConfirm()},d.createElement(Ts.A.Header,null,d.createElement(L.Translate,null,"Confirm cancellation")),d.createElement(Ts.A.Content,null,d.createElement("p",null,d.createElement(L.PluralTranslate,{count:i},d.createElement(L.Singular,null,"Are you sure you want to cancel this booking?"),d.createElement(L.Plural,null,"Are you sure you want to cancel this booking? This will cancel"," ",d.createElement(L.Param,{name:"count",value:i,wrapper:d.createElement("strong",null)})," ","upcoming occurrences."))),i>1&&d.createElement("p",null,d.createElement(L.Translate,null,"Single occurrences can be cancelled via the timeline view."))),d.createElement(Ts.A.Actions,null,d.createElement(dn.A,{onClick:this.hideConfirm,content:L.Translate.string("Close")}),i>1&&d.createElement(dn.A,{icon:"calendar outline",onClick:()=>{this.hideConfirm(),this.showOccurrences()},content:L.Translate.string("View Timeline")}),d.createElement(dn.A,{onClick:()=>{this.changeState("cancel"),this.hideConfirm()},content:L.PluralTranslate.string("Cancel booking","Cancel all occurrences",i),negative:!0})))),t&&d.createElement(mn.A,{trigger:c,position:"bottom center",on:"click"},d.createElement(ks.Form,{onSubmit:e=>this.changeState("reject",{reason:e.reason}),render:e=>{let{handleSubmit:t,hasValidationErrors:n,submitSucceeded:r,submitting:a,pristine:s}=e;return d.createElement(ws.A,{className:"rb-client-js-common-bookings-___BookingDetails-module__rejection-form___Tthlm",onSubmit:t},d.createElement(Cs.FinalTextArea,{name:"reason",placeholder:L.Translate.string("Provide the rejection reason"),disabled:r,rows:2,required:!0}),o&&i>1&&d.createElement(Cs.FinalCheckbox,{name:"_confirm",label:L.Translate.string("I understand that this will reject all occurrences of the booking."),validate:e=>e?void 0:L.Translate.string("Please confirm rejecting the booking.")}),d.createElement(dn.A,{type:"submit",disabled:a||s||n||r,loading:a,floated:"right",primary:!0},d.createElement(L.Translate,null,"Reject")))},subscription:{hasValidationErrors:!0,submitSucceeded:!0,submitting:!0,pristine:!0}})),n&&d.createElement(dn.A.Group,{size:"small",color:"green"},d.createElement(dn.A,{type:"button",icon:"check circle",onClick:()=>this.changeState("approve"),loading:"approve"===a&&r,disabled:r||l,content:L.Translate.string("Accept booking")}),d.createElement(mn.A,{trigger:u,position:"bottom right",on:"click",open:l,onOpen:this.showAcceptanceForm,onClose:this.hideAcceptanceForm},d.createElement(ks.Form,{onSubmit:e=>this.changeState("approve",e),render:e=>{let{handleSubmit:t,hasValidationErrors:n,submitSucceeded:i,submitting:o}=e;return d.createElement(ws.A,{className:"rb-client-js-common-bookings-___BookingDetails-module__rejection-form___Tthlm",onSubmit:t},d.createElement(Cs.FinalTextArea,{name:"reason",placeholder:L.Translate.string("You can provide an optional message when accepting this booking"),disabled:i,rows:2,autoFocus:!0}),d.createElement(dn.A,{type:"submit",disabled:o||n||i,loading:o,floated:"right",primary:!0},d.createElement(L.Translate,null,"Accept")))},subscription:{hasValidationErrors:!0,submitSucceeded:!0,submitting:!0,pristine:!0}}))))}))}render(){const{error:e,occurrencesVisible:t}=this.state,{onClose:n,editButton:i,bookingStateChangeInProgress:o,booking:r}=this.props,{id:a,startDt:s,endDt:l,occurrences:c,dateRange:u,repetition:m,room:h,bookedForUser:p,bookingReason:_,internalNote:f,editLogs:g,createdDt:b,createdByUser:y,isCancelled:v,isRejected:E,canDelete:k,canCancel:A,canReject:w,canAccept:D,canEdit:C,isAccepted:O,newBookingId:R,isLinkedToObjects:S,externalDetailsURL:P,recurrenceWeekdays:M}=r,x={startDate:s,endDate:l},j={startTime:cr()(s).format("HH:mm"),endTime:cr()(l).format("HH:mm")},I=kr(m),B=D&&!O,N=!v&&!E&&(A||w||B),F=Kp()(c.bookings,(e=>rn()(e))),z=Object.keys(F).length,q=Object.values(F).filter((e=>e.some((e=>e.canCancel)))).length;return d.createElement(d.Fragment,null,d.createElement(Ts.A,{onClose:()=>n(),size:"large",closeIcon:!0,open:!0},d.createElement(Ts.A.Header,{className:"rb-client-js-common-bookings-___BookingDetails-module__booking-modal-header___6gJYs"},d.createElement("span",{className:"rb-client-js-common-bookings-___BookingDetails-module__header-text___DgVz8"},d.createElement(L.Translate,null,"Booking Details")),d.createElement("span",{className:"rb-client-js-common-bookings-___BookingDetails-module__booking-status___3cKSe"},this.renderBookingStatus()),d.createElement(Os.ClipboardButton,{text:P,successText:L.Translate.string("Booking link copied")}),d.createElement("span",null,d.createElement(xt.Responsive.Tablet,{andLarger:!0},C&&i({disabled:o})),k&&this.renderDeleteButton())),d.createElement(Ts.A.Content,null,d.createElement(Mt.A,{stackable:!0,columns:2},d.createElement(Mt.A.Column,null,d.createElement(hp,{room:h}),d.createElement(Yp,{room:h}),d.createElement(Ap,{recurrence:I,dates:x,timeSlot:j,onClickOccurrences:this.showOccurrences,occurrenceCount:z,recurrenceWeekdays:M}),(0,Ep.renderPluginComponents)("rb-booking-detail-extra-fields",{booking:r})),d.createElement(Mt.A.Column,null,d.createElement(d.Fragment,null,p&&this.renderBookedFor(p),_&&this.renderReason(_),h.canUserViewInternalNotes&&this.renderNotes(f),S&&d.createElement(Jp,{id:a}),this.renderBookingHistory(g,b,y),this.renderMessages(e,R))))),N&&this.renderActionButtons(A,w,B,q,O)),d.createElement(Ts.A,{open:t,onClose:this.hideOccurrences,size:"large",closeIcon:!0},d.createElement(Ts.A.Header,{className:"legend-header"},d.createElement(L.Translate,null,"Occurrences"),d.createElement(mn.A,{trigger:d.createElement(T.A,{name:"info circle",className:"legend-info-icon"}),content:d.createElement(Su,{labels:this.getLegendLabels(c),compact:!0})})),d.createElement(Ts.A.Content,null,this.renderTimeline(c,u))),this.renderCancelOccurrence(c.bookings,a),this.renderPreBookingWarning())}}(0,pe.A)(i_,"propTypes",{onClose:y().func,editButton:y().func.isRequired,booking:y().object.isRequired,bookingStateChangeInProgress:y().bool.isRequired,actions:y().exact({deleteBooking:y().func.isRequired,changeBookingOccurrenceState:y().func,changeBookingState:y().func.isRequired,openBookingDetails:y().func.isRequired,fetchBookingDetails:y().func.isRequired}).isRequired,cancelDate:y().string}),(0,pe.A)(i_,"defaultProps",{onClose:()=>{},cancelDate:null});const o_=(0,p.connect)((e=>({bookingStateChangeInProgress:Yl(e)})),(e=>({actions:(0,_e.bindActionCreators)({changeBookingState:rs,changeBookingOccurrenceState:ls,deleteBooking:as,openBookingDetails:e=>Z("booking-details",e,null,!0),fetchBookingDetails:is},e)})))(i_);function r_(e){let{bookingsCount:t,newBookingsCount:n,pastBookingsCount:i}=e;return d.createElement("div",{className:"rb-client-js-common-bookings-___OccurrencesCounter-module__occurrence-count___sUH6D"},d.createElement(mn.A,{trigger:d.createElement(Ll.A,{color:"blue",size:"tiny",content:t,circular:!0}),position:"bottom center",on:"hover"},d.createElement(L.Translate,null,"Number of booking occurrences")),null!==n&&d.createElement("div",null,null!==i&&d.createElement("div",{className:"rb-client-js-common-bookings-___OccurrencesCounter-module__old-occurrences-count___ztnDh"},d.createElement("div",{className:"rb-client-js-common-bookings-___OccurrencesCounter-module__arrow___Dgmp-"},"→"),d.createElement(mn.A,{trigger:d.createElement(Ll.A,{size:"tiny",content:i,color:"orange",circular:!0}),position:"bottom center",on:"hover"},d.createElement(L.Translate,null,"Number of past occurrences that will not be modified"))),d.createElement("div",{className:(0,xt.toClasses)({"new-occurrences-count":!0,"single-arrow":null===i})},d.createElement("div",{className:"rb-client-js-common-bookings-___OccurrencesCounter-module__arrow___Dgmp-"},"→"),d.createElement(mn.A,{trigger:d.createElement(Ll.A,{size:"tiny",content:n,color:"green",circular:!0}),position:"bottom center",on:"hover"},d.createElement(L.Translate,null,"Number of new occurrences after changes")))))}r_.propTypes={bookingsCount:y().number.isRequired,newBookingsCount:y().number,pastBookingsCount:y().number},r_.defaultProps={newBookingsCount:null,pastBookingsCount:null};function a_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a_(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class l_ extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"getLegendLabels",(e=>{const t=e.reduce(((e,t)=>{const n=t.reduce(((e,t)=>{let{availability:n}=t;return Hl()(e,Dr(n))}),[]);return Hl()(e,n)}),[]);return Lr(t)})),(0,pe.A)(this,"serializeRow",(e=>{const{booking:{room:t}}=this.props;return n=>({availability:{bookings:e.bookings[n]||[],cancellations:e.cancellations[n]||[],rejections:e.rejections[n]||[],other:e.other[n]||[],candidates:(e.candidates[n]||[]).map((e=>s_(s_({},e),{},{bookable:!1}))),conflictingCandidates:(e.conflictingCandidates[n]||[]).map((e=>s_(s_({},e),{},{bookable:!1}))),conflicts:e.conflicts[n]||[],pendingCancellations:e.pendingCancellations[n]||[],blockings:e.blockings[n]||[],overridableBlockings:e.overridableBlockings[n]||[],nonbookablePeriods:e.nonbookablePeriods[n]||[],unbookableHours:e.unbookableHours||[]},label:d.createElement(d.Fragment,null,d.createElement("span",{className:"rb-client-js-components-___WeekdayInformation-module__weekday___ohBFC"},cr()(n).format("ddd"))," ",(0,De.serializeDate)(n,"L")),key:n,room:t})})),(0,pe.A)(this,"getCalendarData",(e=>{const{isLoading:t}=this.props,{dateRange:n,data:i}=e;return t?[]:n.map(this.serializeRow(i))})),(0,pe.A)(this,"renderNumberOfOccurrences",(()=>{const{calendars:{currentBooking:{data:{bookings:e,pendingCancellations:t,cancellations:n,rejections:i}}},numberOfBookingOccurrences:o,numberOfCandidates:r,willBookingSplit:a}=this.props,s=a?Object.keys(e).length-Object.keys(t).length-Object.keys(n||{}).length-Object.keys(i||{}).length:null;return d.createElement(r_,{bookingsCount:o,newBookingsCount:r,pastBookingsCount:s})}))}render(){const{willBookingSplit:e,calendars:{currentBooking:t,newBooking:n},isLoading:i}=this.props,o=this.getCalendarData(t),r=n?this.getCalendarData(n):[],a=this.getLegendLabels([o,r]);return d.createElement("div",{className:"rb-client-js-common-bookings-___BookingEditCalendar-module__booking-calendar___Ll9H+"},d.createElement(ro.A,{className:"legend-header"},d.createElement("span",null,d.createElement(L.Translate,null,"Occurrences")),d.createElement(mn.A,{trigger:d.createElement(T.A,{name:"info circle",className:"legend-info-icon"}),position:"right center",content:d.createElement(Su,{labels:a,compact:!0})}),this.renderNumberOfOccurrences()),e&&d.createElement(oo.A,{className:"rb-client-js-common-bookings-___BookingEditCalendar-module__ongoing-booking-explanation___bQEkA",color:"green",icon:!0},d.createElement(T.A,{name:"code branch"}),d.createElement(oo.A.Content,null,d.createElement(L.Translate,null,"Your booking has already started and will be split into:"),d.createElement(Ws.A,{bulleted:!0},d.createElement(Ws.A.Item,null,d.createElement(L.Translate,null,"the original booking, which will be shortened;")),d.createElement(Ws.A.Item,null,d.createElement(L.Translate,null,"a new booking, which will take into account the updated time information."))))),d.createElement("div",{className:"rb-client-js-common-bookings-___BookingEditCalendar-module__calendars___ToNCs"},d.createElement("div",{className:"rb-client-js-common-bookings-___BookingEditCalendar-module__original-booking___o4tLv"},d.createElement($u,{rows:o,renderHeader:n?()=>d.createElement(ro.A,{as:"h3",color:"orange",className:"rb-client-js-common-bookings-___BookingEditCalendar-module__original-booking-header___y8aHS"},d.createElement(L.Translate,null,"Original booking")):null,isLoading:i,fixedHeight:t.dateRange.length>0?"100%":null,hideRecurrence:!0,trim12hMins:!0})),n&&d.createElement("div",{className:"rb-client-js-common-bookings-___BookingEditCalendar-module__new-booking___cZ98B"},d.createElement($u,{rows:r,renderHeader:()=>d.createElement(ro.A,{as:"h3",color:"green",className:"rb-client-js-common-bookings-___BookingEditCalendar-module__new-booking-header___dr+rq"},e?d.createElement(L.Translate,null,"New booking"):d.createElement(L.Translate,null,"Booking after changes")),fixedHeight:n.dateRange.length>0?"100%":null,hideRecurrence:!0,trim12hMins:!0}))))}}(0,pe.A)(l_,"propTypes",{booking:y().object.isRequired,numberOfBookingOccurrences:y().number.isRequired,numberOfCandidates:y().number,willBookingSplit:y().bool.isRequired,calendars:y().object.isRequired,isLoading:y().bool}),(0,pe.A)(l_,"defaultProps",{numberOfCandidates:0,isLoading:!1});const c_=(0,p.connect)(((e,t)=>{let{booking:{id:n}}=t;return{numberOfBookingOccurrences:Ql(e,{bookingId:n})}}))(l_);function u_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u_(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class m_ extends d.Component{constructor(){var e;super(...arguments),e=this,(0,pe.A)(this,"showApprovalWarning",((e,t,n)=>{const i=cr()(t.timeSlot.startTime,"HH:mm"),o=cr()(t.timeSlot.endTime,"HH:mm"),r=cr()(n.timeSlot.startTime,"HH:mm"),a=cr()(n.timeSlot.endTime,"HH:mm");return Object.keys(e).some((e=>"dates"===e||e.startsWith("recurrence.")))||r.isBefore(i)||a.isAfter(o)})),(0,pe.A)(this,"recurrenceTypeChanged",(e=>{const{booking:{startDt:t},onBookingPeriodChange:n,formProps:{form:i,values:{recurrence:o,dates:r,timeSlot:a}}}=this.props,s={dates:r,recurrence:d_(d_({},o),{},{type:e})},l=cr()();["daily","every"].includes(e)&&l.isAfter(t,"day")?r.startDate=(0,De.serializeDate)(t):"single"===e&&(l.isAfter(t,"minute")?r.startDate=(0,De.serializeDate)(l.add(1,"day")):r.startDate=(0,De.serializeDate)(t)),_r(s),i.change("recurrence",s.recurrence),i.change("dates",s.dates),n(s.dates,a,s.recurrence),"every"===e&&"week"===o.interval?this.preselectWeekdayToday(i,!0):i.change("recurrence.weekdays",[])})),(0,pe.A)(this,"clearWeekdays",(e=>{const{formProps:{values:{recurrence:t}}}=this.props,n="month"===e?[]:t.weekdays;return d_(d_({},t),{},{weekdays:n})})),(0,pe.A)(this,"isDateDisabled",(e=>{const{booking:{startDt:t}}=this.props,n=cr()();return n.isSameOrBefore(t,"day")||n.isAfter(t,"day")?!e.isSameOrAfter(n,"day"):!e.isSameOrAfter(t,"day")})),(0,pe.A)(this,"preselectWeekdayToday",(function(t){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{formProps:{values:{recurrence:i}}}=e.props,o=cr()().format("ddd").toLowerCase();if(("every"===i.type&&"week"===i.interval||n)&&(null===i.weekdays||0===i.weekdays.length)){const e=d_(d_({},i),{},{weekdays:[o]});t.change("recurrence.weekdays",e.weekdays)}})),(0,pe.A)(this,"getRecurrenceLabel",(e=>{const{hideOptions:t}=this.props;return t.recurringWeekly&&t.recurringMonthly?null:t.recurringWeekly?[{text:L.PluralTranslate.string("Month","Months",e||0),value:"month"}]:t.recurringMonthly?[{text:L.PluralTranslate.string("Week","Weeks",e||0),value:"week"}]:void 0}))}render(){var e;const{user:t,booking:n,onBookingPeriodChange:i,formProps:o,hideOptions:r,bookingReasonRequired:a,onExtraFieldsChange:s}=this.props,{bookedForUser:l,startDt:c,endDt:u,room:m,isAccepted:h,repetition:p,link:_}=n,{values:{dates:f,recurrence:g,timeSlot:b,usage:y},submitSucceeded:v,submitting:E,form:k,handleSubmit:A}=o,w=null===(e={always:!0,never:!1,not_for_events:!_}[a])||void 0===e||e,D=t.id===l.id,O=cr()(),R=O.isAfter(c,"day"),S=O.isAfter(u,"day"),P="every"===kr(p).type,M=r.recurringWeekly&&r.recurringMonthly,x=2!==["single","daily","recurring"].filter((e=>r[e])).length,j=r.recurringWeekly||r.recurringMonthly;return d.createElement(ws.A,{id:"booking-edit-form",className:"rb-client-js-common-bookings-___BookingEditForm-module__booking-edit-form___osQbb",onSubmit:A},!j&&P&&"every"===g.type&&d.createElement(oo.A,{icon:!0,className:"rb-client-js-common-bookings-___BookingEditForm-module__repeat-frequency-disabled-notice___a8U6P"},d.createElement(T.A,{name:"dont"}),d.createElement(L.Translate,null,"You cannot modify the repeat frequency of an existing booking.")),d.createElement(Ul.A,null,x&&d.createElement(ws.A.Group,{inline:!0},!r.single&&d.createElement(Cs.FinalRadio,{name:"recurrence.type",label:L.Translate.string("Single booking"),value:"single",disabled:v||S,onClick:()=>this.recurrenceTypeChanged("single")}),!r.daily&&d.createElement(Cs.FinalRadio,{name:"recurrence.type",label:L.Translate.string("Daily booking"),value:"daily",disabled:v||S,onClick:()=>this.recurrenceTypeChanged("daily")}),!M&&d.createElement(Cs.FinalRadio,{name:"recurrence.type",label:L.Translate.string("Recurring booking"),value:"every",disabled:v||S,onClick:()=>this.recurrenceTypeChanged("every")})),"every"===g.type&&d.createElement(ws.A.Group,{inline:!0},d.createElement("label",null,d.createElement(L.Translate,null,"Every")),d.createElement(Cs.FinalInput,{name:"recurrence.number",type:"number",min:"1",max:"99",step:"1",validate:Cs.validators.min(1),disabled:v,required:!0,parse:Cs.parsers.number,onChange:e=>{if(e>0){const t=d_(d_({},g),{},{number:e});i(f,b,t)}}}),r.recurringWeekly||r.recurringMonthly?d.createElement("label",null,this.getRecurrenceLabel(g.number).map((e=>e.text))):d.createElement(ks.Field,{name:"recurrence.number",subscription:{}},(e=>{let{input:{value:t}}=e;return d.createElement(Cs.FinalDropdown,{name:"recurrence.interval",disabled:v||P,selection:!0,required:!0,options:[{value:"week",text:L.PluralTranslate.string("Week","Weeks",t||0)},{value:"month",text:L.PluralTranslate.string("Month","Months",t||0)}],onChange:e=>{i(f,b,this.clearWeekdays(e)),this.preselectWeekdayToday(k)}})}))),"single"===g.type?d.createElement(Os.FinalSingleDatePicker,{name:"dates",asRange:!0,onChange:e=>{i(e,b,g)},disabled:v||S,disabledDate:this.isDateDisabled,initialVisibleMonth:()=>cr()(u)}):d.createElement(Os.FinalDatePeriod,{name:"dates",onChange:e=>{i(e,b,this.clearWeekdays(g.interval))},disabled:v||S,disabledDateFields:R?Xs.START_DATE:null,disabledDate:this.isDateDisabled,initialVisibleMonth:()=>cr()(u)}),!r.timeSlot&&d.createElement(Hs,{name:"timeSlot",onChange:e=>{i(f,e,g)},allowPastTimes:!0,disabled:v||S}),d.createElement("div",{style:"every"===g.type&&"week"===g.interval?{}:{display:"none"}},d.createElement("div",{className:"rb-client-js-common-bookings-___BookingEditForm-module__recurring-every-label___4orkq"},d.createElement(L.Translate,null,"Recurring every")),d.createElement(Th,{name:"recurrence.weekdays",requireOneSelected:!0,onChange:e=>{const t=d_(d_({},g),{},{weekdays:e});i(f,b,t)}})),!m.canUserBook&&m.canUserPrebook&&h&&d.createElement(ks.FormSpy,{subscription:{dirtyFields:!0,initialValues:!0,values:!0}},(e=>{let{dirtyFields:t,initialValues:n,values:i}=e;return this.showApprovalWarning(t,n,i)&&d.createElement(oo.A,{warning:!0,visible:!0},d.createElement(oo.A.Header,null,d.createElement(L.Translate,null,"This booking will require approval!")),d.createElement(L.Translate,null,"Changing date or time will revert it back to a pre-booking."))}))),d.createElement(Ul.A,{color:"blue",inverted:!0},d.createElement(ws.A.Group,null,d.createElement(Cs.FinalRadio,{name:"usage",value:"myself",onClick:()=>k.change("user",t.identifier),label:L.Translate.string("I'll be using it myself"),disabled:v,checked:"myself"===y}),d.createElement(Cs.FinalRadio,{name:"usage",value:"someone",onClick:()=>k.change("user",D?null:l.identifier),label:L.Translate.string("I'm booking it for someone else"),disabled:v,checked:"someone"===y})),d.createElement(Cs.FieldCondition,{when:"usage",is:"someone"},d.createElement(C.HM,null,(e=>d.createElement(Os.FinalPrincipal,{name:"user",favoriteUsersController:e,disabled:v,required:!0})))),d.createElement(Cs.FinalTextArea,{name:"reason",nullIfEmpty:!0,placeholder:L.Translate.string("Reason for booking"),required:w,disabled:v})),(0,Ep.renderPluginComponents)("rb-booking-form-extra-fields",{room:m,booking:n,disabled:v||E,onSubmit:e=>s(e)}),m.canUserViewInternalNotes&&d.createElement(Ul.A,{inverted:!0,className:"rb-client-js-common-bookings-___BookingEditForm-module__internal-notes-segment___NYfCF"},d.createElement("p",{style:{marginBottom:"0.5em"}},d.createElement(L.Translate,null,"Internal notes about the booking are only visible to room managers.")),d.createElement(Cs.FinalTextArea,{name:"internalNote",disabled:v})))}}(0,pe.A)(m_,"propTypes",{user:y().object.isRequired,booking:y().object.isRequired,formProps:y().object.isRequired,onBookingPeriodChange:y().func,onExtraFieldsChange:y().func,hideOptions:y().objectOf(y().bool),bookingReasonRequired:y().string.isRequired}),(0,pe.A)(m_,"defaultProps",{onBookingPeriodChange:()=>{},hideOptions:{},onExtraFieldsChange:()=>null});const h_=(0,p.connect)((e=>({user:zi(e),bookingReasonRequired:he(e)})))(h.Ay.component("BookingEditForm",m_));function p_(e){let{rows:t}=e;const n=cr()(),i=Array(t).fill().map(((e,t)=>{const i=n.clone().add(t,"days");return{availability:{candidates:[{startDt:i.set({hour:9,minute:0,second:0}).format(),endDt:i.set({hour:11,minute:0,second:0}).format(),bookable:!1}],conflictingCandidates:[]},key:i.format("YYYY-MM-DD"),room:{id:null,name:"Dummy Room"},label:d.createElement(d.Fragment,null,d.createElement("span",{className:"rb-client-js-components-___WeekdayInformation-module__weekday___ohBFC"},i.format("ddd"))," ",i.format("L"))}}));return d.createElement("div",{className:"rb-client-js-common-bookings-___DummyTimeline-module__blurred-timeline___Wdyvx"},d.createElement($u,{rows:i}))}p_.propTypes={rows:y().number.isRequired},p_.defaultProps={};const __=_.Ay.bind(null,{endpoint:"rb.booking_edit_calendars",rules:[{args:["booking_id"],converters:{booking_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"bookings",isDynamic:!1},{data:"/",isDynamic:!1},{data:"booking_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"edit",isDynamic:!1},{data:"/",isDynamic:!1},{data:"calendars",isDynamic:!1}]}]},"/");function f_(e){let{reason:t}=e;const n={};return t&&t.length<3&&(n.reason=L.Translate.string("Reason must be at least 3 characters")),n}const g_={currentBooking:{dateRange:[],data:{}}};class b_ extends d.Component{constructor(e){super(e),(0,pe.A)(this,"fetchBookingTimelineInfo",(async e=>{const{dates:t,timeSlot:n,recurrence:i}=e,{booking:{id:o}}=this.props,r=hr({timeSlot:n,recurrence:i,dates:t},Pr);let a;try{a=await D.indicoAxios.get(__({booking_id:o}),{params:r})}catch(e){return 418===sr()(e,"response.status")?void this.setState({timelineError:e.response.data.message}):void(0,D.handleAxiosError)(e)}return(0,fe.camelizeKeys)(a.data)})),(0,pe.A)(this,"updateBookingCalendar",(async(e,t,n)=>{this.setState({numberOfCandidates:null,numberOfConflicts:null,skipConflicts:!1,calendars:g_,isLoading:!0,willBookingSplit:!1});const i=await this.fetchBookingTimelineInfo({dates:e,timeSlot:t,recurrence:n});if(!i)return;this.setState({timelineError:null});const{calendars:o,willBeSplit:r}=i,[a,s]=o;this.setState({numberOfCandidates:s?s.data.numDaysAvailable:null,numberOfConflicts:s?s.data.numConflicts:null,isLoading:!1,willBookingSplit:r,calendars:{currentBooking:a,newBooking:s}})})),(0,pe.A)(this,"renderBookingEditModal",(e=>{const{submitting:t,submitSucceeded:n,hasValidationErrors:i,pristine:o}=e,{booking:r,onClose:a,actionButtons:s,isOngoingBooking:l}=this.props,{room:c}=r,{skipConflicts:u,willBookingSplit:m,calendars:h,numberOfConflicts:p,numberOfCandidates:_,isLoading:f,timelineError:g}=this.state,b=t||n||i||o||p>0&&!u;return d.createElement(Ts.A,{size:"large",onClose:a,closeIcon:!0,open:!0},d.createElement(Ts.A.Header,{className:"rb-client-js-common-bookings-___BookingEdit-module__booking-edit-modal-header___kNlMw"},d.createElement(L.Translate,null,"Edit a booking"),s()),d.createElement(Ts.A.Content,null,d.createElement(Mt.A,{stackable:!0,columns:2},d.createElement(Mt.A.Column,null,d.createElement(hp,{room:c}),l&&d.createElement(oo.A,{color:"blue",className:"rb-client-js-common-bookings-___BookingEdit-module__ongoing-booking-info___iay3i",icon:!0},d.createElement(T.A,{name:"play"}),d.createElement(L.Translate,null,"This booking has already started.")),d.createElement(h_,{booking:r,formProps:e,onBookingPeriodChange:this.updateBookingCalendar,onExtraFieldsChange:t=>{this.setState({extraFields:t}),e.form.change("extraFieldsChanged",!0)}}),d.createElement(Cs.FinalField,{name:"extraFieldsChanged",component:()=>null})),d.createElement(Mt.A.Column,{stretched:!g},g?d.createElement(d.Fragment,null,d.createElement("div",null,d.createElement(oo.A,{icon:"times circle outline",error:!0,content:g,style:{marginBottom:"2rem"}})),d.createElement(p_,{rows:10})):h?d.createElement(c_,{calendars:h,booking:r,numberOfCandidates:_,numberOfConflicts:p,willBookingSplit:m,isLoading:f}):null,this.renderConflictsMessage()))),d.createElement(Ts.A.Actions,null,d.createElement(dn.A,{type:"submit",form:"booking-edit-form",disabled:b||f,primary:!0},d.createElement(L.Translate,null,"Save changes")),d.createElement(dn.A,{type:"button",onClick:a},d.createElement(L.Translate,null,"Close"))))})),(0,pe.A)(this,"renderConflictsMessage",(()=>{const{skipConflicts:e,numberOfConflicts:t,numberOfCandidates:n}=this.state;return t?d.createElement("div",{className:"rb-client-js-common-bookings-___BookingEdit-module__booking-conflicts-info___C+lMB"},d.createElement(oo.A,{color:"yellow",attached:!0,icon:!0},d.createElement(T.A,{name:"warning circle"}),d.createElement(oo.A.Content,null,d.createElement(oo.A.Header,null,d.createElement(L.Translate,null,"Conflicts with new booking")),d.createElement(L.PluralTranslate,{count:t},d.createElement(L.Singular,null,"Your new booking conflicts with another one."),d.createElement(L.Plural,null,d.createElement(L.Param,{name:"count",value:t})," occurrences of your booking are unavailable due to conflicts.")))),n>0&&t>0&&d.createElement(Ul.A,{attached:"bottom"},d.createElement(un.A,{toggle:!0,defaultChecked:e,label:L.Translate.string("I understand, please skip any days with conflicting occurrences."),onChange:(e,t)=>{let{checked:n}=t;this.setState({skipConflicts:n})}}))):null})),(0,pe.A)(this,"updateBooking",(async e=>{const{dates:{startDate:t,endDate:n},timeSlot:{startTime:i,endTime:o},user:r,reason:a,recurrence:s,internalNote:l}=e,{actions:{updateBooking:c},booking:{id:u,room:{id:d}},onSubmit:m,isAdminOverrideEnabled:h}=this.props,[p,_]=function(e){let{type:t,number:n,interval:i}=e;return"single"===t?["NEVER",0]:"daily"===t?["DAY",1]:"week"===i?["WEEK",n]:"month"===i?["MONTH",n]:void 0}(s),{extraFields:f}=this.state,g={start_dt:`${t} ${i}`,end_dt:`${n||t} ${o}`,repeat_frequency:p,repeat_interval:_,recurrence_weekdays:s.weekdays,room_id:d,user:r,reason:a||void 0,internal_note:l};null!==f&&(g.extra_fields=f),h&&(g.admin_override_enabled=!0);const b=await c(u,g);if(b.error)return b.error;m()})),this.state={skipConflicts:!1,numberOfConflicts:null,numberOfCandidates:null,willBookingSplit:!1,calendars:null,timelineError:null,extraFields:null}}async componentDidMount(){this.setState({calendars:g_});const{dates:e,timeSlot:t,recurrence:n}=this.initialFormValues,{calendars:[i]}=await this.fetchBookingTimelineInfo({dates:e,timeSlot:t,recurrence:n});this.setState({isLoading:!1,calendars:{currentBooking:i}})}get initialFormValues(){const{user:e,booking:{repetition:t,startDt:n,endDt:i,bookedForUser:o,bookingReason:r,internalNote:a}}=this.props,s=kr(t),l="single"===s.type;return{recurrence:s,dates:{startDate:(0,De.serializeDate)(n),endDate:l?null:(0,De.serializeDate)(i)},timeSlot:{startTime:(0,De.serializeTime)(n),endTime:(0,De.serializeTime)(i)},usage:o.id===e.id?"myself":"someone",user:o.identifier,reason:r,internalNote:a,extraFieldsChanged:!1}}render(){return d.createElement(ks.Form,{onSubmit:this.updateBooking,render:this.renderBookingEditModal,initialValues:this.initialFormValues,initialValuesEqual:cn(),subscription:{submitting:!0,submitSucceeded:!0,hasValidationErrors:!0,pristine:!0,values:!0},validate:f_,keepDirtyOnReinitialize:!0})}}(0,pe.A)(b_,"propTypes",{user:y().object.isRequired,booking:y().object.isRequired,isOngoingBooking:y().bool.isRequired,isAdminOverrideEnabled:y().bool.isRequired,actionButtons:y().func,onSubmit:y().func.isRequired,onClose:y().func,actions:y().exact({updateBooking:y().func.isRequired}).isRequired}),(0,pe.A)(b_,"defaultProps",{actionButtons:()=>{},onClose:()=>{}});const y_=(0,p.connect)(((e,t)=>{let{booking:{id:n}}=t;return{user:zi(e),isOngoingBooking:Xl(e,{bookingId:n}),isAdminOverrideEnabled:Ui(e)}}),(e=>({actions:(0,_e.bindActionCreators)({updateBooking:ss},e)})))(b_);class v_ extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"state",{mode:"view"})}render(){var e=this;const{booking:t,onClose:n,cancelDate:i}=this.props,{mode:o}=this.state,r=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return d.createElement(dn.A,(0,bn.A)({},t,{icon:"pencil",onClick:()=>e.setState({mode:"edit"===o?"view":"edit"}),primary:"edit"===o,circular:!0}))};return"edit"===o?d.createElement(y_,{booking:t,onClose:n,onSubmit:()=>this.setState({mode:"view"}),actionButtons:r}):d.createElement(o_,{booking:t,onClose:n,editButton:r,cancelDate:i})}}(0,pe.A)(v_,"propTypes",{booking:y().object.isRequired,onClose:y().func,cancelDate:y().string}),(0,pe.A)(v_,"defaultProps",{onClose:()=>{},cancelDate:null});const E_=(0,p.connect)(((e,t)=>{let{bookingId:n}=t;return{booking:Kl(e,{bookingId:n})}}))(v_),k_={"booking-details":(e,t,n)=>d.createElement(ic,{bookingId:t,component:E_,onClose:e,cancelDate:n?n.cancel:null})};var A_=n(20469),T_=n.n(A_);function w_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function L_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w_(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const D_=["myBookings","showInactive"],C_=["hideUnused","onlyAuthorized"],O_=e=>{let{calendar:t}=e;return t.filters},R_=(0,jt.Mz)(O_,(e=>be()(e,[...D_,...C_]))),S_=(0,jt.Mz)(O_,(e=>qo()(e,D_))),P_=(0,jt.Mz)(O_,(e=>qo()(e,C_))),M_=e=>{let{calendar:t}=e;return t.requests.calendar.state===G.X_.STARTED},x_=e=>{let{calendar:t}=e;return t.datePicker},j_=(0,jt.Mz)((e=>{let{calendar:{data:t}}=e;return t}),Xo,P_,S_,Wi,((e,t,n,i,o)=>{let{roomIds:r,rows:a}=e,{onlyAuthorized:s}=n,{showInactive:l}=i;if(s){const e=new Set(o);r=r.filter((t=>!e.has(t))),a=a.filter((t=>{let{roomId:n}=t;return!e.has(n)}))}return{roomIds:r,rows:a.map((e=>{const n=t[e.roomId],i=L_({},e);return l||(i.cancellations={},i.rejections={}),[n.id,L_(L_({},i),{},{room:n})]}))}})),I_=e=>{let{calendar:t}=e;return t.activeBookings.rowsLeft},B_=e=>{let{calendar:t}=e;return t.requests.activeBookings.state===G.X_.STARTED},N_=(0,jt.Mz)((e=>{let{calendar:t}=e;return t.activeBookings.data}),Xo,P_,Wi,((e,t,n,i)=>{let{onlyAuthorized:o}=n;const r=new Set(i);return Fo()(Object.entries(e).map((e=>{let[n,i]=e;o&&(i=i.filter((e=>{let{reservation:{roomId:t}}=e;return!r.has(t)})));return[n,i.map((e=>{const n=e.reservation.roomId,{reservation:i}=e;return L_(L_({},e),{},{reservation:L_(L_({},i),{},{room:t[n]})})}))]})))})),F_=e=>{let{calendar:t}=e;return t.view},z_={start_date:{onlyIf:e=>{let{selectedDate:t}=e;return t},serializer:e=>{let{selectedDate:t,mode:n}=e;return(0,De.serializeDate)((0,De.toMoment)(t).startOf(n))}},end_date:{onlyIf:e=>{let{selectedDate:t,mode:n}=e;return t&&"days"!==n},serializer:e=>{let{selectedDate:t,mode:n}=e;return(0,De.serializeDate)((0,De.toMoment)(t).endOf(n))}},my_bookings:{onlyIf:e=>{let{myBookings:t}=e;return t},serializer:e=>{let{myBookings:t}=e;return t}},show_inactive:{onlyIf:e=>{let{showInactive:t}=e;return t},serializer:e=>{let{showInactive:t}=e;return t}},text:{onlyIf:e=>{let{text:t}=e;return t},serializer:e=>{let{text:t}=e;return t}}};function q_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function H_(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q_(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const U_=_.Ay.bind(null,{endpoint:"rb.active_bookings",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"bookings",isDynamic:!1},{data:"/",isDynamic:!1},{data:"active",isDynamic:!1}]}]},"/"),$_=_.Ay.bind(null,{endpoint:"rb.calendar",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"calendar",isDynamic:!1}]}]},"/"),Z_=_.Ay.bind(null,{endpoint:"rb.search_rooms",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"search",isDynamic:!1}]}]},"/"),G_="calendar/CHANGE_VIEW",V_="calendar/SET_DATE",W_="calendar/SET_MODE",K_="calendar/ROWS_RECEIVED",Y_="calendar/FETCH_CALENDAR_REQUEST",X_="calendar/FETCH_CALENDAR_SUCCESS",Q_="calendar/FETCH_CALENDAR_ERROR",J_="calendar/ROOM_IDS_RECEIVED",ef="calendar/FETCH_ACTIVE_BOOKINGS_REQUEST",tf="calendar/FETCH_ACTIVE_BOOKINGS_SUCCESS",nf="calendar/FETCH_ACTIVE_BOOKINGS_ERROR",of="calendar/ACTIVE_BOOKINGS_RECEIVED",rf="calendar/CLEAR_ACTIVE_BOOKINGS";function af(e){return{type:G_,view:e}}function sf(e){return{type:V_,date:e}}function lf(e){return{type:W_,mode:e}}async function cf(e,t){const n=hr(H_({},R_(t)),Pr);let i;Ui(t)&&(n.is_admin=!0);try{i=await D.indicoAxios.get(Z_(),{params:n})}catch(t){const n=(0,D.handleAxiosError)(t);return e({type:Q_,error:n}),[]}const o=i.data.rooms;return e({type:J_,data:o}),o.length||e({type:K_,data:[]}),o}function uf(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return async(t,n)=>{t({type:Y_});const i=n(),{myBookings:o,showInactive:r}=S_(i),{text:a}=R_(i),{data:{roomIds:s},datePicker:l}=i.calendar;let c=s;if(e&&(c=await cf(t,i),!a&&!c.length))return void t({type:X_});const u=hr(H_(H_({},l),{},{myBookings:o,showInactive:r,text:a}),z_);return await(0,G.P$)((()=>D.indicoAxios.post($_(),{room_ids:c},{params:u})),null,[K_,X_],[Q_])(t)}}function df(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return async(n,i)=>{n({type:ef});const o=i(),{myBookings:r}=S_(o),{text:a}=R_(o),{data:{roomIds:s},activeBookings:{data:l}}=o.calendar;let c=s;if(t&&(c=await cf(n,o),!a&&!c.length))return void n({type:tf});const u=hr({myBookings:r,text:a},z_),d={room_ids:c,limit:e};if(Object.keys(l).length){const e=Object.keys(l).reverse()[0];u.start_dt=T_()(l[e],(e=>cr()(e.startDt,"YYYY-MM-DD HH:mm").unix())).startDt,u.last_reservation_id=l[e][l[e].length-1].reservation.id}return await(0,G.P$)((()=>D.indicoAxios.post(U_(),d,{params:u})),null,[of,tf],[nf])(n)}}function mf(){return{type:rf}}class hf extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"state",{linkingConfirm:null}),(0,pe.A)(this,"fetchMoreBookings",(()=>{const{actions:{fetchActiveBookings:e}}=this.props;e(40,!1)})),(0,pe.A)(this,"renderDayBookings",((e,t)=>t.length?d.createElement("div",{className:"rb-client-js-modules-calendar-___CalendarListView-module__day-cards___Dmsa2",key:e},d.createElement(ro.A,{className:"rb-client-js-modules-calendar-___CalendarListView-module__day-cards-header___VhfEV",dividing:!0},d.createElement(T.A,{name:"calendar outline"}),cr()(e,"YYYY-MM-DD").format("dddd, LL")),d.createElement(wl.A.Group,{itemsPerRow:4,stackable:!0,className:"rb-client-js-modules-calendar-___CalendarListView-module__day-cards-container___YeSGb"},t.map((t=>this.renderBooking(t,e)))),d.createElement(eu.A,{hidden:!0})):null)),(0,pe.A)(this,"renderLink",((e,t)=>{const{linkData:n,isAdminOverrideEnabled:i,actions:{linkBookingOccurrence:o}}=this.props;if(!n)return;const{linkingConfirm:r}=this.state,{reservation:a}=e,s=[cr()(n.startDt),cr()(n.endDt)],l=cr()(e.startDt).isBetween(...s,void 0,"[]")&&cr()(e.endDt).isBetween(...s,void 0,"[]"),c=i||a.bookedBySelf||a.bookedForSelf;if(e.linkId||!l||!c)return;const u=d.createElement(dn.A,{icon:d.createElement(T.A,{name:"linkify"}),primary:!0,size:"small",circular:!0,onClick:e=>{e.stopPropagation(),this.setState({linkingConfirm:{reservationId:a.id,day:t,linkId:n.id}})}});return d.createElement(d.Fragment,null,d.createElement(Cu.A,{size:"mini",header:L.Translate.string("Link event"),open:r&&r.reservationId===a.id&&r.day===t,content:L.Translate.string("Are you sure you want to link this event?"),closeOnDimmerClick:!0,closeOnEscape:!0,onClose:e=>{e.stopPropagation(),this.setState({linkingConfirm:null})},onConfirm:e=>{e.stopPropagation(),this.setState({linkingConfirm:null}),o(a.id,t,n.id,i,(()=>this.refetchActiveBookings(!1)))},onCancel:e=>{e.stopPropagation(),this.setState({linkingConfirm:null})},onOpen:e=>e.stopPropagation(),cancelButton:d.createElement(dn.A,{content:L.Translate.string("Cancel")}),confirmButton:d.createElement(dn.A,{content:L.Translate.string("Link")}),closeIcon:!0}),d.createElement("div",{style:{position:"absolute",top:"35%",right:"5px"}},d.createElement(mn.A,{trigger:u,position:"bottom center"},d.createElement(L.Translate,null,"Link to ",d.createElement(L.Param,{name:"bookedFor",wrapper:d.createElement("strong",null),value:n.title})))))})),(0,pe.A)(this,"renderBooking",((e,t)=>{const{linkData:n,actions:{openBookingDetails:i}}=this.props,{reservation:o}=e,{room:r,isAccepted:a}=o,s=`${o.id}-${e.startDt}-${e.endDt}`,l=cr()(e.startDt,"YYYY-MM-DD HH:mm").format("LT"),c=cr()(e.endDt,"YYYY-MM-DD HH:mm").format("LT");return d.createElement(wl.A,{className:"rb-client-js-modules-calendar-___CalendarListView-module__booking-card___y5JkI",key:s,onClick:()=>i(o.id)},d.createElement(wl.A.Content,null,d.createElement(wl.A.Header,null,!a&&d.createElement(mn.A,{trigger:d.createElement(Ll.A,{color:"yellow",icon:"clock",corner:"right",size:"tiny"}),content:L.Translate.string("This booking is pending confirmation by the room owner"),position:"right center"}),d.createElement(Os.TooltipIfTruncated,null,d.createElement("div",{className:"rb-client-js-modules-calendar-___CalendarListView-module__booking-card-header___Sg-X1"},r.fullName))),d.createElement(wl.A.Meta,null,l," - ",c),d.createElement(wl.A.Description,null,o.bookingReason)),d.createElement(wl.A.Content,{extra:!0},d.createElement(Os.TooltipIfTruncated,null,d.createElement("div",{className:"rb-client-js-modules-calendar-___CalendarListView-module__booking-booked-for___ck-2w"},d.createElement(L.Translate,null,"Booked for ",d.createElement(L.Param,{name:"bookedFor",value:o.bookedForName})))),n&&!!e.linkId&&d.createElement(Os.TooltipIfTruncated,null,d.createElement("div",{className:"rb-client-js-modules-calendar-___CalendarListView-module__booking-booked-for___ck-2w"},d.createElement(L.Translate,null,"Already linked")))),this.renderLink(e,t))}))}componentDidMount(){const{actions:{fetchActiveBookings:e}}=this.props;e(40)}componentDidUpdate(e){const{datePicker:{selectedDate:t,mode:n},roomFilters:i,calendarFilters:o}=e,{datePicker:{selectedDate:r,mode:a},roomFilters:s,calendarFilters:l}=this.props,c=!cn()(i,s),u=!cn()(o,l);(t!==r||a!==n||c||u)&&this.refetchActiveBookings(c)}componentWillUnmount(){const{actions:{clearActiveBookings:e}}=this.props;e()}refetchActiveBookings(e){const{actions:{fetchActiveBookings:t,clearActiveBookings:n}}=this.props;n(),t(40,e)}render(){const{bookings:e,rowsLeft:t,isFetchingActiveBookings:n}=this.props,i=g()(Object.entries(e),(e=>e[0])),o=0!==Object.keys(i).length;return d.createElement("div",{className:"rb-client-js-modules-calendar-___CalendarListView-module__active-bookings___EZuXS"},(n||o)&&d.createElement(Qc.Ay,{hasMore:t>0,loadMore:this.fetchMoreBookings,isFetching:n},i.map((e=>this.renderDayBookings(...e))),n&&d.createElement(ld.Group,{count:40,itemsPerRow:4,withImage:!1})),!n&&!o&&d.createElement(oo.A,{info:!0},d.createElement(L.Translate,null,"There are no bookings matching the criteria.")))}}(0,pe.A)(hf,"propTypes",{bookings:y().object.isRequired,rowsLeft:y().number.isRequired,isFetchingActiveBookings:y().bool.isRequired,roomFilters:y().object.isRequired,calendarFilters:y().object.isRequired,datePicker:y().object.isRequired,linkData:y().object,isAdminOverrideEnabled:y().bool.isRequired,actions:y().exact({openBookingDetails:y().func.isRequired,linkBookingOccurrence:y().func.isRequired,fetchActiveBookings:y().func.isRequired,clearActiveBookings:y().func.isRequired}).isRequired}),(0,pe.A)(hf,"defaultProps",{linkData:null});const pf=(0,p.connect)((e=>({bookings:N_(e),rowsLeft:I_(e),isFetchingActiveBookings:B_(e),roomFilters:R_(e),calendarFilters:S_(e),datePicker:x_(e),linkData:hc(e),isAdminOverrideEnabled:Ui(e)})),(e=>({actions:(0,_e.bindActionCreators)({openBookingDetails:os,linkBookingOccurrence:cs,fetchActiveBookings:df,clearActiveBookings:mf},e)})))(hf),_f=hd("calendar",s),ff=oh("calendar",s);class gf extends d.Component{constructor(e){super(e),(0,pe.A)(this,"onAddSlot",(e=>{let{room:t,slotStartTime:n,slotEndTime:i}=e;const{datePicker:{selectedDate:o},actions:{openBookRoom:r}}=this.props;r(t.id,{dates:{startDate:o,endDate:null},timeSlot:{startTime:n,endTime:i},recurrence:{type:"single"},isPrebooking:!t.canUserBook})})),(0,pe.A)(this,"toggleHideUnused",(()=>{const{localFilters:{hideUnused:e},actions:{setFilterParameter:t}}=this.props;t("hideUnused",!e)})),(0,pe.A)(this,"toggleShowInactive",(()=>{const{calendarFilters:{showInactive:e},actions:{setFilterParameter:t}}=this.props;t("showInactive",!e)})),(0,pe.A)(this,"getLegendLabels",((e,t)=>{const n=t?[]:["rejections","cancellations"],i=e.reduce(((e,t)=>{let[,n]=t;return Hl()(e,Dr(n))}),[]);return Lr(i,n)})),(0,pe.A)(this,"renderExtraButtons",(()=>{const{calendarFilters:{myBookings:e,showInactive:t},localFilters:{hideUnused:n},actions:{setFilterParameter:i},isFetching:o,isFetchingActiveBookings:r}=this.props,{view:a}=this.props;return d.createElement(dn.A.Group,{size:"small"},d.createElement(Os.ResponsivePopup,{trigger:d.createElement(dn.A,{primary:e,icon:"user circle",disabled:o||r,onClick:()=>i("myBookings",!e||null)})},d.createElement(L.Translate,null,"Show only my bookings")),"timeline"===a&&d.createElement(d.Fragment,null,d.createElement(Os.ResponsivePopup,{trigger:d.createElement(dn.A,{primary:t,icon:"ban",disabled:o,onClick:this.toggleShowInactive})},t?d.createElement(L.Translate,null,"Hide rejected/cancelled bookings"):d.createElement(L.Translate,null,"Show rejected/cancelled bookings")),d.createElement(Os.ResponsivePopup,{trigger:d.createElement(dn.A,{primary:n,icon:n?"plus square outline":"minus square outline",disabled:o,onClick:this.toggleHideUnused})},n?d.createElement(L.Translate,null,"Show unused spaces"):d.createElement(L.Translate,null,"Hide unused spaces"))))})),(0,pe.A)(this,"renderViewSwitch",(()=>{const{view:e,actions:{changeView:t,setFilterParameter:n},isFetching:i,isFetchingActiveBookings:o}=this.props,r=d.createElement(dn.A,{icon:d.createElement(T.A,{name:"calendar"}),primary:"timeline"===e,onClick:()=>t("timeline"),disabled:i||o,size:"small",circular:!0}),a=d.createElement(dn.A,{icon:d.createElement(T.A,{name:"list"}),primary:"list"===e,onClick:()=>{n("showInactive",null),t("list")},disabled:i||o,size:"small",circular:!0});return d.createElement("div",{className:"rb-client-js-modules-calendar-___Calendar-module__view-switch___07How"},d.createElement(xt.Responsive.Tablet,{andLarger:!0,orElse:"timeline"===e?a:r},d.createElement(mn.A,{trigger:r,position:"bottom center"},d.createElement(L.Translate,null,"Show calendar view")),d.createElement(mn.A,{trigger:a,position:"bottom center"},d.createElement(L.Translate,null,"Show a list of all upcoming bookings"))))})),this.contextRef=d.createRef()}componentDidMount(){const{actions:{fetchCalendar:e}}=this.props;e()}componentDidUpdate(e){const{datePicker:{selectedDate:t,mode:n},roomFilters:i,calendarFilters:o}=e,{datePicker:{selectedDate:r,mode:a},roomFilters:s,calendarFilters:l,actions:{fetchCalendar:c}}=this.props,u=!cn()(i,s),d=!cn()(o,l);(t!==r||a!==n||u||d)&&c(u)}render(){const{view:e,isFetching:t,isFetchingActiveBookings:n,localFilters:{hideUnused:i},calendarFilters:{showInactive:o},roomFilters:{text:r},calendarData:{rows:a},actions:{openRoomDetails:s,setDate:l,openBookingDetails:c,setMode:u},datePicker:m,allowDragDrop:h}=this.props,p="days"===m.mode&&h,_="timeline"===e;return d.createElement(Mt.A,null,d.createElement(Mt.A.Row,{className:"rb-client-js-modules-calendar-___Calendar-module__row___92Vfe"},d.createElement(Pt.A,null,d.createElement("div",{ref:this.contextRef},d.createElement(Os.StickyWithScrollBack,{context:this.contextRef.current,responsive:!0},d.createElement(Mt.A.Row,{className:"rb-client-js-modules-calendar-___Calendar-module__calendar-filters___LoBAD"},d.createElement("div",{className:"filter-row"},d.createElement("div",{className:"filter-row-filters"},d.createElement(ff,{disabled:t||n}),this.renderExtraButtons(),d.createElement(_f,{disabled:t||n}))),this.renderViewSwitch()),_&&d.createElement(sd,{datePicker:m,disableDatePicker:t||!a.length&&!r,onModeChange:u,onDateChange:l,legendLabels:this.getLegendLabels(a,o)})),_?d.createElement(rd,{availability:a,datePicker:m,onClickLabel:s,isLoading:t,onClickReservation:c,onAddSlot:p?this.onAddSlot:null,showUnused:!i,setDate:l,setMode:u,longLabel:!0}):d.createElement(pf,null)))))}}(0,pe.A)(gf,"propTypes",{calendarData:y().object.isRequired,datePicker:y().object.isRequired,isFetching:y().bool.isRequired,isFetchingActiveBookings:y().bool.isRequired,roomFilters:y().object.isRequired,calendarFilters:y().object.isRequired,localFilters:y().shape({hideUnused:y().bool.isRequired}).isRequired,allowDragDrop:y().bool,view:y().oneOf(["timeline","list"]).isRequired,actions:y().exact({fetchCalendar:y().func.isRequired,setDate:y().func.isRequired,setMode:y().func.isRequired,openRoomDetails:y().func.isRequired,openBookRoom:y().func.isRequired,openBookingDetails:y().func.isRequired,setFilterParameter:y().func.isRequired,changeView:y().func.isRequired}).isRequired}),(0,pe.A)(gf,"defaultProps",{allowDragDrop:!0});const bf=(0,p.connect)((e=>({isFetching:M_(e),isFetchingActiveBookings:B_(e),calendarData:j_(e),roomFilters:R_(e),calendarFilters:S_(e),localFilters:P_(e),datePicker:x_(e),view:F_(e)})),(e=>({actions:(0,_e.bindActionCreators)({fetchCalendar:uf,setDate:e=>sf((0,De.serializeDate)(e)),setMode:lf,openRoomDetails:Io,openBookRoom:Pa,openBookingDetails:os,setFilterParameter:(e,t)=>Ee("calendar",e,t),changeView:af},e)})))(h.Ay.component("Calendar",gf));var yf=n(81285),vf=n.n(yf);function Ef(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function kf(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ef(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ef(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Af=()=>kf(kf({},Hh),{},{selectedDate:(0,De.serializeDate)(cr()())}),Tf={rows:[],roomIds:[]},wf={rowsLeft:0,data:{}};function Lf(e,t,n){return e.map((e=>{if(e.roomId!==n)return e;const i=kf({},e);return Object.keys(e).filter((e=>!["unbookableHours","nonbookablePeriods"].includes(e))).forEach((n=>{const o=e[n];if(Object.keys(o).length)for(const e of Object.keys(o)){const r=o[e]||[];i[n][e]=r.filter((e=>e.reservation.id!==t))}})),i}))}function Df(e,t,n,i,o){return e.map((e=>{if(e.roomId!==t)return e;const r=vf()(e),a="cancelled"===n?"cancellations":"rejections";for(const e of["bookings","preBookings"]){const t=r[e];for(const[n,s]of Object.entries(t)){const t=s.findIndex(o);-1!==t&&(r[a][n]=[...r[a][n]||[],kf(kf({},s[t]),{},{isValid:!1,rejectionReason:i})],r[e][n].splice(t,1))}}return r}))}const Cf=(0,_e.combineReducers)({requests:(0,_e.combineReducers)({calendar:(0,G.Od)(Y_,X_,Q_),activeBookings:(0,G.Od)(ef,tf,nf)}),filters:we("calendar",au,ru),activeBookings:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wf,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case of:{const{bookings:n,rowsLeft:i}=(0,fe.camelizeKeys)(t.data),{data:o}=e,r=kf({},o);return Object.entries(n).forEach((e=>{let[t,n]=e;r[t]=t in r?[...r[t],...n]:n})),kf(kf({},e),{},{data:r,rowsLeft:i})}case rf:return kf(kf({},e),{},{data:{},rowsLeft:0});case es:{const{bookingId:n}=(0,fe.camelizeKeys)(t.data),{data:i}=e,o={};return Object.entries(i).forEach((e=>{let[t,i]=e;const r=i.filter((e=>{let{reservation:{id:t}}=e;return t!==n}));r.length&&(o[t]=r)})),kf(kf({},e),{},{data:o})}case Ja:{const{booking:{id:n,state:i}}=(0,fe.camelizeKeys)(t.data),{data:o}=e,r={};return"rejected"===i||"cancelled"===i?Object.entries(o).forEach((e=>{let[t,i]=e;i.filter((e=>{let{reservation:{id:t}}=e;return t!==n})).length&&(r[t]=i.filter((e=>{let{reservation:{id:t}}=e;return t!==n})))})):Object.entries(o).forEach((e=>{let[t,i]=e;r[t]=i.map((e=>{const{reservation:t}=e,i=t.id,o=kf({},t);return i===n&&(o.isAccepted=!0),kf(kf({},e),{},{reservation:o})}))})),kf(kf({},e),{},{data:r})}default:return e}},data:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Tf,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Je:return Tf;case Y_:return kf(kf({},e),{},{rows:[]});case K_:return kf(kf({},e),{},{rows:(0,fe.camelizeKeys)(t.data)});case J_:return kf(kf({},e),{},{roomIds:t.data.slice()});case es:{const{bookingId:n,roomId:i}=(0,fe.camelizeKeys)(t.data),{rows:o}=e;return kf(kf({},e),{},{rows:Lf(o,n,i)})}case Ja:{const{booking:n}=(0,fe.camelizeKeys)(t.data),{id:i,roomId:o,state:r}=n,{rows:a}=e;let s;return"rejected"===r||"cancelled"===r?s=Df(a,o,r,n.rejectionReason,(e=>e.reservation.id===i)):"accepted"===r&&(s=function(e,t,n){return e.map((e=>{if(e.roomId!==n)return e;const i=kf({},e),o=e.preBookings;for(const e of Object.keys(o)){const n=o[e],r=n.find((e=>e.reservation.id===t));e in i.bookings||(i.bookings[e]=[]),i.bookings[e]=[...i.bookings[e],r],i.preBookings[e]=n.filter((e=>e.reservation.id!==t))}return i}))}(a,i,o)),kf(kf({},e),{},{rows:s})}case ns:{const{occurrence:n}=(0,fe.camelizeKeys)(t.data),{reservation:i,state:o,startDt:r}=n,{roomId:a,id:s}=i,{rows:l}=e,c=Df(l,a,o,n.rejectionReason,(e=>{const{reservation:{id:t},startDt:n}=e;return s===t&&(0,De.serializeTime)(n)===(0,De.serializeTime)(r)&&(0,De.serializeDate)(n)===(0,De.serializeDate)(r)}));return kf(kf({},e),{},{rows:c})}case Ur:{const n=(0,fe.camelizeKeys)(t.data),{roomId:i,calendarData:o}=n,{rows:r}=e,a=r.map((e=>{if(e.roomId!==i)return e;const t=kf({},e);for(const e of["bookings","preBookings"]){if(!(e in o))continue;const n=o[e];for(const i of Object.keys(n)){const o=t[e][i]||[];t[e][i]=[...o,...n[i]]}}return t}));return kf(kf({},e),{},{rows:a})}case ts:{const{roomCalendar:n}=(0,fe.camelizeKeys)(t.data),{rows:i}=e,o=i.map((e=>e.roomId===n[0].roomId?n[0]:e));return kf(kf({},e),{},{rows:o})}default:return e}},datePicker:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Af(),t=arguments.length>1?arguments[1]:void 0;switch(t.type){case V_:return kf(kf({},e),{},{dateRange:[],selectedDate:t.date});case W_:return kf(kf({},e),{},{mode:t.mode});case U:return Af()}return e},view:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"timeline",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case G_:return t.view;case U:return"timeline";default:return e}}}),Of=_.Ay.bind(null,{endpoint:"rb.room_stats",rules:[{args:["room_id"],converters:{room_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"room_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"stats",isDynamic:!1}]}]},"/");class Rf extends d.PureComponent{constructor(){super(...arguments),(0,pe.A)(this,"state",{loaded:!1,data:{}})}componentDidMount(){const{roomId:e}=this.props;this.fetchStatsData(e)}async fetchStatsData(e){let t;try{t=await D.indicoAxios.get(Of({room_id:e}))}catch(e){return void(0,D.handleAxiosError)(e)}this.setState({loaded:!0,data:(0,fe.camelizeKeys)(t.data)})}renderPlaceholder(){return d.createElement(Mt.A,{columns:2,stackable:!0},wu()(0,2).map((e=>d.createElement(Mt.A.Column,{key:e},d.createElement(Du.A,{className:"rb-client-js-common-rooms-___RoomStats-module__placeholder___T1UDF"},d.createElement(Du.A.Line,{length:"long"}),wu()(0,3).map((e=>d.createElement(Du.A.Paragraph,{key:e},d.createElement(Du.A.Line,{length:"medium"}),d.createElement(Du.A.Line,{length:"very short"})))))))))}render(){const{loaded:e,data:t}=this.state,n={times_booked:{title:L.Translate.string("Times booked")},occupancy:{title:L.Translate.string("Occupancy"),note:L.Translate.string("excluding weekends")}},i=Object.values(t).map((e=>{let{values:t}=e;return t})).some((e=>!!e.length));return e?i&&d.createElement(d.Fragment,null,d.createElement(ro.A,null,d.createElement(L.Translate,null,"Statistics")),d.createElement("div",{className:"rb-client-js-common-rooms-___RoomStats-module__room-stats___ODsU2"},Object.entries(t).map((e=>{let[t,{id:i,values:o,note:r}]=e;return d.createElement("div",{key:t,className:"rb-client-js-common-rooms-___RoomStats-module__stats-box___hYOOu"},d.createElement("div",{className:"rb-client-js-common-rooms-___RoomStats-module__title___C5NHH"},n[i].title,r&&"*"),o.map((e=>{let{days:n,value:i}=e;return d.createElement("div",{className:"rb-client-js-common-rooms-___RoomStats-module__value-box___ry6qT",key:`${n}-${i}`},d.createElement("div",{className:"rb-client-js-common-rooms-___RoomStats-module__days___mJBSX"},d.createElement(L.PluralTranslate,{count:n},d.createElement(L.Singular,null,"Last day"),d.createElement(L.Plural,null,"Last ",d.createElement(L.Param,{name:"days",value:n})," days"))),d.createElement("div",{className:"rb-client-js-common-rooms-___RoomStats-module__value___fHAhf"},Math.round(i),"percentage"===t?"%":""))})),r&&d.createElement("div",{className:"rb-client-js-common-rooms-___RoomStats-module__note___5jNFD"},"* ",n[i].note))})))):this.renderPlaceholder()}}(0,pe.A)(Rf,"propTypes",{roomId:y().number.isRequired});class Sf extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"state",{roomEditVisible:!1}),(0,pe.A)(this,"showRoomEditModal",(()=>{this.setState({roomEditVisible:!0})})),(0,pe.A)(this,"handleCloseRoomEditModal",(()=>{this.setState({roomEditVisible:!1})})),(0,pe.A)(this,"handleCloseModal",(()=>{const{onClose:e}=this.props;e()}))}render(){const{room:e,availability:t,attributes:n,promptDatesOnBook:i,title:o,gotoAllBookings:r,actions:{openBookRoom:a,openBookingForm:s,openBookingDetails:l}}=this.props,{roomEditVisible:c}=this.state;return c?d.createElement(Tl,{roomId:e.id,locationId:e.locationId,onClose:this.handleCloseRoomEditModal}):d.createElement(Ts.A,{onClose:this.handleCloseModal,size:"large",closeIcon:!0,open:!0},d.createElement(Ts.A.Header,{className:"rb-client-js-common-rooms-___RoomDetailsModal-module__room-details-header___g4ahn"},o,d.createElement(xt.Responsive.Tablet,{andLarger:!0},e.canUserEdit&&d.createElement(dn.A,{icon:"pencil",circular:!0,onClick:this.showRoomEditModal}))),d.createElement(Ts.A.Content,null,d.createElement(xf,{room:e,attributes:n,availability:t,bookRoom:i?a:s,gotoAllBookings:r,onClickReservation:l})))}}(0,pe.A)(Sf,"propTypes",{room:y().object.isRequired,availability:y().array.isRequired,attributes:y().array.isRequired,onClose:y().func.isRequired,promptDatesOnBook:y().bool,title:xt.IndicoPropTypes.i18n,gotoAllBookings:y().func.isRequired,actions:y().exact({openBookRoom:y().func.isRequired,openBookingForm:y().func.isRequired,openBookingDetails:y().func.isRequired}).isRequired}),(0,pe.A)(Sf,"defaultProps",{promptDatesOnBook:!1,title:d.createElement(L.Translate,null,"Room Details")});const Pf=(0,p.connect)(((e,t)=>{let{roomId:n}=t;return{room:Qo(e,{roomId:n}),availability:Jo(e,{roomId:n}),attributes:er(e,{roomId:n})}}),(e=>({gotoAllBookings(t,n){e($("calendar")),e(Ee("calendar","text",`#${t}`)),e(sf((0,De.serializeDate)(cr()().startOf("month")))),e(lf("months")),e(z(n))},actions:(0,_e.bindActionCreators)({openBookRoom:Pa,openBookingForm:xa,openBookingDetails:os},e)})))(h.Ay.component("RoomDetailsModal",Sf)),Mf=e=>{const t=e.reduce(((e,t)=>Hl()(e,Dr(t))),[]);return Lr(t)};function xf(e){let{bookRoom:t,room:n,availability:i,attributes:o,gotoAllBookings:r,onClickReservation:a}=e;const s=Mf(i),l={text:`#${n.id}`,mode:"months",date:(0,De.serializeDate)(cr()().startOf("month"))},c=`calendar?${E().stringify(l)}`,{isPhone:u}=(0,xt.useResponsive)();return d.createElement("div",{className:"rb-client-js-common-rooms-___RoomDetailsModal-module__room-details___A6vym"},d.createElement(Mt.A,{stackable:!0,columns:2},d.createElement(Mt.A.Column,null,d.createElement("div",null,d.createElement(hp,{room:n}),d.createElement(h.Ay,{id:"RoomDetails.infoBoxes",room:n},d.createElement(d.Fragment,null,d.createElement(jf,{room:n}),d.createElement(If,{room:n}),d.createElement(Yp,{room:n}),d.createElement(Bf,{attributes:o}))))),d.createElement(Mt.A.Column,null,d.createElement(ro.A,{className:"legend-header"},d.createElement(L.Translate,null,"Usage"),!u&&d.createElement(mn.A,{trigger:d.createElement(T.A,{name:"info circle",className:"legend-info-icon"}),content:d.createElement(Su,{labels:s,compact:!0})}),d.createElement(dn.A,{as:"a",href:c,basic:!0,size:"tiny",compact:!0,color:"blue",className:"rb-client-js-common-rooms-___RoomDetailsModal-module__all-bookings___0DF4U",onClick:e=>{0===e.button&&(e.preventDefault(),r(n.id,c))}},d.createElement(L.Translate,null,"See all bookings"))),d.createElement(xt.Responsive.Tablet,{andLarger:!0},d.createElement($u,{rows:i.map((e=>{let{bookings:t,preBookings:i,nonbookablePeriods:o,unbookableHours:r,blockings:a,overridableBlockings:s,day:l}=e;return{availability:{bookings:t||[],preBookings:i||[],nonbookablePeriods:o||[],unbookableHours:r||[],blockings:a||[],overridableBlockings:s||[]},label:d.createElement(d.Fragment,null,d.createElement("span",{className:"rb-client-js-components-___WeekdayInformation-module__weekday___ohBFC"},cr()(l).format("ddd"))," ",cr()(l).format("L")),key:l,room:n}})),onClickReservation:a,trim12hMins:!0})),d.createElement(Rf,{roomId:n.id}),(n.canUserBook||n.canUserPrebook)&&d.createElement(d.Fragment,null,d.createElement(oo.A,{attached:!0,info:!0},d.createElement(T.A,{name:"info"}),d.createElement(L.Translate,null,"Would you like to use this space?")),d.createElement(Ul.A,{attached:"bottom"},n.canUserBook&&d.createElement(dn.A,{color:"green",onClick:()=>t(n.id,{isPrebooking:!1})},d.createElement(T.A,{name:"check circle"}),d.createElement(L.Translate,null,"Start booking")),n.canUserPrebook&&d.createElement(dn.A,{color:"orange",onClick:()=>t(n.id,{isPrebooking:!0})},d.createElement(T.A,{name:"check circle"}),d.createElement(L.Translate,null,"Start pre-booking")))))))}function jf(e){let{room:t}=e;return t.canUserBook||t.canUserPrebook?d.createElement(oo.A,{positive:!0,className:"rb-client-js-common-rooms-___RoomDetailsModal-module__message-icon___+nQHp",icon:"unlock",content:d.createElement(d.Fragment,null,d.createElement("p",null,t.isPublic?d.createElement(L.Translate,null,"Anyone can book this space."):d.createElement(L.Translate,null,"You can book this space.")),t.maxAdvanceDays&&d.createElement("p",null,d.createElement(L.Translate,null,"Max. ",d.createElement(L.Param,{name:"max_advance_days",value:t.maxAdvanceDays})," days in advance")))}):t.isReservable?d.createElement(oo.A,{negative:!0,className:"rb-client-js-common-rooms-___RoomDetailsModal-module__message-icon___+nQHp",icon:"lock",content:L.Translate.string("You are not authorized to book this space.")}):d.createElement(oo.A,{negative:!0,className:"rb-client-js-common-rooms-___RoomDetailsModal-module__message-icon___+nQHp",icon:"exclamation triangle",content:L.Translate.string("This space cannot be booked at the moment.")})}function If(e){let{room:t}=e;return t.comments&&d.createElement(oo.A,{className:"rb-client-js-common-rooms-___RoomDetailsModal-module__message-icon___+nQHp",icon:!0,info:!0},d.createElement(T.A,{name:"info"}),d.createElement(oo.A.Content,null,d.createElement(xt.Markdown,{targetBlank:!0},t.comments)))}function Bf(e){let{attributes:t}=e;return!!t.length&&d.createElement(oo.A,null,d.createElement(Ws.A,null,t.map((e=>{let{title:t,value:n}=e;return d.createElement(Ws.A.Item,{key:t},d.createElement("span",{className:"rb-client-js-common-rooms-___RoomDetailsModal-module__attribute-title___+SYAh"},d.createElement("strong",null,t)),d.createElement("span",null,n))}))))}xf.propTypes={bookRoom:y().func.isRequired,room:y().object.isRequired,availability:y().array.isRequired,attributes:y().array.isRequired,gotoAllBookings:y().func.isRequired,onClickReservation:y().func.isRequired},jf.propTypes={room:y().object.isRequired},If.propTypes={room:y().object.isRequired},Bf.propTypes={attributes:y().arrayOf(y().shape({title:y().string.isRequired,value:y().string.isRequired})).isRequired};const Nf={"room-details":(e,t)=>d.createElement(_s,{roomId:t},(()=>d.createElement(Pf,{roomId:t,onClose:e,promptDatesOnBook:!0}))),"room-details-book":(e,t)=>d.createElement(_s,{roomId:t},(()=>d.createElement(Pf,{roomId:t,onClose:e})))};function Ff(){return d.createElement(ao.A,null,d.createElement(ao.A.Image,null,d.createElement(Du.A,null,d.createElement(Du.A.Image,null))),d.createElement(ao.A.Content,null,d.createElement(Du.A,null,d.createElement(Du.A.Line,{length:"very short"})),d.createElement(ao.A.Meta,null,d.createElement(Du.A,null,d.createElement(Du.A.Line,{length:"short"}))),d.createElement(ao.A.Description,null,d.createElement(Du.A,null,d.createElement(Du.A.Line,{length:"full"}),d.createElement(Du.A.Line,{length:"full"})))))}function zf(e){let{count:t}=e;return d.createElement(ao.A.Group,null,wu()(0,t).map((e=>d.createElement(Ff,{key:e}))))}zf.propTypes={count:y().number.isRequired},Ff.Group=zf;function qf(e){let{room:t,locationId:n,deleteRoom:i,fetchRooms:o}=e;const[r,a]=(0,d.useState)(!1),[s,l]=(0,d.useState)(!1);return d.createElement(ao.A,{key:t.id,className:"rb-client-js-modules-admin-___AdminRoomItem-module__room-item___0u6hg"},d.createElement(ao.A.Image,{size:"small",className:"rb-client-js-modules-admin-___AdminRoomItem-module__room-item-image___Km39b"},d.createElement(xl,{pos:t.spritePosition,width:"100%",height:"100%"})),d.createElement(ao.A.Content,null,d.createElement(ao.A.Header,{className:"rb-client-js-modules-admin-___AdminRoomItem-module__room-item-header___u0JDX"},t.fullName,d.createElement("div",null,d.createElement(dn.A,{size:"mini",icon:"pencil",circular:!0,onClick:()=>a(!0)}),d.createElement(dn.A,{size:"mini",icon:"trash",negative:!0,circular:!0,onClick:()=>l(!0)}))),d.createElement(ao.A.Meta,null,t.ownerName),d.createElement(ao.A.Description,null,t.comments)),r&&d.createElement(Tl,{roomId:t.id,locationId:n,onClose:e=>{e&&o(),a(!1)}}),d.createElement(Cu.A,{header:L.Translate.string("Confirm deletion"),content:L.Translate.string("Are you sure you want to delete this room?"),confirmButton:d.createElement(dn.A,{content:L.Translate.string("Delete"),negative:!0}),cancelButton:L.Translate.string("Cancel"),open:s,onCancel:()=>l(!1),onConfirm:()=>i(t.id)}))}qf.propTypes={room:y().object.isRequired,locationId:y().number.isRequired,deleteRoom:y().func.isRequired,fetchRooms:y().func.isRequired};const Hf=(0,p.connect)(null,{deleteRoom:function(e){return(0,G.P$)((()=>D.indicoAxios.delete(Ie({room_id:e}))),null,(()=>({type:Je,id:e})))},fetchRooms:kt})(qf);function Uf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function $f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Uf(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Zf=e=>(t,n)=>t[e].localeCompare(n[e]),Gf=e=>{let{admin:t}=e;return t.locations},Vf=e=>{let{admin:t}=e;return t.rooms},Wf=(0,jt.Mz)(Gf,Vf,((e,t)=>e.sort(Zf("name")).map((e=>$f($f({},e),{},{numRooms:t.filter((t=>t.locationId===e.id)).length}))))),Kf=(0,jt.Mz)(Gf,Vf,((e,t)=>{let{locationId:n}=t;return n}),((e,t,n)=>{const i=e.find((e=>e.id===n));return i?$f($f({},i),{},{rooms:t.filter((e=>e.locationId===i.id))}):null})),Yf=e=>(e=>{let{admin:t}=e;return t.requests.locations.state===G.X_.STARTED&&!t.requests.locations.reloading})(e)||(e=>{let{admin:t}=e;return t.requests.rooms.state===G.X_.STARTED&&!t.requests.rooms.reloading})(e),Xf=e=>{let{admin:t}=e;return t.filters},Qf=e=>{let{admin:t}=e;return t.equipmentTypes},Jf=e=>{let{admin:t}=e;return t.features},eg=(0,jt.Mz)(Jf,(e=>Fo()(e.map((e=>[e.id,e]))))),tg=(0,jt.Mz)(Qf,eg,((e,t)=>e.map((e=>$f($f({},e),{},{features:e.features.map((e=>t[e])).sort(Zf("title"))}))).sort(Zf("name")))),ng=(0,jt.Mz)(Qf,Jf,((e,t)=>t.map((t=>$f($f({},t),{},{numEquipmentTypes:e.filter((e=>e.features.includes(t.id))).length}))).sort(Zf("title")))),ig=e=>{let{admin:t}=e;return t.requests.equipmentTypes.state===G.X_.STARTED||t.requests.features.state===G.X_.STARTED},og=e=>{let{admin:t}=e;return t.requests.attributes.state===G.X_.STARTED},rg=e=>{let{admin:t}=e;return t.attributes},ag=(0,jt.Mz)(rg,(e=>e.slice().sort(Zf("title")))),sg=e=>{let{admin:t}=e;return t.requests.settings.state===G.X_.SUCCESS},lg=e=>{let{admin:t}=e;return t.settings},cg=hd("admin",l);function ug(e){let{location:t,isFetching:n,fetchRooms:i,filters:{text:o}}=e;const[r,a]=(0,d.useState)(!1);if(n)return d.createElement(Ff.Group,{count:10});if(!t)return d.createElement(oo.A,{error:!0},d.createElement(L.Translate,null,"This location does not exist."));let s=t.rooms;o&&(s=s.filter((e=>e.fullName.toLowerCase().includes(o.trim().toLowerCase()))));return d.createElement(d.Fragment,null,d.createElement(ro.A,{as:"h2",className:"rb-client-js-modules-admin-___AdminLocationRooms-module__header___5DE3Q"},d.createElement(L.Translate,null,"Location: ",d.createElement(L.Param,{name:"location",value:t.name})),d.createElement(dn.A,{size:"small",content:L.Translate.string("Add room"),onClick:()=>a(!0)})),d.createElement(cg,null),s.length?d.createElement(ao.A.Group,{divided:!0},s.map((e=>d.createElement(Hf,{key:e.id,room:e,locationId:t.id})))):d.createElement(oo.A,{info:!0},d.createElement(L.Translate,null,"There are no rooms for the specified location.")),r&&d.createElement(Tl,{locationId:t.id,roomNameFormat:t.roomNameFormat,onClose:e=>{e&&i(),a(!1)}}))}ug.propTypes={location:y().object,isFetching:y().bool.isRequired,fetchRooms:y().func.isRequired,filters:y().exact({text:y().string}).isRequired},ug.defaultProps={location:null};const dg=(0,p.connect)(((e,t)=>{let{locationId:n}=t;return{isFetching:Yf(e),location:Kf(e,{locationId:n}),filters:Xf(e)}}),{fetchRooms:kt})(ug);var mg=n(58591);function hg(e){let{locations:t,isFetchingLocations:n,isMapEnabled:i,actions:{clearTextFilter:o}}=e;if(n)return d.createElement(As.A,{vertical:!0},d.createElement(As.A.Item,null,d.createElement(As.A.Header,null,d.createElement(Du.A,null,d.createElement(Du.A.Line,{length:"medium"}))),d.createElement(As.A.Menu,null,d.createElement(As.A.Item,null,d.createElement(Du.A,null,d.createElement(Du.A.Line,{length:"short"}),d.createElement(Du.A.Line,{length:"short"}),d.createElement(Du.A.Line,{length:"short"}),d.createElement(Du.A.Line,{length:"short"}))))));const r=0!==t.length;return d.createElement(As.A,{size:"large",className:"rb-client-js-modules-admin-___AdminMenu-module__admin-menu___Waixj",vertical:!0,fluid:!0},d.createElement(As.A.Item,null,d.createElement(mg.NavLink,{exact:!0,to:"/admin"},d.createElement(L.Translate,null,"General settings"))),i&&d.createElement(As.A.Item,null,d.createElement(mg.NavLink,{exact:!0,to:"/admin/map-areas"},d.createElement(L.Translate,null,"Map Areas"))),d.createElement(As.A.Item,null,d.createElement(As.A.Header,null,d.createElement(L.Translate,null,"Room Metadata")),d.createElement(As.A.Menu,null,d.createElement(As.A.Item,null,d.createElement(mg.NavLink,{exact:!0,to:"/admin/attributes"},d.createElement(L.Translate,null,"Attributes"))),d.createElement(As.A.Item,null,d.createElement(mg.NavLink,{exact:!0,to:"/admin/equipment"},d.createElement(L.Translate,null,"Equipment & Features"))))),d.createElement(As.A.Item,null,d.createElement(mg.Link,{to:"/admin/locations/"},d.createElement(As.A.Header,{className:"rb-client-js-modules-admin-___AdminMenu-module__locations-header___9bWqi"},d.createElement(L.Translate,{as:"strong"},"Locations"),d.createElement(T.A,{name:"setting"}))),r&&d.createElement(As.A.Menu,null,t.map((e=>{return d.createElement(As.A.Item,{key:e.id},d.createElement(mg.NavLink,{to:(t=e.id,`/admin/locations/${t}`),onClick:o,exact:!0},e.name));var t})))))}hg.propTypes={locations:y().array.isRequired,isFetchingLocations:y().bool.isRequired,isMapEnabled:y().bool.isRequired,actions:y().exact({clearTextFilter:y().func.isRequired}).isRequired};const pg=(0,St.withRouter)((0,p.connect)((e=>({locations:Wf(e),isMapEnabled:Bt(e),isFetchingLocations:Yf(e)})),(e=>({actions:(0,_e.bindActionCreators)({clearTextFilter:Lt},e)})))(hg)),_g={"./EditableList.module.scss":{header:"rb-client-js-modules-admin-___EditableList-module__header___ETUdx",item:"rb-client-js-modules-admin-___EditableList-module__item___M0IO8",editing:"rb-client-js-modules-admin-___EditableList-module__editing___e2poy",info:"rb-client-js-modules-admin-___EditableList-module__info___btTDX",name:"rb-client-js-modules-admin-___EditableList-module__name___UuMhD",actions:"rb-client-js-modules-admin-___EditableList-module__actions___ondjO"}};class fg extends d.PureComponent{constructor(){super(...arguments),(0,pe.A)(this,"state",{confirming:!1,deleting:!1,editing:!1,saving:!1}),(0,pe.A)(this,"handleDeleteClick",(()=>{this.setState({confirming:!0,editing:!1})})),(0,pe.A)(this,"cancelDelete",(()=>{this.setState({confirming:!1})})),(0,pe.A)(this,"confirmDelete",(async()=>{const{item:e,onDelete:t}=this.props;this.setState({deleting:!0,confirming:!1});const n=await t(e);n&&n.error&&this.setState({deleting:!1})})),(0,pe.A)(this,"handleEditClick",(()=>{const{editing:e}=this.state;this.setState({editing:!e})})),(0,pe.A)(this,"handleSubmit",(async(e,t)=>{const{item:n,onUpdate:i}=this.props;this.setState({saving:!0});const o=await i(n,(0,Cs.getChangedValues)(e,t));if(o.error)return this.setState({saving:!1}),o.error;this.setState({saving:!1,editing:!1})}))}render(){const{confirming:e,editing:t,deleting:n,saving:i}=this.state,{confirmDeleteMessage:o,renderDisplay:r,renderEditForm:a,initialEditValues:s,editFormProps:l,item:c,canDelete:u}=this.props;return d.createElement(Ws.A.Item,null,d.createElement("div",{className:(0,mu.A)(t?"item editing":"item",_g,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})},t?d.createElement(ks.Form,(0,bn.A)({onSubmit:this.handleSubmit,initialValues:s(c),initialValuesEqual:cn(),subscription:{submitting:!0,hasValidationErrors:!0,pristine:!0}},l),(e=>d.createElement(ws.A,{onSubmit:e.handleSubmit},a(e),d.createElement(ws.A.Group,null,d.createElement(ws.A.Button,{type:"submit",disabled:e.hasValidationErrors||e.pristine||e.submitting,loading:e.submitting,primary:!0,content:L.Translate.string("Save")}))))):r(c),d.createElement(Ws.A.Content,{className:"rb-client-js-modules-admin-___EditableList-module__actions___ondjO"},d.createElement(dn.A,{icon:"pencil",basic:!0,onClick:this.handleEditClick,disabled:i||n,primary:t}),d.createElement(dn.A,{icon:"trash",basic:!0,negative:!0,onClick:this.handleDeleteClick,loading:n,disabled:i||n||!u(c)}),d.createElement(Cu.A,{header:L.Translate.string("Confirm deletion"),content:{content:o},confirmButton:d.createElement(dn.A,{content:L.Translate.string("Delete"),negative:!0}),cancelButton:L.Translate.string("Cancel"),open:e,onCancel:this.cancelDelete,onConfirm:this.confirmDelete}))))}}(0,pe.A)(fg,"propTypes",{item:y().object.isRequired,canDelete:y().func,renderDisplay:y().func.isRequired,renderEditForm:y().func.isRequired,confirmDeleteMessage:y().any.isRequired,initialEditValues:y().func,editFormProps:y().object,onDelete:y().func.isRequired,onUpdate:y().func.isRequired}),(0,pe.A)(fg,"defaultProps",{canDelete:()=>!0,initialEditValues:e=>e,editFormProps:{}});class gg extends d.PureComponent{constructor(){super(...arguments),(0,pe.A)(this,"handleSubmit",(async e=>{const{onSubmit:t}=this.props,n=await t(e);if(n.error)return n.error}))}render(){const{title:e,initialValues:t,onClose:n,renderForm:i,formProps:o}=this.props;return d.createElement(Ts.A,{open:!0,size:"mini",closeIcon:!0,onClose:n},d.createElement(Ts.A.Header,null,e),d.createElement(Ts.A.Content,null,d.createElement(ks.Form,(0,bn.A)({onSubmit:this.handleSubmit,initialValues:t,initialValuesEqual:cn(),subscription:{submitting:!0,hasValidationErrors:!0,pristine:!0}},o),(e=>d.createElement(ws.A,{onSubmit:e.handleSubmit},i(e),d.createElement(ws.A.Button,{type:"submit",disabled:e.hasValidationErrors||e.pristine||e.submitting,loading:e.submitting,primary:!0,content:L.Translate.string("Add")}))))))}}(0,pe.A)(gg,"propTypes",{title:y().string.isRequired,initialValues:y().object.isRequired,renderForm:y().func.isRequired,onClose:y().func.isRequired,onSubmit:y().func.isRequired,formProps:y().object.isRequired});class bg extends d.PureComponent{constructor(){super(...arguments),(0,pe.A)(this,"state",{adding:!1}),(0,pe.A)(this,"handleAddClick",(()=>{this.setState({adding:!0})})),(0,pe.A)(this,"handleAddClose",(()=>{this.setState({adding:!1})})),(0,pe.A)(this,"handleCreate",(async e=>{const{onCreate:t}=this.props,n=await t(e);return n.error||this.setState({adding:!1}),n}))}render(){const{title:e,addModalTitle:t,renderAddForm:n,renderEditForm:i,renderDeleteMessage:o,renderItem:r,initialEditValues:a,initialAddValues:s,addFormProps:l,editFormProps:c,canDeleteItem:u,isFetching:m,items:h,onDelete:p,onUpdate:_}=this.props,{adding:f}=this.state;return d.createElement(d.Fragment,null,d.createElement(ro.A,{as:"h2",className:"rb-client-js-modules-admin-___EditableList-module__header___ETUdx"},e,d.createElement(dn.A,{size:"small",content:L.Translate.string("Add"),onClick:this.handleAddClick})),m?d.createElement(Du.A,{fluid:!0},wu()(20).map((e=>d.createElement(Du.A.Line,{key:e,length:"full"})))):d.createElement(d.Fragment,null,d.createElement(Ws.A,{divided:!0,relaxed:!0},h.map((e=>d.createElement(fg,{key:e.id,item:e,onDelete:p,onUpdate:_,canDelete:u,renderDisplay:r,renderAddForm:i,renderEditForm:i,initialEditValues:a,editFormProps:c,confirmDeleteMessage:o(e)})))),f&&d.createElement(gg,{onSubmit:this.handleCreate,onClose:this.handleAddClose,title:t,renderForm:n,initialValues:s,formProps:l})))}}(0,pe.A)(bg,"propTypes",{title:y().string.isRequired,addModalTitle:y().string.isRequired,isFetching:y().bool.isRequired,items:y().array.isRequired,initialAddValues:y().object,initialEditValues:y().func,renderItem:y().func.isRequired,canDeleteItem:y().func,renderAddForm:y().func.isRequired,renderEditForm:y().func.isRequired,addFormProps:y().object,editFormProps:y().object,renderDeleteMessage:y().func.isRequired,onDelete:y().func.isRequired,onUpdate:y().func.isRequired,onCreate:y().func.isRequired}),(0,pe.A)(bg,"defaultProps",{initialAddValues:{},initialEditValues:void 0,canDeleteItem:void 0,addFormProps:{},editFormProps:{}});class yg extends d.PureComponent{constructor(){super(...arguments),(0,pe.A)(this,"renderItem",(e=>{let{title:t,hidden:n,numRooms:i}=e;return d.createElement(Ws.A.Content,{className:"rb-client-js-modules-admin-___EditableList-module__info___btTDX"},d.createElement(Ws.A.Header,null,d.createElement("span",{className:"rb-client-js-modules-admin-___EditableList-module__name___UuMhD"},t),n&&d.createElement(mn.A,{trigger:d.createElement(T.A,{name:"hide",color:"blue"})},d.createElement(L.Translate,null,"This attribute is not shown in the public room details."))),d.createElement(Ws.A.Description,null,i?d.createElement(L.PluralTranslate,{count:i},d.createElement(L.Singular,null,"Used in"," ",d.createElement(L.Param,{name:"count",wrapper:d.createElement("strong",null)},"1")," ","room"),d.createElement(L.Plural,null,"Used in ",d.createElement(L.Param,{name:"count",wrapper:d.createElement("strong",null),value:i})," rooms")):d.createElement(L.Translate,null,"Currently unused")))})),(0,pe.A)(this,"renderForm",(()=>d.createElement(d.Fragment,null,d.createElement(Cs.FinalInput,{name:"name",required:!0,format:Cs.formatters.slugify,formatOnBlur:!0,label:L.Translate.string("Name"),autoFocus:!0}),d.createElement(Cs.FinalInput,{name:"title",required:!0,label:L.Translate.string("Title")}),d.createElement(Cs.FinalCheckbox,{name:"hidden",label:L.Translate.string("Hidden")})))),(0,pe.A)(this,"renderDeleteMessage",(e=>{let{title:t,numRooms:n}=e;return d.createElement(d.Fragment,null,d.createElement(L.Translate,null,"Are you sure you want to delete the attribute"," ",d.createElement(L.Param,{name:"name",wrapper:d.createElement("strong",null),value:t}),"?"),n>0&&d.createElement(d.Fragment,null,d.createElement("br",null),d.createElement(L.PluralTranslate,{count:n},d.createElement(L.Singular,null,"It is currently used in"," ",d.createElement(L.Param,{name:"count",wrapper:d.createElement("strong",null)},"1")," ","room."),d.createElement(L.Plural,null,"It is currently used in ",d.createElement(L.Param,{name:"count",wrapper:d.createElement("strong",null),value:n})," ","rooms."))))}))}componentDidMount(){const{actions:{fetchAttributes:e}}=this.props;e()}render(){const{isFetching:e,attributes:t,actions:{createAttribute:n,updateAttribute:i,deleteAttribute:o}}=this.props;return d.createElement(bg,{title:L.Translate.string("Attributes"),addModalTitle:L.Translate.string("Add attribute"),isFetching:e,items:t,renderItem:this.renderItem,renderAddForm:this.renderForm,renderEditForm:this.renderForm,renderDeleteMessage:this.renderDeleteMessage,onCreate:n,onUpdate:i,onDelete:o})}}(0,pe.A)(yg,"propTypes",{isFetching:y().bool.isRequired,attributes:y().array.isRequired,actions:y().exact({fetchAttributes:y().func.isRequired,deleteAttribute:y().func.isRequired,updateAttribute:y().func.isRequired,createAttribute:y().func.isRequired}).isRequired});const vg=(0,p.connect)((e=>({isFetching:og(e),attributes:ag(e)})),(e=>({actions:(0,_e.bindActionCreators)({fetchAttributes:wt,deleteAttribute:e=>{let{id:t}=e;return function(e){return(0,G.P$)((()=>D.indicoAxios.delete(Pe({attribute_id:e}))),null,(()=>({type:gt,id:e})))}(t)},updateAttribute:(e,t)=>{let{id:n}=e;return function(e,t){return(0,G.HX)((()=>D.indicoAxios.patch(Pe({attribute_id:e}),t)),null,ft)}(n,t)},createAttribute:Ot},e)})))(yg);class Eg extends d.PureComponent{constructor(){super(...arguments),(0,pe.A)(this,"renderItem",(e=>{let{name:t,features:n,numRooms:i}=e;return d.createElement(Ws.A.Content,{className:"rb-client-js-modules-admin-___EditableList-module__info___btTDX"},d.createElement(Ws.A.Header,null,d.createElement("span",{className:"rb-client-js-modules-admin-___EditableList-module__name___UuMhD"},t),n.map((e=>d.createElement(mn.A,{key:e.name,trigger:d.createElement(T.A,{name:e.icon||"cog",color:"blue"})},d.createElement(L.Translate,null,"This equipment type provides the"," ",d.createElement(L.Param,{name:"name",wrapper:d.createElement("strong",null),value:e.title})," feature."))))),d.createElement(Ws.A.Description,null,i?d.createElement(L.PluralTranslate,{count:i},d.createElement(L.Singular,null,"Available in"," ",d.createElement(L.Param,{name:"count",wrapper:d.createElement("strong",null)},"1")," ","room"),d.createElement(L.Plural,null,"Available in ",d.createElement(L.Param,{name:"count",wrapper:d.createElement("strong",null),value:i})," rooms")):d.createElement(L.Translate,null,"Currently unused")))})),(0,pe.A)(this,"renderForm",(()=>{const{features:e}=this.props,t=e.map((e=>({key:e.name,value:e.id,text:e.title,icon:e.icon})));return d.createElement(d.Fragment,null,d.createElement(Cs.FinalInput,{name:"name",required:!0,label:L.Translate.string("Name"),autoFocus:!0}),t.length>0&&d.createElement(Cs.FinalDropdown,{name:"features",multiple:!0,selection:!0,closeOnChange:!0,options:t,label:L.Translate.string("Features")}))})),(0,pe.A)(this,"renderDeleteMessage",(e=>{let{name:t,numRooms:n}=e;return d.createElement(d.Fragment,null,d.createElement(L.Translate,null,"Are you sure you want to delete the equipment type"," ",d.createElement(L.Param,{name:"name",wrapper:d.createElement("strong",null),value:t}),"?"),n>0&&d.createElement(d.Fragment,null,d.createElement("br",null),d.createElement(L.PluralTranslate,{count:n},d.createElement(L.Singular,null,"It is currently used by"," ",d.createElement(L.Param,{name:"count",wrapper:d.createElement("strong",null)},"1")," ","room."),d.createElement(L.Plural,null,"It is currently used by ",d.createElement(L.Param,{name:"count",wrapper:d.createElement("strong",null),value:n})," ","rooms."))))}))}render(){const{isFetching:e,equipmentTypes:t,actions:{createEquipmentType:n,updateEquipmentType:i,deleteEquipmentType:o}}=this.props;return d.createElement(bg,{title:L.Translate.string("Equipment types"),addModalTitle:L.Translate.string("Add equipment type"),isFetching:e,items:t,renderItem:this.renderItem,renderAddForm:this.renderForm,renderEditForm:this.renderForm,renderDeleteMessage:this.renderDeleteMessage,initialAddValues:{name:"",features:[]},initialEditValues:e=>({name:e.name,features:e.features.map((e=>e.id))}),onCreate:n,onUpdate:i,onDelete:o})}}(0,pe.A)(Eg,"propTypes",{isFetching:y().bool.isRequired,equipmentTypes:y().array.isRequired,features:y().array.isRequired,actions:y().exact({deleteEquipmentType:y().func.isRequired,updateEquipmentType:y().func.isRequired,createEquipmentType:y().func.isRequired}).isRequired});const kg=(0,p.connect)((e=>({isFetching:ig(e),equipmentTypes:tg(e),features:ng(e)})),(e=>({actions:(0,_e.bindActionCreators)({deleteEquipmentType:e=>{let{id:t}=e;return function(e){return(0,G.P$)((()=>D.indicoAxios.delete(Me({equipment_type_id:e}))),null,(()=>({type:dt,id:e})))}(t)},updateEquipmentType:(e,t)=>{let{id:n}=e;return function(e,t){return(0,G.HX)((()=>D.indicoAxios.patch(Me({equipment_type_id:e}),t)),null,ut)}(n,t)},createEquipmentType:Dt},e)})))(Eg);var Ag=n(65073);class Tg extends d.PureComponent{constructor(){super(...arguments),(0,pe.A)(this,"renderItem",(e=>{let{title:t,icon:n,numEquipmentTypes:i}=e;return d.createElement(d.Fragment,null,d.createElement(Ws.A.Content,null,d.createElement(T.A,{name:n||"cog",size:"big"})),d.createElement(Ws.A.Content,{className:"rb-client-js-modules-admin-___EditableList-module__info___btTDX"},d.createElement(Ws.A.Header,null,d.createElement("span",{className:"rb-client-js-modules-admin-___EditableList-module__name___UuMhD"},t)),d.createElement(Ws.A.Description,null,i?d.createElement(L.PluralTranslate,{count:i},d.createElement(L.Singular,null,"Provided by"," ",d.createElement(L.Param,{name:"count",wrapper:d.createElement("strong",null)},"1")," ","equipment type"),d.createElement(L.Plural,null,"Provided by ",d.createElement(L.Param,{name:"count",wrapper:d.createElement("strong",null),value:i})," ","equipment types")):d.createElement(L.Translate,null,"Currently unused"))))})),(0,pe.A)(this,"renderForm",(()=>{const e=Ag.AJ.map((e=>({key:e,value:e,text:e,icon:e})));return d.createElement(d.Fragment,null,d.createElement(Cs.FinalInput,{name:"name",required:!0,format:Cs.formatters.slugify,formatOnBlur:!0,label:L.Translate.string("Name"),autoFocus:!0}),d.createElement(Cs.FinalInput,{name:"title",required:!0,label:L.Translate.string("Title")}),d.createElement(Cs.FinalDropdown,{name:"icon",search:!0,selection:!0,options:e,label:L.Translate.string("Icon")}))})),(0,pe.A)(this,"renderDeleteMessage",(e=>{const{title:t,numEquipmentTypes:n}=e;return d.createElement(d.Fragment,null,d.createElement(L.Translate,null,"Are you sure you want to delete the feature"," ",d.createElement(L.Param,{name:"name",wrapper:d.createElement("strong",null),value:t}),"?"),n>0&&d.createElement(d.Fragment,null,d.createElement("br",null),d.createElement(L.PluralTranslate,{count:n},d.createElement(L.Singular,null,"It is currently provided by"," ",d.createElement(L.Param,{name:"count",wrapper:d.createElement("strong",null)},"1")," ","equipment type."),d.createElement(L.Plural,null,"It is currently provided by"," ",d.createElement(L.Param,{name:"count",wrapper:d.createElement("strong",null),value:n})," equipment types."))))}))}render(){const{isFetching:e,features:t,actions:{createFeature:n,updateFeature:i,deleteFeature:o}}=this.props;return d.createElement(bg,{title:L.Translate.string("Features"),addModalTitle:L.Translate.string("Add feature"),isFetching:e,items:t,renderItem:this.renderItem,renderAddForm:this.renderForm,renderEditForm:this.renderForm,renderDeleteMessage:this.renderDeleteMessage,onCreate:n,onUpdate:i,onDelete:o})}}(0,pe.A)(Tg,"propTypes",{isFetching:y().bool.isRequired,features:y().array.isRequired,actions:y().exact({deleteFeature:y().func.isRequired,updateFeature:y().func.isRequired,createFeature:y().func.isRequired}).isRequired});const wg=(0,p.connect)((e=>({isFetching:ig(e),features:ng(e)})),(e=>({actions:(0,_e.bindActionCreators)({deleteFeature:e=>{let{id:t}=e;return function(e){return(0,G.P$)((()=>D.indicoAxios.delete(xe({feature_id:e}))),null,(()=>({type:rt,id:e})))}(t)},updateFeature:(e,t)=>{let{id:n}=e;return function(e,t){return(0,G.HX)((()=>D.indicoAxios.patch(xe({feature_id:e}),t)),null,ot)}(n,t)},createFeature:Ct},e)})))(Tg);class Lg extends d.PureComponent{componentDidMount(){const{actions:{fetchEquipmentTypes:e,fetchFeatures:t}}=this.props;e(),t()}render(){return d.createElement(Mt.A,{columns:2},d.createElement(Mt.A.Column,{width:8},d.createElement(kg,null)),d.createElement(Mt.A.Column,null,d.createElement(wg,null)))}}(0,pe.A)(Lg,"propTypes",{actions:y().exact({fetchEquipmentTypes:y().func.isRequired,fetchFeatures:y().func.isRequired}).isRequired});const Dg=(0,p.connect)(null,(e=>({actions:(0,_e.bindActionCreators)({fetchEquipmentTypes:At,fetchFeatures:Tt},e)})))(Lg),Cg=[{value:"none",text:L.Translate.string("None")},{value:"custom",text:L.Translate.string("Custom")},{value:"https://www.google.com/maps/place/{lat},{lng}",text:"Google Maps"},{value:"https://www.openstreetmap.org/?mlat={lat}&mlon={lng}&zoom=18",text:"OpenStreetMap"}],Og=(0,vp.A)({field:"_map_url_template_choice",updates:e=>"custom"!==e?{map_url_template:"none"===e?null:e}:{}});class Rg extends d.PureComponent{constructor(){super(...arguments),(0,pe.A)(this,"renderItem",(e=>{let{name:t,numRooms:n}=e;return d.createElement(Ws.A.Content,{className:"rb-client-js-modules-admin-___EditableList-module__info___btTDX"},d.createElement(Ws.A.Header,null,d.createElement("span",{className:"rb-client-js-modules-admin-___EditableList-module__name___UuMhD"},t)),d.createElement(Ws.A.Description,null,n?d.createElement(L.PluralTranslate,{count:n},d.createElement(L.Singular,null,d.createElement(L.Param,{name:"count",wrapper:d.createElement("strong",null)},"1")," ","room"),d.createElement(L.Plural,null,d.createElement(L.Param,{name:"count",wrapper:d.createElement("strong",null),value:n})," rooms")):d.createElement(L.Translate,null,"No rooms")))})),(0,pe.A)(this,"renderForm",(()=>d.createElement(d.Fragment,null,d.createElement(Cs.FinalInput,{name:"name",required:!0,label:L.Translate.string("Name"),autoFocus:!0}),d.createElement(Cs.FinalInput,{name:"room_name_format",required:!0,label:L.Translate.string("Room name format"),validate:e=>{const t=Cs.validators.required(e);if(t)return t;if(!e.includes("{number}"))return L.Translate.string("Missing placeholder: number");const n=["{site}","{building}","{floor}","{number}"],i=[...e.matchAll(/\{.*?\}/g)].map((e=>e[0])).filter((e=>!n.includes(e)));return i.length?L.PluralTranslate.string("Invalid placeholder: {placeholders}","Invalid placeholders: {placeholders}",i.length,{placeholders:i.join(", ")}):void 0},description:d.createElement(L.Translate,null,"Specify the room name format using any of the following placeholders:"," ",d.createElement(L.Param,{name:"placeholders",wrapper:d.createElement("code",null),value:"{site}, {building}, {floor}, {number}"}))}),d.createElement(Cs.FinalDropdown,{name:"_map_url_template_choice",label:L.Translate.string("Map URL template"),description:d.createElement(L.Translate,null,"Indico can show a link to an external map when a room is associated to an event."),selection:!0,options:Cg}),d.createElement(ks.Field,{name:"_map_url_template_choice",subscription:{value:!0}},(e=>{let{input:{value:t}}=e;return d.createElement(Cs.FinalInput,{name:"map_url_template",label:"",readOnly:"custom"!==t,style:"none"===t?{display:"none"}:{},nullIfEmpty:!0,validate:e=>{if(!e)return;const t=Cs.validators.url(e);if(t)return t;const n=["{id}","{building}","{floor}","{number}","{lat}","{lng}"],i=[...e.matchAll(/\{.*?\}/g)].map((e=>e[0])).filter((e=>!n.includes(e)));return i.length?L.PluralTranslate.string("Invalid placeholder: {placeholders}","Invalid placeholders: {placeholders}",i.length,{placeholders:i.join(", ")}):void 0},description:"custom"===t&&d.createElement(L.Translate,null,"Specify a custom URL template using any of the following placeholders:"," ",d.createElement(L.Param,{name:"placeholders",wrapper:d.createElement("code",null),value:"{id}, {building}, {floor}, {number}, {lat}, {lng}"}))})}))))),(0,pe.A)(this,"renderDeleteMessage",(e=>{let{name:t}=e;return d.createElement(L.Translate,null,"Are you sure you want to delete the location"," ",d.createElement(L.Param,{name:"name",wrapper:d.createElement("strong",null),value:t})," and all data associated with it?")})),(0,pe.A)(this,"getInitialEditValues",(e=>{if((e=qo()((0,fe.snakifyKeys)(e),["name","room_name_format","map_url_template","_map_url_template_choice"])).map_url_template){const t=Cg.find((t=>t.value===e.map_url_template));e._map_url_template_choice=t?t.value:"custom"}else e.map_url_template=null,e._map_url_template_choice="none";return e}))}componentDidMount(){const{isFetching:e,actions:{fetchLocations:t}}=this.props;e||t()}render(){const{isFetching:e,locations:t,actions:{createLocation:n,updateLocation:i,deleteLocation:o}}=this.props;return d.createElement(bg,{title:L.Translate.string("Locations"),addModalTitle:L.Translate.string("Add location"),isFetching:e,items:t,initialEditValues:this.getInitialEditValues,initialAddValues:{room_name_format:"{building}/{floor}-{number}",_map_url_template_choice:"none",map_url_template:null},addFormProps:{decorators:[Og]},editFormProps:{decorators:[Og]},renderItem:this.renderItem,canDeleteItem:e=>e.canDelete,renderAddForm:this.renderForm,renderEditForm:this.renderForm,renderDeleteMessage:this.renderDeleteMessage,onCreate:n,onUpdate:i,onDelete:o})}}(0,pe.A)(Rg,"propTypes",{locations:y().array.isRequired,isFetching:y().bool.isRequired,actions:y().exact({fetchLocations:y().func.isRequired,deleteLocation:y().func.isRequired,updateLocation:y().func.isRequired,createLocation:y().func.isRequired}).isRequired});const Sg=(0,p.connect)((e=>({locations:Wf(e),isFetching:Yf(e)})),(e=>({actions:(0,_e.bindActionCreators)({fetchLocations:Et,deleteLocation:e=>{let{id:t}=e;return function(e){return(0,G.P$)((()=>D.indicoAxios.delete(je({location_id:e}))),null,(()=>({type:We,id:e})))}(t)},updateLocation:(e,t)=>{let{id:n}=e;return function(e,t){return(0,G.HX)((()=>D.indicoAxios.patch(je({location_id:e}),be()(t,"_map_url_template_choice"))),null,Ve)}(n,t)},createLocation:Rt},e)})))(Rg);var Pg=n(33734),Mg=n.n(Pg),xg=n(67942),jg=n(50114),Ig=n(17875),Bg=n(15808);function Ng(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Fg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ng(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ng(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}vn().EditToolbar.Delete.include({removeAllLayers:!1});const zg=[46.233832398,6.053166454];class qg extends d.Component{constructor(e){super(e),(0,pe.A)(this,"state",{areaProps:null,suppressClick:!1}),(0,pe.A)(this,"setMapAreaRef",(e=>{this.map=e})),(0,pe.A)(this,"setFeatureGroupRef",(e=>{this.featureGroup=e})),(0,pe.A)(this,"createNewArea",(e=>{const{layerType:t,layer:{_bounds:{_northEast:n,_southWest:i}}}=e;"rectangle"===t&&(this.setState({areaProps:{bounds:{northEast:n,southWest:i}}}),this.featureGroup&&this.featureGroup.leafletElement.eachLayer((e=>{const{options:{id:t}}=e;void 0===t&&this.featureGroup.leafletElement.removeLayer(e)})))})),(0,pe.A)(this,"editArea",(e=>{if(!Object.keys(e.layers._layers).length)return;const{actions:{updateMapAreas:t}}=this.props,n=[];e.layers.eachLayer((e=>{let{options:{id:t},_bounds:i}=e;const{_southWest:o,_northEast:r}=i;n.push({id:t,bounds:{southWest:o,northEast:r}})})),t(n)})),(0,pe.A)(this,"deleteMapAreas",(e=>{if(!Object.keys(e.layers._layers).length)return;const{actions:{deleteMapAreas:t}}=this.props,n=[];e.layers.eachLayer((e=>{let{options:{id:t}}=e;n.push(t)})),t(n)})),(0,pe.A)(this,"drawAreas",(()=>{if(null===this.map)return null;const{areas:e}=this.props;return e.map(this._drawArea)})),(0,pe.A)(this,"_drawArea",(e=>{let{id:t,is_default:n,name:i,top_left_latitude:o,top_left_longitude:r,bottom_right_latitude:a,bottom_right_longitude:s}=e;const l=[o,r],c=[a,s],u=new(vn().LatLngBounds)([l,c]),m=this.map.leafletElement.latLngToContainerPoint(u.getCenter()),h=this.map.leafletElement.latLngToContainerPoint(u.getSouthEast());return d.createElement(xg.A,{key:`${i}-${m.x}-${m.y}`,bounds:[l,c],name:i,isDefault:n,onClick:()=>{const{suppressClick:e}=this.state;e||this.setState({areaProps:{bounds:{southWest:u.getSouthWest(),northEast:u.getNorthEast()},id:t,isDefault:n,name:i}})},id:t},d.createElement(kn.A,{offset:[h.x-m.x,h.y-m.y],direction:"bottom",sticky:!0,permanent:!0,interactive:!0},d.createElement(d.Fragment,null,i,n&&d.createElement("span",{className:"area-default"},"★"))))})),(0,pe.A)(this,"onSubmit",(async e=>{const{actions:{createMapArea:t,updateMapAreas:n}}=this.props,{areaProps:{id:i}}=this.state;void 0===i?await t(e):await n([Fg(Fg({},e),{},{id:i})]),this.setState({areaProps:null})})),(0,pe.A)(this,"renderModalForm",(()=>{const{areaProps:e}=this.state;if(!e)return null;const{id:t,bounds:n,name:i,isDefault:o}=e;return d.createElement(ks.Form,{onSubmit:this.onSubmit,render:this.renderForm,subscription:{},initialValues:{name:void 0===t?null:i,bounds:n,default:o}})})),(0,pe.A)(this,"renderForm",(e=>{let{handleSubmit:t}=e;const{areaProps:{id:n}}=this.state,i=void 0===n;return d.createElement(Ts.A,{onClose:()=>this.setState({areaProps:null}),closeIcon:!0,open:!0},d.createElement(Ts.A.Header,null,i?d.createElement(L.Translate,null,"Create new area"):d.createElement(L.Translate,null,"Update area")),d.createElement(Ts.A.Content,null,d.createElement(ws.A,{id:"map-area-form",onSubmit:t},d.createElement(ws.A.Group,null,d.createElement(Cs.FinalInput,{name:"name",label:L.Translate.string("Name of the area"),autoFocus:!0,required:!0})),d.createElement(ws.A.Group,null,d.createElement(Cs.FinalCheckbox,{name:"default",label:L.Translate.string("Default map area"),toggle:!0})),d.createElement(ws.A.Group,null,d.createElement(Cs.FinalInput,{name:"bounds.southWest.lat",type:"number",label:L.Translate.string("SW Latitude"),step:"0.00000000000001",required:!0}),d.createElement(Cs.FinalInput,{name:"bounds.southWest.lng",type:"number",label:L.Translate.string("SW Longitude"),step:"0.00000000000001",required:!0})),d.createElement(ws.A.Group,null,d.createElement(Cs.FinalInput,{name:"bounds.northEast.lat",label:L.Translate.string("NE Latitude"),step:"0.00000000000001",type:"number",required:!0}),d.createElement(Cs.FinalInput,{name:"bounds.northEast.lng",label:L.Translate.string("NE Longitude"),step:"0.00000000000001",type:"number",required:!0})))),d.createElement(Ts.A.Actions,null,d.createElement(Cs.FinalSubmitButton,{form:"map-area-form",label:i?L.Translate.string("Create"):L.Translate.string("Update"),primary:!0}),d.createElement(dn.A,{onClick:()=>this.setState({areaProps:null})},d.createElement(L.Translate,null,"Cancel"))))})),this.map=null,this.featureGroup=null}componentDidMount(){const{actions:{fetchMapAreas:e}}=this.props;e(),this.forceUpdate()}render(){const{tileServerURL:e,areas:t}=this.props,n=t.find((e=>e.is_default)),i=n?new(vn().LatLngBounds)([[n.top_left_latitude,n.top_left_longitude],[n.bottom_right_latitude,n.bottom_right_longitude]]):null,o=["draw","edit","delete"].reduce(((e,t)=>(t=Mg()(t),Fg(Fg({},e),{},{[`on${t}Start`]:()=>this.setState({suppressClick:!0}),[`on${t}Stop`]:()=>this.setState({suppressClick:!1})}))),{});return d.createElement(d.Fragment,null,d.createElement(ro.A,{as:"h2"},d.createElement(L.Translate,null,"Map Areas")),d.createElement("div",{className:"rb-client-js-modules-admin-___MapAreasPage-module__areas-map-container___5GfZn"},d.createElement(fn.A,{ref:this.setMapAreaRef,center:i?i.getCenter():zg,onZoomEnd:()=>{const{suppressClick:e}=this.state;e||this.forceUpdate()},zoomControl:!1,zoom:14},d.createElement(gn.A,{attribution:'© <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',minZoom:"14",maxZoom:"20",url:e}),d.createElement(jg.A,{ref:this.setFeatureGroupRef},d.createElement(Bg.M,(0,bn.A)({position:"topleft",onCreated:this.createNewArea,onEdited:this.editArea,onDeleted:this.deleteMapAreas,draw:{marker:!1,circle:!1,polygon:!1,polyline:!1,circlemarker:!1}},o)),0!==t.length&&this.drawAreas()),d.createElement(Ig.A,{position:"bottomleft"}))),this.renderModalForm())}}(0,pe.A)(qg,"propTypes",{tileServerURL:y().string.isRequired,areas:y().arrayOf(y().object).isRequired,actions:y().exact({createMapArea:y().func.isRequired,updateMapAreas:y().func.isRequired,deleteMapAreas:y().func.isRequired,fetchMapAreas:y().func.isRequired}).isRequired});const Hg=(0,p.connect)((e=>({areas:It(e),tileServerURL:ne(e)})),(e=>({actions:(0,_e.bindActionCreators)({createMapArea:en,deleteMapAreas:nn,updateMapAreas:tn,fetchMapAreas:Jt},e)})))(qg);var Ug=n(70953),$g=n.n(Ug);const Zg=e=>+e>=0,Gg=e=>{const{value:t,disabled:n,onChange:i,onFocus:o,onBlur:r}=e,[a,s]=(0,d.useState)(t.filter(Zg).map((e=>({text:e,value:e}))));return d.createElement(k.A,{options:a,value:t,disabled:n,searchInput:{onFocus:o,onBlur:r,pattern:"^\\d+$"},search:!0,selection:!0,multiple:!0,allowAdditions:!0,fluid:!0,closeOnChange:!0,noResultsMessage:L.Translate.string("Please enter a category ID"),placeholder:L.Translate.string("Please enter a category ID"),additionLabel:L.Translate.string("Add category")+" #",onChange:(e,t)=>{let{value:n}=t;n=$g()(n.filter(Zg).map((e=>+e))),s(n.map((e=>({text:e,value:e})))),i(n),o(),r()}})};Gg.propTypes={value:y().arrayOf(y().number).isRequired,disabled:y().bool.isRequired,onChange:y().func.isRequired,onFocus:y().func.isRequired,onBlur:y().func.isRequired};const Vg=d.memo(Gg),Wg=e=>{const{settingsLoaded:t,settings:n,actions:{fetchSettings:i,updateSettings:o}}=e,r=(0,C.EV)();(0,d.useEffect)((()=>{i()}),[i]);if(!t)return d.createElement(Du.A,null,d.createElement(Du.A.Line,null),d.createElement(Du.A.Line,null),d.createElement(Du.A.Line,null),d.createElement(Du.A.Line,null),d.createElement(Du.A.Line,null));const a=[{value:"always",text:L.Translate.string("Always")},{value:"never",text:L.Translate.string("Never")},{value:"not_for_events",text:L.Translate.string("Not for events")}];return d.createElement(d.Fragment,null,d.createElement(ro.A,{as:"h2"},d.createElement(L.Translate,null,"General Settings")),d.createElement(ks.Form,{onSubmit:async(e,t)=>{const n=(0,Cs.getChangedValues)(e,t),i=await o(n);if(i.error)return i.error},initialValues:n,initialValuesEqual:cn(),subscription:{}},(e=>d.createElement(ws.A,{onSubmit:e.handleSubmit},d.createElement(Cs.FinalUnloadPrompt,null),d.createElement(oo.A,null,d.createElement(oo.A.Header,null,d.createElement(L.Translate,null,"Specify who has access to the room booking system.")),d.createElement(ws.A.Group,{widths:"equal"},d.createElement(Os.FinalPrincipalList,{name:"authorized_principals",withGroups:!0,favoriteUsersController:r,label:L.Translate.string("Authorized users"),description:d.createElement(L.Translate,null,"Restrict access to the room booking system to these users/groups. If empty, all logged-in users have access.")}),d.createElement(Os.FinalPrincipalList,{name:"admin_principals",withGroups:!0,favoriteUsersController:r,label:L.Translate.string("Administrators"),description:d.createElement(L.Translate,null,"Grant full room booking admin permissions to these users/groups.")}))),d.createElement(Cs.FinalCheckbox,{name:"managers_edit_rooms",label:L.Translate.string("Allow owners/managers to edit their rooms"),description:d.createElement(L.Translate,null,"By default only admins can modify rooms, but you can allow room owners and managers to modify them as well.")}),d.createElement(Cs.FinalCheckbox,{name:"hide_module_if_unauthorized",label:L.Translate.string("Hide the Room Booking system from unauthorized users"),description:d.createElement(L.Translate,null,"If enabled, links to the Room Booking system will not be shown to users who do not have access to it.")}),d.createElement(Cs.FinalInput,{name:"tileserver_url",label:L.Translate.string("Tileserver URL"),description:d.createElement(L.Translate,null,"If you want to use the map, specify the URL to a tileserver covering the area in which your rooms are located."),nullIfEmpty:!0,validate:e=>{if(e){if(!e.match(/https?:\/\/.+/))return L.Translate.string("Please provide a valid URL");{const t=["{x}","{y}","{z}"].filter((t=>!e.includes(t)));if(t.length)return L.PluralTranslate.string("Missing placeholder: {placeholders}","Missing placeholders: {placeholders}",t.length,{placeholders:t.join(", ")})}}}}),d.createElement(Cs.FinalInput,{name:"booking_limit",type:"number",min:"1",required:!0,label:L.Translate.string("Max. booking length"),description:L.Translate.string("The maximum length (in days) a booking may last."),validate:Cs.validators.min(1)}),d.createElement(Cs.FinalDropdown,{options:a,required:!0,selection:!0,name:"booking_reason_required",label:L.Translate.string("Booking reason required"),description:L.Translate.string("Specify when a booking reason must be provided.")}),d.createElement(Cs.FinalCheckbox,{name:"notifications_enabled",label:L.Translate.string("Send reminders for upcoming bookings")}),d.createElement(Cs.FieldCondition,{when:"notifications_enabled"},d.createElement(oo.A,null,d.createElement(oo.A.Header,null,d.createElement(L.Translate,null,"Specify how many days in advance booking reminders should be sent")),d.createElement(ws.A.Group,{widths:"equal"},d.createElement(Cs.FinalInput,{name:"notification_before_days",type:"number",min:"1",max:"30",required:!0,label:L.Translate.string("Single/Daily bookings"),validate:Cs.validators.range(1,30)}),d.createElement(Cs.FinalInput,{name:"notification_before_days_weekly",type:"number",min:"1",max:"30",required:!0,label:L.Translate.string("Weekly bookings"),validate:Cs.validators.range(1,30)}),d.createElement(Cs.FinalInput,{name:"notification_before_days_monthly",type:"number",min:"1",max:"30",required:!0,label:L.Translate.string("Monthly bookings"),validate:Cs.validators.range(1,30)})))),d.createElement(Cs.FinalCheckbox,{name:"end_notifications_enabled",label:L.Translate.string("Send reminders when bookings are about to end")}),d.createElement(Cs.FieldCondition,{when:"end_notifications_enabled"},d.createElement(oo.A,null,d.createElement(oo.A.Header,null,d.createElement(L.Translate,null,"Specify how many days before the end of a booking reminders should be sent")),d.createElement(ws.A.Group,{widths:"equal"},d.createElement(Cs.FinalInput,{name:"end_notification_daily",type:"number",min:"1",max:"30",required:!0,label:L.Translate.string("Daily bookings"),validate:Cs.validators.range(1,30)}),d.createElement(Cs.FinalInput,{name:"end_notification_weekly",type:"number",min:"1",max:"30",required:!0,label:L.Translate.string("Weekly bookings"),validate:Cs.validators.range(1,30)}),d.createElement(Cs.FinalInput,{name:"end_notification_monthly",type:"number",min:"1",max:"30",required:!0,label:L.Translate.string("Monthly bookings"),validate:Cs.validators.range(1,30)})))),d.createElement(Cs.FinalCheckbox,{name:"internal_notes_enabled",label:L.Translate.string("Enable internal booking notes"),description:d.createElement(L.Translate,null,"Allow room owners/managers to add internal notes to bookings which are only visible to other room owners/managers.")}),d.createElement(Cs.FinalField,{name:"excluded_categories",component:Vg,isEqual:cn(),label:L.Translate.string("Disable booking during event creation"),description:d.createElement(L.Translate,null,"Specify the IDs of categories for which booking a room during event creation will not be suggested.")}),d.createElement(Cs.FinalInput,{name:"grace_period",type:"number",min:"0",max:"24",validate:Cs.validators.optional(Cs.validators.range(0,24)),label:L.Translate.string("Grace period"),description:d.createElement(L.Translate,null,"Usually booking a space in the past is not allowed. This setting will allow to book a room with a start date within a specified number of hours in the past. Leaving the field empty will allow any start date that is not in the past without restricting the start time as well.")}),d.createElement(Cs.FinalSubmitButton,{label:L.Translate.string("Save"),style:{marginBottom:"0.875rem"}})))))};Wg.propTypes={settingsLoaded:y().bool.isRequired,settings:y().object.isRequired,actions:y().exact({fetchSettings:y().func.isRequired,updateSettings:y().func.isRequired}).isRequired};const Kg=(0,p.connect)((e=>({settings:lg(e),settingsLoaded:sg(e)})),(e=>({actions:(0,_e.bindActionCreators)({fetchSettings:yt,updateSettings:vt},e)})))(d.memo(Wg));class Yg extends d.Component{componentDidMount(){const{actions:{fetchLocations:e,fetchRooms:t}}=this.props;e(),t()}render(){const{isAdmin:e,isMapEnabled:t}=this.props;return e?d.createElement(Pt.A,{className:"rb-client-js-modules-admin-___AdminArea-module__admin-area___I19lv"},d.createElement(Mt.A,{columns:2},d.createElement(Mt.A.Column,{width:4,floated:"left"},d.createElement(pg,null)),d.createElement(Mt.A.Column,{width:12},d.createElement(St.Route,{exact:!0,path:"/admin",component:Kg}),d.createElement(xt.ConditionalRoute,{exact:!0,path:"/admin/map-areas",component:Hg,active:t}),d.createElement(St.Route,{exact:!0,path:"/admin/equipment",component:Dg}),d.createElement(St.Route,{exact:!0,path:"/admin/attributes",component:vg}),d.createElement(St.Route,{exact:!0,path:"/admin/locations/",component:Sg}),d.createElement(St.Route,{exact:!0,path:"/admin/locations/:locationId",render:e=>{let{match:{params:{locationId:t}}}=e;return d.createElement(dg,{locationId:parseInt(t,10)})}})))):null}}(0,pe.A)(Yg,"propTypes",{isAdmin:y().bool.isRequired,isMapEnabled:y().bool.isRequired,actions:y().exact({fetchLocations:y().func.isRequired,fetchRooms:y().func.isRequired}).isRequired});const Xg=(0,p.connect)((e=>({isAdmin:qi(e),isMapEnabled:Bt(e)})),(e=>({actions:(0,_e.bindActionCreators)({fetchLocations:Et,fetchRooms:kt},e)})))(Yg);function Qg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Jg(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qg(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qg(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const eb=(0,_e.combineReducers)({requests:(0,_e.combineReducers)({settings:(0,G.Od)(Fe,ze,qe),locations:(0,G.Od)(Ue,$e,Ze),rooms:(0,G.Od)(Ke,Ye,Xe),equipmentTypes:(0,G.Od)(at,st,lt),features:(0,G.Od)(et,tt,nt),attributes:(0,G.Od)(mt,ht,pt)}),locations:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ge:return(0,fe.camelizeKeys)(t.data);case Ve:return[...e.filter((e=>e.id!==t.data.id)),(0,fe.camelizeKeys)(t.data)];case We:return e.filter((e=>e.id!==t.id));default:return e}},rooms:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Qe:return(0,fe.camelizeKeys)(t.data);case Je:return e.filter((e=>e.id!==t.id));default:return e}},settings:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return t.type===He?t.data:e},equipmentTypes:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ct:return(0,fe.camelizeKeys)(t.data);case ut:return[...e.filter((e=>e.id!==t.data.id)),(0,fe.camelizeKeys)(t.data)];case dt:return e.filter((e=>e.id!==t.id));case rt:return e.map((e=>Jg(Jg({},e),{},{features:e.features.filter((e=>e!==t.id))})));default:return e}},features:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case it:return t.data;case ot:return[...e.filter((e=>e.id!==t.data.id)),t.data];case rt:return e.filter((e=>e.id!==t.id));default:return e}},attributes:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case _t:return(0,fe.camelizeKeys)(t.data);case ft:return[...e.filter((e=>e.id!==t.data.id)),(0,fe.camelizeKeys)(t.data)];case gt:return e.filter((e=>e.id!==t.id));default:return e}},filters:we(bt,(()=>({text:null})))});function tb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function nb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tb(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const ib={roomsSpriteToken:"",languages:{},tileServerURL:"",gracePeriod:1,helpURL:"",hasTOS:!1,tosHTML:null,hasPrivacyPolicy:!1,internalNotesEnabled:!1,privacyPolicyHTML:null,contactEmail:null,bookingReasonRequired:!0},ob=(0,_e.combineReducers)({request:(0,G.Od)(W,K,Y),data:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ib,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case X:{const{roomsSpriteToken:e,gracePeriod:n,managersEditRooms:i,helpURL:o,contactEmail:r,hasPrivacyPolicy:a,bookingReasonRequired:s,hasTos:l,tosHtml:c,privacyPolicyHtml:u,tileserverURL:d,internalNotesEnabled:m}=(0,fe.camelizeKeys)(t.data),{languages:h}=t.data;return{roomsSpriteToken:e,languages:h,tileServerURL:d,gracePeriod:n,managersEditRooms:i,helpURL:o,hasTOS:l,tosHTML:c,hasPrivacyPolicy:a,privacyPolicyHTML:u,contactEmail:r,internalNotesEnabled:m,bookingReasonRequired:s}}case He:return nb(nb({},e),{},{tileServerURL:t.data.tileserver_url});case Q:return nb(nb({},e),{},{roomsSpriteToken:t.token});default:return e}}});var rb=n(99172),ab=n.n(rb);function sb(e){return sb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sb(e)}const lb=function(e){var t=e.getIn,n=e.toJS,i=function(e){var i,o=n(t(e,["router"]));if(null==(i=o)||"object"!==sb(i)||!t(i,["location"])||!t(i,["action"]))throw'Could not find router reducer in state tree, it must be mounted under "router"';return o},o=function(e){return n(t(i(e),["location"]))};return{getLocation:o,getAction:function(e){return n(t(i(e),["action"]))},getRouter:i,getSearch:function(e){return n(t(i(e),["location","search"]))},getHash:function(e){return n(t(i(e),["location","hash"]))},createMatchSelector:function(e){var t=null,n=null;return function(i){var r=(o(i)||{}).pathname;if(r===t)return n;t=r;var a=(0,St.matchPath)(r,e);return a&&n&&a.url===n.url&&a.isExact===n.isExact||(n=a),n}}}};function cb(e){return cb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cb(e)}function ub(){return ub=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ub.apply(this,arguments)}function db(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mb(e){return function(){var t,n=hb(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()){var i=hb(this).constructor;t=Reflect.construct(n,arguments,i)}else t=n.apply(this,arguments);return function(e,t){if(t&&("object"===cb(t)||"function"==typeof t))return t;return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,t)}}function hb(e){return hb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},hb(e)}function pb(e,t){return pb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},pb(e,t)}const _b=function(e){var t=lb(e).getLocation,n=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pb(e,t)}(a,e);var n,i,o,r=mb(a);function a(e){var n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),n=r.call(this,e);var i=e.store,o=e.history,s=e.onLocationChanged,l=e.stateCompareFunction;n.inTimeTravelling=!1,n.unsubscribe=i.subscribe((function(){var r=!e.noTimeTravelDebugging,a=t(i.getState()),s=a.pathname,c=a.search,u=a.hash,d=a.state,m=o.location,h=m.pathname,p=m.search,_=m.hash,f=m.state;!r||"PUSH"!==e.history.action||h===s&&p===c&&_===u&&ab()(d,f,l)||(n.inTimeTravelling=!0,o.push({pathname:s,search:c,hash:u,state:d}))}));var c=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n.inTimeTravelling?n.inTimeTravelling=!1:s(e,t,i)};return n.unlisten=o.listen(c),e.noInitialPop||c(o.location,o.action,!0),n}return n=a,(i=[{key:"componentWillUnmount",value:function(){this.unlisten(),this.unsubscribe()}},{key:"render",value:function(){var e=this.props,t=e.omitRouter,n=e.history,i=e.children;return t?d.createElement(d.Fragment,null,i):d.createElement(St.Router,{history:n},i)}}])&&db(n.prototype,i),o&&db(n,o),a}(d.PureComponent);n.propTypes={store:y().shape({getState:y().func.isRequired,subscribe:y().func.isRequired}).isRequired,history:y().shape({action:y().string.isRequired,listen:y().func.isRequired,location:y().object.isRequired,push:y().func.isRequired}).isRequired,basename:y().string,children:y().oneOfType([y().func,y().node]),onLocationChanged:y().func.isRequired,noInitialPop:y().bool,noTimeTravelDebugging:y().bool,stateCompareFunction:y().func,omitRouter:y().bool};var i=function(e){var t=e.context||p.ReactReduxContext;if(null==t)throw"Please upgrade to react-redux v6";return d.createElement(t.Consumer,null,(function(t){var i=t.store;return d.createElement(n,ub({store:i},e))}))};return i.propTypes={context:y().object},(0,p.connect)(null,(function(e){return{onLocationChanged:function(t,n,i){return e(function(e,t){return{type:B,payload:{location:e,action:t,isFirstRendering:arguments.length>2&&void 0!==arguments[2]&&arguments[2]}}}(t,n,i))}}}))(i)};function fb(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return gb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gb(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function bb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function yb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bb(Object(n),!0).forEach((function(t){vb(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Eb=function(e){if(e&&e.query)return e;var t=e&&e.search;if("string"!=typeof t||0===t.length)return yb({},e,{query:{}});var n=t.substring(1).split("&").reduce((function(e,t){var n=fb(t.split("="),2);return yb({},e,vb({},n[0],n[1]))}),{});return yb({},e,{query:n})};const kb=function(e){var t=e.fromJS,n=e.merge;return function(e){var i=t({location:Eb(e.location),action:e.action});return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=o.type,a=o.payload;if(r===B){var s=a.location,l=a.action;return a.isFirstRendering?e:n(e,{location:t(Eb(s)),action:l})}return e}}};function Ab(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Tb(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const wb={fromJS:function(e){return e},getIn:function(e,t){if(!e)return e;var n=t.length;if(n){for(var i=e,o=0;o<n&&i;++o)i=i[t[o]];return i}},merge:function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ab(Object(n),!0).forEach((function(t){Tb(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ab(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{},t)},toJS:function(e){return e}};var Lb=_b(wb),Db=kb(wb),Cb=lb(wb),Ob=(Cb.getLocation,Cb.getAction,Cb.getHash,Cb.getRouter,Cb.getSearch,Cb.createMatchSelector,n(8710)),Rb=n.n(Ob),Sb=n(76781);const Pb=(0,jt.Mz)(ee,Fi,(e=>{let{rooms:t}=e;return t.requests.rooms.state===G.X_.SUCCESS||t.requests.rooms.reloading}),(e=>{let{rooms:t}=e;return t.requests.equipmentTypes.state===G.X_.SUCCESS||t.requests.equipmentTypes.reloading}),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some((e=>!e))}));function Mb(e){const{filters:{recurrence:t,dates:{startDate:n}}}=e.bookRoom;return!(!t.type||!n)}function xb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function jb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xb(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class Ib extends d.PureComponent{constructor(e){super(e),this.modalHandlers=jb(jb(jb(jb({},Sm),Bp),Nf),k_)}getQueryData(){const{queryString:e}=this.props;let{modal:t}=E().parse(e);if(!t)return null;Array.isArray(t)&&(t=t[t.length-1]);const n=t.match(/^([^:]+)(?::(\d+)(?::(.+))?)?$/);if(!n)return null;const[i,o,r,a]=n;return{orig:i,name:o,value:parseInt(r,10),payload:JSON.parse(a||"null")}}getQueryStringWithout(e){const{queryString:t}=this.props,n=E().parse(t);return Array.isArray(n.modal)?n.modal=n.modal.filter((t=>t!==e)):n.modal===e&&delete n.modal,E().stringify(n,{arrayFormat:"repeat"})}getQueryStringWithoutModals(){const{queryString:e}=this.props,t=E().parse(e);return delete t.modal,E().stringify(t,{arrayFormat:"repeat"})}makeCloseHandler(e){const{actions:{pushState:t},path:n}=this.props;return i=>{const o=i?this.getQueryStringWithoutModals():this.getQueryStringWithout(e);t(n+(o?`?${o}`:""))}}render(){const{isInitializing:e}=this.props;if(e)return null;const t=this.getQueryData();if(!t)return null;const{orig:n,name:i,value:o,payload:r}=t,a=this.makeCloseHandler(n),s=this.modalHandlers[i];return s?s(a,o,r):null}}(0,pe.A)(Ib,"propTypes",{isInitializing:y().bool.isRequired,path:y().string.isRequired,queryString:y().string.isRequired,actions:y().exact({pushState:y().func.isRequired}).isRequired});const Bb=(0,p.connect)((e=>({isInitializing:Pb(e),path:e.router.location.pathname,queryString:e.router.location.search.substr(1)})),(e=>({actions:(0,_e.bindActionCreators)({pushState:z},e)})))(Ib),Nb=_.Ay.bind(null,{endpoint:"rb.my_bookings",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"bookings",isDynamic:!1},{data:"/",isDynamic:!1},{data:"mine",isDynamic:!1}]}]},"/"),Fb=_.Ay.bind(null,{endpoint:"rb.stats",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"rooms",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"stats",isDynamic:!1}]}]},"/"),zb="landing/STATS_RECEIVED",qb="landing/FETCH_STATS_REQUEST",Hb="landing/FETCH_STATS_SUCCESS",Ub="landing/FETCH_STATS_ERROR",$b="landing/BOOKINGS_RECEIVED",Zb="landing/FETCH_BOOKINGS_REQUEST",Gb="landing/FETCH_BOOKINGS_SUCCESS",Vb="landing/FETCH_BOOKINGS_ERROR";function Wb(){return(0,G.P$)((()=>D.indicoAxios.get(Fb())),qb,[zb,Hb],Ub)}var Kb=n(10102);function Yb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Xb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yb(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yb(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Qb=e=>{let{landing:t}=e;return t.stats.data},Jb=e=>null!==Qb(e),ey=e=>{let{landing:{upcomingBookings:{data:t}}}=e;return!(!t||!t.length)},ty=e=>{let{landing:{upcomingBookings:{request:t}}}=e;return"success"===t.state},ny=(0,jt.Mz)((e=>{let{landing:t}=e;return t.upcomingBookings.data}),Xo,((e,t)=>e.map((e=>{const{reservation:n}=e;return Xb(Xb({},e),{},{reservation:Xb(Xb({},n),{},{room:t[n.roomId]})})}))));function iy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function oy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?iy(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const ry={activeRooms:d.createElement(L.Translate,null,"Active rooms"),buildings:d.createElement(L.Translate,null,"Buildings"),bookingsToday:d.createElement(L.Translate,null,"Bookings today"),pendingBookings:d.createElement(L.Translate,null,"Active booking requests")};class ay extends d.Component{componentDidMount(){const{actions:{fetchStatistics:e}}=this.props;e()}render(){const{hasStatistics:e}=this.props;if(!e)return d.createElement(_n.A,{size:"massive",active:!0});const{statistics:{activeRooms:t,bookingsToday:n,buildings:i,pendingBookings:o},labels:r}=this.props,a=oy(oy({},ry),r);return d.createElement("div",{className:"statistics"},d.createElement(Kb.A,{size:"huge"},d.createElement(Kb.A.Value,null,t),d.createElement(Kb.A.Label,null,a.activeRooms)),d.createElement(Kb.A,{size:"huge"},d.createElement(Kb.A.Value,null,i),d.createElement(Kb.A.Label,null,a.buildings)),d.createElement(Kb.A,{size:"huge"},d.createElement(Kb.A.Value,null,n),d.createElement(Kb.A.Label,null,a.bookingsToday)),d.createElement(Kb.A,{size:"huge"},d.createElement(Kb.A.Value,null,o),d.createElement(Kb.A.Label,null,a.pendingBookings)))}}(0,pe.A)(ay,"propTypes",{hasStatistics:y().bool.isRequired,statistics:y().shape({activeRooms:y().number.isRequired,bookingsToday:y().number.isRequired,buildings:y().number.isRequired,pendingBookings:y().number.isRequired}),actions:y().exact({fetchStatistics:y().func.isRequired}).isRequired,labels:y().object}),(0,pe.A)(ay,"defaultProps",{statistics:null,labels:{}});const sy=(0,p.connect)((e=>({statistics:Qb(e),hasStatistics:Jb(e)})),(e=>({actions:(0,_e.bindActionCreators)({fetchStatistics:Wb},e)})))(h.Ay.component("LandingStatistics",ay));class ly extends d.PureComponent{renderPrebookingWarning(){return d.createElement(Ll.A,{corner:"right",icon:"time",color:"yellow",size:"small"})}renderCard(e){let{reservation:{room:t,id:n,bookingReason:i,isAccepted:o},startDt:r}=e;const a=(0,De.toMoment)(r),{actions:s}=this.props;return d.createElement(Ws.A.Item,{key:`${n}-${r}`,className:"rb-client-js-modules-landing-___UpcomingBookings-module__upcoming-bookings-item___1h7Bc",onClick:()=>s.openBookingDetails(n)},d.createElement(Ws.A.Content,null,d.createElement("div",{className:"rb-client-js-modules-landing-___UpcomingBookings-module__upcoming-item-img-container___PdgLp"},d.createElement(xl,{pos:t.spritePosition,width:"100%",height:"100px",styles:{margin:"auto"}}),!o&&this.renderPrebookingWarning(),d.createElement(Ws.A.Header,{as:"h3",className:"rb-client-js-modules-landing-___UpcomingBookings-module__upcoming-item-room-notch___p6nvt"},d.createElement("span",{className:"rb-client-js-modules-landing-___UpcomingBookings-module__upcoming-item-room-name___m8Waf"},t.name))),d.createElement(Ws.A.Description,null,d.createElement(mn.A,{trigger:d.createElement("span",null,a.calendar())},a.format("ll LT")),d.createElement("p",{className:"rb-client-js-modules-landing-___UpcomingBookings-module__booking-reason___vACsc"},i))))}render(){const{bookings:e}=this.props;return d.createElement("div",null,d.createElement(ro.A,{as:"h3"},d.createElement(L.Translate,null,"Your bookings")),d.createElement(Ws.A,{divided:!0,horizontal:!0,relaxed:!0,className:"rb-client-js-modules-landing-___UpcomingBookings-module__upcoming-bookings-list___314Us"},e.map((e=>this.renderCard(e)))))}}(0,pe.A)(ly,"propTypes",{bookings:y().arrayOf(y().object).isRequired,actions:y().exact({openBookingDetails:y().func}).isRequired});const cy=(0,p.connect)(null,(e=>({actions:(0,_e.bindActionCreators)({openBookingDetails:os},e)})))(ly);function uy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function dy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?uy(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}class my extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"state",{text:null,extraState:{onlyFavorites:!1}}),(0,pe.A)(this,"doSearch",(e=>{const{extraState:t,text:n}=this.state,{actions:{setFilters:i}}=this.props;i(dy(dy(dy({},e),t),{},{text:n,equipment:[]}))})),(0,pe.A)(this,"updateText",(e=>{this.setState({text:e})})),(0,pe.A)(this,"toggleFavorites",((e,t)=>{let{checked:n}=t;this.setExtraState({onlyFavorites:n})})),(0,pe.A)(this,"setExtraState",(e=>{const{extraState:t}=this.state;this.setState({extraState:dy(dy({},t),e)})}))}componentDidMount(){const{actions:{fetchUpcomingBookings:e},showUpcomingBookings:t,filters:{text:n}}=this.props;t&&e(),n&&this.updateText(n)}renderCarousel(){const{upcomingBookings:e}=this.props,t=[{key:"upcoming",content:d.createElement(cy,{bookings:e}),delay:20},{key:"stats",content:d.createElement(sy,null)}];return d.createElement(Os.Carousel,{panes:t})}render(){const{userHasFavorites:e,showUpcomingBookings:t,hasUpcomingBookings:n,fetchedUpcomingBookings:i,filters:{dates:{startDate:o}}}=this.props,{extraState:r,text:a}=this.state,s=o?{dates:{startDate:(0,De.toMoment)(o,cr().HTML5_FMT.DATE)}}:{};return d.createElement("div",{className:"landing-wrapper"},d.createElement(Mt.A,{centered:!0,className:"rb-client-js-modules-landing-___Landing-module__landing-page___tdxBk",columns:1},d.createElement(Mt.A.Row,{className:"rb-client-js-modules-landing-___Landing-module__landing-page-form___y1LhT"},d.createElement(wl.A,{className:"rb-client-js-modules-landing-___Landing-module__landing-page-card___jCe4R"},d.createElement(wl.A.Content,null,d.createElement(wl.A.Header,null,d.createElement(L.Translate,null,"Start your booking..."))),d.createElement(wl.A.Content,{className:"rb-client-js-modules-landing-___Landing-module__landing-page-card-content___CeACH"},d.createElement(lp,{onSearch:this.doSearch,defaults:s},d.createElement(ws.A.Group,{inline:!0},d.createElement(ws.A.Input,{placeholder:"e.g. IT Amphitheatre",className:"rb-client-js-modules-landing-___Landing-module__search-input___+oKDK",onChange:(e,t)=>this.updateText(t.value),value:a||""})),d.createElement(h.Ay,{id:"Landing.bootstrapOptions",setOptions:this.setExtraState,options:r},e&&d.createElement(ws.A.Field,null,d.createElement(un.A,{label:L.Translate.string("Search only my favorites"),onClick:this.toggleFavorites}))))))),d.createElement(xt.Responsive.Desktop,{andLarger:!0,minDeviceHeigth:900},(!t||i)&&d.createElement(Mt.A.Row,{className:"rb-client-js-modules-landing-___Landing-module__landing-page-lower-row___46v-s"},d.createElement("div",{className:"rb-client-js-modules-landing-___Landing-module__lower-row___R3vLy"},n?this.renderCarousel():d.createElement(sy,null))))))}}(0,pe.A)(my,"propTypes",{actions:y().exact({setFilters:y().func.isRequired,fetchUpcomingBookings:y().func.isRequired}).isRequired,userHasFavorites:y().bool.isRequired,showUpcomingBookings:y().bool,fetchedUpcomingBookings:y().bool.isRequired,hasUpcomingBookings:y().bool.isRequired,upcomingBookings:y().arrayOf(y().object),filters:y().shape({text:y().string,dates:y().shape({startDate:y().string,endDate:y().string}).isRequired}).isRequired}),(0,pe.A)(my,"defaultProps",{upcomingBookings:null,showUpcomingBookings:!0});const hy=(0,p.connect)((e=>({userHasFavorites:Qi(e),fetchedUpcomingBookings:ty(e),hasUpcomingBookings:ey(e),upcomingBookings:ny(e),filters:gc(e)})),(e=>({actions:{setFilters(t){e(ke("bookRoom",t))},fetchUpcomingBookings(){e((0,G.P$)((()=>D.indicoAxios.get(Nb())),Zb,[$b,Gb],Vb))}}})))(h.Ay.component("Landing",my)),py=(0,_e.combineReducers)({stats:(0,_e.combineReducers)({request:(0,G.Od)(qb,Hb,Ub),data:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;return t.type===zb?(0,fe.camelizeKeys)(t.data):e}}),upcomingBookings:(0,_e.combineReducers)({request:(0,G.Od)(Zb,Gb,Vb),data:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $b:return(0,fe.camelizeKeys)(t.data);case Je:return[];default:return e}}})}),_y=e=>{let{visible:t,disable:n}=e;if(!t)return null;const i=d.createElement("span",null,d.createElement(T.A,{name:"exclamation triangle"}),d.createElement(L.Translate,null,"Admin override enabled"),"."," ",d.createElement(L.Translate,null,"Use"," ",d.createElement(L.Param,{name:"shortcut",value:d.createElement(d.Fragment,null,d.createElement("kbd",null,"Ctrl")," + ",d.createElement("kbd",null,"Shift")," + ",d.createElement("kbd",null,"A"))})," ","to toggle."));return d.createElement("header",{className:"rb-client-js-components-___AdminOverrideBar-module__admin-override-bar___DPQeq"},d.createElement(mn.A,{trigger:i},d.createElement(L.Translate,null,"While in Admin Override mode, you can book any room regardless of restrictions and edit any booking.")),d.createElement("span",{className:"rb-client-js-components-___AdminOverrideBar-module__disable___E3Ihi",onClick:n},d.createElement(mn.A,{trigger:d.createElement(T.A,{name:"close"}),position:"top right",offset:[10,0]},d.createElement(L.Translate,null,"Disable admin override"))))};_y.propTypes={visible:y().bool.isRequired,disable:y().func.isRequired};const fy=(0,p.connect)((e=>({visible:Ui(e)})),(e=>({disable:(0,_e.bindActionCreators)(Ni,e)})))(_y);function gy(e){let{isAdmin:t,toggleAdminOverride:n}=e;const i=(0,d.useCallback)((e=>{e.ctrlKey&&e.shiftKey&&"A"===e.key&&t&&(e.preventDefault(),n())}),[t,n]);return(0,d.useEffect)((()=>(window.addEventListener("keydown",i),()=>{window.removeEventListener("keydown",i)})),[i]),null}gy.propTypes={isAdmin:y().bool.isRequired,toggleAdminOverride:y().func.isRequired};const by=(0,p.connect)((e=>({isAdmin:qi(e)})),(e=>({toggleAdminOverride:()=>e(Ni())})))(gy);function yy(e){let{namespace:t,path:n,children:i,resetPageState:o}=e;return d.createElement(St.Route,{path:n},(e=>{let{match:r}=e;return d.createElement("li",{className:(!r?"":(r?"selected":"")+" ")+"rb-client-js-components-___MenuItem-module__rb-menu-item___7D0Th"},d.createElement(mg.Link,{to:n,onClick:()=>o(t)},i))}))}yy.propTypes={namespace:y().string.isRequired,path:y().string.isRequired,children:y().node.isRequired,resetPageState:y().func.isRequired};const vy=(0,p.connect)(null,(e=>({resetPageState(t){e($(t))}})))(yy);function Ey(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ky(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ey(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ey(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Ay={bookRoom:d.createElement(L.Translate,null,"Book a Room"),roomList:d.createElement(L.Translate,null,"List of Rooms"),calendar:d.createElement(L.Translate,null,"Bookings")},Ty=[["bookRoom",{path:"/book",icon:"add square"}],["roomList",{path:"/rooms",icon:"list"}],["calendar",{path:"/calendar",icon:"calendar"}]];function wy(e){let{labels:t}=e;const n=ky(ky({},Ay),t);return d.createElement("ul",{className:"rb-client-js-components-___Menu-module__rb-menu___KTztc"},Ty.map((e=>{let[t,{path:i,icon:o}]=e;return d.createElement(vy,{key:t,path:i,namespace:t},d.createElement(T.A,{name:o}),d.createElement(xt.Responsive.Tablet,{as:"span",andLarger:!0},n[t]))})))}wy.propTypes={labels:y().object},wy.defaultProps={labels:{}};var Ly=n(94360),Dy=n.n(Ly);const Cy=["href","icon","modal","caption"],Oy=_.Ay.bind(null,{endpoint:"core.contact",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contact",isDynamic:!1}]}]},"/"),Ry=_.Ay.bind(null,{endpoint:"legal.display_privacy",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"privacy",isDynamic:!1}]}]},"/"),Sy=_.Ay.bind(null,{endpoint:"legal.display_tos",rules:[{args:[],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"tos",isDynamic:!1}]}]},"/");function Py(e){let{hasTOS:t,tosHTML:n,hasPrivacyPolicy:i,privacyPolicyHTML:o,helpURL:r,contactEmail:a}=e;const[s,l]=(0,d.useState)(null);const c=((e,t,n,i,o,r)=>{const a=[["help",{href:e,target:"_blank",rel:"noopener noreferrer",caption:L.Translate.string("Help"),icon:"question"}]];return r&&a.push(["contact",{href:Oy(),modal:!0,caption:L.Translate.string("Contact"),icon:"at"}]),t&&a.push(["tos",{href:Sy(),modal:n,target:"_blank",rel:"noopener noreferrer",caption:L.Translate.string("Terms and Conditions"),icon:"file text"}]),i&&a.push(["privacy",{href:Ry(),modal:o,target:"_blank",rel:"noopener noreferrer",caption:L.Translate.string("Privacy Policy"),icon:"eye"}]),a})(r,t,!!n,i,!!o,a);return d.createElement(d.Fragment,null,d.createElement(xt.Responsive.Phone,{andLarger:!0,minHeight:600},d.createElement(As.A.Item,null,c.map((e=>{let[t,n]=e;const{href:i,icon:o,modal:r,caption:a}=n,s=(0,In.A)(n,Cy);return d.createElement(Os.ResponsivePopup,{key:t,inverted:!0,position:"bottom right",trigger:d.createElement("a",(0,bn.A)({href:i,onClick:r?e=>function(e,t){l(t),e.preventDefault()}(e,t):void 0},s),d.createElement(T.A,{size:"large",name:o}))},a)})))),a&&d.createElement(Ts.A,{open:"contact"===s,size:"tiny",closeIcon:!0,onClose:()=>l(null)},d.createElement(Ts.A.Header,null,d.createElement(L.Translate,null,"Contact")),d.createElement(Ts.A.Content,null,d.createElement("div",null,d.createElement(L.Translate,null,"If you need support, you can contact the following email address:")),d.createElement("div",null,d.createElement("a",{href:`mailto:${a}`},a)))),n&&d.createElement(Ts.A,{open:"tos"===s,closeIcon:!0,onClose:()=>l(null)},d.createElement(Ts.A.Header,null,d.createElement(L.Translate,null,"Terms and Conditions")),d.createElement(Ts.A.Content,null,d.createElement("div",{dangerouslySetInnerHTML:{__html:n}}))),o&&d.createElement(Ts.A,{open:"privacy"===s,closeIcon:!0,onClose:()=>l(null)},d.createElement(Ts.A.Header,null,d.createElement(L.Translate,null,"Privacy Policy")),d.createElement(Ts.A.Content,null,d.createElement("div",{dangerouslySetInnerHTML:{__html:o}}))))}Py.propTypes={hasTOS:y().bool.isRequired,tosHTML:y().string,hasPrivacyPolicy:y().bool.isRequired,privacyPolicyHTML:y().string,helpURL:y().string.isRequired,contactEmail:y().string},Py.defaultProps={tosHTML:null,privacyPolicyHTML:null,contactEmail:null};const My=(0,p.connect)((e=>({contactEmail:de(e),helpURL:ae(e),hasTOS:se(e),tosHTML:le(e),hasPrivacyPolicy:ce(e),privacyPolicyHTML:ue(e)})))(Py);function xy(e){let{onClick:t,active:n}=e;const i=d.createElement(T.A,{name:"bars",size:"large"});return d.createElement("div",{className:(!n?"":(n?"active":"")+" ")+"rb-client-js-components-___SidebarMenu-module__sidebar-button___fHFJU"},n?i:d.createElement("div",{onClick:t},i))}function jy(e){let{isAdmin:t,isAdminOverrideEnabled:n,hasOwnedRooms:i,gotoMyBookings:o,gotoBookingsInMyRooms:r,gotoMyRoomsList:a,gotoMyBlockings:s,gotoRBAdminArea:l,toggleAdminOverride:c,visible:u,onClickOption:m,hideOptions:h,extraOptions:p}=e;const _=[{key:"my_bookings",icon:"list alternate outline",text:L.Translate.string("My Bookings"),onClick:o},{key:"bookings_my_rooms",icon:"checkmark",text:L.Translate.string("Bookings in My Rooms"),onClick:r,onlyIf:i},{key:"my_rooms",icon:"user",text:L.Translate.string("List of My Rooms"),onClick:a,onlyIf:i},{key:"my_blockings",icon:"window close outline",text:L.Translate.string("My Blockings"),onClick:s,onlyIf:!h.myBlockings},{key:"isAdmin",icon:"cogs",text:L.Translate.string("Administration"),onClick:l,onlyIf:t},{key:"adminOverride",icon:n?"unlock":"lock",text:L.Translate.string("Admin Override"),iconColor:n?"orange":void 0,active:n,onClick:c,onlyIf:t}].concat(p).filter((e=>{let{onlyIf:o}=e;return void 0===o||(Dy()(o)?o({isAdmin:t,isAdminOverrideEnabled:n,hasOwnedRooms:i}):o)}));return d.createElement(Sb.A,{as:As.A,animation:"overlay",icon:"labeled",vertical:!0,width:"thin",direction:"right",onHide:m,inverted:!0,visible:u,className:"rb-client-js-components-___SidebarMenu-module__sidebar___TVb2j"},_.map((e=>{let{key:t,text:n,icon:i,onClick:o,iconColor:r,active:a}=e;return d.createElement(As.A.Item,{as:"a",key:t,active:a,onClick:()=>{o(),m&&m()}},d.createElement(T.A,{name:i,color:r}),n)})),d.createElement("div",{className:"rb-client-js-components-___SidebarMenu-module__bottom-align___ZfQA8"},d.createElement(My,null)))}xy.propTypes={onClick:y().func.isRequired,active:y().bool.isRequired},jy.propTypes={extraOptions:y().arrayOf(y().shape({key:y().string.isRequired,icon:y().string.isRequired})),isAdmin:y().bool.isRequired,isAdminOverrideEnabled:y().bool.isRequired,hasOwnedRooms:y().bool.isRequired,gotoMyBookings:y().func.isRequired,gotoBookingsInMyRooms:y().func.isRequired,gotoMyRoomsList:y().func.isRequired,gotoMyBlockings:y().func.isRequired,gotoRBAdminArea:y().func.isRequired,toggleAdminOverride:y().func.isRequired,visible:y().bool,onClickOption:y().func,hideOptions:y().objectOf(y().bool)},jy.defaultProps={extraOptions:[],visible:!1,onClickOption:null,hideOptions:{}};const Iy=(0,p.connect)((e=>({isAdmin:qi(e),isAdminOverrideEnabled:Ui(e),hasOwnedRooms:$i(e)})),(e=>({dispatch:e,gotoMyBookings(){e($("calendar")),e(ke("calendar",{myBookings:!0,hideUnused:!0},!1)),e(z("/calendar?my_bookings=true&hide_unused=true"))},gotoBookingsInMyRooms(){e($("calendar")),e(ke("calendar",{onlyMine:!0,hideUnused:!0},!1)),e(z("/calendar?mine=true&hide_unused=true"))},gotoMyRoomsList(){e($("roomList")),e(ke("roomList",{onlyMine:!0},!1)),e(z("/rooms?mine=true"))},gotoMyBlockings(){e($("blockings")),e(function(e){return ke($d,e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1])}({myBlockings:!0},!1)),e(z("/blockings?my_blockings=true"))},gotoRBAdminArea(){e(z("/admin"))},toggleAdminOverride(){e(Ni())}})))(h.Ay.component("SidebarMenu",jy));class By extends d.Component{constructor(){super(...arguments),(0,pe.A)(this,"state",{userActionsVisible:!1}),(0,pe.A)(this,"onSidebarHide",(()=>{document.body.classList.remove("scrolling-disabled"),this.setState({userActionsVisible:!1})}))}componentDidMount(){const{fetchInitialData:e}=this.props;e()}renderContent(){const{filtersSet:e,isInitializing:t,renderExtraRoutes:n}=this.props,{userActionsVisible:i}=this.state;return d.createElement(Sb.A.Pushable,{className:"rb-client-js-components-___App-module__rb-pushable___gHirk"},d.createElement(Iy,{visible:i,onClickOption:this.onSidebarHide}),d.createElement(Sb.A.Pusher,{dimmed:i,className:"rb-client-js-components-___App-module__rb-pusher___xKHUI"},d.createElement("div",{className:"rb-client-js-components-___App-module__rb-content___YjslM"},d.createElement(St.Switch,null,d.createElement(St.Route,{exact:!0,path:"/",render:e=>{let{location:t}=e;return d.createElement(St.Redirect,{to:{pathname:"/book",search:t.search}})}}),d.createElement(xt.ConditionalRoute,{path:"/book",render:t=>{let{location:n,match:{isExact:i}}=t;return e?d.createElement(op,{location:n}):i?d.createElement(hy,null):d.createElement(St.Redirect,{to:"/book"})},active:!t}),d.createElement(xt.ConditionalRoute,{path:"/rooms",component:hh,active:!t}),d.createElement(xt.ConditionalRoute,{path:"/blockings",component:mm,active:!t}),d.createElement(xt.ConditionalRoute,{path:"/calendar",component:bf,active:!t}),d.createElement(xt.ConditionalRoute,{path:"/admin",component:Xg,active:!t}),n(t),d.createElement(St.Route,{render:()=>d.createElement(Ul.A,{placeholder:!0},d.createElement(ro.A,{icon:!0,color:"red"},d.createElement(T.A,{name:"exclamation triangle"}),d.createElement(L.Translate,null,"This page does not exist.")))})),d.createElement(Bb,null))))}render(){const{title:e,history:t,iconName:n,resetPageState:i,isInitializing:o}=this.props,{userActionsVisible:r}=this.state;return d.createElement(Lb,{history:t},d.createElement("div",{className:"rb-client-js-components-___App-module__rb-layout___4-78p"},d.createElement("header",{className:"rb-client-js-components-___App-module__rb-menu-bar___jdvem"},d.createElement("div",{className:"rb-client-js-components-___App-module__rb-menu-bar-side-left___cmsrh"},d.createElement("h1",null,d.createElement(mg.Link,{to:"/",onClick:()=>i("bookRoom")},d.createElement(T.A,{name:n}),d.createElement(Rb(),{as:"span",minWidth:500},e)))),d.createElement("div",{className:"rb-client-js-components-___App-module__rb-menu-bar-menu___P1NME"},d.createElement(h.Ay,{id:"Menu"},d.createElement(wy,null))),d.createElement("div",{className:"rb-client-js-components-___App-module__rb-menu-bar-side-right___ePX8S"},d.createElement(xy,{onClick:e=>{document.body.classList.add("scrolling-disabled"),this.setState({userActionsVisible:!0}),e.stopPropagation()},active:r}))),d.createElement(fy,null),d.createElement(by,null),!o&&d.createElement(Hp,null),this.renderContent(),d.createElement(pn.A.Dimmable,null,d.createElement(pn.A,{active:o,page:!0},d.createElement(_n.A,null)))))}}(0,pe.A)(By,"propTypes",{title:y().string,iconName:y().string,history:y().object.isRequired,filtersSet:y().bool.isRequired,isInitializing:y().bool.isRequired,fetchInitialData:y().func.isRequired,resetPageState:y().func.isRequired,renderExtraRoutes:y().func}),(0,pe.A)(By,"defaultProps",{title:L.Translate.string("Room Booking"),iconName:"home",renderExtraRoutes:()=>null});const Ny=(0,p.connect)((e=>({filtersSet:Mb(e),isInitializing:Pb(e)})),(e=>({fetchInitialData(){e(J()).then((()=>{e(Jt())})),e((async e=>{const t=await(0,G.P$)((()=>D.indicoAxios.get(hi())),pi,gi,fi)(e);return t.data&&(await(0,De.setMomentLocale)(t.data.momentLanguage),e({type:_i,data:t.data})),t})),e((0,G.P$)((()=>D.indicoAxios.get(ui())),bi,[Ei,yi],vi)),e(Bi()),e(Mo()),e(xo())},resetPageState(t){e($(t))}})))(h.Ay.component("App",By));function Fy(e){return function(e){if(Array.isArray(e))return zy(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return zy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zy(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}const qy=function(e){return function(t){return function(t){return function(n){if(n.type!==N)return t(n);var i=n.payload,o=i.method,r=i.args;e[o].apply(e,Fy(r))}}}},Hy={my_rooms:{stateField:gr("myRooms"),validator:Jc.Nc.isBoolean(),sanitizer:Jc.Nc.toBoolean()},my_blockings:{stateField:gr("myBlockings"),validator:Jc.Nc.isBoolean(),sanitizer:Jc.Nc.toBoolean()},timeframe:{stateField:"timeframe",validator:Jc.Nc.isIn(["recent","year","all"])}},Uy={"/blockings":{listen:[ye,ve],select:e=>{let{blockings:{filters:t}}=e;return t},serialize:Hy}},$y=(0,Jc.GP)(Hy,((e,t)=>t.type===H?{namespace:"blockings.filters",queryString:q.location.search.slice(1)}:null),((e,t)=>t?nu()({},e,rr()({},t,{myBlockings:!1,myRooms:!1,timeframe:"recent"})):e));function Zy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Gy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zy(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Vy=Gy(Gy({},uu),{},{date:{validator:e=>Jc.Nc.isDate(e)&&cr()(e).isBetween("1970-01-01","2999-12-31"),stateField:"datePicker.selectedDate"},mode:{validator:Jc.Nc.isIn(["days","weeks","months"]),stateField:br("datePicker.mode","days")},my_bookings:{validator:Jc.Nc.isBoolean(),sanitizer:Jc.Nc.toBoolean(),stateField:gr("filters.myBookings")},hide_unused:{validator:Jc.Nc.isBoolean(),sanitizer:Jc.Nc.toBoolean(),stateField:gr("filters.hideUnused")},show_inactive:{validator:Jc.Nc.isBoolean(),sanitizer:Jc.Nc.toBoolean(),stateField:gr("filters.showInactive")},view:{validator:Jc.Nc.isIn(["timeline","list"]),stateField:br("view","calendar")}}),Wy={"/calendar":{listen:[ye,ve,V_,W_,G_],select:e=>{let{calendar:t}=e;return t},serialize:Vy}},Ky=(0,Jc.GP)(Vy,((e,t)=>t.type===H?{namespace:"calendar",queryString:q.location.search.slice(1)}:null),((e,t)=>t?nu()({},e,rr()({},t,{filters:au("calendar"),data:Tf,datePicker:Af(),activeBookings:wf,view:"timeline"})):e)),Yy={"/rooms":{listen:[ye,ve],select:e=>{let{roomList:{filters:t}}=e;return{filters:t}},serialize:uu}},Xy=e=>({router:Db(e),config:ob,user:io,bookRoom:Gh,roomList:ph,map:ai,rooms:hs,blockings:wm,calendar:Cf,landing:py,bookings:tc,admin:eb,linking:Fp});function Qy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Jy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qy(Object(n),!0).forEach((function(t){(0,pe.A)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n(40285),n(31051);!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];window.addEventListener("scroll",u()((()=>{document.body.style.setProperty("--offset",window.pageYOffset)}),500)),document.addEventListener("DOMContentLoaded",(()=>{const n=document.getElementById("rb-app-container"),r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,G.Ay)("rb-new",Xy(q),{},[qy(q),(0,Jc.i7)(q,{reduxPathname:e=>{let{router:{location:{pathname:t}}}=e;return t},routes:Jy(Jy(Jy(Jy({},Yy),Wh),Wy),Uy)},{usePush:!1})],[du,Kh,Ky,$y,...e])}(t);let a=q.location.pathname;var s;q.listen((e=>{let{pathname:t}=e;a.startsWith("/admin")&&!t.startsWith("/admin")&&(r.dispatch(J()),r.dispatch(Mo()),r.dispatch(xo()),r.dispatch(Bi())),a=t})),r.dispatch({type:H}),r.dispatch((s=q.location.search.slice(1),async e=>{const{linkType:t,linkId:n}=(0,fe.camelizeKeys)(E().parse(s));if(void 0===t||void 0===n)return;let i;try{i=await D.indicoAxios.get(lc({type:sc()(t),id:n}))}catch(e){return void(0,D.handleAxiosError)(e)}const o=(0,fe.camelizeKeys)(i.data);o.canAccess&&e({type:cc,objectType:rc()(t),objectId:+n,objectTitle:o.title,eventURL:o.eventURL,eventTitle:o.eventTitle,ownRoomId:o.ownRoomId,ownRoomName:o.ownRoomName,startDt:o.startDt,endDt:o.endDt})})),function(e,t,n,i){const o=(0,p.connect)((e=>({userData:n.getUserInfo(e),languages:i.getLanguages(e),hasLoadedConfig:i.hasLoadedConfig(e),hasLoadedUserInfo:n.hasLoadedUserInfo(e)})))(I);m.render(d.createElement(p.Provider,{store:t},d.createElement(o,null)),e)}(document.getElementById("indico-user-menu-container"),r,o,i),m.render(d.createElement(h.r3.Provider,{value:e},d.createElement(p.Provider,{store:r},d.createElement(Ny,{history:q}))),n)}))}()},36643:()=>{var e,t;e=window,t=document,L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(e,t){this._map=e,this._container=e._container,this._overlayPane=e._panes.overlayPane,this._popupPane=e._panes.popupPane,t&&t.shapeOptions&&(t.shapeOptions=L.Util.extend({},this.options.shapeOptions,t.shapeOptions)),L.setOptions(this,t);var n=L.version.split(".");1===parseInt(n[0],10)&&parseInt(n[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var e=this._map;e&&(L.DomUtil.disableTextSelection(),e.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(e){L.setOptions(this,e)},_fireCreatedEvent:function(e){this._map.fire(L.Draw.Event.CREATED,{layer:e,layerType:this.type})},_cancelDrawing:function(e){27===e.keyCode&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(e,t){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,t&&t.drawError&&(t.drawError=L.Util.extend({},this.options.drawError,t.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,e,t)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var e=this._markers.pop(),t=this._poly,n=t.getLatLngs(),i=n.splice(-1,1)[0];this._poly.setLatLngs(n),this._markerGroup.removeLayer(e),t.getLatLngs().length<2&&this._map.removeLayer(t),this._vertexChanged(i,!1)}},addVertex:function(e){this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(e)?this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(e)),this._poly.addLatLng(e),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._vertexChanged(e,!0))},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var e=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),t=this._poly.newLatLngIntersects(e[e.length-1]);!this.options.allowIntersection&&t||!this._shapeIsValid()?this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_shapeIsValid:function(){return!0},_onZoomEnd:function(){null!==this._markers&&this._updateGuide()},_onMouseMove:function(e){var t=this._map.mouseEventToLayerPoint(e.originalEvent),n=this._map.layerPointToLatLng(t);this._currentLatLng=n,this._updateTooltip(n),this._updateGuide(t),this._mouseMarker.setLatLng(n),L.DomEvent.preventDefault(e.originalEvent)},_vertexChanged:function(e,t){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(e,t),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(e){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(e),this._clickHandled=!0,this._disableNewMarkers();var t=e.originalEvent,n=t.clientX,i=t.clientY;this._startPoint.call(this,n,i)}},_startPoint:function(e,t){this._mouseDownOrigin=L.point(e,t)},_onMouseUp:function(e){var t=e.originalEvent,n=t.clientX,i=t.clientY;this._endPoint.call(this,n,i,e),this._clickHandled=null},_endPoint:function(t,n,i){if(this._mouseDownOrigin){var o=L.point(t,n).distanceTo(this._mouseDownOrigin),r=this._calculateFinishDistance(i.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(i.latlng),this._finishShape()):r<10&&L.Browser.touch?this._finishShape():Math.abs(o)<9*(e.devicePixelRatio||1)&&this.addVertex(i.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(e){var t,n,i=e.originalEvent;!i.touches||!i.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(t=i.touches[0].clientX,n=i.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,t,n),this._endPoint.call(this,t,n,e),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(e){var t;if(this._markers.length>0){var n;if(this.type===L.Draw.Polyline.TYPE)n=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;n=this._markers[0]}var i=this._map.latLngToContainerPoint(n.getLatLng()),o=new L.Marker(e,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),r=this._map.latLngToContainerPoint(o.getLatLng());t=i.distanceTo(r)}else t=1/0;return t},_updateFinishHandler:function(){var e=this._markers.length;e>1&&this._markers[e-1].on("click",this._finishShape,this),e>2&&this._markers[e-2].off("click",this._finishShape,this)},_createMarker:function(e){var t=new L.Marker(e,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(t),t},_updateGuide:function(e){var t=this._markers?this._markers.length:0;t>0&&(e=e||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[t-1].getLatLng()),e))},_updateTooltip:function(e){var t=this._getTooltipText();e&&this._tooltip.updatePosition(e),this._errorShown||this._tooltip.updateContent(t)},_drawGuide:function(e,t){var n,i,o,r=Math.floor(Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))),a=this.options.guidelineDistance,s=this.options.maxGuideLineLength,l=r>s?r-s:a;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));l<r;l+=this.options.guidelineDistance)n=l/r,i={x:Math.floor(e.x*(1-n)+n*t.x),y:Math.floor(e.y*(1-n)+n*t.y)},(o=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer)).style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(o,i)},_updateGuideColor:function(e){if(this._guidesContainer)for(var t=0,n=this._guidesContainer.childNodes.length;t<n;t++)this._guidesContainer.childNodes[t].style.backgroundColor=e},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var e,t,n=this.options.showLength;return 0===this._markers.length?e={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(t=n?this._getMeasurementString():"",e=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:t}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:t}),e},_updateRunningMeasure:function(e,t){var n,i,o=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(n=o-(t?2:1),i=L.GeometryUtil.isVersion07x()?e.distanceTo(this._markers[n].getLatLng())*(this.options.factor||1):this._map.distance(e,this._markers[n].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=i*(t?1:-1))},_getMeasurementString:function(){var e,t=this._currentLatLng,n=this._markers[this._markers.length-1].getLatLng();return e=L.GeometryUtil.isVersion07x()?n&&t&&t.distanceTo?this._measurementRunningTotal+t.distanceTo(n)*(this.options.factor||1):this._measurementRunningTotal||0:n&&t?this._measurementRunningTotal+this._map.distance(t,n)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(e,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var e=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,e)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(e,t){L.Draw.Polyline.prototype.initialize.call(this,e,t),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var e=this._markers.length;1===e&&this._markers[0].on("click",this._finishShape,this),e>2&&(this._markers[e-1].on("dblclick",this._finishShape,this),e>3&&this._markers[e-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var e,t;return 0===this._markers.length?e=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(e=L.drawLocal.draw.handlers.polygon.tooltip.cont,t=this._getMeasurementString()):(e=L.drawLocal.draw.handlers.polygon.tooltip.end,t=this._getMeasurementString()),{text:e,subtext:t}},_getMeasurementString:function(){var e=this._area,t="";return e||this.options.showLength?(this.options.showLength&&(t=L.Draw.Polyline.prototype._getMeasurementString.call(this)),e&&(t+="<br>"+L.GeometryUtil.readableArea(e,this.options.metric,this.options.precision)),t):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(e,t){var n;!this.options.allowIntersection&&this.options.showArea&&(n=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(n)),L.Draw.Polyline.prototype._vertexChanged.call(this,e,t)},_cleanUpShape:function(){var e=this._markers.length;e>0&&(this._markers[0].off("click",this._finishShape,this),e>2&&this._markers[e-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(e,t){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,e,t)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),t.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(t,"mouseup",this._onMouseUp,this),L.DomEvent.off(t,"touchend",this._onMouseUp,this),t.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(e){this._isDrawing=!0,this._startLatLng=e.latlng,L.DomEvent.on(t,"mouseup",this._onMouseUp,this).on(t,"touchend",this._onMouseUp,this).preventDefault(e.originalEvent)},_onMouseMove:function(e){var t=e.latlng;this._tooltip.updatePosition(t),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(t))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(e,t){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,e,t)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(e){this._shape||this._isCurrentlyTwoClickDrawing?this._isCurrentlyTwoClickDrawing&&!function(e,t){for(;(e=e.parentElement)&&!e.classList.contains(t););return e}(e.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this):this._isCurrentlyTwoClickDrawing=!0},_drawShape:function(e){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,e)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,e),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var e=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,e)},_getTooltipText:function(){var e,t,n,i=L.Draw.SimpleShape.prototype._getTooltipText.call(this),o=this._shape,r=this.options.showArea;return o&&(e=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),t=L.GeometryUtil.geodesicArea(e),n=r?L.GeometryUtil.readableArea(t,this.options.metric):""),{text:i.text,subtext:n}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(e,t){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,e,t)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(e){var t=e.latlng;this._tooltip.updatePosition(t),this._mouseMarker.setLatLng(t),this._marker?(t=this._mouseMarker.getLatLng(),this._marker.setLatLng(t)):(this._marker=this._createMarker(t),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(e){return new L.Marker(e,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(e){this._onMouseMove(e),this._onClick()},_fireCreatedEvent:function(){var e=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,e)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(e,t){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,e,t)},_fireCreatedEvent:function(){var e=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,e)},_createMarker:function(e){return new L.CircleMarker(e,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(e,t){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,e,t)},_drawShape:function(e){if(L.GeometryUtil.isVersion07x())var t=this._startLatLng.distanceTo(e);else t=this._map.distance(this._startLatLng,e);this._shape?this._shape.setRadius(t):(this._shape=new L.Circle(this._startLatLng,t,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var e=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,e)},_onMouseMove:function(e){var t,n=e.latlng,i=this.options.showRadius,o=this.options.metric;if(this._tooltip.updatePosition(n),this._isDrawing){this._drawShape(n),t=this._shape.getRadius().toFixed(1);var r="";i&&(r=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(t,o,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:r})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(e,t){this._marker=e,L.setOptions(this,t)},addHooks:function(){var e=this._marker;e.dragging.enable(),e.on("dragend",this._onDragEnd,e),this._toggleMarkerHighlight()},removeHooks:function(){var e=this._marker;e.dragging.disable(),e.off("dragend",this._onDragEnd,e),this._toggleMarkerHighlight()},_onDragEnd:function(e){var t=e.target;t.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:t})},_toggleMarkerHighlight:function(){var e=this._marker._icon;e&&(e.style.display="none",L.DomUtil.hasClass(e,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(e,"leaflet-edit-marker-selected"),this._offsetMarker(e,-4)):(L.DomUtil.addClass(e,"leaflet-edit-marker-selected"),this._offsetMarker(e,4)),e.style.display="")},_offsetMarker:function(e,t){var n=parseInt(e.style.marginTop,10)-t,i=parseInt(e.style.marginLeft,10)-t;e.style.marginTop=n+"px",e.style.marginLeft=i+"px"}}),L.Marker.addInitHook((function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())})),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(e){this.latlngs=[e._latlngs],e._holes&&(this.latlngs=this.latlngs.concat(e._holes)),this._poly=e,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(e){for(var t=0;t<this._verticesHandlers.length;t++)e(this._verticesHandlers[t])},addHooks:function(){this._initHandlers(),this._eachVertexHandler((function(e){e.addHooks()}))},removeHooks:function(){this._eachVertexHandler((function(e){e.removeHooks()}))},updateMarkers:function(){this._eachVertexHandler((function(e){e.updateMarkers()}))},_initHandlers:function(){this._verticesHandlers=[];for(var e=0;e<this.latlngs.length;e++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[e],this._poly.options.poly))},_updateLatLngs:function(e){this.latlngs=[e.layer._latlngs],e.layer._holes&&(this.latlngs=this.latlngs.concat(e.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(e,t,n){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=e,n&&n.drawError&&(n.drawError=L.Util.extend({},this.options.drawError,n.drawError)),this._latlngs=t,L.setOptions(this,n)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var e=this._poly,t=e._path;e instanceof L.Polygon||(e.options.fill=!1,e.options.editing&&(e.options.editing.fill=!1)),t&&e.options.editing&&e.options.editing.className&&(e.options.original.className&&e.options.original.className.split(" ").forEach((function(e){L.DomUtil.removeClass(t,e)})),e.options.editing.className.split(" ").forEach((function(e){L.DomUtil.addClass(t,e)}))),e.setStyle(e.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var e=this._poly,t=e._path;t&&e.options.editing&&e.options.editing.className&&(e.options.editing.className.split(" ").forEach((function(e){L.DomUtil.removeClass(t,e)})),e.options.original.className&&e.options.original.className.split(" ").forEach((function(e){L.DomUtil.addClass(t,e)}))),e.setStyle(e.options.original),e._map&&(e._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var e,t,n,i,o,r,a=this._defaultShape();for(e=0,n=a.length;e<n;e++)(i=this._createMarker(a[e],e)).on("click",this._onMarkerClick,this),i.on("contextmenu",this._onContextMenu,this),this._markers.push(i);for(e=0,t=n-1;e<n;t=e++)(0!==e||L.Polygon&&this._poly instanceof L.Polygon)&&(o=this._markers[t],r=this._markers[e],this._createMiddleMarker(o,r),this._updatePrevNext(o,r))},_createMarker:function(e,t){var n=new L.Marker.Touch(e,{draggable:!0,icon:this.options.icon});return n._origLatLng=e,n._index=t,n.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(n),n},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var e=this._defaultShape(),t=[].splice.apply(e,arguments);return this._poly._convertLatLngs(e,!0),this._poly.redraw(),t},_removeMarker:function(e){var t=e._index;this._markerGroup.removeLayer(e),this._markers.splice(t,1),this._spliceLatLngs(t,1),this._updateIndexes(t,-1),e.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(e){var t=e.target,n=this._poly,i=L.LatLngUtil.cloneLatLng(t._origLatLng);if(L.extend(t._origLatLng,t._latlng),n.options.poly){var o=n._map._editTooltip;if(!n.options.poly.allowIntersection&&n.intersects()){L.extend(t._origLatLng,i),t.setLatLng(i);var r=n.options.color;n.setStyle({color:this.options.drawError.color}),o&&o.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout((function(){n.setStyle({color:r}),o&&o.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})}),1e3)}}t._middleLeft&&t._middleLeft.setLatLng(this._getMiddleLatLng(t._prev,t)),t._middleRight&&t._middleRight.setLatLng(this._getMiddleLatLng(t,t._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var a=this._poly.getLatLngs();this._poly._convertLatLngs(a,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(e){var t=L.Polygon&&this._poly instanceof L.Polygon?4:3,n=e.target;this._defaultShape().length<t||(this._removeMarker(n),this._updatePrevNext(n._prev,n._next),n._middleLeft&&this._markerGroup.removeLayer(n._middleLeft),n._middleRight&&this._markerGroup.removeLayer(n._middleRight),n._prev&&n._next?this._createMiddleMarker(n._prev,n._next):n._prev?n._next||(n._prev._middleRight=null):n._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(e){var t=e.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:t,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(e){var t=this._map.mouseEventToLayerPoint(e.originalEvent.touches[0]),n=this._map.layerPointToLatLng(t),i=e.target;L.extend(i._origLatLng,n),i._middleLeft&&i._middleLeft.setLatLng(this._getMiddleLatLng(i._prev,i)),i._middleRight&&i._middleRight.setLatLng(this._getMiddleLatLng(i,i._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(e,t){this._markerGroup.eachLayer((function(n){n._index>e&&(n._index+=t)}))},_createMiddleMarker:function(e,t){var n,i,o,r=this._getMiddleLatLng(e,t),a=this._createMarker(r);a.setOpacity(.6),e._middleRight=t._middleLeft=a,i=function(){a.off("touchmove",i,this);var o=t._index;a._index=o,a.off("click",n,this).on("click",this._onMarkerClick,this),r.lat=a.getLatLng().lat,r.lng=a.getLatLng().lng,this._spliceLatLngs(o,0,r),this._markers.splice(o,0,a),a.setOpacity(1),this._updateIndexes(o,1),t._index++,this._updatePrevNext(e,a),this._updatePrevNext(a,t),this._poly.fire("editstart")},o=function(){a.off("dragstart",i,this),a.off("dragend",o,this),a.off("touchmove",i,this),this._createMiddleMarker(e,a),this._createMiddleMarker(a,t)},n=function(){i.call(this),o.call(this),this._fireEdit()},a.on("click",n,this).on("dragstart",i,this).on("dragend",o,this).on("touchmove",i,this),this._markerGroup.addLayer(a)},_updatePrevNext:function(e,t){e&&(e._next=t),t&&(t._prev=e)},_getMiddleLatLng:function(e,t){var n=this._poly._map,i=n.project(e.getLatLng()),o=n.project(t.getLatLng());return n.unproject(i._add(o)._divideBy(2))}}),L.Polyline.addInitHook((function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",(function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()})),this.on("remove",(function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})))})),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(e,t){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=e,L.Util.setOptions(this,t)},addHooks:function(){var e=this._shape;this._shape._map&&(this._map=this._shape._map,e.setStyle(e.options.editing),e._map&&(this._map=e._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var e=this._shape;if(e.setStyle(e.options.original),e._map){this._unbindMarker(this._moveMarker);for(var t=0,n=this._resizeMarkers.length;t<n;t++)this._unbindMarker(this._resizeMarkers[t]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(e,t){var n=new L.Marker.Touch(e,{draggable:!0,icon:t,zIndexOffset:10});return this._bindMarker(n),this._markerGroup.addLayer(n),n},_bindMarker:function(e){e.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(e){e.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(e){e.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(e){var t=e.target,n=t.getLatLng();t===this._moveMarker?this._move(n):this._resize(n),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(e){e.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(e){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,e),"function"==typeof this._getCorners){var t=this._getCorners(),n=e.target,i=n._cornerIndex;n.setOpacity(0),this._oppositeCorner=t[(i+2)%4],this._toggleCornerMarkers(0,i)}this._shape.fire("editstart")},_onTouchMove:function(e){var t=this._map.mouseEventToLayerPoint(e.originalEvent.touches[0]),n=this._map.layerPointToLatLng(t);return e.target===this._moveMarker?this._move(n):this._resize(n),this._shape.redraw(),!1},_onTouchEnd:function(e){e.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var e=this._shape.getBounds().getCenter();this._moveMarker=this._createMarker(e,this.options.moveIcon)},_createResizeMarker:function(){var e=this._getCorners();this._resizeMarkers=[];for(var t=0,n=e.length;t<n;t++)this._resizeMarkers.push(this._createMarker(e[t],this.options.resizeIcon)),this._resizeMarkers[t]._cornerIndex=t},_onMarkerDragStart:function(e){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,e);var t=this._getCorners(),n=e.target._cornerIndex;this._oppositeCorner=t[(n+2)%4],this._toggleCornerMarkers(0,n)},_onMarkerDragEnd:function(e){var t,n=e.target;n===this._moveMarker&&(t=this._shape.getBounds().getCenter(),n.setLatLng(t)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,e)},_move:function(e){for(var t,n=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),i=this._shape.getBounds().getCenter(),o=[],r=0,a=n.length;r<a;r++)t=[n[r].lat-i.lat,n[r].lng-i.lng],o.push([e.lat+t[0],e.lng+t[1]]);this._shape.setLatLngs(o),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(e){var t;this._shape.setBounds(L.latLngBounds(e,this._oppositeCorner)),t=this._shape.getBounds(),this._moveMarker.setLatLng(t.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var e=this._shape.getBounds();return[e.getNorthWest(),e.getNorthEast(),e.getSouthEast(),e.getSouthWest()]},_toggleCornerMarkers:function(e){for(var t=0,n=this._resizeMarkers.length;t<n;t++)this._resizeMarkers[t].setOpacity(e)},_repositionCornerMarkers:function(){for(var e=this._getCorners(),t=0,n=this._resizeMarkers.length;t<n;t++)this._resizeMarkers[t].setLatLng(e[t])}}),L.Rectangle.addInitHook((function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())})),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var e=this._shape.getLatLng();this._moveMarker=this._createMarker(e,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(e){if(this._resizeMarkers.length){var t=this._getResizeMarkerPoint(e);this._resizeMarkers[0].setLatLng(t)}this._shape.setLatLng(e),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook((function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",(function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()})),this.on("remove",(function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))})),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var e=this._shape.getLatLng(),t=this._getResizeMarkerPoint(e);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(t,this.options.resizeIcon))},_getResizeMarkerPoint:function(e){var t=this._shape._radius*Math.cos(Math.PI/4),n=this._map.project(e);return this._map.unproject([n.x+t,n.y-t])},_resize:function(e){var t=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=t.distanceTo(e):radius=this._map.distance(t,e),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook((function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())})),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(e,t){var n={};if(void 0!==e.touches){if(!e.touches.length)return;n=e.touches[0]}else{if("touch"!==e.pointerType)return;if(n=e,!this._filterClick(e))return}var i=this._map.mouseEventToContainerPoint(n),o=this._map.mouseEventToLayerPoint(n),r=this._map.layerPointToLatLng(o);this._map.fire(t,{latlng:r,layerPoint:o,containerPoint:i,pageX:n.pageX,pageY:n.pageY,originalEvent:e})},_filterClick:function(e){var t=e.timeStamp||e.originalEvent.timeStamp,n=L.DomEvent._lastClick&&t-L.DomEvent._lastClick;return n&&n>100&&n<500||e.target._simulatedClick&&!e._simulated?(L.DomEvent.stop(e),!1):(L.DomEvent._lastClick=t,!0)},_onTouchStart:function(e){this._map._loaded&&this._touchEvent(e,"touchstart")},_onTouchEnd:function(e){this._map._loaded&&this._touchEvent(e,"touchend")},_onTouchCancel:function(e){if(this._map._loaded){var t="touchcancel";this._detectIE()&&(t="pointercancel"),this._touchEvent(e,t)}},_onTouchLeave:function(e){this._map._loaded&&this._touchEvent(e,"touchleave")},_onTouchMove:function(e){this._map._loaded&&this._touchEvent(e,"touchmove")},_detectIE:function(){var t=e.navigator.userAgent,n=t.indexOf("MSIE ");if(n>0)return parseInt(t.substring(n+5,t.indexOf(".",n)),10);if(t.indexOf("Trident/")>0){var i=t.indexOf("rv:");return parseInt(t.substring(i+3,t.indexOf(".",i)),10)}var o=t.indexOf("Edge/");return o>0&&parseInt(t.substring(o+5,t.indexOf(".",o)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var e=this._icon,t=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?t.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):t.concat(["touchcancel"]),L.DomUtil.addClass(e,"leaflet-clickable"),L.DomEvent.on(e,"click",this._onMouseClick,this),L.DomEvent.on(e,"keypress",this._onKeyPress,this);for(var n=0;n<t.length;n++)L.DomEvent.on(e,t[n],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var t=e.navigator.userAgent,n=t.indexOf("MSIE ");if(n>0)return parseInt(t.substring(n+5,t.indexOf(".",n)),10);if(t.indexOf("Trident/")>0){var i=t.indexOf("rv:");return parseInt(t.substring(i+3,t.indexOf(".",i)),10)}var o=t.indexOf("Edge/");return o>0&&parseInt(t.substring(o+5,t.indexOf(".",o)),10)}}),L.LatLngUtil={cloneLatLngs:function(e){for(var t=[],n=0,i=e.length;n<i;n++)Array.isArray(e[n])?t.push(L.LatLngUtil.cloneLatLngs(e[n])):t.push(this.cloneLatLng(e[n]));return t},cloneLatLng:function(e){return L.latLng(e.lat,e.lng)}},function(){var e={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(e){var t,n,i=e.length,o=0,r=Math.PI/180;if(i>2){for(var a=0;a<i;a++)t=e[a],o+=((n=e[(a+1)%i]).lng-t.lng)*r*(2+Math.sin(t.lat*r)+Math.sin(n.lat*r));o=6378137*o*6378137/2}return Math.abs(o)},formattedNumber:function(e,t){var n=parseFloat(e).toFixed(t),i=L.drawLocal.format&&L.drawLocal.format.numeric,o=i&&i.delimiters,r=o&&o.thousands,a=o&&o.decimal;if(r||a){var s=n.split(".");n=r?s[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+r):s[0],a=a||".",s.length>1&&(n=n+a+s[1])}return n},readableArea:function(t,n,i){var o,r;return i=L.Util.extend({},e,i),n?(r=["ha","m"],type=typeof n,"string"===type?r=[n]:"boolean"!==type&&(r=n),o=t>=1e6&&-1!==r.indexOf("km")?L.GeometryUtil.formattedNumber(1e-6*t,i.km)+" km²":t>=1e4&&-1!==r.indexOf("ha")?L.GeometryUtil.formattedNumber(1e-4*t,i.ha)+" ha":L.GeometryUtil.formattedNumber(t,i.m)+" m²"):o=(t/=.836127)>=3097600?L.GeometryUtil.formattedNumber(t/3097600,i.mi)+" mi²":t>=4840?L.GeometryUtil.formattedNumber(t/4840,i.ac)+" acres":L.GeometryUtil.formattedNumber(t,i.yd)+" yd²",o},readableDistance:function(t,n,i,o,r){var a;switch(r=L.Util.extend({},e,r),n?"string"==typeof n?n:"metric":i?"feet":o?"nauticalMile":"yards"){case"metric":a=t>1e3?L.GeometryUtil.formattedNumber(t/1e3,r.km)+" km":L.GeometryUtil.formattedNumber(t,r.m)+" m";break;case"feet":t*=3.28083,a=L.GeometryUtil.formattedNumber(t,r.ft)+" ft";break;case"nauticalMile":t*=.53996,a=L.GeometryUtil.formattedNumber(t/1e3,r.nm)+" nm";break;default:a=(t*=1.09361)>1760?L.GeometryUtil.formattedNumber(t/1760,r.mi)+" miles":L.GeometryUtil.formattedNumber(t,r.yd)+" yd"}return a},isVersion07x:function(){var e=L.version.split(".");return 0===parseInt(e[0],10)&&7===parseInt(e[1],10)}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(e,t,n,i){return this._checkCounterclockwise(e,n,i)!==this._checkCounterclockwise(t,n,i)&&this._checkCounterclockwise(e,t,n)!==this._checkCounterclockwise(e,t,i)},_checkCounterclockwise:function(e,t,n){return(n.y-e.y)*(t.x-e.x)>(t.y-e.y)*(n.x-e.x)}}),L.Polyline.include({intersects:function(){var e,t,n,i=this._getProjectedPoints(),o=i?i.length:0;if(this._tooFewPointsForIntersection())return!1;for(e=o-1;e>=3;e--)if(t=i[e-1],n=i[e],this._lineSegmentsIntersectsRange(t,n,e-2))return!0;return!1},newLatLngIntersects:function(e,t){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(e),t)},newPointIntersects:function(e,t){var n=this._getProjectedPoints(),i=n?n.length:0,o=n?n[i-1]:null,r=i-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(o,e,r,t?1:0)},_tooFewPointsForIntersection:function(e){var t=this._getProjectedPoints(),n=t?t.length:0;return!t||(n+=e||0)<=3},_lineSegmentsIntersectsRange:function(e,t,n,i){var o,r,a=this._getProjectedPoints();i=i||0;for(var s=n;s>i;s--)if(o=a[s-1],r=a[s],L.LineUtil.segmentsIntersect(e,t,o,r))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var e=[],t=this._defaultShape(),n=0;n<t.length;n++)e.push(this._map.latLngToLayerPoint(t[n]));return e}}),L.Polygon.include({intersects:function(){var e,t,n,i,o=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(e=o.length,t=o[0],n=o[e-1],i=e-2,this._lineSegmentsIntersectsRange(n,t,i,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(e){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");var t;L.Control.prototype.initialize.call(this,e),this._toolbars={},L.DrawToolbar&&this.options.draw&&(t=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=t,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(t=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=t,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(e){var t,n=L.DomUtil.create("div","leaflet-draw"),i=!1;for(var o in this._toolbars)this._toolbars.hasOwnProperty(o)&&(t=this._toolbars[o].addToolbar(e))&&(i||(L.DomUtil.hasClass(t,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(t.childNodes[0],"leaflet-draw-toolbar-top"),i=!0),n.appendChild(t));return n},onRemove:function(){for(var e in this._toolbars)this._toolbars.hasOwnProperty(e)&&this._toolbars[e].removeToolbar()},setDrawingOptions:function(e){for(var t in this._toolbars)this._toolbars[t]instanceof L.DrawToolbar&&this._toolbars[t].setOptions(e)},_toolbarEnabled:function(e){var t=e.target;for(var n in this._toolbars)this._toolbars[n]!==t&&this._toolbars[n].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook((function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))})),L.Toolbar=L.Class.extend({initialize:function(e){L.setOptions(this,e),this._modes={},this._actionButtons=[],this._activeMode=null;var t=L.version.split(".");1===parseInt(t[0],10)&&parseInt(t[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(e){var t,n=L.DomUtil.create("div","leaflet-draw-section"),i=0,o=this._toolbarClass||"",r=this.getModeHandlers(e);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=e,t=0;t<r.length;t++)r[t].enabled&&this._initModeHandler(r[t].handler,this._toolbarContainer,i++,o,r[t].title);if(i)return this._lastButtonIndex=--i,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),n.appendChild(this._toolbarContainer),n.appendChild(this._actionsContainer),n},removeToolbar:function(){for(var e in this._modes)this._modes.hasOwnProperty(e)&&(this._disposeButton(this._modes[e].button,this._modes[e].handler.enable,this._modes[e].handler),this._modes[e].handler.disable(),this._modes[e].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var t=0,n=this._actionButtons.length;t<n;t++)this._disposeButton(this._actionButtons[t].button,this._actionButtons[t].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(e,t,n,i,o){var r=e.type;this._modes[r]={},this._modes[r].handler=e,this._modes[r].button=this._createButton({type:r,title:o,className:i+"-"+r,container:t,callback:this._modes[r].handler.enable,context:this._modes[r].handler}),this._modes[r].buttonIndex=n,this._modes[r].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!e.MSStream},_createButton:function(e){var t=L.DomUtil.create("a",e.className||"",e.container),n=L.DomUtil.create("span","sr-only",e.container);t.href="#",t.appendChild(n),e.title&&(t.title=e.title,n.innerHTML=e.title),e.text&&(t.innerHTML=e.text,n.innerHTML=e.text);var i=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(t,"click",L.DomEvent.stopPropagation).on(t,"mousedown",L.DomEvent.stopPropagation).on(t,"dblclick",L.DomEvent.stopPropagation).on(t,"touchstart",L.DomEvent.stopPropagation).on(t,"click",L.DomEvent.preventDefault).on(t,i,e.callback,e.context),t},_disposeButton:function(e,t){var n=this._detectIOS()?"touchstart":"click";L.DomEvent.off(e,"click",L.DomEvent.stopPropagation).off(e,"mousedown",L.DomEvent.stopPropagation).off(e,"dblclick",L.DomEvent.stopPropagation).off(e,"touchstart",L.DomEvent.stopPropagation).off(e,"click",L.DomEvent.preventDefault).off(e,n,t)},_handlerActivated:function(e){this.disable(),this._activeMode=this._modes[e.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(e){var t,n,i,o,r=this._actionsContainer,a=this.getActions(e),s=a.length;for(n=0,i=this._actionButtons.length;n<i;n++)this._disposeButton(this._actionButtons[n].button,this._actionButtons[n].callback);for(this._actionButtons=[];r.firstChild;)r.removeChild(r.firstChild);for(var l=0;l<s;l++)"enabled"in a[l]&&!a[l].enabled||(t=L.DomUtil.create("li","",r),o=this._createButton({title:a[l].title,text:a[l].text,container:t,callback:a[l].callback,context:a[l].context}),this._actionButtons.push({button:o,callback:a[l].callback}))},_showActionsToolbar:function(){var e=this._activeMode.buttonIndex,t=this._lastButtonIndex,n=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=n+"px",0===e&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),e===t&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(e){this._map=e,this._popupPane=e._panes.popupPane,this._visible=!1,this._container=e.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(e){return this._container?(e.subtext=e.subtext||"",0!==e.subtext.length||this._singleLineLabel?e.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(e.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+e.subtext+"</span><br />":"")+"<span>"+e.text+"</span>",e.text||e.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(e){var t=this._map.latLngToLayerPoint(e),n=this._container;return this._container&&(this._visible&&(n.style.visibility="inherit"),L.DomUtil.setPosition(n,t)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(e){for(var t in this.options)this.options.hasOwnProperty(t)&&e[t]&&(e[t]=L.extend({},this.options[t],e[t]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,e)},getModeHandlers:function(e){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(e,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(e,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(e,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(e,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(e,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(e,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(e){return[{enabled:e.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:e.completeShape,context:e},{enabled:e.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:e.deleteLastVertex,context:e},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(e){for(var t in L.setOptions(this,e),this._modes)this._modes.hasOwnProperty(t)&&e.hasOwnProperty(t)&&this._modes[t].handler.setOptions(e[t])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(e){e.edit&&(void 0===e.edit.selectedPathOptions&&(e.edit.selectedPathOptions=this.options.edit.selectedPathOptions),e.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,e.edit.selectedPathOptions)),e.remove&&(e.remove=L.extend({},this.options.remove,e.remove)),e.poly&&(e.poly=L.extend({},this.options.poly,e.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,e),this._selectedFeatureCount=0},getModeHandlers:function(e){var t=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(e,{featureGroup:t,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(e,{featureGroup:t}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(e){var t=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return e.removeAllLayers&&t.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),t},addToolbar:function(e){var t=L.Toolbar.prototype.addToolbar.call(this,e);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),t},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var e,t=0!==this.options.featureGroup.getLayers().length;this.options.edit&&(e=this._modes[L.EditToolbar.Edit.TYPE].button,t?L.DomUtil.removeClass(e,"leaflet-disabled"):L.DomUtil.addClass(e,"leaflet-disabled"),e.setAttribute("title",t?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(e=this._modes[L.EditToolbar.Delete.TYPE].button,t?L.DomUtil.removeClass(e,"leaflet-disabled"):L.DomUtil.addClass(e,"leaflet-disabled"),e.setAttribute("title",t?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(e,t){if(L.Handler.prototype.initialize.call(this,e),L.setOptions(this,t),this._featureGroup=t.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var n=L.version.split(".");1===parseInt(n[0],10)&&parseInt(n[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var e=this._map;e&&(e.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),e._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer((function(e){this._revertLayer(e)}),this)},save:function(){var e=new L.LayerGroup;this._featureGroup.eachLayer((function(t){t.edited&&(e.addLayer(t),t.edited=!1)})),this._map.fire(L.Draw.Event.EDITED,{layers:e})},_backupLayer:function(e){var t=L.Util.stamp(e);this._uneditedLayerProps[t]||(e instanceof L.Polyline||e instanceof L.Polygon||e instanceof L.Rectangle?this._uneditedLayerProps[t]={latlngs:L.LatLngUtil.cloneLatLngs(e.getLatLngs())}:e instanceof L.Circle?this._uneditedLayerProps[t]={latlng:L.LatLngUtil.cloneLatLng(e.getLatLng()),radius:e.getRadius()}:(e instanceof L.Marker||e instanceof L.CircleMarker)&&(this._uneditedLayerProps[t]={latlng:L.LatLngUtil.cloneLatLng(e.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(e){var t=L.Util.stamp(e);e.edited=!1,this._uneditedLayerProps.hasOwnProperty(t)&&(e instanceof L.Polyline||e instanceof L.Polygon||e instanceof L.Rectangle?e.setLatLngs(this._uneditedLayerProps[t].latlngs):e instanceof L.Circle?(e.setLatLng(this._uneditedLayerProps[t].latlng),e.setRadius(this._uneditedLayerProps[t].radius)):(e instanceof L.Marker||e instanceof L.CircleMarker)&&e.setLatLng(this._uneditedLayerProps[t].latlng),e.fire("revert-edited",{layer:e}))},_enableLayerEdit:function(e){var t,n,i=e.layer||e.target||e;this._backupLayer(i),this.options.poly&&(n=L.Util.extend({},this.options.poly),i.options.poly=n),this.options.selectedPathOptions&&((t=L.Util.extend({},this.options.selectedPathOptions)).maintainColor&&(t.color=i.options.color,t.fillColor=i.options.fillColor),i.options.original=L.extend({},i.options),i.options.editing=t),i instanceof L.Marker?(i.editing&&i.editing.enable(),i.dragging.enable(),i.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):i.editing.enable()},_disableLayerEdit:function(e){var t=e.layer||e.target||e;t.edited=!1,t.editing&&t.editing.disable(),delete t.options.editing,delete t.options.original,this._selectedPathOptions&&(t instanceof L.Marker?this._toggleMarkerHighlight(t):(t.setStyle(t.options.previousOptions),delete t.options.previousOptions)),t instanceof L.Marker?(t.dragging.disable(),t.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):t.editing.disable()},_onMouseMove:function(e){this._tooltip.updatePosition(e.latlng)},_onMarkerDragEnd:function(e){var t=e.target;t.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:t})},_onTouchMove:function(e){var t=e.originalEvent.changedTouches[0],n=this._map.mouseEventToLayerPoint(t),i=this._map.layerPointToLatLng(n);e.target.setLatLng(i)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(e,t){if(L.Handler.prototype.initialize.call(this,e),L.Util.setOptions(this,t),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var n=L.version.split(".");1===parseInt(n[0],10)&&parseInt(n[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var e=this._map;e&&(e.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer((function(e){this._deletableLayers.addLayer(e),e.fire("revert-deleted",{layer:e})}),this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer((function(e){this._removeLayer({layer:e})}),this),this.save()},_enableLayerDelete:function(e){(e.layer||e.target||e).on("click",this._removeLayer,this)},_disableLayerDelete:function(e){var t=e.layer||e.target||e;t.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(t)},_removeLayer:function(e){var t=e.layer||e.target||e;this._deletableLayers.removeLayer(t),this._deletedLayers.addLayer(t),t.fire("deleted")},_onMouseMove:function(e){this._tooltip.updatePosition(e.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})},81875:function(e,t){!function(e){"use strict";var t=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnEveryZoom:!1,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyShapePositions:null,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(e){L.Util.setOptions(this,e),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var t=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,t?this._withAnimation:this._noAnimation),this._markerCluster=t?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(e){if(e instanceof L.LayerGroup)return this.addLayers([e]);if(!e.getLatLng)return this._nonPointGroup.addLayer(e),this.fire("layeradd",{layer:e}),this;if(!this._map)return this._needsClustering.push(e),this.fire("layeradd",{layer:e}),this;if(this.hasLayer(e))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(e,this._maxZoom),this.fire("layeradd",{layer:e}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var t=e,n=this._zoom;if(e.__parent)for(;t.__parent._zoom>=n;)t=t.__parent;return this._currentShownBounds.contains(t.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(e,t):this._animationAddLayerNonAnimated(e,t)),this},removeLayer:function(e){return e instanceof L.LayerGroup?this.removeLayers([e]):e.getLatLng?this._map?e.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(e)),this._removeLayer(e,!0),this.fire("layerremove",{layer:e}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),e.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(e)&&(this._featureGroup.removeLayer(e),e.clusterShow&&e.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,e)&&this.hasLayer(e)&&this._needsRemoving.push({layer:e,latlng:e._latlng}),this.fire("layerremove",{layer:e}),this):(this._nonPointGroup.removeLayer(e),this.fire("layerremove",{layer:e}),this)},addLayers:function(e,t){if(!L.Util.isArray(e))return this.addLayer(e);var n,i=this._featureGroup,o=this._nonPointGroup,r=this.options.chunkedLoading,a=this.options.chunkInterval,s=this.options.chunkProgress,l=e.length,c=0,u=!0;if(this._map){var d=(new Date).getTime(),m=L.bind((function(){var h=(new Date).getTime();for(this._map&&this._unspiderfy&&this._unspiderfy();c<l&&!(r&&c%200==0&&(new Date).getTime()-h>a);c++)if((n=e[c])instanceof L.LayerGroup)u&&(e=e.slice(),u=!1),this._extractNonGroupLayers(n,e),l=e.length;else if(n.getLatLng){if(!this.hasLayer(n)&&(this._addLayer(n,this._maxZoom),t||this.fire("layeradd",{layer:n}),n.__parent&&2===n.__parent.getChildCount())){var p=n.__parent.getAllChildMarkers(),_=p[0]===n?p[1]:p[0];i.removeLayer(_)}}else o.addLayer(n),t||this.fire("layeradd",{layer:n});s&&s(c,l,(new Date).getTime()-d),c===l?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(m,this.options.chunkDelay)}),this);m()}else for(var h=this._needsClustering;c<l;c++)(n=e[c])instanceof L.LayerGroup?(u&&(e=e.slice(),u=!1),this._extractNonGroupLayers(n,e),l=e.length):n.getLatLng?this.hasLayer(n)||h.push(n):o.addLayer(n);return this},removeLayers:function(e){var t,n,i=e.length,o=this._featureGroup,r=this._nonPointGroup,a=!0;if(!this._map){for(t=0;t<i;t++)(n=e[t])instanceof L.LayerGroup?(a&&(e=e.slice(),a=!1),this._extractNonGroupLayers(n,e),i=e.length):(this._arraySplice(this._needsClustering,n),r.removeLayer(n),this.hasLayer(n)&&this._needsRemoving.push({layer:n,latlng:n._latlng}),this.fire("layerremove",{layer:n}));return this}if(this._unspiderfy){this._unspiderfy();var s=e.slice(),l=i;for(t=0;t<l;t++)(n=s[t])instanceof L.LayerGroup?(this._extractNonGroupLayers(n,s),l=s.length):this._unspiderfyLayer(n)}for(t=0;t<i;t++)(n=e[t])instanceof L.LayerGroup?(a&&(e=e.slice(),a=!1),this._extractNonGroupLayers(n,e),i=e.length):n.__parent?(this._removeLayer(n,!0,!0),this.fire("layerremove",{layer:n}),o.hasLayer(n)&&(o.removeLayer(n),n.clusterShow&&n.clusterShow())):(r.removeLayer(n),this.fire("layerremove",{layer:n}));return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer((function(e){e.off(this._childMarkerEventHandlers,this),delete e.__parent}),this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var e=new L.LatLngBounds;this._topClusterLevel&&e.extend(this._topClusterLevel._bounds);for(var t=this._needsClustering.length-1;t>=0;t--)e.extend(this._needsClustering[t].getLatLng());return e.extend(this._nonPointGroup.getBounds()),e},eachLayer:function(e,t){var n,i,o,r=this._needsClustering.slice(),a=this._needsRemoving;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(r),i=r.length-1;i>=0;i--){for(n=!0,o=a.length-1;o>=0;o--)if(a[o].layer===r[i]){n=!1;break}n&&e.call(t,r[i])}this._nonPointGroup.eachLayer(e,t)},getLayers:function(){var e=[];return this.eachLayer((function(t){e.push(t)})),e},getLayer:function(e){var t=null;return e=parseInt(e,10),this.eachLayer((function(n){L.stamp(n)===e&&(t=n)})),t},hasLayer:function(e){if(!e)return!1;var t,n=this._needsClustering;for(t=n.length-1;t>=0;t--)if(n[t]===e)return!0;for(t=(n=this._needsRemoving).length-1;t>=0;t--)if(n[t].layer===e)return!1;return!(!e.__parent||e.__parent._group!==this)||this._nonPointGroup.hasLayer(e)},zoomToShowLayer:function(e,t){var n=this._map;"function"!=typeof t&&(t=function(){});var i=function(){!n.hasLayer(e)&&!n.hasLayer(e.__parent)||this._inZoomAnimation||(this._map.off("moveend",i,this),this.off("animationend",i,this),n.hasLayer(e)?t():e.__parent._icon&&(this.once("spiderfied",t,this),e.__parent.spiderfy()))};e._icon&&this._map.getBounds().contains(e.getLatLng())?t():e.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",i,this),this._map.panTo(e.getLatLng())):(this._map.on("moveend",i,this),this.on("animationend",i,this),e.__parent.zoomToBounds())},onAdd:function(e){var t,n,i;if(this._map=e,!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(e),this._nonPointGroup.addTo(e),this._gridClusters||this._generateInitialClusters(),this._maxLat=e.options.crs.projection.MAX_LATITUDE,t=0,n=this._needsRemoving.length;t<n;t++)(i=this._needsRemoving[t]).newlatlng=i.layer._latlng,i.layer._latlng=i.latlng;for(t=0,n=this._needsRemoving.length;t<n;t++)i=this._needsRemoving[t],this._removeLayer(i.layer,!0),i.layer._latlng=i.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),n=this._needsClustering,this._needsClustering=[],this.addLayers(n,!0)},onRemove:function(e){e.off("zoomend",this._zoomEnd,this),e.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(e){for(var t=e;t&&!t._icon;)t=t.__parent;return t||null},_arraySplice:function(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return e.splice(n,1),!0},_removeFromGridUnclustered:function(e,t){for(var n=this._map,i=this._gridUnclustered,o=Math.floor(this._map.getMinZoom());t>=o&&i[t].removeObject(e,n.project(e.getLatLng(),t));t--);},_childMarkerDragStart:function(e){e.target.__dragStart=e.target._latlng},_childMarkerMoved:function(e){if(!this._ignoreMove&&!e.target.__dragStart){var t=e.target._popup&&e.target._popup.isOpen();this._moveChild(e.target,e.oldLatLng,e.latlng),t&&e.target.openPopup()}},_moveChild:function(e,t,n){e._latlng=t,this.removeLayer(e),e._latlng=n,this.addLayer(e)},_childMarkerDragEnd:function(e){var t=e.target.__dragStart;delete e.target.__dragStart,t&&this._moveChild(e.target,t,e.target._latlng)},_removeLayer:function(e,t,n){var i=this._gridClusters,o=this._gridUnclustered,r=this._featureGroup,a=this._map,s=Math.floor(this._map.getMinZoom());t&&this._removeFromGridUnclustered(e,this._maxZoom);var l,c=e.__parent,u=c._markers;for(this._arraySplice(u,e);c&&(c._childCount--,c._boundsNeedUpdate=!0,!(c._zoom<s));)t&&c._childCount<=1?(l=c._markers[0]===e?c._markers[1]:c._markers[0],i[c._zoom].removeObject(c,a.project(c._cLatLng,c._zoom)),o[c._zoom].addObject(l,a.project(l.getLatLng(),c._zoom)),this._arraySplice(c.__parent._childClusters,c),c.__parent._markers.push(l),l.__parent=c.__parent,c._icon&&(r.removeLayer(c),n||r.addLayer(l))):c._iconNeedsUpdate=!0,c=c.__parent;delete e.__parent},_isOrIsParent:function(e,t){for(;t;){if(e===t)return!0;t=t.parentNode}return!1},fire:function(e,t,n){if(t&&t.layer instanceof L.MarkerCluster){if(t.originalEvent&&this._isOrIsParent(t.layer._icon,t.originalEvent.relatedTarget))return;e="cluster"+e}L.FeatureGroup.prototype.fire.call(this,e,t,n)},listens:function(e,t){return L.FeatureGroup.prototype.listens.call(this,e,t)||L.FeatureGroup.prototype.listens.call(this,"cluster"+e,t)},_defaultIconCreateFunction:function(e){var t=e.getChildCount(),n=" marker-cluster-";return n+=t<10?"small":t<100?"medium":"large",new L.DivIcon({html:"<div><span>"+t+"</span></div>",className:"marker-cluster"+n,iconSize:new L.Point(40,40)})},_bindEvents:function(){var e=this._map,t=this.options.spiderfyOnMaxZoom,n=this.options.showCoverageOnHover,i=this.options.zoomToBoundsOnClick,o=this.options.spiderfyOnEveryZoom;(t||i||o)&&this.on("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),n&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),e.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(e){var t=e.layer,n=t;if("clusterkeypress"!==e.type||!e.originalEvent||13===e.originalEvent.keyCode){for(;1===n._childClusters.length;)n=n._childClusters[0];n._zoom===this._maxZoom&&n._childCount===t._childCount&&this.options.spiderfyOnMaxZoom?t.spiderfy():this.options.zoomToBoundsOnClick&&t.zoomToBounds(),this.options.spiderfyOnEveryZoom&&t.spiderfy(),e.originalEvent&&13===e.originalEvent.keyCode&&this._map._container.focus()}},_showCoverage:function(e){var t=this._map;this._inZoomAnimation||(this._shownPolygon&&t.removeLayer(this._shownPolygon),e.layer.getChildCount()>2&&e.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(e.layer.getConvexHull(),this.options.polygonOptions),t.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var e=this.options.spiderfyOnMaxZoom,t=this.options.showCoverageOnHover,n=this.options.zoomToBoundsOnClick,i=this.options.spiderfyOnEveryZoom,o=this._map;(e||n||i)&&this.off("clusterclick clusterkeypress",this._zoomOrSpiderfy,this),t&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),o.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var e=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),e),this._currentShownBounds=e}},_generateInitialClusters:function(){var e=Math.ceil(this._map.getMaxZoom()),t=Math.floor(this._map.getMinZoom()),n=this.options.maxClusterRadius,i=n;"function"!=typeof n&&(i=function(){return n}),null!==this.options.disableClusteringAtZoom&&(e=this.options.disableClusteringAtZoom-1),this._maxZoom=e,this._gridClusters={},this._gridUnclustered={};for(var o=e;o>=t;o--)this._gridClusters[o]=new L.DistanceGrid(i(o)),this._gridUnclustered[o]=new L.DistanceGrid(i(o));this._topClusterLevel=new this._markerCluster(this,t-1)},_addLayer:function(e,t){var n,i,o=this._gridClusters,r=this._gridUnclustered,a=Math.floor(this._map.getMinZoom());for(this.options.singleMarkerMode&&this._overrideMarkerIcon(e),e.on(this._childMarkerEventHandlers,this);t>=a;t--){n=this._map.project(e.getLatLng(),t);var s=o[t].getNearObject(n);if(s)return s._addChild(e),void(e.__parent=s);if(s=r[t].getNearObject(n)){var l=s.__parent;l&&this._removeLayer(s,!1);var c=new this._markerCluster(this,t,s,e);o[t].addObject(c,this._map.project(c._cLatLng,t)),s.__parent=c,e.__parent=c;var u=c;for(i=t-1;i>l._zoom;i--)u=new this._markerCluster(this,i,u),o[i].addObject(u,this._map.project(s.getLatLng(),i));return l._addChild(u),void this._removeFromGridUnclustered(s,t)}r[t].addObject(e,n)}this._topClusterLevel._addChild(e),e.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer((function(e){e instanceof L.MarkerCluster&&e._iconNeedsUpdate&&e._updateIcon()}))},_enqueue:function(e){this._queue.push(e),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var e=0;e<this._queue.length;e++)this._queue[e].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var e=Math.round(this._map._zoom);this._processQueue(),this._zoom<e&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,e)):this._zoom>e?(this._animationStart(),this._animationZoomOut(this._zoom,e)):this._moveEnd()},_getExpandedVisibleBounds:function(){return this.options.removeOutsideVisibleBounds?L.Browser.mobile?this._checkBoundsMaxLat(this._map.getBounds()):this._checkBoundsMaxLat(this._map.getBounds().pad(1)):this._mapBoundsInfinite},_checkBoundsMaxLat:function(e){var t=this._maxLat;return void 0!==t&&(e.getNorth()>=t&&(e._northEast.lat=1/0),e.getSouth()<=-t&&(e._southWest.lat=-1/0)),e},_animationAddLayerNonAnimated:function(e,t){if(t===e)this._featureGroup.addLayer(e);else if(2===t._childCount){t._addToMap();var n=t.getAllChildMarkers();this._featureGroup.removeLayer(n[0]),this._featureGroup.removeLayer(n[1])}else t._updateIcon()},_extractNonGroupLayers:function(e,t){var n,i=e.getLayers(),o=0;for(t=t||[];o<i.length;o++)(n=i[o])instanceof L.LayerGroup?this._extractNonGroupLayers(n,t):t.push(n);return t},_overrideMarkerIcon:function(e){return e.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[e]}})}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(e,t){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),e),this._topClusterLevel._recursivelyAddChildrenToMap(null,t,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(e,t){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),e),this._topClusterLevel._recursivelyAddChildrenToMap(null,t,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(e,t){this._animationAddLayerNonAnimated(e,t)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(e,t){var n,i=this._getExpandedVisibleBounds(),o=this._featureGroup,r=Math.floor(this._map.getMinZoom());this._ignoreMove=!0,this._topClusterLevel._recursively(i,e,r,(function(r){var a,s=r._latlng,l=r._markers;for(i.contains(s)||(s=null),r._isSingleParent()&&e+1===t?(o.removeLayer(r),r._recursivelyAddChildrenToMap(null,t,i)):(r.clusterHide(),r._recursivelyAddChildrenToMap(s,t,i)),n=l.length-1;n>=0;n--)a=l[n],i.contains(a._latlng)||o.removeLayer(a)})),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(i,t),o.eachLayer((function(e){e instanceof L.MarkerCluster||!e._icon||e.clusterShow()})),this._topClusterLevel._recursively(i,e,t,(function(e){e._recursivelyRestoreChildPositions(t)})),this._ignoreMove=!1,this._enqueue((function(){this._topClusterLevel._recursively(i,e,r,(function(e){o.removeLayer(e),e.clusterShow()})),this._animationEnd()}))},_animationZoomOut:function(e,t){this._animationZoomOutSingle(this._topClusterLevel,e-1,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,t,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),e,this._getExpandedVisibleBounds())},_animationAddLayer:function(e,t){var n=this,i=this._featureGroup;i.addLayer(e),t!==e&&(t._childCount>2?(t._updateIcon(),this._forceLayout(),this._animationStart(),e._setPos(this._map.latLngToLayerPoint(t.getLatLng())),e.clusterHide(),this._enqueue((function(){i.removeLayer(e),e.clusterShow(),n._animationEnd()}))):(this._forceLayout(),n._animationStart(),n._animationZoomOutSingle(t,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(e,t,n){var i=this._getExpandedVisibleBounds(),o=Math.floor(this._map.getMinZoom());e._recursivelyAnimateChildrenInAndAddSelfToMap(i,o,t+1,n);var r=this;this._forceLayout(),e._recursivelyBecomeVisible(i,n),this._enqueue((function(){if(1===e._childCount){var a=e._markers[0];this._ignoreMove=!0,a.setLatLng(a.getLatLng()),this._ignoreMove=!1,a.clusterShow&&a.clusterShow()}else e._recursively(i,n,o,(function(e){e._recursivelyRemoveChildrenFromMap(i,o,t+1)}));r._animationEnd()}))},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(e){return new L.MarkerClusterGroup(e)};var n=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(e,t,n,i){L.Marker.prototype.initialize.call(this,n?n._cLatLng||n.getLatLng():new L.LatLng(0,0),{icon:this,pane:e.options.clusterPane}),this._group=e,this._zoom=t,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,n&&this._addChild(n),i&&this._addChild(i)},getAllChildMarkers:function(e,t){e=e||[];for(var n=this._childClusters.length-1;n>=0;n--)this._childClusters[n].getAllChildMarkers(e,t);for(var i=this._markers.length-1;i>=0;i--)t&&this._markers[i].__dragStart||e.push(this._markers[i]);return e},getChildCount:function(){return this._childCount},zoomToBounds:function(e){for(var t,n=this._childClusters.slice(),i=this._group._map,o=i.getBoundsZoom(this._bounds),r=this._zoom+1,a=i.getZoom();n.length>0&&o>r;){r++;var s=[];for(t=0;t<n.length;t++)s=s.concat(n[t]._childClusters);n=s}o>r?this._group._map.setView(this._latlng,r):o<=a?this._group._map.setView(this._latlng,a+1):this._group._map.fitBounds(this._bounds,e)},getBounds:function(){var e=new L.LatLngBounds;return e.extend(this._bounds),e},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(e,t){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(e),e instanceof L.MarkerCluster?(t||(this._childClusters.push(e),e.__parent=this),this._childCount+=e._childCount):(t||this._markers.push(e),this._childCount++),this.__parent&&this.__parent._addChild(e,!0)},_setClusterCenter:function(e){this._cLatLng||(this._cLatLng=e._cLatLng||e._latlng)},_resetBounds:function(){var e=this._bounds;e._southWest&&(e._southWest.lat=1/0,e._southWest.lng=1/0),e._northEast&&(e._northEast.lat=-1/0,e._northEast.lng=-1/0)},_recalculateBounds:function(){var e,t,n,i,o=this._markers,r=this._childClusters,a=0,s=0,l=this._childCount;if(0!==l){for(this._resetBounds(),e=0;e<o.length;e++)n=o[e]._latlng,this._bounds.extend(n),a+=n.lat,s+=n.lng;for(e=0;e<r.length;e++)(t=r[e])._boundsNeedUpdate&&t._recalculateBounds(),this._bounds.extend(t._bounds),n=t._wLatLng,i=t._childCount,a+=n.lat*i,s+=n.lng*i;this._latlng=this._wLatLng=new L.LatLng(a/l,s/l),this._boundsNeedUpdate=!1}},_addToMap:function(e){e&&(this._backupLatlng=this._latlng,this.setLatLng(e)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(e,t,n){this._recursively(e,this._group._map.getMinZoom(),n-1,(function(e){var n,i,o=e._markers;for(n=o.length-1;n>=0;n--)(i=o[n])._icon&&(i._setPos(t),i.clusterHide())}),(function(e){var n,i,o=e._childClusters;for(n=o.length-1;n>=0;n--)(i=o[n])._icon&&(i._setPos(t),i.clusterHide())}))},_recursivelyAnimateChildrenInAndAddSelfToMap:function(e,t,n,i){this._recursively(e,i,t,(function(o){o._recursivelyAnimateChildrenIn(e,o._group._map.latLngToLayerPoint(o.getLatLng()).round(),n),o._isSingleParent()&&n-1===i?(o.clusterShow(),o._recursivelyRemoveChildrenFromMap(e,t,n)):o.clusterHide(),o._addToMap()}))},_recursivelyBecomeVisible:function(e,t){this._recursively(e,this._group._map.getMinZoom(),t,null,(function(e){e.clusterShow()}))},_recursivelyAddChildrenToMap:function(e,t,n){this._recursively(n,this._group._map.getMinZoom()-1,t,(function(i){if(t!==i._zoom)for(var o=i._markers.length-1;o>=0;o--){var r=i._markers[o];n.contains(r._latlng)&&(e&&(r._backupLatlng=r.getLatLng(),r.setLatLng(e),r.clusterHide&&r.clusterHide()),i._group._featureGroup.addLayer(r))}}),(function(t){t._addToMap(e)}))},_recursivelyRestoreChildPositions:function(e){for(var t=this._markers.length-1;t>=0;t--){var n=this._markers[t];n._backupLatlng&&(n.setLatLng(n._backupLatlng),delete n._backupLatlng)}if(e-1===this._zoom)for(var i=this._childClusters.length-1;i>=0;i--)this._childClusters[i]._restorePosition();else for(var o=this._childClusters.length-1;o>=0;o--)this._childClusters[o]._recursivelyRestoreChildPositions(e)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(e,t,n,i){var o,r;this._recursively(e,t-1,n-1,(function(e){for(r=e._markers.length-1;r>=0;r--)o=e._markers[r],i&&i.contains(o._latlng)||(e._group._featureGroup.removeLayer(o),o.clusterShow&&o.clusterShow())}),(function(e){for(r=e._childClusters.length-1;r>=0;r--)o=e._childClusters[r],i&&i.contains(o._latlng)||(e._group._featureGroup.removeLayer(o),o.clusterShow&&o.clusterShow())}))},_recursively:function(e,t,n,i,o){var r,a,s=this._childClusters,l=this._zoom;if(t<=l&&(i&&i(this),o&&l===n&&o(this)),l<t||l<n)for(r=s.length-1;r>=0;r--)(a=s[r])._boundsNeedUpdate&&a._recalculateBounds(),e.intersects(a._bounds)&&a._recursively(e,t,n,i,o)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var e=this.options.opacity;return this.setOpacity(0),this.options.opacity=e,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(e){this._cellSize=e,this._sqCellSize=e*e,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(e,t){var n=this._getCoord(t.x),i=this._getCoord(t.y),o=this._grid,r=o[i]=o[i]||{},a=r[n]=r[n]||[],s=L.Util.stamp(e);this._objectPoint[s]=t,a.push(e)},updateObject:function(e,t){this.removeObject(e),this.addObject(e,t)},removeObject:function(e,t){var n,i,o=this._getCoord(t.x),r=this._getCoord(t.y),a=this._grid,s=a[r]=a[r]||{},l=s[o]=s[o]||[];for(delete this._objectPoint[L.Util.stamp(e)],n=0,i=l.length;n<i;n++)if(l[n]===e)return l.splice(n,1),1===i&&delete s[o],!0},eachObject:function(e,t){var n,i,o,r,a,s,l=this._grid;for(n in l)for(i in a=l[n])for(o=0,r=(s=a[i]).length;o<r;o++)e.call(t,s[o])&&(o--,r--)},getNearObject:function(e){var t,n,i,o,r,a,s,l,c=this._getCoord(e.x),u=this._getCoord(e.y),d=this._objectPoint,m=this._sqCellSize,h=null;for(t=u-1;t<=u+1;t++)if(o=this._grid[t])for(n=c-1;n<=c+1;n++)if(r=o[n])for(i=0,a=r.length;i<a;i++)s=r[i],((l=this._sqDist(d[L.Util.stamp(s)],e))<m||l<=m&&null===h)&&(m=l,h=s);return h},_getCoord:function(e){var t=Math.floor(e/this._cellSize);return isFinite(t)?t:e},_sqDist:function(e,t){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}},L.QuickHull={getDistant:function(e,t){var n=t[1].lat-t[0].lat;return(t[0].lng-t[1].lng)*(e.lat-t[0].lat)+n*(e.lng-t[0].lng)},findMostDistantPointFromBaseLine:function(e,t){var n,i,o,r=0,a=null,s=[];for(n=t.length-1;n>=0;n--)i=t[n],(o=this.getDistant(i,e))>0&&(s.push(i),o>r&&(r=o,a=i));return{maxPoint:a,newPoints:s}},buildConvexHull:function(e,t){var n=[],i=this.findMostDistantPointFromBaseLine(e,t);return i.maxPoint?n=(n=n.concat(this.buildConvexHull([e[0],i.maxPoint],i.newPoints))).concat(this.buildConvexHull([i.maxPoint,e[1]],i.newPoints)):[e[0]]},getConvexHull:function(e){var t,n=!1,i=!1,o=!1,r=!1,a=null,s=null,l=null,c=null,u=null,d=null;for(t=e.length-1;t>=0;t--){var m=e[t];(!1===n||m.lat>n)&&(a=m,n=m.lat),(!1===i||m.lat<i)&&(s=m,i=m.lat),(!1===o||m.lng>o)&&(l=m,o=m.lng),(!1===r||m.lng<r)&&(c=m,r=m.lng)}return i!==n?(d=s,u=a):(d=c,u=l),[].concat(this.buildConvexHull([d,u],e),this.buildConvexHull([u,d],e))}},L.MarkerCluster.include({getConvexHull:function(){var e,t,n=this.getAllChildMarkers(),i=[];for(t=n.length-1;t>=0;t--)e=n[t].getLatLng(),i.push(e);return L.QuickHull.getConvexHull(i)}}),L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var e,t=this.getAllChildMarkers(null,!0),n=this._group._map.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,this._group.options.spiderfyShapePositions?e=this._group.options.spiderfyShapePositions(t.length,n):t.length>=this._circleSpiralSwitchover?e=this._generatePointsSpiral(t.length,n):(n.y+=10,e=this._generatePointsCircle(t.length,n)),this._animationSpiderfy(t,e)}},unspiderfy:function(e){this._group._inZoomAnimation||(this._animationUnspiderfy(e),this._group._spiderfied=null)},_generatePointsCircle:function(e,t){var n,i,o=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+e)/this._2PI,r=this._2PI/e,a=[];for(o=Math.max(o,35),a.length=e,n=0;n<e;n++)i=this._circleStartAngle+n*r,a[n]=new L.Point(t.x+o*Math.cos(i),t.y+o*Math.sin(i))._round();return a},_generatePointsSpiral:function(e,t){var n,i=this._group.options.spiderfyDistanceMultiplier,o=i*this._spiralLengthStart,r=i*this._spiralFootSeparation,a=i*this._spiralLengthFactor*this._2PI,s=0,l=[];for(l.length=e,n=e;n>=0;n--)n<e&&(l[n]=new L.Point(t.x+o*Math.cos(s),t.y+o*Math.sin(s))._round()),o+=a/(s+=r/o+5e-4*n);return l},_noanimationUnspiderfy:function(){var e,t,n=this._group,i=n._map,o=n._featureGroup,r=this.getAllChildMarkers(null,!0);for(n._ignoreMove=!0,this.setOpacity(1),t=r.length-1;t>=0;t--)e=r[t],o.removeLayer(e),e._preSpiderfyLatlng&&(e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng),e.setZIndexOffset&&e.setZIndexOffset(0),e._spiderLeg&&(i.removeLayer(e._spiderLeg),delete e._spiderLeg);n.fire("unspiderfied",{cluster:this,markers:r}),n._ignoreMove=!1,n._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(e,t){var n,i,o,r,a=this._group,s=a._map,l=a._featureGroup,c=this._group.options.spiderLegPolylineOptions;for(a._ignoreMove=!0,n=0;n<e.length;n++)r=s.layerPointToLatLng(t[n]),i=e[n],o=new L.Polyline([this._latlng,r],c),s.addLayer(o),i._spiderLeg=o,i._preSpiderfyLatlng=i._latlng,i.setLatLng(r),i.setZIndexOffset&&i.setZIndexOffset(1e6),l.addLayer(i);this.setOpacity(.3),a._ignoreMove=!1,a.fire("spiderfied",{cluster:this,markers:e})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(e,t){var n,i,o,r,a,s,l=this,c=this._group,u=c._map,d=c._featureGroup,m=this._latlng,h=u.latLngToLayerPoint(m),p=L.Path.SVG,_=L.extend({},this._group.options.spiderLegPolylineOptions),f=_.opacity;for(void 0===f&&(f=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),p?(_.opacity=0,_.className=(_.className||"")+" leaflet-cluster-spider-leg"):_.opacity=f,c._ignoreMove=!0,n=0;n<e.length;n++)i=e[n],s=u.layerPointToLatLng(t[n]),o=new L.Polyline([m,s],_),u.addLayer(o),i._spiderLeg=o,p&&(a=(r=o._path).getTotalLength()+.1,r.style.strokeDasharray=a,r.style.strokeDashoffset=a),i.setZIndexOffset&&i.setZIndexOffset(1e6),i.clusterHide&&i.clusterHide(),d.addLayer(i),i._setPos&&i._setPos(h);for(c._forceLayout(),c._animationStart(),n=e.length-1;n>=0;n--)s=u.layerPointToLatLng(t[n]),(i=e[n])._preSpiderfyLatlng=i._latlng,i.setLatLng(s),i.clusterShow&&i.clusterShow(),p&&((r=(o=i._spiderLeg)._path).style.strokeDashoffset=0,o.setStyle({opacity:f}));this.setOpacity(.3),c._ignoreMove=!1,setTimeout((function(){c._animationEnd(),c.fire("spiderfied",{cluster:l,markers:e})}),200)},_animationUnspiderfy:function(e){var t,n,i,o,r,a,s=this,l=this._group,c=l._map,u=l._featureGroup,d=e?c._latLngToNewLayerPoint(this._latlng,e.zoom,e.center):c.latLngToLayerPoint(this._latlng),m=this.getAllChildMarkers(null,!0),h=L.Path.SVG;for(l._ignoreMove=!0,l._animationStart(),this.setOpacity(1),n=m.length-1;n>=0;n--)(t=m[n])._preSpiderfyLatlng&&(t.closePopup(),t.setLatLng(t._preSpiderfyLatlng),delete t._preSpiderfyLatlng,a=!0,t._setPos&&(t._setPos(d),a=!1),t.clusterHide&&(t.clusterHide(),a=!1),a&&u.removeLayer(t),h&&(r=(o=(i=t._spiderLeg)._path).getTotalLength()+.1,o.style.strokeDashoffset=r,i.setStyle({opacity:0})));l._ignoreMove=!1,setTimeout((function(){var e=0;for(n=m.length-1;n>=0;n--)(t=m[n])._spiderLeg&&e++;for(n=m.length-1;n>=0;n--)(t=m[n])._spiderLeg&&(t.clusterShow&&t.clusterShow(),t.setZIndexOffset&&t.setZIndexOffset(0),e>1&&u.removeLayer(t),c.removeLayer(t._spiderLeg),delete t._spiderLeg);l._animationEnd(),l.fire("unspiderfied",{cluster:s,markers:m})}),200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(e){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(e))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(e){this._spiderfied&&this._spiderfied.unspiderfy(e)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(e){e._spiderLeg&&(this._featureGroup.removeLayer(e),e.clusterShow&&e.clusterShow(),e.setZIndexOffset&&e.setZIndexOffset(0),this._map.removeLayer(e._spiderLeg),delete e._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(e){return e?e instanceof L.MarkerClusterGroup?e=e._topClusterLevel.getAllChildMarkers():e instanceof L.LayerGroup?e=e._layers:e instanceof L.MarkerCluster?e=e.getAllChildMarkers():e instanceof L.Marker&&(e=[e]):e=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(e),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(e),this},_flagParentsIconsNeedUpdate:function(e){var t,n;for(t in e)for(n=e[t].__parent;n;)n._iconNeedsUpdate=!0,n=n.__parent},_refreshSingleMarkerModeMarkers:function(e){var t,n;for(t in e)n=e[t],this.hasLayer(n)&&n.setIcon(this._overrideMarkerIcon(n))}}),L.Marker.include({refreshIconOptions:function(e,t){var n=this.options.icon;return L.setOptions(n,e),this.setIcon(n),t&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),e.MarkerClusterGroup=t,e.MarkerCluster=n,Object.defineProperty(e,"__esModule",{value:!0})}(t)},21863:function(e,t){
/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */
!function(e){"use strict";var t="1.9.4";function n(e){var t,n,i,o;for(n=1,i=arguments.length;n<i;n++)for(t in o=arguments[n])e[t]=o[t];return e}var i=Object.create||function(){function e(){}return function(t){return e.prototype=t,new e}}();function o(e,t){var n=Array.prototype.slice;if(e.bind)return e.bind.apply(e,n.call(arguments,1));var i=n.call(arguments,2);return function(){return e.apply(t,i.length?i.concat(n.call(arguments)):arguments)}}var r=0;function a(e){return"_leaflet_id"in e||(e._leaflet_id=++r),e._leaflet_id}function s(e,t,n){var i,o,r,a;return a=function(){i=!1,o&&(r.apply(n,o),o=!1)},r=function(){i?o=arguments:(e.apply(n,arguments),setTimeout(a,t),i=!0)},r}function l(e,t,n){var i=t[1],o=t[0],r=i-o;return e===i&&n?e:((e-o)%r+r)%r+o}function c(){return!1}function u(e,t){if(!1===t)return e;var n=Math.pow(10,void 0===t?6:t);return Math.round(e*n)/n}function d(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function m(e){return d(e).split(/\s+/)}function h(e,t){for(var n in Object.prototype.hasOwnProperty.call(e,"options")||(e.options=e.options?i(e.options):{}),t)e.options[n]=t[n];return e.options}function p(e,t,n){var i=[];for(var o in e)i.push(encodeURIComponent(n?o.toUpperCase():o)+"="+encodeURIComponent(e[o]));return(t&&-1!==t.indexOf("?")?"&":"?")+i.join("&")}var _=/\{ *([\w_ -]+) *\}/g;function f(e,t){return e.replace(_,(function(e,n){var i=t[n];if(void 0===i)throw new Error("No value provided for variable "+e);return"function"==typeof i&&(i=i(t)),i}))}var g=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function b(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}var y="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function v(e){return window["webkit"+e]||window["moz"+e]||window["ms"+e]}var E=0;function k(e){var t=+new Date,n=Math.max(0,16-(t-E));return E=t+n,window.setTimeout(e,n)}var A=window.requestAnimationFrame||v("RequestAnimationFrame")||k,T=window.cancelAnimationFrame||v("CancelAnimationFrame")||v("CancelRequestAnimationFrame")||function(e){window.clearTimeout(e)};function w(e,t,n){if(!n||A!==k)return A.call(window,o(e,t));e.call(t)}function D(e){e&&T.call(window,e)}var C={__proto__:null,extend:n,create:i,bind:o,get lastId(){return r},stamp:a,throttle:s,wrapNum:l,falseFn:c,formatNum:u,trim:d,splitWords:m,setOptions:h,getParamString:p,template:f,isArray:g,indexOf:b,emptyImageUrl:y,requestFn:A,cancelFn:T,requestAnimFrame:w,cancelAnimFrame:D};function O(){}function R(e){if("undefined"!=typeof L&&L&&L.Mixin){e=g(e)?e:[e];for(var t=0;t<e.length;t++)e[t]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}O.extend=function(e){var t=function(){h(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},o=t.__super__=this.prototype,r=i(o);for(var a in r.constructor=t,t.prototype=r,this)Object.prototype.hasOwnProperty.call(this,a)&&"prototype"!==a&&"__super__"!==a&&(t[a]=this[a]);return e.statics&&n(t,e.statics),e.includes&&(R(e.includes),n.apply(null,[r].concat(e.includes))),n(r,e),delete r.statics,delete r.includes,r.options&&(r.options=o.options?i(o.options):{},n(r.options,e.options)),r._initHooks=[],r.callInitHooks=function(){if(!this._initHooksCalled){o.callInitHooks&&o.callInitHooks.call(this),this._initHooksCalled=!0;for(var e=0,t=r._initHooks.length;e<t;e++)r._initHooks[e].call(this)}},t},O.include=function(e){var t=this.prototype.options;return n(this.prototype,e),e.options&&(this.prototype.options=t,this.mergeOptions(e.options)),this},O.mergeOptions=function(e){return n(this.prototype.options,e),this},O.addInitHook=function(e){var t=Array.prototype.slice.call(arguments,1),n="function"==typeof e?e:function(){this[e].apply(this,t)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var S={on:function(e,t,n){if("object"==typeof e)for(var i in e)this._on(i,e[i],t);else for(var o=0,r=(e=m(e)).length;o<r;o++)this._on(e[o],t,n);return this},off:function(e,t,n){if(arguments.length)if("object"==typeof e)for(var i in e)this._off(i,e[i],t);else{e=m(e);for(var o=1===arguments.length,r=0,a=e.length;r<a;r++)o?this._off(e[r]):this._off(e[r],t,n)}else delete this._events;return this},_on:function(e,t,n,i){if("function"==typeof t){if(!1===this._listens(e,t,n)){n===this&&(n=void 0);var o={fn:t,ctx:n};i&&(o.once=!0),this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(o)}}else console.warn("wrong listener type: "+typeof t)},_off:function(e,t,n){var i,o,r;if(this._events&&(i=this._events[e]))if(1!==arguments.length)if("function"==typeof t){var a=this._listens(e,t,n);if(!1!==a){var s=i[a];this._firingCount&&(s.fn=c,this._events[e]=i=i.slice()),i.splice(a,1)}}else console.warn("wrong listener type: "+typeof t);else{if(this._firingCount)for(o=0,r=i.length;o<r;o++)i[o].fn=c;delete this._events[e]}},fire:function(e,t,i){if(!this.listens(e,i))return this;var o=n({},t,{type:e,target:this,sourceTarget:t&&t.sourceTarget||this});if(this._events){var r=this._events[e];if(r){this._firingCount=this._firingCount+1||1;for(var a=0,s=r.length;a<s;a++){var l=r[a],c=l.fn;l.once&&this.off(e,c,l.ctx),c.call(l.ctx||this,o)}this._firingCount--}}return i&&this._propagateEvent(o),this},listens:function(e,t,n,i){"string"!=typeof e&&console.warn('"string" type argument expected');var o=t;"function"!=typeof t&&(i=!!t,o=void 0,n=void 0);var r=this._events&&this._events[e];if(r&&r.length&&!1!==this._listens(e,o,n))return!0;if(i)for(var a in this._eventParents)if(this._eventParents[a].listens(e,t,n,i))return!0;return!1},_listens:function(e,t,n){if(!this._events)return!1;var i=this._events[e]||[];if(!t)return!!i.length;n===this&&(n=void 0);for(var o=0,r=i.length;o<r;o++)if(i[o].fn===t&&i[o].ctx===n)return o;return!1},once:function(e,t,n){if("object"==typeof e)for(var i in e)this._on(i,e[i],t,!0);else for(var o=0,r=(e=m(e)).length;o<r;o++)this._on(e[o],t,n,!0);return this},addEventParent:function(e){return this._eventParents=this._eventParents||{},this._eventParents[a(e)]=e,this},removeEventParent:function(e){return this._eventParents&&delete this._eventParents[a(e)],this},_propagateEvent:function(e){for(var t in this._eventParents)this._eventParents[t].fire(e.type,n({layer:e.target,propagatedFrom:e.target},e),!0)}};S.addEventListener=S.on,S.removeEventListener=S.clearAllEventListeners=S.off,S.addOneTimeEventListener=S.once,S.fireEvent=S.fire,S.hasEventListeners=S.listens;var P=O.extend(S);function M(e,t,n){this.x=n?Math.round(e):e,this.y=n?Math.round(t):t}var x=Math.trunc||function(e){return e>0?Math.floor(e):Math.ceil(e)};function j(e,t,n){return e instanceof M?e:g(e)?new M(e[0],e[1]):null==e?e:"object"==typeof e&&"x"in e&&"y"in e?new M(e.x,e.y):new M(e,t,n)}function I(e,t){if(e)for(var n=t?[e,t]:e,i=0,o=n.length;i<o;i++)this.extend(n[i])}function B(e,t){return!e||e instanceof I?e:new I(e,t)}function N(e,t){if(e)for(var n=t?[e,t]:e,i=0,o=n.length;i<o;i++)this.extend(n[i])}function F(e,t){return e instanceof N?e:new N(e,t)}function z(e,t,n){if(isNaN(e)||isNaN(t))throw new Error("Invalid LatLng object: ("+e+", "+t+")");this.lat=+e,this.lng=+t,void 0!==n&&(this.alt=+n)}function q(e,t,n){return e instanceof z?e:g(e)&&"object"!=typeof e[0]?3===e.length?new z(e[0],e[1],e[2]):2===e.length?new z(e[0],e[1]):null:null==e?e:"object"==typeof e&&"lat"in e?new z(e.lat,"lng"in e?e.lng:e.lon,e.alt):void 0===t?null:new z(e,t,n)}M.prototype={clone:function(){return new M(this.x,this.y)},add:function(e){return this.clone()._add(j(e))},_add:function(e){return this.x+=e.x,this.y+=e.y,this},subtract:function(e){return this.clone()._subtract(j(e))},_subtract:function(e){return this.x-=e.x,this.y-=e.y,this},divideBy:function(e){return this.clone()._divideBy(e)},_divideBy:function(e){return this.x/=e,this.y/=e,this},multiplyBy:function(e){return this.clone()._multiplyBy(e)},_multiplyBy:function(e){return this.x*=e,this.y*=e,this},scaleBy:function(e){return new M(this.x*e.x,this.y*e.y)},unscaleBy:function(e){return new M(this.x/e.x,this.y/e.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=x(this.x),this.y=x(this.y),this},distanceTo:function(e){var t=(e=j(e)).x-this.x,n=e.y-this.y;return Math.sqrt(t*t+n*n)},equals:function(e){return(e=j(e)).x===this.x&&e.y===this.y},contains:function(e){return e=j(e),Math.abs(e.x)<=Math.abs(this.x)&&Math.abs(e.y)<=Math.abs(this.y)},toString:function(){return"Point("+u(this.x)+", "+u(this.y)+")"}},I.prototype={extend:function(e){var t,n;if(!e)return this;if(e instanceof M||"number"==typeof e[0]||"x"in e)t=n=j(e);else if(t=(e=B(e)).min,n=e.max,!t||!n)return this;return this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(n.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(n.y,this.max.y)):(this.min=t.clone(),this.max=n.clone()),this},getCenter:function(e){return j((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,e)},getBottomLeft:function(){return j(this.min.x,this.max.y)},getTopRight:function(){return j(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(e){var t,n;return(e="number"==typeof e[0]||e instanceof M?j(e):B(e))instanceof I?(t=e.min,n=e.max):t=n=e,t.x>=this.min.x&&n.x<=this.max.x&&t.y>=this.min.y&&n.y<=this.max.y},intersects:function(e){e=B(e);var t=this.min,n=this.max,i=e.min,o=e.max,r=o.x>=t.x&&i.x<=n.x,a=o.y>=t.y&&i.y<=n.y;return r&&a},overlaps:function(e){e=B(e);var t=this.min,n=this.max,i=e.min,o=e.max,r=o.x>t.x&&i.x<n.x,a=o.y>t.y&&i.y<n.y;return r&&a},isValid:function(){return!(!this.min||!this.max)},pad:function(e){var t=this.min,n=this.max,i=Math.abs(t.x-n.x)*e,o=Math.abs(t.y-n.y)*e;return B(j(t.x-i,t.y-o),j(n.x+i,n.y+o))},equals:function(e){return!!e&&(e=B(e),this.min.equals(e.getTopLeft())&&this.max.equals(e.getBottomRight()))}},N.prototype={extend:function(e){var t,n,i=this._southWest,o=this._northEast;if(e instanceof z)t=e,n=e;else{if(!(e instanceof N))return e?this.extend(q(e)||F(e)):this;if(t=e._southWest,n=e._northEast,!t||!n)return this}return i||o?(i.lat=Math.min(t.lat,i.lat),i.lng=Math.min(t.lng,i.lng),o.lat=Math.max(n.lat,o.lat),o.lng=Math.max(n.lng,o.lng)):(this._southWest=new z(t.lat,t.lng),this._northEast=new z(n.lat,n.lng)),this},pad:function(e){var t=this._southWest,n=this._northEast,i=Math.abs(t.lat-n.lat)*e,o=Math.abs(t.lng-n.lng)*e;return new N(new z(t.lat-i,t.lng-o),new z(n.lat+i,n.lng+o))},getCenter:function(){return new z((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new z(this.getNorth(),this.getWest())},getSouthEast:function(){return new z(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(e){e="number"==typeof e[0]||e instanceof z||"lat"in e?q(e):F(e);var t,n,i=this._southWest,o=this._northEast;return e instanceof N?(t=e.getSouthWest(),n=e.getNorthEast()):t=n=e,t.lat>=i.lat&&n.lat<=o.lat&&t.lng>=i.lng&&n.lng<=o.lng},intersects:function(e){e=F(e);var t=this._southWest,n=this._northEast,i=e.getSouthWest(),o=e.getNorthEast(),r=o.lat>=t.lat&&i.lat<=n.lat,a=o.lng>=t.lng&&i.lng<=n.lng;return r&&a},overlaps:function(e){e=F(e);var t=this._southWest,n=this._northEast,i=e.getSouthWest(),o=e.getNorthEast(),r=o.lat>t.lat&&i.lat<n.lat,a=o.lng>t.lng&&i.lng<n.lng;return r&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(e,t){return!!e&&(e=F(e),this._southWest.equals(e.getSouthWest(),t)&&this._northEast.equals(e.getNorthEast(),t))},isValid:function(){return!(!this._southWest||!this._northEast)}},z.prototype={equals:function(e,t){return!!e&&(e=q(e),Math.max(Math.abs(this.lat-e.lat),Math.abs(this.lng-e.lng))<=(void 0===t?1e-9:t))},toString:function(e){return"LatLng("+u(this.lat,e)+", "+u(this.lng,e)+")"},distanceTo:function(e){return $.distance(this,q(e))},wrap:function(){return $.wrapLatLng(this)},toBounds:function(e){var t=180*e/40075017,n=t/Math.cos(Math.PI/180*this.lat);return F([this.lat-t,this.lng-n],[this.lat+t,this.lng+n])},clone:function(){return new z(this.lat,this.lng,this.alt)}};var H,U={latLngToPoint:function(e,t){var n=this.projection.project(e),i=this.scale(t);return this.transformation._transform(n,i)},pointToLatLng:function(e,t){var n=this.scale(t),i=this.transformation.untransform(e,n);return this.projection.unproject(i)},project:function(e){return this.projection.project(e)},unproject:function(e){return this.projection.unproject(e)},scale:function(e){return 256*Math.pow(2,e)},zoom:function(e){return Math.log(e/256)/Math.LN2},getProjectedBounds:function(e){if(this.infinite)return null;var t=this.projection.bounds,n=this.scale(e);return new I(this.transformation.transform(t.min,n),this.transformation.transform(t.max,n))},infinite:!1,wrapLatLng:function(e){var t=this.wrapLng?l(e.lng,this.wrapLng,!0):e.lng;return new z(this.wrapLat?l(e.lat,this.wrapLat,!0):e.lat,t,e.alt)},wrapLatLngBounds:function(e){var t=e.getCenter(),n=this.wrapLatLng(t),i=t.lat-n.lat,o=t.lng-n.lng;if(0===i&&0===o)return e;var r=e.getSouthWest(),a=e.getNorthEast();return new N(new z(r.lat-i,r.lng-o),new z(a.lat-i,a.lng-o))}},$=n({},U,{wrapLng:[-180,180],R:6371e3,distance:function(e,t){var n=Math.PI/180,i=e.lat*n,o=t.lat*n,r=Math.sin((t.lat-e.lat)*n/2),a=Math.sin((t.lng-e.lng)*n/2),s=r*r+Math.cos(i)*Math.cos(o)*a*a,l=2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s));return this.R*l}}),Z=6378137,G={R:Z,MAX_LATITUDE:85.0511287798,project:function(e){var t=Math.PI/180,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,e.lat),-n),o=Math.sin(i*t);return new M(this.R*e.lng*t,this.R*Math.log((1+o)/(1-o))/2)},unproject:function(e){var t=180/Math.PI;return new z((2*Math.atan(Math.exp(e.y/this.R))-Math.PI/2)*t,e.x*t/this.R)},bounds:(H=Z*Math.PI,new I([-H,-H],[H,H]))};function V(e,t,n,i){if(g(e))return this._a=e[0],this._b=e[1],this._c=e[2],void(this._d=e[3]);this._a=e,this._b=t,this._c=n,this._d=i}function W(e,t,n,i){return new V(e,t,n,i)}V.prototype={transform:function(e,t){return this._transform(e.clone(),t)},_transform:function(e,t){return t=t||1,e.x=t*(this._a*e.x+this._b),e.y=t*(this._c*e.y+this._d),e},untransform:function(e,t){return t=t||1,new M((e.x/t-this._b)/this._a,(e.y/t-this._d)/this._c)}};var K=n({},$,{code:"EPSG:3857",projection:G,transformation:function(){var e=.5/(Math.PI*G.R);return W(e,.5,-e,.5)}()}),Y=n({},K,{code:"EPSG:900913"});function X(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function Q(e,t){var n,i,o,r,a,s,l="";for(n=0,o=e.length;n<o;n++){for(i=0,r=(a=e[n]).length;i<r;i++)l+=(i?"L":"M")+(s=a[i]).x+" "+s.y;l+=t?Ne.svg?"z":"x":""}return l||"M0 0"}var J,ee=document.documentElement.style,te="ActiveXObject"in window,ne=te&&!document.addEventListener,ie="msLaunchUri"in navigator&&!("documentMode"in document),oe=Be("webkit"),re=Be("android"),ae=Be("android 2")||Be("android 3"),se=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),le=re&&Be("Google")&&se<537&&!("AudioNode"in window),ce=!!window.opera,ue=!ie&&Be("chrome"),de=Be("gecko")&&!oe&&!ce&&!te,me=!ue&&Be("safari"),he=Be("phantom"),pe="OTransition"in ee,_e=0===navigator.platform.indexOf("Win"),fe=te&&"transition"in ee,ge="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ae,be="MozPerspective"in ee,ye=!window.L_DISABLE_3D&&(fe||ge||be)&&!pe&&!he,ve="undefined"!=typeof orientation||Be("mobile"),Ee=ve&&oe,ke=ve&&ge,Ae=!window.PointerEvent&&window.MSPointerEvent,Te=!(!window.PointerEvent&&!Ae),we="ontouchstart"in window||!!window.TouchEvent,Le=!window.L_NO_TOUCH&&(we||Te),De=ve&&ce,Ce=ve&&de,Oe=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Re=function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassiveEventSupport",c,t),window.removeEventListener("testPassiveEventSupport",c,t)}catch(e){}return e}(),Se=!!document.createElement("canvas").getContext,Pe=!(!document.createElementNS||!X("svg").createSVGRect),Me=!!Pe&&((J=document.createElement("div")).innerHTML="<svg/>","http://www.w3.org/2000/svg"===(J.firstChild&&J.firstChild.namespaceURI)),xe=!Pe&&function(){try{var e=document.createElement("div");e.innerHTML='<v:shape adj="1"/>';var t=e.firstChild;return t.style.behavior="url(#default#VML)",t&&"object"==typeof t.adj}catch(e){return!1}}(),je=0===navigator.platform.indexOf("Mac"),Ie=0===navigator.platform.indexOf("Linux");function Be(e){return navigator.userAgent.toLowerCase().indexOf(e)>=0}var Ne={ie:te,ielt9:ne,edge:ie,webkit:oe,android:re,android23:ae,androidStock:le,opera:ce,chrome:ue,gecko:de,safari:me,phantom:he,opera12:pe,win:_e,ie3d:fe,webkit3d:ge,gecko3d:be,any3d:ye,mobile:ve,mobileWebkit:Ee,mobileWebkit3d:ke,msPointer:Ae,pointer:Te,touch:Le,touchNative:we,mobileOpera:De,mobileGecko:Ce,retina:Oe,passiveEvents:Re,canvas:Se,svg:Pe,vml:xe,inlineSvg:Me,mac:je,linux:Ie},Fe=Ne.msPointer?"MSPointerDown":"pointerdown",ze=Ne.msPointer?"MSPointerMove":"pointermove",qe=Ne.msPointer?"MSPointerUp":"pointerup",He=Ne.msPointer?"MSPointerCancel":"pointercancel",Ue={touchstart:Fe,touchmove:ze,touchend:qe,touchcancel:He},$e={touchstart:et,touchmove:Je,touchend:Je,touchcancel:Je},Ze={},Ge=!1;function Ve(e,t,n){return"touchstart"===t&&Qe(),$e[t]?(n=$e[t].bind(this,n),e.addEventListener(Ue[t],n,!1),n):(console.warn("wrong event specified:",t),c)}function We(e,t,n){Ue[t]?e.removeEventListener(Ue[t],n,!1):console.warn("wrong event specified:",t)}function Ke(e){Ze[e.pointerId]=e}function Ye(e){Ze[e.pointerId]&&(Ze[e.pointerId]=e)}function Xe(e){delete Ze[e.pointerId]}function Qe(){Ge||(document.addEventListener(Fe,Ke,!0),document.addEventListener(ze,Ye,!0),document.addEventListener(qe,Xe,!0),document.addEventListener(He,Xe,!0),Ge=!0)}function Je(e,t){if(t.pointerType!==(t.MSPOINTER_TYPE_MOUSE||"mouse")){for(var n in t.touches=[],Ze)t.touches.push(Ze[n]);t.changedTouches=[t],e(t)}}function et(e,t){t.MSPOINTER_TYPE_TOUCH&&t.pointerType===t.MSPOINTER_TYPE_TOUCH&&Kt(t),Je(e,t)}function tt(e){var t,n,i={};for(n in e)t=e[n],i[n]=t&&t.bind?t.bind(e):t;return e=i,i.type="dblclick",i.detail=2,i.isTrusted=!1,i._simulated=!0,i}var nt=200;function it(e,t){e.addEventListener("dblclick",t);var n,i=0;function o(e){if(1===e.detail){if("mouse"!==e.pointerType&&(!e.sourceCapabilities||e.sourceCapabilities.firesTouchEvents)){var o=Xt(e);if(!o.some((function(e){return e instanceof HTMLLabelElement&&e.attributes.for}))||o.some((function(e){return e instanceof HTMLInputElement||e instanceof HTMLSelectElement}))){var r=Date.now();r-i<=nt?2==++n&&t(tt(e)):n=1,i=r}}}else n=e.detail}return e.addEventListener("click",o),{dblclick:t,simDblclick:o}}function ot(e,t){e.removeEventListener("dblclick",t.dblclick),e.removeEventListener("click",t.simDblclick)}var rt,at,st,lt,ct,ut=Dt(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),dt=Dt(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),mt="webkitTransition"===dt||"OTransition"===dt?dt+"End":"transitionend";function ht(e){return"string"==typeof e?document.getElementById(e):e}function pt(e,t){var n=e.style[t]||e.currentStyle&&e.currentStyle[t];if((!n||"auto"===n)&&document.defaultView){var i=document.defaultView.getComputedStyle(e,null);n=i?i[t]:null}return"auto"===n?null:n}function _t(e,t,n){var i=document.createElement(e);return i.className=t||"",n&&n.appendChild(i),i}function ft(e){var t=e.parentNode;t&&t.removeChild(e)}function gt(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function bt(e){var t=e.parentNode;t&&t.lastChild!==e&&t.appendChild(e)}function yt(e){var t=e.parentNode;t&&t.firstChild!==e&&t.insertBefore(e,t.firstChild)}function vt(e,t){if(void 0!==e.classList)return e.classList.contains(t);var n=Tt(e);return n.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(n)}function Et(e,t){if(void 0!==e.classList)for(var n=m(t),i=0,o=n.length;i<o;i++)e.classList.add(n[i]);else if(!vt(e,t)){var r=Tt(e);At(e,(r?r+" ":"")+t)}}function kt(e,t){void 0!==e.classList?e.classList.remove(t):At(e,d((" "+Tt(e)+" ").replace(" "+t+" "," ")))}function At(e,t){void 0===e.className.baseVal?e.className=t:e.className.baseVal=t}function Tt(e){return e.correspondingElement&&(e=e.correspondingElement),void 0===e.className.baseVal?e.className:e.className.baseVal}function wt(e,t){"opacity"in e.style?e.style.opacity=t:"filter"in e.style&&Lt(e,t)}function Lt(e,t){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=e.filters.item(i)}catch(e){if(1===t)return}t=Math.round(100*t),n?(n.Enabled=100!==t,n.Opacity=t):e.style.filter+=" progid:"+i+"(opacity="+t+")"}function Dt(e){for(var t=document.documentElement.style,n=0;n<e.length;n++)if(e[n]in t)return e[n];return!1}function Ct(e,t,n){var i=t||new M(0,0);e.style[ut]=(Ne.ie3d?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(n?" scale("+n+")":"")}function Ot(e,t){e._leaflet_pos=t,Ne.any3d?Ct(e,t):(e.style.left=t.x+"px",e.style.top=t.y+"px")}function Rt(e){return e._leaflet_pos||new M(0,0)}if("onselectstart"in document)rt=function(){Ft(window,"selectstart",Kt)},at=function(){qt(window,"selectstart",Kt)};else{var St=Dt(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);rt=function(){if(St){var e=document.documentElement.style;st=e[St],e[St]="none"}},at=function(){St&&(document.documentElement.style[St]=st,st=void 0)}}function Pt(){Ft(window,"dragstart",Kt)}function Mt(){qt(window,"dragstart",Kt)}function xt(e){for(;-1===e.tabIndex;)e=e.parentNode;e.style&&(jt(),lt=e,ct=e.style.outlineStyle,e.style.outlineStyle="none",Ft(window,"keydown",jt))}function jt(){lt&&(lt.style.outlineStyle=ct,lt=void 0,ct=void 0,qt(window,"keydown",jt))}function It(e){do{e=e.parentNode}while(!(e.offsetWidth&&e.offsetHeight||e===document.body));return e}function Bt(e){var t=e.getBoundingClientRect();return{x:t.width/e.offsetWidth||1,y:t.height/e.offsetHeight||1,boundingClientRect:t}}var Nt={__proto__:null,TRANSFORM:ut,TRANSITION:dt,TRANSITION_END:mt,get:ht,getStyle:pt,create:_t,remove:ft,empty:gt,toFront:bt,toBack:yt,hasClass:vt,addClass:Et,removeClass:kt,setClass:At,getClass:Tt,setOpacity:wt,testProp:Dt,setTransform:Ct,setPosition:Ot,getPosition:Rt,get disableTextSelection(){return rt},get enableTextSelection(){return at},disableImageDrag:Pt,enableImageDrag:Mt,preventOutline:xt,restoreOutline:jt,getSizedParentNode:It,getScale:Bt};function Ft(e,t,n,i){if(t&&"object"==typeof t)for(var o in t)$t(e,o,t[o],n);else for(var r=0,a=(t=m(t)).length;r<a;r++)$t(e,t[r],n,i);return this}var zt="_leaflet_events";function qt(e,t,n,i){if(1===arguments.length)Ht(e),delete e[zt];else if(t&&"object"==typeof t)for(var o in t)Zt(e,o,t[o],n);else if(t=m(t),2===arguments.length)Ht(e,(function(e){return-1!==b(t,e)}));else for(var r=0,a=t.length;r<a;r++)Zt(e,t[r],n,i);return this}function Ht(e,t){for(var n in e[zt]){var i=n.split(/\d/)[0];t&&!t(i)||Zt(e,i,null,null,n)}}var Ut={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function $t(e,t,n,i){var o=t+a(n)+(i?"_"+a(i):"");if(e[zt]&&e[zt][o])return this;var r=function(t){return n.call(i||e,t||window.event)},s=r;!Ne.touchNative&&Ne.pointer&&0===t.indexOf("touch")?r=Ve(e,t,r):Ne.touch&&"dblclick"===t?r=it(e,r):"addEventListener"in e?"touchstart"===t||"touchmove"===t||"wheel"===t||"mousewheel"===t?e.addEventListener(Ut[t]||t,r,!!Ne.passiveEvents&&{passive:!1}):"mouseenter"===t||"mouseleave"===t?(r=function(t){t=t||window.event,tn(e,t)&&s(t)},e.addEventListener(Ut[t],r,!1)):e.addEventListener(t,s,!1):e.attachEvent("on"+t,r),e[zt]=e[zt]||{},e[zt][o]=r}function Zt(e,t,n,i,o){o=o||t+a(n)+(i?"_"+a(i):"");var r=e[zt]&&e[zt][o];if(!r)return this;!Ne.touchNative&&Ne.pointer&&0===t.indexOf("touch")?We(e,t,r):Ne.touch&&"dblclick"===t?ot(e,r):"removeEventListener"in e?e.removeEventListener(Ut[t]||t,r,!1):e.detachEvent("on"+t,r),e[zt][o]=null}function Gt(e){return e.stopPropagation?e.stopPropagation():e.originalEvent?e.originalEvent._stopped=!0:e.cancelBubble=!0,this}function Vt(e){return $t(e,"wheel",Gt),this}function Wt(e){return Ft(e,"mousedown touchstart dblclick contextmenu",Gt),e._leaflet_disable_click=!0,this}function Kt(e){return e.preventDefault?e.preventDefault():e.returnValue=!1,this}function Yt(e){return Kt(e),Gt(e),this}function Xt(e){if(e.composedPath)return e.composedPath();for(var t=[],n=e.target;n;)t.push(n),n=n.parentNode;return t}function Qt(e,t){if(!t)return new M(e.clientX,e.clientY);var n=Bt(t),i=n.boundingClientRect;return new M((e.clientX-i.left)/n.x-t.clientLeft,(e.clientY-i.top)/n.y-t.clientTop)}var Jt=Ne.linux&&Ne.chrome?window.devicePixelRatio:Ne.mac?3*window.devicePixelRatio:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function en(e){return Ne.edge?e.wheelDeltaY/2:e.deltaY&&0===e.deltaMode?-e.deltaY/Jt:e.deltaY&&1===e.deltaMode?20*-e.deltaY:e.deltaY&&2===e.deltaMode?60*-e.deltaY:e.deltaX||e.deltaZ?0:e.wheelDelta?(e.wheelDeltaY||e.wheelDelta)/2:e.detail&&Math.abs(e.detail)<32765?20*-e.detail:e.detail?e.detail/-32765*60:0}function tn(e,t){var n=t.relatedTarget;if(!n)return!0;try{for(;n&&n!==e;)n=n.parentNode}catch(e){return!1}return n!==e}var nn={__proto__:null,on:Ft,off:qt,stopPropagation:Gt,disableScrollPropagation:Vt,disableClickPropagation:Wt,preventDefault:Kt,stop:Yt,getPropagationPath:Xt,getMousePosition:Qt,getWheelDelta:en,isExternalTarget:tn,addListener:Ft,removeListener:qt},on=P.extend({run:function(e,t,n,i){this.stop(),this._el=e,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=Rt(e),this._offset=t.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=w(this._animate,this),this._step()},_step:function(e){var t=+new Date-this._startTime,n=1e3*this._duration;t<n?this._runFrame(this._easeOut(t/n),e):(this._runFrame(1),this._complete())},_runFrame:function(e,t){var n=this._startPos.add(this._offset.multiplyBy(e));t&&n._round(),Ot(this._el,n),this.fire("step")},_complete:function(){D(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(e){return 1-Math.pow(1-e,this._easeOutPower)}}),rn=P.extend({options:{crs:K,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(e,t){t=h(this,t),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(e),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),t.maxBounds&&this.setMaxBounds(t.maxBounds),void 0!==t.zoom&&(this._zoom=this._limitZoom(t.zoom)),t.center&&void 0!==t.zoom&&this.setView(q(t.center),t.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=dt&&Ne.any3d&&!Ne.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ft(this._proxy,mt,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(e,t,i){return t=void 0===t?this._zoom:this._limitZoom(t),e=this._limitCenter(q(e),t,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&!0!==i&&(void 0!==i.animate&&(i.zoom=n({animate:i.animate},i.zoom),i.pan=n({animate:i.animate,duration:i.duration},i.pan)),this._zoom!==t?this._tryAnimatedZoom&&this._tryAnimatedZoom(e,t,i.zoom):this._tryAnimatedPan(e,i.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(e,t,i.pan&&i.pan.noMoveStart),this)},setZoom:function(e,t){return this._loaded?this.setView(this.getCenter(),e,{zoom:t}):(this._zoom=e,this)},zoomIn:function(e,t){return e=e||(Ne.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+e,t)},zoomOut:function(e,t){return e=e||(Ne.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-e,t)},setZoomAround:function(e,t,n){var i=this.getZoomScale(t),o=this.getSize().divideBy(2),r=(e instanceof M?e:this.latLngToContainerPoint(e)).subtract(o).multiplyBy(1-1/i),a=this.containerPointToLatLng(o.add(r));return this.setView(a,t,{zoom:n})},_getBoundsCenterZoom:function(e,t){t=t||{},e=e.getBounds?e.getBounds():F(e);var n=j(t.paddingTopLeft||t.padding||[0,0]),i=j(t.paddingBottomRight||t.padding||[0,0]),o=this.getBoundsZoom(e,!1,n.add(i));if((o="number"==typeof t.maxZoom?Math.min(t.maxZoom,o):o)===1/0)return{center:e.getCenter(),zoom:o};var r=i.subtract(n).divideBy(2),a=this.project(e.getSouthWest(),o),s=this.project(e.getNorthEast(),o);return{center:this.unproject(a.add(s).divideBy(2).add(r),o),zoom:o}},fitBounds:function(e,t){if(!(e=F(e)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(e,t);return this.setView(n.center,n.zoom,t)},fitWorld:function(e){return this.fitBounds([[-90,-180],[90,180]],e)},panTo:function(e,t){return this.setView(e,this._zoom,{pan:t})},panBy:function(e,t){if(t=t||{},!(e=j(e).round()).x&&!e.y)return this.fire("moveend");if(!0!==t.animate&&!this.getSize().contains(e))return this._resetView(this.unproject(this.project(this.getCenter()).add(e)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new on,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),t.noMoveStart||this.fire("movestart"),!1!==t.animate){Et(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(e).round();this._panAnim.run(this._mapPane,n,t.duration||.25,t.easeLinearity)}else this._rawPanBy(e),this.fire("move").fire("moveend");return this},flyTo:function(e,t,n){if(!1===(n=n||{}).animate||!Ne.any3d)return this.setView(e,t,n);this._stop();var i=this.project(this.getCenter()),o=this.project(e),r=this.getSize(),a=this._zoom;e=q(e),t=void 0===t?a:t;var s=Math.max(r.x,r.y),l=s*this.getZoomScale(a,t),c=o.distanceTo(i)||1,u=1.42,d=u*u;function m(e){var t=(l*l-s*s+(e?-1:1)*d*d*c*c)/(2*(e?l:s)*d*c),n=Math.sqrt(t*t+1)-t;return n<1e-9?-18:Math.log(n)}function h(e){return(Math.exp(e)-Math.exp(-e))/2}function p(e){return(Math.exp(e)+Math.exp(-e))/2}function _(e){return h(e)/p(e)}var f=m(0);function g(e){return s*(p(f)/p(f+u*e))}function b(e){return s*(p(f)*_(f+u*e)-h(f))/d}function y(e){return 1-Math.pow(1-e,1.5)}var v=Date.now(),E=(m(1)-f)/u,k=n.duration?1e3*n.duration:1e3*E*.8;function A(){var n=(Date.now()-v)/k,r=y(n)*E;n<=1?(this._flyToFrame=w(A,this),this._move(this.unproject(i.add(o.subtract(i).multiplyBy(b(r)/c)),a),this.getScaleZoom(s/g(r),a),{flyTo:!0})):this._move(e,t)._moveEnd(!0)}return this._moveStart(!0,n.noMoveStart),A.call(this),this},flyToBounds:function(e,t){var n=this._getBoundsCenterZoom(e,t);return this.flyTo(n.center,n.zoom,t)},setMaxBounds:function(e){return e=F(e),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),e.isValid()?(this.options.maxBounds=e,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(e){var t=this.options.minZoom;return this.options.minZoom=e,this._loaded&&t!==e&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(e):this},setMaxZoom:function(e){var t=this.options.maxZoom;return this.options.maxZoom=e,this._loaded&&t!==e&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(e):this},panInsideBounds:function(e,t){this._enforcingBounds=!0;var n=this.getCenter(),i=this._limitCenter(n,this._zoom,F(e));return n.equals(i)||this.panTo(i,t),this._enforcingBounds=!1,this},panInside:function(e,t){var n=j((t=t||{}).paddingTopLeft||t.padding||[0,0]),i=j(t.paddingBottomRight||t.padding||[0,0]),o=this.project(this.getCenter()),r=this.project(e),a=this.getPixelBounds(),s=B([a.min.add(n),a.max.subtract(i)]),l=s.getSize();if(!s.contains(r)){this._enforcingBounds=!0;var c=r.subtract(s.getCenter()),u=s.extend(r).getSize().subtract(l);o.x+=c.x<0?-u.x:u.x,o.y+=c.y<0?-u.y:u.y,this.panTo(this.unproject(o),t),this._enforcingBounds=!1}return this},invalidateSize:function(e){if(!this._loaded)return this;e=n({animate:!1,pan:!0},!0===e?{animate:!0}:e);var t=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),r=t.divideBy(2).round(),a=i.divideBy(2).round(),s=r.subtract(a);return s.x||s.y?(e.animate&&e.pan?this.panBy(s):(e.pan&&this._rawPanBy(s),this.fire("move"),e.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:t,newSize:i})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(e){if(e=this._locateOptions=n({timeout:1e4,watch:!1},e),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var t=o(this._handleGeolocationResponse,this),i=o(this._handleGeolocationError,this);return e.watch?this._locationWatchId=navigator.geolocation.watchPosition(t,i,e):navigator.geolocation.getCurrentPosition(t,i,e),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(e){if(this._container._leaflet_id){var t=e.code,n=e.message||(1===t?"permission denied":2===t?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:t,message:"Geolocation error: "+n+"."})}},_handleGeolocationResponse:function(e){if(this._container._leaflet_id){var t=new z(e.coords.latitude,e.coords.longitude),n=t.toBounds(2*e.coords.accuracy),i=this._locateOptions;if(i.setView){var o=this.getBoundsZoom(n);this.setView(t,i.maxZoom?Math.min(o,i.maxZoom):o)}var r={latlng:t,bounds:n,timestamp:e.timestamp};for(var a in e.coords)"number"==typeof e.coords[a]&&(r[a]=e.coords[a]);this.fire("locationfound",r)}},addHandler:function(e,t){if(!t)return this;var n=this[e]=new t(this);return this._handlers.push(n),this.options[e]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(e){this._container._leaflet_id=void 0,this._containerId=void 0}var e;for(e in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),ft(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(D(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[e].remove();for(e in this._panes)ft(this._panes[e]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(e,t){var n=_t("div","leaflet-pane"+(e?" leaflet-"+e.replace("Pane","")+"-pane":""),t||this._mapPane);return e&&(this._panes[e]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var e=this.getPixelBounds();return new N(this.unproject(e.getBottomLeft()),this.unproject(e.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(e,t,n){e=F(e),n=j(n||[0,0]);var i=this.getZoom()||0,o=this.getMinZoom(),r=this.getMaxZoom(),a=e.getNorthWest(),s=e.getSouthEast(),l=this.getSize().subtract(n),c=B(this.project(s,i),this.project(a,i)).getSize(),u=Ne.any3d?this.options.zoomSnap:1,d=l.x/c.x,m=l.y/c.y,h=t?Math.max(d,m):Math.min(d,m);return i=this.getScaleZoom(h,i),u&&(i=Math.round(i/(u/100))*(u/100),i=t?Math.ceil(i/u)*u:Math.floor(i/u)*u),Math.max(o,Math.min(r,i))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new M(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(e,t){var n=this._getTopLeftPoint(e,t);return new I(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(e){return this.options.crs.getProjectedBounds(void 0===e?this.getZoom():e)},getPane:function(e){return"string"==typeof e?this._panes[e]:e},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(e,t){var n=this.options.crs;return t=void 0===t?this._zoom:t,n.scale(e)/n.scale(t)},getScaleZoom:function(e,t){var n=this.options.crs;t=void 0===t?this._zoom:t;var i=n.zoom(e*n.scale(t));return isNaN(i)?1/0:i},project:function(e,t){return t=void 0===t?this._zoom:t,this.options.crs.latLngToPoint(q(e),t)},unproject:function(e,t){return t=void 0===t?this._zoom:t,this.options.crs.pointToLatLng(j(e),t)},layerPointToLatLng:function(e){var t=j(e).add(this.getPixelOrigin());return this.unproject(t)},latLngToLayerPoint:function(e){return this.project(q(e))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(e){return this.options.crs.wrapLatLng(q(e))},wrapLatLngBounds:function(e){return this.options.crs.wrapLatLngBounds(F(e))},distance:function(e,t){return this.options.crs.distance(q(e),q(t))},containerPointToLayerPoint:function(e){return j(e).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(e){return j(e).add(this._getMapPanePos())},containerPointToLatLng:function(e){var t=this.containerPointToLayerPoint(j(e));return this.layerPointToLatLng(t)},latLngToContainerPoint:function(e){return this.layerPointToContainerPoint(this.latLngToLayerPoint(q(e)))},mouseEventToContainerPoint:function(e){return Qt(e,this._container)},mouseEventToLayerPoint:function(e){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(e))},mouseEventToLatLng:function(e){return this.layerPointToLatLng(this.mouseEventToLayerPoint(e))},_initContainer:function(e){var t=this._container=ht(e);if(!t)throw new Error("Map container not found.");if(t._leaflet_id)throw new Error("Map container is already initialized.");Ft(t,"scroll",this._onScroll,this),this._containerId=a(t)},_initLayout:function(){var e=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ne.any3d,Et(e,"leaflet-container"+(Ne.touch?" leaflet-touch":"")+(Ne.retina?" leaflet-retina":"")+(Ne.ielt9?" leaflet-oldie":"")+(Ne.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var t=pt(e,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&"sticky"!==t&&(e.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var e=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ot(this._mapPane,new M(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Et(e.markerPane,"leaflet-zoom-hide"),Et(e.shadowPane,"leaflet-zoom-hide"))},_resetView:function(e,t,n){Ot(this._mapPane,new M(0,0));var i=!this._loaded;this._loaded=!0,t=this._limitZoom(t),this.fire("viewprereset");var o=this._zoom!==t;this._moveStart(o,n)._move(e,t)._moveEnd(o),this.fire("viewreset"),i&&this.fire("load")},_moveStart:function(e,t){return e&&this.fire("zoomstart"),t||this.fire("movestart"),this},_move:function(e,t,n,i){void 0===t&&(t=this._zoom);var o=this._zoom!==t;return this._zoom=t,this._lastCenter=e,this._pixelOrigin=this._getNewPixelOrigin(e),i?n&&n.pinch&&this.fire("zoom",n):((o||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)),this},_moveEnd:function(e){return e&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return D(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(e){Ot(this._mapPane,this._getMapPanePos().subtract(e))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){this._targets={},this._targets[a(this._container)]=this;var t=e?qt:Ft;t(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&t(window,"resize",this._onResize,this),Ne.any3d&&this.options.transform3DLimit&&(e?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){D(this._resizeRequest),this._resizeRequest=w((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var e=this._getMapPanePos();Math.max(Math.abs(e.x),Math.abs(e.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(e,t){for(var n,i=[],o="mouseout"===t||"mouseover"===t,r=e.target||e.srcElement,s=!1;r;){if((n=this._targets[a(r)])&&("click"===t||"preclick"===t)&&this._draggableMoved(n)){s=!0;break}if(n&&n.listens(t,!0)){if(o&&!tn(r,e))break;if(i.push(n),o)break}if(r===this._container)break;r=r.parentNode}return i.length||s||o||!this.listens(t,!0)||(i=[this]),i},_isClickDisabled:function(e){for(;e&&e!==this._container;){if(e._leaflet_disable_click)return!0;e=e.parentNode}},_handleDOMEvent:function(e){var t=e.target||e.srcElement;if(!(!this._loaded||t._leaflet_disable_events||"click"===e.type&&this._isClickDisabled(t))){var n=e.type;"mousedown"===n&&xt(t),this._fireDOMEvent(e,n)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(e,t,i){if("click"===e.type){var o=n({},e);o.type="preclick",this._fireDOMEvent(o,o.type,i)}var r=this._findEventTargets(e,t);if(i){for(var a=[],s=0;s<i.length;s++)i[s].listens(t,!0)&&a.push(i[s]);r=a.concat(r)}if(r.length){"contextmenu"===t&&Kt(e);var l=r[0],c={originalEvent:e};if("keypress"!==e.type&&"keydown"!==e.type&&"keyup"!==e.type){var u=l.getLatLng&&(!l._radius||l._radius<=10);c.containerPoint=u?this.latLngToContainerPoint(l.getLatLng()):this.mouseEventToContainerPoint(e),c.layerPoint=this.containerPointToLayerPoint(c.containerPoint),c.latlng=u?l.getLatLng():this.layerPointToLatLng(c.layerPoint)}for(s=0;s<r.length;s++)if(r[s].fire(t,c,!0),c.originalEvent._stopped||!1===r[s].options.bubblingMouseEvents&&-1!==b(this._mouseEvents,t))return}},_draggableMoved:function(e){return(e=e.dragging&&e.dragging.enabled()?e:this).dragging&&e.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var e=0,t=this._handlers.length;e<t;e++)this._handlers[e].disable()},whenReady:function(e,t){return this._loaded?e.call(t||this,{target:this}):this.on("load",e,t),this},_getMapPanePos:function(){return Rt(this._mapPane)||new M(0,0)},_moved:function(){var e=this._getMapPanePos();return e&&!e.equals([0,0])},_getTopLeftPoint:function(e,t){return(e&&void 0!==t?this._getNewPixelOrigin(e,t):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(e,t){var n=this.getSize()._divideBy(2);return this.project(e,t)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(e,t,n){var i=this._getNewPixelOrigin(n,t);return this.project(e,t)._subtract(i)},_latLngBoundsToNewLayerBounds:function(e,t,n){var i=this._getNewPixelOrigin(n,t);return B([this.project(e.getSouthWest(),t)._subtract(i),this.project(e.getNorthWest(),t)._subtract(i),this.project(e.getSouthEast(),t)._subtract(i),this.project(e.getNorthEast(),t)._subtract(i)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(e){return this.latLngToLayerPoint(e).subtract(this._getCenterLayerPoint())},_limitCenter:function(e,t,n){if(!n)return e;var i=this.project(e,t),o=this.getSize().divideBy(2),r=new I(i.subtract(o),i.add(o)),a=this._getBoundsOffset(r,n,t);return Math.abs(a.x)<=1&&Math.abs(a.y)<=1?e:this.unproject(i.add(a),t)},_limitOffset:function(e,t){if(!t)return e;var n=this.getPixelBounds(),i=new I(n.min.add(e),n.max.add(e));return e.add(this._getBoundsOffset(i,t))},_getBoundsOffset:function(e,t,n){var i=B(this.project(t.getNorthEast(),n),this.project(t.getSouthWest(),n)),o=i.min.subtract(e.min),r=i.max.subtract(e.max);return new M(this._rebound(o.x,-r.x),this._rebound(o.y,-r.y))},_rebound:function(e,t){return e+t>0?Math.round(e-t)/2:Math.max(0,Math.ceil(e))-Math.max(0,Math.floor(t))},_limitZoom:function(e){var t=this.getMinZoom(),n=this.getMaxZoom(),i=Ne.any3d?this.options.zoomSnap:1;return i&&(e=Math.round(e/i)*i),Math.max(t,Math.min(n,e))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){kt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(e,t){var n=this._getCenterOffset(e)._trunc();return!(!0!==(t&&t.animate)&&!this.getSize().contains(n)||(this.panBy(n,t),0))},_createAnimProxy:function(){var e=this._proxy=_t("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(e),this.on("zoomanim",(function(e){var t=ut,n=this._proxy.style[t];Ct(this._proxy,this.project(e.center,e.zoom),this.getZoomScale(e.zoom,1)),n===this._proxy.style[t]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ft(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var e=this.getCenter(),t=this.getZoom();Ct(this._proxy,this.project(e,t),this.getZoomScale(t,1))},_catchTransitionEnd:function(e){this._animatingZoom&&e.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(e,t,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(t-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(t),o=this._getCenterOffset(e)._divideBy(1-1/i);return!(!0!==n.animate&&!this.getSize().contains(o)||(w((function(){this._moveStart(!0,n.noMoveStart||!1)._animateZoom(e,t,!0)}),this),0))},_animateZoom:function(e,t,n,i){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=e,this._animateToZoom=t,Et(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:e,zoom:t,noUpdate:i}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&kt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function an(e,t){return new rn(e,t)}var sn=O.extend({options:{position:"topright"},initialize:function(e){h(this,e)},getPosition:function(){return this.options.position},setPosition:function(e){var t=this._map;return t&&t.removeControl(this),this.options.position=e,t&&t.addControl(this),this},getContainer:function(){return this._container},addTo:function(e){this.remove(),this._map=e;var t=this._container=this.onAdd(e),n=this.getPosition(),i=e._controlCorners[n];return Et(t,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(t,i.firstChild):i.appendChild(t),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ft(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(e){this._map&&e&&e.screenX>0&&e.screenY>0&&this._map.getContainer().focus()}}),ln=function(e){return new sn(e)};rn.include({addControl:function(e){return e.addTo(this),this},removeControl:function(e){return e.remove(),this},_initControlPos:function(){var e=this._controlCorners={},t="leaflet-",n=this._controlContainer=_t("div",t+"control-container",this._container);function i(i,o){var r=t+i+" "+t+o;e[i+o]=_t("div",r,n)}i("top","left"),i("top","right"),i("bottom","left"),i("bottom","right")},_clearControlPos:function(){for(var e in this._controlCorners)ft(this._controlCorners[e]);ft(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var cn=sn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(e,t,n,i){return n<i?-1:i<n?1:0}},initialize:function(e,t,n){for(var i in h(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1,e)this._addLayer(e[i],i);for(i in t)this._addLayer(t[i],i,!0)},onAdd:function(e){this._initLayout(),this._update(),this._map=e,e.on("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(e){return sn.prototype.addTo.call(this,e),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(e,t){return this._addLayer(e,t),this._map?this._update():this},addOverlay:function(e,t){return this._addLayer(e,t,!0),this._map?this._update():this},removeLayer:function(e){e.off("add remove",this._onLayerChange,this);var t=this._getLayer(a(e));return t&&this._layers.splice(this._layers.indexOf(t),1),this._map?this._update():this},expand:function(){Et(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var e=this._map.getSize().y-(this._container.offsetTop+50);return e<this._section.clientHeight?(Et(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=e+"px"):kt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return kt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var e="leaflet-control-layers",t=this._container=_t("div",e),n=this.options.collapsed;t.setAttribute("aria-haspopup",!0),Wt(t),Vt(t);var i=this._section=_t("section",e+"-list");n&&(this._map.on("click",this.collapse,this),Ft(t,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var o=this._layersLink=_t("a",e+"-toggle",t);o.href="#",o.title="Layers",o.setAttribute("role","button"),Ft(o,{keydown:function(e){13===e.keyCode&&this._expandSafely()},click:function(e){Kt(e),this._expandSafely()}},this),n||this.expand(),this._baseLayersList=_t("div",e+"-base",i),this._separator=_t("div",e+"-separator",i),this._overlaysList=_t("div",e+"-overlays",i),t.appendChild(i)},_getLayer:function(e){for(var t=0;t<this._layers.length;t++)if(this._layers[t]&&a(this._layers[t].layer)===e)return this._layers[t]},_addLayer:function(e,t,n){this._map&&e.on("add remove",this._onLayerChange,this),this._layers.push({layer:e,name:t,overlay:n}),this.options.sortLayers&&this._layers.sort(o((function(e,t){return this.options.sortFunction(e.layer,t.layer,e.name,t.name)}),this)),this.options.autoZIndex&&e.setZIndex&&(this._lastZIndex++,e.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;gt(this._baseLayersList),gt(this._overlaysList),this._layerControlInputs=[];var e,t,n,i,o=0;for(n=0;n<this._layers.length;n++)i=this._layers[n],this._addItem(i),t=t||i.overlay,e=e||!i.overlay,o+=i.overlay?0:1;return this.options.hideSingleBase&&(e=e&&o>1,this._baseLayersList.style.display=e?"":"none"),this._separator.style.display=t&&e?"":"none",this},_onLayerChange:function(e){this._handlingClick||this._update();var t=this._getLayer(a(e.target)),n=t.overlay?"add"===e.type?"overlayadd":"overlayremove":"add"===e.type?"baselayerchange":null;n&&this._map.fire(n,t)},_createRadioElement:function(e,t){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(t?' checked="checked"':"")+"/>",i=document.createElement("div");return i.innerHTML=n,i.firstChild},_addItem:function(e){var t,n=document.createElement("label"),i=this._map.hasLayer(e.layer);e.overlay?((t=document.createElement("input")).type="checkbox",t.className="leaflet-control-layers-selector",t.defaultChecked=i):t=this._createRadioElement("leaflet-base-layers_"+a(this),i),this._layerControlInputs.push(t),t.layerId=a(e.layer),Ft(t,"click",this._onInputClick,this);var o=document.createElement("span");o.innerHTML=" "+e.name;var r=document.createElement("span");return n.appendChild(r),r.appendChild(t),r.appendChild(o),(e.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){if(!this._preventClick){var e,t,n=this._layerControlInputs,i=[],o=[];this._handlingClick=!0;for(var r=n.length-1;r>=0;r--)e=n[r],t=this._getLayer(e.layerId).layer,e.checked?i.push(t):e.checked||o.push(t);for(r=0;r<o.length;r++)this._map.hasLayer(o[r])&&this._map.removeLayer(o[r]);for(r=0;r<i.length;r++)this._map.hasLayer(i[r])||this._map.addLayer(i[r]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var e,t,n=this._layerControlInputs,i=this._map.getZoom(),o=n.length-1;o>=0;o--)e=n[o],t=this._getLayer(e.layerId).layer,e.disabled=void 0!==t.options.minZoom&&i<t.options.minZoom||void 0!==t.options.maxZoom&&i>t.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var e=this._section;this._preventClick=!0,Ft(e,"click",Kt),this.expand();var t=this;setTimeout((function(){qt(e,"click",Kt),t._preventClick=!1}))}}),un=function(e,t,n){return new cn(e,t,n)},dn=sn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(e){var t="leaflet-control-zoom",n=_t("div",t+" leaflet-bar"),i=this.options;return this._zoomInButton=this._createButton(i.zoomInText,i.zoomInTitle,t+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(i.zoomOutText,i.zoomOutTitle,t+"-out",n,this._zoomOut),this._updateDisabled(),e.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(e){e.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(e){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(e.shiftKey?3:1))},_zoomOut:function(e){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(e.shiftKey?3:1))},_createButton:function(e,t,n,i,o){var r=_t("a",n,i);return r.innerHTML=e,r.href="#",r.title=t,r.setAttribute("role","button"),r.setAttribute("aria-label",t),Wt(r),Ft(r,"click",Yt),Ft(r,"click",o,this),Ft(r,"click",this._refocusOnMap,this),r},_updateDisabled:function(){var e=this._map,t="leaflet-disabled";kt(this._zoomInButton,t),kt(this._zoomOutButton,t),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||e._zoom===e.getMinZoom())&&(Et(this._zoomOutButton,t),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||e._zoom===e.getMaxZoom())&&(Et(this._zoomInButton,t),this._zoomInButton.setAttribute("aria-disabled","true"))}});rn.mergeOptions({zoomControl:!0}),rn.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new dn,this.addControl(this.zoomControl))}));var mn=function(e){return new dn(e)},hn=sn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(e){var t="leaflet-control-scale",n=_t("div",t),i=this.options;return this._addScales(i,t+"-line",n),e.on(i.updateWhenIdle?"moveend":"move",this._update,this),e.whenReady(this._update,this),n},onRemove:function(e){e.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(e,t,n){e.metric&&(this._mScale=_t("div",t,n)),e.imperial&&(this._iScale=_t("div",t,n))},_update:function(){var e=this._map,t=e.getSize().y/2,n=e.distance(e.containerPointToLatLng([0,t]),e.containerPointToLatLng([this.options.maxWidth,t]));this._updateScales(n)},_updateScales:function(e){this.options.metric&&e&&this._updateMetric(e),this.options.imperial&&e&&this._updateImperial(e)},_updateMetric:function(e){var t=this._getRoundNum(e),n=t<1e3?t+" m":t/1e3+" km";this._updateScale(this._mScale,n,t/e)},_updateImperial:function(e){var t,n,i,o=3.2808399*e;o>5280?(t=o/5280,n=this._getRoundNum(t),this._updateScale(this._iScale,n+" mi",n/t)):(i=this._getRoundNum(o),this._updateScale(this._iScale,i+" ft",i/o))},_updateScale:function(e,t,n){e.style.width=Math.round(this.options.maxWidth*n)+"px",e.innerHTML=t},_getRoundNum:function(e){var t=Math.pow(10,(Math.floor(e)+"").length-1),n=e/t;return t*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),pn=function(e){return new hn(e)},_n='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',fn=sn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ne.inlineSvg?_n+" ":"")+"Leaflet</a>"},initialize:function(e){h(this,e),this._attributions={}},onAdd:function(e){for(var t in e.attributionControl=this,this._container=_t("div","leaflet-control-attribution"),Wt(this._container),e._layers)e._layers[t].getAttribution&&this.addAttribution(e._layers[t].getAttribution());return this._update(),e.on("layeradd",this._addAttribution,this),this._container},onRemove:function(e){e.off("layeradd",this._addAttribution,this)},_addAttribution:function(e){e.layer.getAttribution&&(this.addAttribution(e.layer.getAttribution()),e.layer.once("remove",(function(){this.removeAttribution(e.layer.getAttribution())}),this))},setPrefix:function(e){return this.options.prefix=e,this._update(),this},addAttribution:function(e){return e?(this._attributions[e]||(this._attributions[e]=0),this._attributions[e]++,this._update(),this):this},removeAttribution:function(e){return e?(this._attributions[e]&&(this._attributions[e]--,this._update()),this):this},_update:function(){if(this._map){var e=[];for(var t in this._attributions)this._attributions[t]&&e.push(t);var n=[];this.options.prefix&&n.push(this.options.prefix),e.length&&n.push(e.join(", ")),this._container.innerHTML=n.join(' <span aria-hidden="true">|</span> ')}}});rn.mergeOptions({attributionControl:!0}),rn.addInitHook((function(){this.options.attributionControl&&(new fn).addTo(this)}));var gn=function(e){return new fn(e)};sn.Layers=cn,sn.Zoom=dn,sn.Scale=hn,sn.Attribution=fn,ln.layers=un,ln.zoom=mn,ln.scale=pn,ln.attribution=gn;var bn=O.extend({initialize:function(e){this._map=e},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});bn.addTo=function(e,t){return e.addHandler(t,this),this};var yn={Events:S},vn=Ne.touch?"touchstart mousedown":"mousedown",En=P.extend({options:{clickTolerance:3},initialize:function(e,t,n,i){h(this,i),this._element=e,this._dragStartTarget=t||e,this._preventOutline=n},enable:function(){this._enabled||(Ft(this._dragStartTarget,vn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(En._dragging===this&&this.finishDrag(!0),qt(this._dragStartTarget,vn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(e){if(this._enabled&&(this._moved=!1,!vt(this._element,"leaflet-zoom-anim")))if(e.touches&&1!==e.touches.length)En._dragging===this&&this.finishDrag();else if(!(En._dragging||e.shiftKey||1!==e.which&&1!==e.button&&!e.touches||(En._dragging=this,this._preventOutline&&xt(this._element),Pt(),rt(),this._moving))){this.fire("down");var t=e.touches?e.touches[0]:e,n=It(this._element);this._startPoint=new M(t.clientX,t.clientY),this._startPos=Rt(this._element),this._parentScale=Bt(n);var i="mousedown"===e.type;Ft(document,i?"mousemove":"touchmove",this._onMove,this),Ft(document,i?"mouseup":"touchend touchcancel",this._onUp,this)}},_onMove:function(e){if(this._enabled)if(e.touches&&e.touches.length>1)this._moved=!0;else{var t=e.touches&&1===e.touches.length?e.touches[0]:e,n=new M(t.clientX,t.clientY)._subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(n.x/=this._parentScale.x,n.y/=this._parentScale.y,Kt(e),this._moved||(this.fire("dragstart"),this._moved=!0,Et(document.body,"leaflet-dragging"),this._lastTarget=e.target||e.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Et(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,this._lastEvent=e,this._updatePosition()))}},_updatePosition:function(){var e={originalEvent:this._lastEvent};this.fire("predrag",e),Ot(this._element,this._newPos),this.fire("drag",e)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(e){kt(document.body,"leaflet-dragging"),this._lastTarget&&(kt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),qt(document,"mousemove touchmove",this._onMove,this),qt(document,"mouseup touchend touchcancel",this._onUp,this),Mt(),at();var t=this._moved&&this._moving;this._moving=!1,En._dragging=!1,t&&this.fire("dragend",{noInertia:e,distance:this._newPos.distanceTo(this._startPos)})}});function kn(e,t,n){var i,o,r,a,s,l,c,u,d,m=[1,4,2,8];for(o=0,c=e.length;o<c;o++)e[o]._code=jn(e[o],t);for(a=0;a<4;a++){for(u=m[a],i=[],o=0,r=(c=e.length)-1;o<c;r=o++)s=e[o],l=e[r],s._code&u?l._code&u||((d=xn(l,s,u,t,n))._code=jn(d,t),i.push(d)):(l._code&u&&((d=xn(l,s,u,t,n))._code=jn(d,t),i.push(d)),i.push(s));e=i}return e}function An(e,t){var n,i,o,r,a,s,l,c,u;if(!e||0===e.length)throw new Error("latlngs not passed");Nn(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var d=q([0,0]),m=F(e);m.getNorthWest().distanceTo(m.getSouthWest())*m.getNorthEast().distanceTo(m.getNorthWest())<1700&&(d=Tn(e));var h=e.length,p=[];for(n=0;n<h;n++){var _=q(e[n]);p.push(t.project(q([_.lat-d.lat,_.lng-d.lng])))}for(s=l=c=0,n=0,i=h-1;n<h;i=n++)o=p[n],r=p[i],a=o.y*r.x-r.y*o.x,l+=(o.x+r.x)*a,c+=(o.y+r.y)*a,s+=3*a;u=0===s?p[0]:[l/s,c/s];var f=t.unproject(j(u));return q([f.lat+d.lat,f.lng+d.lng])}function Tn(e){for(var t=0,n=0,i=0,o=0;o<e.length;o++){var r=q(e[o]);t+=r.lat,n+=r.lng,i++}return q([t/i,n/i])}var wn,Ln={__proto__:null,clipPolygon:kn,polygonCenter:An,centroid:Tn};function Dn(e,t){if(!t||!e.length)return e.slice();var n=t*t;return e=Rn(e=Pn(e,n),n)}function Cn(e,t,n){return Math.sqrt(Bn(e,t,n,!0))}function On(e,t,n){return Bn(e,t,n)}function Rn(e,t){var n=e.length,i=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(n);i[0]=i[n-1]=1,Sn(e,i,t,0,n-1);var o,r=[];for(o=0;o<n;o++)i[o]&&r.push(e[o]);return r}function Sn(e,t,n,i,o){var r,a,s,l=0;for(a=i+1;a<=o-1;a++)(s=Bn(e[a],e[i],e[o],!0))>l&&(r=a,l=s);l>n&&(t[r]=1,Sn(e,t,n,i,r),Sn(e,t,n,r,o))}function Pn(e,t){for(var n=[e[0]],i=1,o=0,r=e.length;i<r;i++)In(e[i],e[o])>t&&(n.push(e[i]),o=i);return o<r-1&&n.push(e[r-1]),n}function Mn(e,t,n,i,o){var r,a,s,l=i?wn:jn(e,n),c=jn(t,n);for(wn=c;;){if(!(l|c))return[e,t];if(l&c)return!1;s=jn(a=xn(e,t,r=l||c,n,o),n),r===l?(e=a,l=s):(t=a,c=s)}}function xn(e,t,n,i,o){var r,a,s=t.x-e.x,l=t.y-e.y,c=i.min,u=i.max;return 8&n?(r=e.x+s*(u.y-e.y)/l,a=u.y):4&n?(r=e.x+s*(c.y-e.y)/l,a=c.y):2&n?(r=u.x,a=e.y+l*(u.x-e.x)/s):1&n&&(r=c.x,a=e.y+l*(c.x-e.x)/s),new M(r,a,o)}function jn(e,t){var n=0;return e.x<t.min.x?n|=1:e.x>t.max.x&&(n|=2),e.y<t.min.y?n|=4:e.y>t.max.y&&(n|=8),n}function In(e,t){var n=t.x-e.x,i=t.y-e.y;return n*n+i*i}function Bn(e,t,n,i){var o,r=t.x,a=t.y,s=n.x-r,l=n.y-a,c=s*s+l*l;return c>0&&((o=((e.x-r)*s+(e.y-a)*l)/c)>1?(r=n.x,a=n.y):o>0&&(r+=s*o,a+=l*o)),s=e.x-r,l=e.y-a,i?s*s+l*l:new M(r,a)}function Nn(e){return!g(e[0])||"object"!=typeof e[0][0]&&void 0!==e[0][0]}function Fn(e){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Nn(e)}function zn(e,t){var n,i,o,r,a,s,l,c;if(!e||0===e.length)throw new Error("latlngs not passed");Nn(e)||(console.warn("latlngs are not flat! Only the first ring will be used"),e=e[0]);var u=q([0,0]),d=F(e);d.getNorthWest().distanceTo(d.getSouthWest())*d.getNorthEast().distanceTo(d.getNorthWest())<1700&&(u=Tn(e));var m=e.length,h=[];for(n=0;n<m;n++){var p=q(e[n]);h.push(t.project(q([p.lat-u.lat,p.lng-u.lng])))}for(n=0,i=0;n<m-1;n++)i+=h[n].distanceTo(h[n+1])/2;if(0===i)c=h[0];else for(n=0,r=0;n<m-1;n++)if(a=h[n],s=h[n+1],(r+=o=a.distanceTo(s))>i){l=(r-i)/o,c=[s.x-l*(s.x-a.x),s.y-l*(s.y-a.y)];break}var _=t.unproject(j(c));return q([_.lat+u.lat,_.lng+u.lng])}var qn={__proto__:null,simplify:Dn,pointToSegmentDistance:Cn,closestPointOnSegment:On,clipSegment:Mn,_getEdgeIntersection:xn,_getBitCode:jn,_sqClosestPointOnSegment:Bn,isFlat:Nn,_flat:Fn,polylineCenter:zn},Hn={project:function(e){return new M(e.lng,e.lat)},unproject:function(e){return new z(e.y,e.x)},bounds:new I([-180,-90],[180,90])},Un={R:6378137,R_MINOR:6356752.314245179,bounds:new I([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(e){var t=Math.PI/180,n=this.R,i=e.lat*t,o=this.R_MINOR/n,r=Math.sqrt(1-o*o),a=r*Math.sin(i),s=Math.tan(Math.PI/4-i/2)/Math.pow((1-a)/(1+a),r/2);return i=-n*Math.log(Math.max(s,1e-10)),new M(e.lng*t*n,i)},unproject:function(e){for(var t,n=180/Math.PI,i=this.R,o=this.R_MINOR/i,r=Math.sqrt(1-o*o),a=Math.exp(-e.y/i),s=Math.PI/2-2*Math.atan(a),l=0,c=.1;l<15&&Math.abs(c)>1e-7;l++)t=r*Math.sin(s),t=Math.pow((1-t)/(1+t),r/2),s+=c=Math.PI/2-2*Math.atan(a*t)-s;return new z(s*n,e.x*n/i)}},$n={__proto__:null,LonLat:Hn,Mercator:Un,SphericalMercator:G},Zn=n({},$,{code:"EPSG:3395",projection:Un,transformation:function(){var e=.5/(Math.PI*Un.R);return W(e,.5,-e,.5)}()}),Gn=n({},$,{code:"EPSG:4326",projection:Hn,transformation:W(1/180,1,-1/180,.5)}),Vn=n({},U,{projection:Hn,transformation:W(1,0,-1,0),scale:function(e){return Math.pow(2,e)},zoom:function(e){return Math.log(e)/Math.LN2},distance:function(e,t){var n=t.lng-e.lng,i=t.lat-e.lat;return Math.sqrt(n*n+i*i)},infinite:!0});U.Earth=$,U.EPSG3395=Zn,U.EPSG3857=K,U.EPSG900913=Y,U.EPSG4326=Gn,U.Simple=Vn;var Wn=P.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(e){return e.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(e){return e&&e.removeLayer(this),this},getPane:function(e){return this._map.getPane(e?this.options[e]||e:this.options.pane)},addInteractiveTarget:function(e){return this._map._targets[a(e)]=this,this},removeInteractiveTarget:function(e){return delete this._map._targets[a(e)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(e){var t=e.target;if(t.hasLayer(this)){if(this._map=t,this._zoomAnimated=t._zoomAnimated,this.getEvents){var n=this.getEvents();t.on(n,this),this.once("remove",(function(){t.off(n,this)}),this)}this.onAdd(t),this.fire("add"),t.fire("layeradd",{layer:this})}}});rn.include({addLayer:function(e){if(!e._layerAdd)throw new Error("The provided object is not a Layer.");var t=a(e);return this._layers[t]||(this._layers[t]=e,e._mapToAdd=this,e.beforeAdd&&e.beforeAdd(this),this.whenReady(e._layerAdd,e)),this},removeLayer:function(e){var t=a(e);return this._layers[t]?(this._loaded&&e.onRemove(this),delete this._layers[t],this._loaded&&(this.fire("layerremove",{layer:e}),e.fire("remove")),e._map=e._mapToAdd=null,this):this},hasLayer:function(e){return a(e)in this._layers},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},_addLayers:function(e){for(var t=0,n=(e=e?g(e)?e:[e]:[]).length;t<n;t++)this.addLayer(e[t])},_addZoomLimit:function(e){isNaN(e.options.maxZoom)&&isNaN(e.options.minZoom)||(this._zoomBoundLayers[a(e)]=e,this._updateZoomLevels())},_removeZoomLimit:function(e){var t=a(e);this._zoomBoundLayers[t]&&(delete this._zoomBoundLayers[t],this._updateZoomLevels())},_updateZoomLevels:function(){var e=1/0,t=-1/0,n=this._getZoomSpan();for(var i in this._zoomBoundLayers){var o=this._zoomBoundLayers[i].options;e=void 0===o.minZoom?e:Math.min(e,o.minZoom),t=void 0===o.maxZoom?t:Math.max(t,o.maxZoom)}this._layersMaxZoom=t===-1/0?void 0:t,this._layersMinZoom=e===1/0?void 0:e,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Kn=Wn.extend({initialize:function(e,t){var n,i;if(h(this,t),this._layers={},e)for(n=0,i=e.length;n<i;n++)this.addLayer(e[n])},addLayer:function(e){var t=this.getLayerId(e);return this._layers[t]=e,this._map&&this._map.addLayer(e),this},removeLayer:function(e){var t=e in this._layers?e:this.getLayerId(e);return this._map&&this._layers[t]&&this._map.removeLayer(this._layers[t]),delete this._layers[t],this},hasLayer:function(e){return("number"==typeof e?e:this.getLayerId(e))in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(e){var t,n,i=Array.prototype.slice.call(arguments,1);for(t in this._layers)(n=this._layers[t])[e]&&n[e].apply(n,i);return this},onAdd:function(e){this.eachLayer(e.addLayer,e)},onRemove:function(e){this.eachLayer(e.removeLayer,e)},eachLayer:function(e,t){for(var n in this._layers)e.call(t,this._layers[n]);return this},getLayer:function(e){return this._layers[e]},getLayers:function(){var e=[];return this.eachLayer(e.push,e),e},setZIndex:function(e){return this.invoke("setZIndex",e)},getLayerId:function(e){return a(e)}}),Yn=function(e,t){return new Kn(e,t)},Xn=Kn.extend({addLayer:function(e){return this.hasLayer(e)?this:(e.addEventParent(this),Kn.prototype.addLayer.call(this,e),this.fire("layeradd",{layer:e}))},removeLayer:function(e){return this.hasLayer(e)?(e in this._layers&&(e=this._layers[e]),e.removeEventParent(this),Kn.prototype.removeLayer.call(this,e),this.fire("layerremove",{layer:e})):this},setStyle:function(e){return this.invoke("setStyle",e)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var e=new N;for(var t in this._layers){var n=this._layers[t];e.extend(n.getBounds?n.getBounds():n.getLatLng())}return e}}),Qn=function(e,t){return new Xn(e,t)},Jn=O.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(e){h(this,e)},createIcon:function(e){return this._createIcon("icon",e)},createShadow:function(e){return this._createIcon("shadow",e)},_createIcon:function(e,t){var n=this._getIconUrl(e);if(!n){if("icon"===e)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(n,t&&"IMG"===t.tagName?t:null);return this._setIconStyles(i,e),(this.options.crossOrigin||""===this.options.crossOrigin)&&(i.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),i},_setIconStyles:function(e,t){var n=this.options,i=n[t+"Size"];"number"==typeof i&&(i=[i,i]);var o=j(i),r=j("shadow"===t&&n.shadowAnchor||n.iconAnchor||o&&o.divideBy(2,!0));e.className="leaflet-marker-"+t+" "+(n.className||""),r&&(e.style.marginLeft=-r.x+"px",e.style.marginTop=-r.y+"px"),o&&(e.style.width=o.x+"px",e.style.height=o.y+"px")},_createImg:function(e,t){return(t=t||document.createElement("img")).src=e,t},_getIconUrl:function(e){return Ne.retina&&this.options[e+"RetinaUrl"]||this.options[e+"Url"]}});function ei(e){return new Jn(e)}var ti=Jn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(e){return"string"!=typeof ti.imagePath&&(ti.imagePath=this._detectIconPath()),(this.options.imagePath||ti.imagePath)+Jn.prototype._getIconUrl.call(this,e)},_stripUrl:function(e){var t=function(e,t,n){var i=t.exec(e);return i&&i[n]};return(e=t(e,/^url\((['"])?(.+)\1\)$/,2))&&t(e,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var e=_t("div","leaflet-default-icon-path",document.body),t=pt(e,"background-image")||pt(e,"backgroundImage");if(document.body.removeChild(e),t=this._stripUrl(t))return t;var n=document.querySelector('link[href$="leaflet.css"]');return n?n.href.substring(0,n.href.length-11-1):""}}),ni=bn.extend({initialize:function(e){this._marker=e},addHooks:function(){var e=this._marker._icon;this._draggable||(this._draggable=new En(e,e,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Et(e,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&kt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(e){var t=this._marker,n=t._map,i=this._marker.options.autoPanSpeed,o=this._marker.options.autoPanPadding,r=Rt(t._icon),a=n.getPixelBounds(),s=n.getPixelOrigin(),l=B(a.min._subtract(s).add(o),a.max._subtract(s).subtract(o));if(!l.contains(r)){var c=j((Math.max(l.max.x,r.x)-l.max.x)/(a.max.x-l.max.x)-(Math.min(l.min.x,r.x)-l.min.x)/(a.min.x-l.min.x),(Math.max(l.max.y,r.y)-l.max.y)/(a.max.y-l.max.y)-(Math.min(l.min.y,r.y)-l.min.y)/(a.min.y-l.min.y)).multiplyBy(i);n.panBy(c,{animate:!1}),this._draggable._newPos._add(c),this._draggable._startPos._add(c),Ot(t._icon,this._draggable._newPos),this._onDrag(e),this._panRequest=w(this._adjustPan.bind(this,e))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(e){this._marker.options.autoPan&&(D(this._panRequest),this._panRequest=w(this._adjustPan.bind(this,e)))},_onDrag:function(e){var t=this._marker,n=t._shadow,i=Rt(t._icon),o=t._map.layerPointToLatLng(i);n&&Ot(n,i),t._latlng=o,e.latlng=o,e.oldLatLng=this._oldLatLng,t.fire("move",e).fire("drag",e)},_onDragEnd:function(e){D(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",e)}}),ii=Wn.extend({options:{icon:new ti,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(e,t){h(this,t),this._latlng=q(e)},onAdd:function(e){this._zoomAnimated=this._zoomAnimated&&e.options.markerZoomAnimation,this._zoomAnimated&&e.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(e){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&e.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(e){var t=this._latlng;return this._latlng=q(e),this.update(),this.fire("move",{oldLatLng:t,latlng:this._latlng})},setZIndexOffset:function(e){return this.options.zIndexOffset=e,this.update()},getIcon:function(){return this.options.icon},setIcon:function(e){return this.options.icon=e,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var e=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(e)}return this},_initIcon:function(){var e=this.options,t="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=e.icon.createIcon(this._icon),i=!1;n!==this._icon&&(this._icon&&this._removeIcon(),i=!0,e.title&&(n.title=e.title),"IMG"===n.tagName&&(n.alt=e.alt||"")),Et(n,t),e.keyboard&&(n.tabIndex="0",n.setAttribute("role","button")),this._icon=n,e.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ft(n,"focus",this._panOnFocus,this);var o=e.icon.createShadow(this._shadow),r=!1;o!==this._shadow&&(this._removeShadow(),r=!0),o&&(Et(o,t),o.alt=""),this._shadow=o,e.opacity<1&&this._updateOpacity(),i&&this.getPane().appendChild(this._icon),this._initInteraction(),o&&r&&this.getPane(e.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&qt(this._icon,"focus",this._panOnFocus,this),ft(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ft(this._shadow),this._shadow=null},_setPos:function(e){this._icon&&Ot(this._icon,e),this._shadow&&Ot(this._shadow,e),this._zIndex=e.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(e){this._icon&&(this._icon.style.zIndex=this._zIndex+e)},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center).round();this._setPos(t)},_initInteraction:function(){if(this.options.interactive&&(Et(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),ni)){var e=this.options.draggable;this.dragging&&(e=this.dragging.enabled(),this.dragging.disable()),this.dragging=new ni(this),e&&this.dragging.enable()}},setOpacity:function(e){return this.options.opacity=e,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var e=this.options.opacity;this._icon&&wt(this._icon,e),this._shadow&&wt(this._shadow,e)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var e=this._map;if(e){var t=this.options.icon.options,n=t.iconSize?j(t.iconSize):j(0,0),i=t.iconAnchor?j(t.iconAnchor):j(0,0);e.panInside(this._latlng,{paddingTopLeft:i,paddingBottomRight:n.subtract(i)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function oi(e,t){return new ii(e,t)}var ri=Wn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(e){this._renderer=e.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(e){return h(this,e),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&e&&Object.prototype.hasOwnProperty.call(e,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ai=ri.extend({options:{fill:!0,radius:10},initialize:function(e,t){h(this,t),this._latlng=q(e),this._radius=this.options.radius},setLatLng:function(e){var t=this._latlng;return this._latlng=q(e),this.redraw(),this.fire("move",{oldLatLng:t,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(e){return this.options.radius=this._radius=e,this.redraw()},getRadius:function(){return this._radius},setStyle:function(e){var t=e&&e.radius||this._radius;return ri.prototype.setStyle.call(this,e),this.setRadius(t),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var e=this._radius,t=this._radiusY||e,n=this._clickTolerance(),i=[e+n,t+n];this._pxBounds=new I(this._point.subtract(i),this._point.add(i))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(e){return e.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function si(e,t){return new ai(e,t)}var li=ai.extend({initialize:function(e,t,i){if("number"==typeof t&&(t=n({},i,{radius:t})),h(this,t),this._latlng=q(e),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(e){return this._mRadius=e,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var e=[this._radius,this._radiusY||this._radius];return new N(this._map.layerPointToLatLng(this._point.subtract(e)),this._map.layerPointToLatLng(this._point.add(e)))},setStyle:ri.prototype.setStyle,_project:function(){var e=this._latlng.lng,t=this._latlng.lat,n=this._map,i=n.options.crs;if(i.distance===$.distance){var o=Math.PI/180,r=this._mRadius/$.R/o,a=n.project([t+r,e]),s=n.project([t-r,e]),l=a.add(s).divideBy(2),c=n.unproject(l).lat,u=Math.acos((Math.cos(r*o)-Math.sin(t*o)*Math.sin(c*o))/(Math.cos(t*o)*Math.cos(c*o)))/o;(isNaN(u)||0===u)&&(u=r/Math.cos(Math.PI/180*t)),this._point=l.subtract(n.getPixelOrigin()),this._radius=isNaN(u)?0:l.x-n.project([c,e-u]).x,this._radiusY=l.y-a.y}else{var d=i.unproject(i.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(d).x}this._updateBounds()}});function ci(e,t,n){return new li(e,t,n)}var ui=ri.extend({options:{smoothFactor:1,noClip:!1},initialize:function(e,t){h(this,t),this._setLatLngs(e)},getLatLngs:function(){return this._latlngs},setLatLngs:function(e){return this._setLatLngs(e),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(e){for(var t,n,i=1/0,o=null,r=Bn,a=0,s=this._parts.length;a<s;a++)for(var l=this._parts[a],c=1,u=l.length;c<u;c++){var d=r(e,t=l[c-1],n=l[c],!0);d<i&&(i=d,o=r(e,t,n))}return o&&(o.distance=Math.sqrt(i)),o},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return zn(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(e,t){return t=t||this._defaultShape(),e=q(e),t.push(e),this._bounds.extend(e),this.redraw()},_setLatLngs:function(e){this._bounds=new N,this._latlngs=this._convertLatLngs(e)},_defaultShape:function(){return Nn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(e){for(var t=[],n=Nn(e),i=0,o=e.length;i<o;i++)n?(t[i]=q(e[i]),this._bounds.extend(t[i])):t[i]=this._convertLatLngs(e[i]);return t},_project:function(){var e=new I;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,e),this._bounds.isValid()&&e.isValid()&&(this._rawPxBounds=e,this._updateBounds())},_updateBounds:function(){var e=this._clickTolerance(),t=new M(e,e);this._rawPxBounds&&(this._pxBounds=new I([this._rawPxBounds.min.subtract(t),this._rawPxBounds.max.add(t)]))},_projectLatlngs:function(e,t,n){var i,o,r=e[0]instanceof z,a=e.length;if(r){for(o=[],i=0;i<a;i++)o[i]=this._map.latLngToLayerPoint(e[i]),n.extend(o[i]);t.push(o)}else for(i=0;i<a;i++)this._projectLatlngs(e[i],t,n)},_clipPoints:function(){var e=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(e))if(this.options.noClip)this._parts=this._rings;else{var t,n,i,o,r,a,s,l=this._parts;for(t=0,i=0,o=this._rings.length;t<o;t++)for(n=0,r=(s=this._rings[t]).length;n<r-1;n++)(a=Mn(s[n],s[n+1],e,n,!0))&&(l[i]=l[i]||[],l[i].push(a[0]),a[1]===s[n+1]&&n!==r-2||(l[i].push(a[1]),i++))}},_simplifyPoints:function(){for(var e=this._parts,t=this.options.smoothFactor,n=0,i=e.length;n<i;n++)e[n]=Dn(e[n],t)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(e,t){var n,i,o,r,a,s,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(n=0,r=this._parts.length;n<r;n++)for(i=0,o=(a=(s=this._parts[n]).length)-1;i<a;o=i++)if((t||0!==i)&&Cn(e,s[o],s[i])<=l)return!0;return!1}});function di(e,t){return new ui(e,t)}ui._flat=Fn;var mi=ui.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return An(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(e){var t=ui.prototype._convertLatLngs.call(this,e),n=t.length;return n>=2&&t[0]instanceof z&&t[0].equals(t[n-1])&&t.pop(),t},_setLatLngs:function(e){ui.prototype._setLatLngs.call(this,e),Nn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Nn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var e=this._renderer._bounds,t=this.options.weight,n=new M(t,t);if(e=new I(e.min.subtract(n),e.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(e))if(this.options.noClip)this._parts=this._rings;else for(var i,o=0,r=this._rings.length;o<r;o++)(i=kn(this._rings[o],e,!0)).length&&this._parts.push(i)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(e){var t,n,i,o,r,a,s,l,c=!1;if(!this._pxBounds||!this._pxBounds.contains(e))return!1;for(o=0,s=this._parts.length;o<s;o++)for(r=0,a=(l=(t=this._parts[o]).length)-1;r<l;a=r++)n=t[r],i=t[a],n.y>e.y!=i.y>e.y&&e.x<(i.x-n.x)*(e.y-n.y)/(i.y-n.y)+n.x&&(c=!c);return c||ui.prototype._containsPoint.call(this,e,!0)}});function hi(e,t){return new mi(e,t)}var pi=Xn.extend({initialize:function(e,t){h(this,t),this._layers={},e&&this.addData(e)},addData:function(e){var t,n,i,o=g(e)?e:e.features;if(o){for(t=0,n=o.length;t<n;t++)((i=o[t]).geometries||i.geometry||i.features||i.coordinates)&&this.addData(i);return this}var r=this.options;if(r.filter&&!r.filter(e))return this;var a=_i(e,r);return a?(a.feature=ki(e),a.defaultOptions=a.options,this.resetStyle(a),r.onEachFeature&&r.onEachFeature(e,a),this.addLayer(a)):this},resetStyle:function(e){return void 0===e?this.eachLayer(this.resetStyle,this):(e.options=n({},e.defaultOptions),this._setLayerStyle(e,this.options.style),this)},setStyle:function(e){return this.eachLayer((function(t){this._setLayerStyle(t,e)}),this)},_setLayerStyle:function(e,t){e.setStyle&&("function"==typeof t&&(t=t(e.feature)),e.setStyle(t))}});function _i(e,t){var n,i,o,r,a="Feature"===e.type?e.geometry:e,s=a?a.coordinates:null,l=[],c=t&&t.pointToLayer,u=t&&t.coordsToLatLng||gi;if(!s&&!a)return null;switch(a.type){case"Point":return fi(c,e,n=u(s),t);case"MultiPoint":for(o=0,r=s.length;o<r;o++)n=u(s[o]),l.push(fi(c,e,n,t));return new Xn(l);case"LineString":case"MultiLineString":return i=bi(s,"LineString"===a.type?0:1,u),new ui(i,t);case"Polygon":case"MultiPolygon":return i=bi(s,"Polygon"===a.type?1:2,u),new mi(i,t);case"GeometryCollection":for(o=0,r=a.geometries.length;o<r;o++){var d=_i({geometry:a.geometries[o],type:"Feature",properties:e.properties},t);d&&l.push(d)}return new Xn(l);case"FeatureCollection":for(o=0,r=a.features.length;o<r;o++){var m=_i(a.features[o],t);m&&l.push(m)}return new Xn(l);default:throw new Error("Invalid GeoJSON object.")}}function fi(e,t,n,i){return e?e(t,n):new ii(n,i&&i.markersInheritOptions&&i)}function gi(e){return new z(e[1],e[0],e[2])}function bi(e,t,n){for(var i,o=[],r=0,a=e.length;r<a;r++)i=t?bi(e[r],t-1,n):(n||gi)(e[r]),o.push(i);return o}function yi(e,t){return void 0!==(e=q(e)).alt?[u(e.lng,t),u(e.lat,t),u(e.alt,t)]:[u(e.lng,t),u(e.lat,t)]}function vi(e,t,n,i){for(var o=[],r=0,a=e.length;r<a;r++)o.push(t?vi(e[r],Nn(e[r])?0:t-1,n,i):yi(e[r],i));return!t&&n&&o.length>0&&o.push(o[0].slice()),o}function Ei(e,t){return e.feature?n({},e.feature,{geometry:t}):ki(t)}function ki(e){return"Feature"===e.type||"FeatureCollection"===e.type?e:{type:"Feature",properties:{},geometry:e}}var Ai={toGeoJSON:function(e){return Ei(this,{type:"Point",coordinates:yi(this.getLatLng(),e)})}};function Ti(e,t){return new pi(e,t)}ii.include(Ai),li.include(Ai),ai.include(Ai),ui.include({toGeoJSON:function(e){var t=!Nn(this._latlngs);return Ei(this,{type:(t?"Multi":"")+"LineString",coordinates:vi(this._latlngs,t?1:0,!1,e)})}}),mi.include({toGeoJSON:function(e){var t=!Nn(this._latlngs),n=t&&!Nn(this._latlngs[0]),i=vi(this._latlngs,n?2:t?1:0,!0,e);return t||(i=[i]),Ei(this,{type:(n?"Multi":"")+"Polygon",coordinates:i})}}),Kn.include({toMultiPoint:function(e){var t=[];return this.eachLayer((function(n){t.push(n.toGeoJSON(e).geometry.coordinates)})),Ei(this,{type:"MultiPoint",coordinates:t})},toGeoJSON:function(e){var t=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===t)return this.toMultiPoint(e);var n="GeometryCollection"===t,i=[];return this.eachLayer((function(t){if(t.toGeoJSON){var o=t.toGeoJSON(e);if(n)i.push(o.geometry);else{var r=ki(o);"FeatureCollection"===r.type?i.push.apply(i,r.features):i.push(r)}}})),n?Ei(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}});var wi=Ti,Li=Wn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(e,t,n){this._url=e,this._bounds=F(t),h(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Et(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ft(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(e){return this.options.opacity=e,this._image&&this._updateOpacity(),this},setStyle:function(e){return e.opacity&&this.setOpacity(e.opacity),this},bringToFront:function(){return this._map&&bt(this._image),this},bringToBack:function(){return this._map&&yt(this._image),this},setUrl:function(e){return this._url=e,this._image&&(this._image.src=e),this},setBounds:function(e){return this._bounds=F(e),this._map&&this._reset(),this},getEvents:function(){var e={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var e="IMG"===this._url.tagName,t=this._image=e?this._url:_t("img");Et(t,"leaflet-image-layer"),this._zoomAnimated&&Et(t,"leaflet-zoom-animated"),this.options.className&&Et(t,this.options.className),t.onselectstart=c,t.onmousemove=c,t.onload=o(this.fire,this,"load"),t.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(t.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),e?this._url=t.src:(t.src=this._url,t.alt=this.options.alt)},_animateZoom:function(e){var t=this._map.getZoomScale(e.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,e.zoom,e.center).min;Ct(this._image,n,t)},_reset:function(){var e=this._image,t=new I(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=t.getSize();Ot(e,t.min),e.style.width=n.x+"px",e.style.height=n.y+"px"},_updateOpacity:function(){wt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var e=this.options.errorOverlayUrl;e&&this._url!==e&&(this._url=e,this._image.src=e)},getCenter:function(){return this._bounds.getCenter()}}),Di=function(e,t,n){return new Li(e,t,n)},Ci=Li.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var e="VIDEO"===this._url.tagName,t=this._image=e?this._url:_t("video");if(Et(t,"leaflet-image-layer"),this._zoomAnimated&&Et(t,"leaflet-zoom-animated"),this.options.className&&Et(t,this.options.className),t.onselectstart=c,t.onmousemove=c,t.onloadeddata=o(this.fire,this,"load"),e){for(var n=t.getElementsByTagName("source"),i=[],r=0;r<n.length;r++)i.push(n[r].src);this._url=n.length>0?i:[t.src]}else{g(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(t.style,"objectFit")&&(t.style.objectFit="fill"),t.autoplay=!!this.options.autoplay,t.loop=!!this.options.loop,t.muted=!!this.options.muted,t.playsInline=!!this.options.playsInline;for(var a=0;a<this._url.length;a++){var s=_t("source");s.src=this._url[a],t.appendChild(s)}}}});function Oi(e,t,n){return new Ci(e,t,n)}var Ri=Li.extend({_initImage:function(){var e=this._image=this._url;Et(e,"leaflet-image-layer"),this._zoomAnimated&&Et(e,"leaflet-zoom-animated"),this.options.className&&Et(e,this.options.className),e.onselectstart=c,e.onmousemove=c}});function Si(e,t,n){return new Ri(e,t,n)}var Pi=Wn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(e,t){e&&(e instanceof z||g(e))?(this._latlng=q(e),h(this,t)):(h(this,e),this._source=t),this.options.content&&(this._content=this.options.content)},openOn:function(e){return(e=arguments.length?e:this._source._map).hasLayer(this)||e.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(e){return this._map?this.close():(arguments.length?this._source=e:e=this._source,this._prepareOpen(),this.openOn(e._map)),this},onAdd:function(e){this._zoomAnimated=e._zoomAnimated,this._container||this._initLayout(),e._fadeAnimated&&wt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),e._fadeAnimated&&wt(this._container,1),this.bringToFront(),this.options.interactive&&(Et(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(e){e._fadeAnimated?(wt(this._container,0),this._removeTimeout=setTimeout(o(ft,void 0,this._container),200)):ft(this._container),this.options.interactive&&(kt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(e){return this._latlng=q(e),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(e){return this._content=e,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var e={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&bt(this._container),this},bringToBack:function(){return this._map&&yt(this._container),this},_prepareOpen:function(e){var t=this._source;if(!t._map)return!1;if(t instanceof Xn){t=null;var n=this._source._layers;for(var i in n)if(n[i]._map){t=n[i];break}if(!t)return!1;this._source=t}if(!e)if(t.getCenter)e=t.getCenter();else if(t.getLatLng)e=t.getLatLng();else{if(!t.getBounds)throw new Error("Unable to get source layer LatLng.");e=t.getBounds().getCenter()}return this.setLatLng(e),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var e=this._contentNode,t="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof t)e.innerHTML=t;else{for(;e.hasChildNodes();)e.removeChild(e.firstChild);e.appendChild(t)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var e=this._map.latLngToLayerPoint(this._latlng),t=j(this.options.offset),n=this._getAnchor();this._zoomAnimated?Ot(this._container,e.add(n)):t=t.add(e).add(n);var i=this._containerBottom=-t.y,o=this._containerLeft=-Math.round(this._containerWidth/2)+t.x;this._container.style.bottom=i+"px",this._container.style.left=o+"px"}},_getAnchor:function(){return[0,0]}});rn.include({_initOverlay:function(e,t,n,i){var o=t;return o instanceof e||(o=new e(i).setContent(t)),n&&o.setLatLng(n),o}}),Wn.include({_initOverlay:function(e,t,n,i){var o=n;return o instanceof e?(h(o,i),o._source=this):(o=t&&!i?t:new e(i,this)).setContent(n),o}});var Mi=Pi.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(e){return!(e=arguments.length?e:this._source._map).hasLayer(this)&&e._popup&&e._popup.options.autoClose&&e.removeLayer(e._popup),e._popup=this,Pi.prototype.openOn.call(this,e)},onAdd:function(e){Pi.prototype.onAdd.call(this,e),e.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof ri||this._source.on("preclick",Gt))},onRemove:function(e){Pi.prototype.onRemove.call(this,e),e.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof ri||this._source.off("preclick",Gt))},getEvents:function(){var e=Pi.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(e.preclick=this.close),this.options.keepInView&&(e.moveend=this._adjustPan),e},_initLayout:function(){var e="leaflet-popup",t=this._container=_t("div",e+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=_t("div",e+"-content-wrapper",t);if(this._contentNode=_t("div",e+"-content",n),Wt(t),Vt(this._contentNode),Ft(t,"contextmenu",Gt),this._tipContainer=_t("div",e+"-tip-container",t),this._tip=_t("div",e+"-tip",this._tipContainer),this.options.closeButton){var i=this._closeButton=_t("a",e+"-close-button",t);i.setAttribute("role","button"),i.setAttribute("aria-label","Close popup"),i.href="#close",i.innerHTML='<span aria-hidden="true">&#215;</span>',Ft(i,"click",(function(e){Kt(e),this.close()}),this)}},_updateLayout:function(){var e=this._contentNode,t=e.style;t.width="",t.whiteSpace="nowrap";var n=e.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),t.width=n+1+"px",t.whiteSpace="",t.height="";var i=e.offsetHeight,o=this.options.maxHeight,r="leaflet-popup-scrolled";o&&i>o?(t.height=o+"px",Et(e,r)):kt(e,r),this._containerWidth=this._container.offsetWidth},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center),n=this._getAnchor();Ot(this._container,t.add(n))},_adjustPan:function(){if(this.options.autoPan)if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning)this._autopanning=!1;else{var e=this._map,t=parseInt(pt(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+t,i=this._containerWidth,o=new M(this._containerLeft,-n-this._containerBottom);o._add(Rt(this._container));var r=e.layerPointToContainerPoint(o),a=j(this.options.autoPanPadding),s=j(this.options.autoPanPaddingTopLeft||a),l=j(this.options.autoPanPaddingBottomRight||a),c=e.getSize(),u=0,d=0;r.x+i+l.x>c.x&&(u=r.x+i-c.x+l.x),r.x-u-s.x<0&&(u=r.x-s.x),r.y+n+l.y>c.y&&(d=r.y+n-c.y+l.y),r.y-d-s.y<0&&(d=r.y-s.y),(u||d)&&(this.options.keepInView&&(this._autopanning=!0),e.fire("autopanstart").panBy([u,d]))}},_getAnchor:function(){return j(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),xi=function(e,t){return new Mi(e,t)};rn.mergeOptions({closePopupOnClick:!0}),rn.include({openPopup:function(e,t,n){return this._initOverlay(Mi,e,t,n).openOn(this),this},closePopup:function(e){return(e=arguments.length?e:this._popup)&&e.close(),this}}),Wn.include({bindPopup:function(e,t){return this._popup=this._initOverlay(Mi,this._popup,e,t),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(e){return this._popup&&(this instanceof Xn||(this._popup._source=this),this._popup._prepareOpen(e||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(e){return this._popup&&this._popup.setContent(e),this},getPopup:function(){return this._popup},_openPopup:function(e){if(this._popup&&this._map){Yt(e);var t=e.layer||e.target;this._popup._source!==t||t instanceof ri?(this._popup._source=t,this.openPopup(e.latlng)):this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(e.latlng)}},_movePopup:function(e){this._popup.setLatLng(e.latlng)},_onKeyPress:function(e){13===e.originalEvent.keyCode&&this._openPopup(e)}});var ji=Pi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(e){Pi.prototype.onAdd.call(this,e),this.setOpacity(this.options.opacity),e.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(e){Pi.prototype.onRemove.call(this,e),e.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var e=Pi.prototype.getEvents.call(this);return this.options.permanent||(e.preclick=this.close),e},_initLayout:function(){var e="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=_t("div",e),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+a(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(e){var t,n,i=this._map,o=this._container,r=i.latLngToContainerPoint(i.getCenter()),a=i.layerPointToContainerPoint(e),s=this.options.direction,l=o.offsetWidth,c=o.offsetHeight,u=j(this.options.offset),d=this._getAnchor();"top"===s?(t=l/2,n=c):"bottom"===s?(t=l/2,n=0):"center"===s?(t=l/2,n=c/2):"right"===s?(t=0,n=c/2):"left"===s?(t=l,n=c/2):a.x<r.x?(s="right",t=0,n=c/2):(s="left",t=l+2*(u.x+d.x),n=c/2),e=e.subtract(j(t,n,!0)).add(u).add(d),kt(o,"leaflet-tooltip-right"),kt(o,"leaflet-tooltip-left"),kt(o,"leaflet-tooltip-top"),kt(o,"leaflet-tooltip-bottom"),Et(o,"leaflet-tooltip-"+s),Ot(o,e)},_updatePosition:function(){var e=this._map.latLngToLayerPoint(this._latlng);this._setPosition(e)},setOpacity:function(e){this.options.opacity=e,this._container&&wt(this._container,e)},_animateZoom:function(e){var t=this._map._latLngToNewLayerPoint(this._latlng,e.zoom,e.center);this._setPosition(t)},_getAnchor:function(){return j(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ii=function(e,t){return new ji(e,t)};rn.include({openTooltip:function(e,t,n){return this._initOverlay(ji,e,t,n).openOn(this),this},closeTooltip:function(e){return e.close(),this}}),Wn.include({bindTooltip:function(e,t){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(ji,this._tooltip,e,t),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(e){if(e||!this._tooltipHandlersAdded){var t=e?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,n.click=this._openTooltip,this._map?this._addFocusListeners():n.add=this._addFocusListeners),this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),this[t](n),this._tooltipHandlersAdded=!e}},openTooltip:function(e){return this._tooltip&&(this instanceof Xn||(this._tooltip._source=this),this._tooltip._prepareOpen(e)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(e){return this._tooltip&&this._tooltip.setContent(e),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(e){var t="function"==typeof e.getElement&&e.getElement();t&&(Ft(t,"focus",(function(){this._tooltip._source=e,this.openTooltip()}),this),Ft(t,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(e){var t="function"==typeof e.getElement&&e.getElement();t&&t.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(e){if(this._tooltip&&this._map)if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var t=this;this._map.once("moveend",(function(){t._openOnceFlag=!1,t._openTooltip(e)}))}else this._tooltip._source=e.layer||e.target,this.openTooltip(this._tooltip.options.sticky?e.latlng:void 0)},_moveTooltip:function(e){var t,n,i=e.latlng;this._tooltip.options.sticky&&e.originalEvent&&(t=this._map.mouseEventToContainerPoint(e.originalEvent),n=this._map.containerPointToLayerPoint(t),i=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(i)}});var Bi=Jn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(e){var t=e&&"DIV"===e.tagName?e:document.createElement("div"),n=this.options;if(n.html instanceof Element?(gt(t),t.appendChild(n.html)):t.innerHTML=!1!==n.html?n.html:"",n.bgPos){var i=j(n.bgPos);t.style.backgroundPosition=-i.x+"px "+-i.y+"px"}return this._setIconStyles(t,"icon"),t},createShadow:function(){return null}});function Ni(e){return new Bi(e)}Jn.Default=ti;var Fi=Wn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ne.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(e){h(this,e)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(e){e._addZoomLimit(this)},onRemove:function(e){this._removeAllTiles(),ft(this._container),e._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(bt(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(yt(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(e){return this.options.opacity=e,this._updateOpacity(),this},setZIndex:function(e){return this.options.zIndex=e,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var e=this._clampZoom(this._map.getZoom());e!==this._tileZoom&&(this._tileZoom=e,this._updateLevels()),this._update()}return this},getEvents:function(){var e={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=s(this._onMoveEnd,this.options.updateInterval,this)),e.move=this._onMove),this._zoomAnimated&&(e.zoomanim=this._animateZoom),e},createTile:function(){return document.createElement("div")},getTileSize:function(){var e=this.options.tileSize;return e instanceof M?e:new M(e,e)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(e){for(var t,n=this.getPane().children,i=-e(-1/0,1/0),o=0,r=n.length;o<r;o++)t=n[o].style.zIndex,n[o]!==this._container&&t&&(i=e(i,+t));isFinite(i)&&(this.options.zIndex=i+e(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ne.ielt9){wt(this._container,this.options.opacity);var e=+new Date,t=!1,n=!1;for(var i in this._tiles){var o=this._tiles[i];if(o.current&&o.loaded){var r=Math.min(1,(e-o.loaded)/200);wt(o.el,r),r<1?t=!0:(o.active?n=!0:this._onOpaqueTile(o),o.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),t&&(D(this._fadeFrame),this._fadeFrame=w(this._updateOpacity,this))}},_onOpaqueTile:c,_initContainer:function(){this._container||(this._container=_t("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var e=this._tileZoom,t=this.options.maxZoom;if(void 0!==e){for(var n in this._levels)n=Number(n),this._levels[n].el.children.length||n===e?(this._levels[n].el.style.zIndex=t-Math.abs(e-n),this._onUpdateLevel(n)):(ft(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var i=this._levels[e],o=this._map;return i||((i=this._levels[e]={}).el=_t("div","leaflet-tile-container leaflet-zoom-animated",this._container),i.el.style.zIndex=t,i.origin=o.project(o.unproject(o.getPixelOrigin()),e).round(),i.zoom=e,this._setZoomTransform(i,o.getCenter(),o.getZoom()),c(i.el.offsetWidth),this._onCreateLevel(i)),this._level=i,i}},_onUpdateLevel:c,_onRemoveLevel:c,_onCreateLevel:c,_pruneTiles:function(){if(this._map){var e,t,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(e in this._tiles)(t=this._tiles[e]).retain=t.current;for(e in this._tiles)if((t=this._tiles[e]).current&&!t.active){var i=t.coords;this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2)}for(e in this._tiles)this._tiles[e].retain||this._removeTile(e)}}},_removeTilesAtZoom:function(e){for(var t in this._tiles)this._tiles[t].coords.z===e&&this._removeTile(t)},_removeAllTiles:function(){for(var e in this._tiles)this._removeTile(e)},_invalidateAll:function(){for(var e in this._levels)ft(this._levels[e].el),this._onRemoveLevel(Number(e)),delete this._levels[e];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(e,t,n,i){var o=Math.floor(e/2),r=Math.floor(t/2),a=n-1,s=new M(+o,+r);s.z=+a;var l=this._tileCoordsToKey(s),c=this._tiles[l];return c&&c.active?(c.retain=!0,!0):(c&&c.loaded&&(c.retain=!0),a>i&&this._retainParent(o,r,a,i))},_retainChildren:function(e,t,n,i){for(var o=2*e;o<2*e+2;o++)for(var r=2*t;r<2*t+2;r++){var a=new M(o,r);a.z=n+1;var s=this._tileCoordsToKey(a),l=this._tiles[s];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),n+1<i&&this._retainChildren(o,r,n+1,i))}},_resetView:function(e){var t=e&&(e.pinch||e.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),t,t)},_animateZoom:function(e){this._setView(e.center,e.zoom,!0,e.noUpdate)},_clampZoom:function(e){var t=this.options;return void 0!==t.minNativeZoom&&e<t.minNativeZoom?t.minNativeZoom:void 0!==t.maxNativeZoom&&t.maxNativeZoom<e?t.maxNativeZoom:e},_setView:function(e,t,n,i){var o=Math.round(t);o=void 0!==this.options.maxZoom&&o>this.options.maxZoom||void 0!==this.options.minZoom&&o<this.options.minZoom?void 0:this._clampZoom(o);var r=this.options.updateWhenZooming&&o!==this._tileZoom;i&&!r||(this._tileZoom=o,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==o&&this._update(e),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(e,t)},_setZoomTransforms:function(e,t){for(var n in this._levels)this._setZoomTransform(this._levels[n],e,t)},_setZoomTransform:function(e,t,n){var i=this._map.getZoomScale(n,e.zoom),o=e.origin.multiplyBy(i).subtract(this._map._getNewPixelOrigin(t,n)).round();Ne.any3d?Ct(e.el,o,i):Ot(e.el,o)},_resetGrid:function(){var e=this._map,t=e.options.crs,n=this._tileSize=this.getTileSize(),i=this._tileZoom,o=this._map.getPixelWorldBounds(this._tileZoom);o&&(this._globalTileRange=this._pxBoundsToTileRange(o)),this._wrapX=t.wrapLng&&!this.options.noWrap&&[Math.floor(e.project([0,t.wrapLng[0]],i).x/n.x),Math.ceil(e.project([0,t.wrapLng[1]],i).x/n.y)],this._wrapY=t.wrapLat&&!this.options.noWrap&&[Math.floor(e.project([t.wrapLat[0],0],i).y/n.x),Math.ceil(e.project([t.wrapLat[1],0],i).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(e){var t=this._map,n=t._animatingZoom?Math.max(t._animateToZoom,t.getZoom()):t.getZoom(),i=t.getZoomScale(n,this._tileZoom),o=t.project(e,this._tileZoom).floor(),r=t.getSize().divideBy(2*i);return new I(o.subtract(r),o.add(r))},_update:function(e){var t=this._map;if(t){var n=this._clampZoom(t.getZoom());if(void 0===e&&(e=t.getCenter()),void 0!==this._tileZoom){var i=this._getTiledPixelBounds(e),o=this._pxBoundsToTileRange(i),r=o.getCenter(),a=[],s=this.options.keepBuffer,l=new I(o.getBottomLeft().subtract([s,-s]),o.getTopRight().add([s,-s]));if(!(isFinite(o.min.x)&&isFinite(o.min.y)&&isFinite(o.max.x)&&isFinite(o.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var c in this._tiles){var u=this._tiles[c].coords;u.z===this._tileZoom&&l.contains(new M(u.x,u.y))||(this._tiles[c].current=!1)}if(Math.abs(n-this._tileZoom)>1)this._setView(e,n);else{for(var d=o.min.y;d<=o.max.y;d++)for(var m=o.min.x;m<=o.max.x;m++){var h=new M(m,d);if(h.z=this._tileZoom,this._isValidTile(h)){var p=this._tiles[this._tileCoordsToKey(h)];p?p.current=!0:a.push(h)}}if(a.sort((function(e,t){return e.distanceTo(r)-t.distanceTo(r)})),0!==a.length){this._loading||(this._loading=!0,this.fire("loading"));var _=document.createDocumentFragment();for(m=0;m<a.length;m++)this._addTile(a[m],_);this._level.el.appendChild(_)}}}}},_isValidTile:function(e){var t=this._map.options.crs;if(!t.infinite){var n=this._globalTileRange;if(!t.wrapLng&&(e.x<n.min.x||e.x>n.max.x)||!t.wrapLat&&(e.y<n.min.y||e.y>n.max.y))return!1}if(!this.options.bounds)return!0;var i=this._tileCoordsToBounds(e);return F(this.options.bounds).overlaps(i)},_keyToBounds:function(e){return this._tileCoordsToBounds(this._keyToTileCoords(e))},_tileCoordsToNwSe:function(e){var t=this._map,n=this.getTileSize(),i=e.scaleBy(n),o=i.add(n);return[t.unproject(i,e.z),t.unproject(o,e.z)]},_tileCoordsToBounds:function(e){var t=this._tileCoordsToNwSe(e),n=new N(t[0],t[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(e){return e.x+":"+e.y+":"+e.z},_keyToTileCoords:function(e){var t=e.split(":"),n=new M(+t[0],+t[1]);return n.z=+t[2],n},_removeTile:function(e){var t=this._tiles[e];t&&(ft(t.el),delete this._tiles[e],this.fire("tileunload",{tile:t.el,coords:this._keyToTileCoords(e)}))},_initTile:function(e){Et(e,"leaflet-tile");var t=this.getTileSize();e.style.width=t.x+"px",e.style.height=t.y+"px",e.onselectstart=c,e.onmousemove=c,Ne.ielt9&&this.options.opacity<1&&wt(e,this.options.opacity)},_addTile:function(e,t){var n=this._getTilePos(e),i=this._tileCoordsToKey(e),r=this.createTile(this._wrapCoords(e),o(this._tileReady,this,e));this._initTile(r),this.createTile.length<2&&w(o(this._tileReady,this,e,null,r)),Ot(r,n),this._tiles[i]={el:r,coords:e,current:!0},t.appendChild(r),this.fire("tileloadstart",{tile:r,coords:e})},_tileReady:function(e,t,n){t&&this.fire("tileerror",{error:t,tile:n,coords:e});var i=this._tileCoordsToKey(e);(n=this._tiles[i])&&(n.loaded=+new Date,this._map._fadeAnimated?(wt(n.el,0),D(this._fadeFrame),this._fadeFrame=w(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),t||(Et(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:e})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ne.ielt9||!this._map._fadeAnimated?w(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(e){return e.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(e){var t=new M(this._wrapX?l(e.x,this._wrapX):e.x,this._wrapY?l(e.y,this._wrapY):e.y);return t.z=e.z,t},_pxBoundsToTileRange:function(e){var t=this.getTileSize();return new I(e.min.unscaleBy(t).floor(),e.max.unscaleBy(t).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var e in this._tiles)if(!this._tiles[e].loaded)return!1;return!0}});function zi(e){return new Fi(e)}var qi=Fi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(e,t){this._url=e,(t=h(this,t)).detectRetina&&Ne.retina&&t.maxZoom>0?(t.tileSize=Math.floor(t.tileSize/2),t.zoomReverse?(t.zoomOffset--,t.minZoom=Math.min(t.maxZoom,t.minZoom+1)):(t.zoomOffset++,t.maxZoom=Math.max(t.minZoom,t.maxZoom-1)),t.minZoom=Math.max(0,t.minZoom)):t.zoomReverse?t.minZoom=Math.min(t.maxZoom,t.minZoom):t.maxZoom=Math.max(t.minZoom,t.maxZoom),"string"==typeof t.subdomains&&(t.subdomains=t.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(e,t){return this._url===e&&void 0===t&&(t=!0),this._url=e,t||this.redraw(),this},createTile:function(e,t){var n=document.createElement("img");return Ft(n,"load",o(this._tileOnLoad,this,t,n)),Ft(n,"error",o(this._tileOnError,this,t,n)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),"string"==typeof this.options.referrerPolicy&&(n.referrerPolicy=this.options.referrerPolicy),n.alt="",n.src=this.getTileUrl(e),n},getTileUrl:function(e){var t={r:Ne.retina?"@2x":"",s:this._getSubdomain(e),x:e.x,y:e.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-e.y;this.options.tms&&(t.y=i),t["-y"]=i}return f(this._url,n(t,this.options))},_tileOnLoad:function(e,t){Ne.ielt9?setTimeout(o(e,this,null,t),0):e(null,t)},_tileOnError:function(e,t,n){var i=this.options.errorTileUrl;i&&t.getAttribute("src")!==i&&(t.src=i),e(n,t)},_onTileRemove:function(e){e.tile.onload=null},_getZoomForUrl:function(){var e=this._tileZoom,t=this.options.maxZoom;return this.options.zoomReverse&&(e=t-e),e+this.options.zoomOffset},_getSubdomain:function(e){var t=Math.abs(e.x+e.y)%this.options.subdomains.length;return this.options.subdomains[t]},_abortLoading:function(){var e,t;for(e in this._tiles)if(this._tiles[e].coords.z!==this._tileZoom&&((t=this._tiles[e].el).onload=c,t.onerror=c,!t.complete)){t.src=y;var n=this._tiles[e].coords;ft(t),delete this._tiles[e],this.fire("tileabort",{tile:t,coords:n})}},_removeTile:function(e){var t=this._tiles[e];if(t)return t.el.setAttribute("src",y),Fi.prototype._removeTile.call(this,e)},_tileReady:function(e,t,n){if(this._map&&(!n||n.getAttribute("src")!==y))return Fi.prototype._tileReady.call(this,e,t,n)}});function Hi(e,t){return new qi(e,t)}var Ui=qi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(e,t){this._url=e;var i=n({},this.defaultWmsParams);for(var o in t)o in this.options||(i[o]=t[o]);var r=(t=h(this,t)).detectRetina&&Ne.retina?2:1,a=this.getTileSize();i.width=a.x*r,i.height=a.y*r,this.wmsParams=i},onAdd:function(e){this._crs=this.options.crs||e.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var t=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[t]=this._crs.code,qi.prototype.onAdd.call(this,e)},getTileUrl:function(e){var t=this._tileCoordsToNwSe(e),n=this._crs,i=B(n.project(t[0]),n.project(t[1])),o=i.min,r=i.max,a=(this._wmsVersion>=1.3&&this._crs===Gn?[o.y,o.x,r.y,r.x]:[o.x,o.y,r.x,r.y]).join(","),s=qi.prototype.getTileUrl.call(this,e);return s+p(this.wmsParams,s,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+a},setParams:function(e,t){return n(this.wmsParams,e),t||this.redraw(),this}});function $i(e,t){return new Ui(e,t)}qi.WMS=Ui,Hi.wms=$i;var Zi=Wn.extend({options:{padding:.1},initialize:function(e){h(this,e),a(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Et(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var e={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(e.zoomanim=this._onAnimZoom),e},_onAnimZoom:function(e){this._updateTransform(e.center,e.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(e,t){var n=this._map.getZoomScale(t,this._zoom),i=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,t),r=i.multiplyBy(-n).add(o).subtract(this._map._getNewPixelOrigin(e,t));Ne.any3d?Ct(this._container,r,n):Ot(this._container,r)},_reset:function(){for(var e in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[e]._reset()},_onZoomEnd:function(){for(var e in this._layers)this._layers[e]._project()},_updatePaths:function(){for(var e in this._layers)this._layers[e]._update()},_update:function(){var e=this.options.padding,t=this._map.getSize(),n=this._map.containerPointToLayerPoint(t.multiplyBy(-e)).round();this._bounds=new I(n,n.add(t.multiplyBy(1+2*e)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Gi=Zi.extend({options:{tolerance:0},getEvents:function(){var e=Zi.prototype.getEvents.call(this);return e.viewprereset=this._onViewPreReset,e},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Zi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var e=this._container=document.createElement("canvas");Ft(e,"mousemove",this._onMouseMove,this),Ft(e,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ft(e,"mouseout",this._handleMouseOut,this),e._leaflet_disable_events=!0,this._ctx=e.getContext("2d")},_destroyContainer:function(){D(this._redrawRequest),delete this._ctx,ft(this._container),qt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var e in this._redrawBounds=null,this._layers)this._layers[e]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){Zi.prototype._update.call(this);var e=this._bounds,t=this._container,n=e.getSize(),i=Ne.retina?2:1;Ot(t,e.min),t.width=i*n.x,t.height=i*n.y,t.style.width=n.x+"px",t.style.height=n.y+"px",Ne.retina&&this._ctx.scale(2,2),this._ctx.translate(-e.min.x,-e.min.y),this.fire("update")}},_reset:function(){Zi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(e){this._updateDashArray(e),this._layers[a(e)]=e;var t=e._order={layer:e,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=t),this._drawLast=t,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(e){this._requestRedraw(e)},_removePath:function(e){var t=e._order,n=t.next,i=t.prev;n?n.prev=i:this._drawLast=i,i?i.next=n:this._drawFirst=n,delete e._order,delete this._layers[a(e)],this._requestRedraw(e)},_updatePath:function(e){this._extendRedrawBounds(e),e._project(),e._update(),this._requestRedraw(e)},_updateStyle:function(e){this._updateDashArray(e),this._requestRedraw(e)},_updateDashArray:function(e){if("string"==typeof e.options.dashArray){var t,n,i=e.options.dashArray.split(/[, ]+/),o=[];for(n=0;n<i.length;n++){if(t=Number(i[n]),isNaN(t))return;o.push(t)}e.options._dashArray=o}else e.options._dashArray=e.options.dashArray},_requestRedraw:function(e){this._map&&(this._extendRedrawBounds(e),this._redrawRequest=this._redrawRequest||w(this._redraw,this))},_extendRedrawBounds:function(e){if(e._pxBounds){var t=(e.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new I,this._redrawBounds.extend(e._pxBounds.min.subtract([t,t])),this._redrawBounds.extend(e._pxBounds.max.add([t,t]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var e=this._redrawBounds;if(e){var t=e.getSize();this._ctx.clearRect(e.min.x,e.min.y,t.x,t.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var e,t=this._redrawBounds;if(this._ctx.save(),t){var n=t.getSize();this._ctx.beginPath(),this._ctx.rect(t.min.x,t.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var i=this._drawFirst;i;i=i.next)e=i.layer,(!t||e._pxBounds&&e._pxBounds.intersects(t))&&e._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(e,t){if(this._drawing){var n,i,o,r,a=e._parts,s=a.length,l=this._ctx;if(s){for(l.beginPath(),n=0;n<s;n++){for(i=0,o=a[n].length;i<o;i++)r=a[n][i],l[i?"lineTo":"moveTo"](r.x,r.y);t&&l.closePath()}this._fillStroke(l,e)}}},_updateCircle:function(e){if(this._drawing&&!e._empty()){var t=e._point,n=this._ctx,i=Math.max(Math.round(e._radius),1),o=(Math.max(Math.round(e._radiusY),1)||i)/i;1!==o&&(n.save(),n.scale(1,o)),n.beginPath(),n.arc(t.x,t.y/o,i,0,2*Math.PI,!1),1!==o&&n.restore(),this._fillStroke(n,e)}},_fillStroke:function(e,t){var n=t.options;n.fill&&(e.globalAlpha=n.fillOpacity,e.fillStyle=n.fillColor||n.color,e.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(e.setLineDash&&e.setLineDash(t.options&&t.options._dashArray||[]),e.globalAlpha=n.opacity,e.lineWidth=n.weight,e.strokeStyle=n.color,e.lineCap=n.lineCap,e.lineJoin=n.lineJoin,e.stroke())},_onClick:function(e){for(var t,n,i=this._map.mouseEventToLayerPoint(e),o=this._drawFirst;o;o=o.next)(t=o.layer).options.interactive&&t._containsPoint(i)&&("click"!==e.type&&"preclick"!==e.type||!this._map._draggableMoved(t))&&(n=t);this._fireEvent(!!n&&[n],e)},_onMouseMove:function(e){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var t=this._map.mouseEventToLayerPoint(e);this._handleMouseHover(e,t)}},_handleMouseOut:function(e){var t=this._hoveredLayer;t&&(kt(this._container,"leaflet-interactive"),this._fireEvent([t],e,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(e,t){if(!this._mouseHoverThrottled){for(var n,i,r=this._drawFirst;r;r=r.next)(n=r.layer).options.interactive&&n._containsPoint(t)&&(i=n);i!==this._hoveredLayer&&(this._handleMouseOut(e),i&&(Et(this._container,"leaflet-interactive"),this._fireEvent([i],e,"mouseover"),this._hoveredLayer=i)),this._fireEvent(!!this._hoveredLayer&&[this._hoveredLayer],e),this._mouseHoverThrottled=!0,setTimeout(o((function(){this._mouseHoverThrottled=!1}),this),32)}},_fireEvent:function(e,t,n){this._map._fireDOMEvent(t,n||t.type,e)},_bringToFront:function(e){var t=e._order;if(t){var n=t.next,i=t.prev;n&&(n.prev=i,i?i.next=n:n&&(this._drawFirst=n),t.prev=this._drawLast,this._drawLast.next=t,t.next=null,this._drawLast=t,this._requestRedraw(e))}},_bringToBack:function(e){var t=e._order;if(t){var n=t.next,i=t.prev;i&&(i.next=n,n?n.prev=i:i&&(this._drawLast=i),t.prev=null,t.next=this._drawFirst,this._drawFirst.prev=t,this._drawFirst=t,this._requestRedraw(e))}}});function Vi(e){return Ne.canvas?new Gi(e):null}var Wi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(e){return document.createElement("<lvml:"+e+' class="lvml">')}}catch(e){}return function(e){return document.createElement("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Ki={_initContainer:function(){this._container=_t("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Zi.prototype._update.call(this),this.fire("update"))},_initPath:function(e){var t=e._container=Wi("shape");Et(t,"leaflet-vml-shape "+(this.options.className||"")),t.coordsize="1 1",e._path=Wi("path"),t.appendChild(e._path),this._updateStyle(e),this._layers[a(e)]=e},_addPath:function(e){var t=e._container;this._container.appendChild(t),e.options.interactive&&e.addInteractiveTarget(t)},_removePath:function(e){var t=e._container;ft(t),e.removeInteractiveTarget(t),delete this._layers[a(e)]},_updateStyle:function(e){var t=e._stroke,n=e._fill,i=e.options,o=e._container;o.stroked=!!i.stroke,o.filled=!!i.fill,i.stroke?(t||(t=e._stroke=Wi("stroke")),o.appendChild(t),t.weight=i.weight+"px",t.color=i.color,t.opacity=i.opacity,i.dashArray?t.dashStyle=g(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):t.dashStyle="",t.endcap=i.lineCap.replace("butt","flat"),t.joinstyle=i.lineJoin):t&&(o.removeChild(t),e._stroke=null),i.fill?(n||(n=e._fill=Wi("fill")),o.appendChild(n),n.color=i.fillColor||i.color,n.opacity=i.fillOpacity):n&&(o.removeChild(n),e._fill=null)},_updateCircle:function(e){var t=e._point.round(),n=Math.round(e._radius),i=Math.round(e._radiusY||n);this._setPath(e,e._empty()?"M0 0":"AL "+t.x+","+t.y+" "+n+","+i+" 0,23592600")},_setPath:function(e,t){e._path.v=t},_bringToFront:function(e){bt(e._container)},_bringToBack:function(e){yt(e._container)}},Yi=Ne.vml?Wi:X,Xi=Zi.extend({_initContainer:function(){this._container=Yi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Yi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ft(this._container),qt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!this._map._animatingZoom||!this._bounds){Zi.prototype._update.call(this);var e=this._bounds,t=e.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(t)||(this._svgSize=t,n.setAttribute("width",t.x),n.setAttribute("height",t.y)),Ot(n,e.min),n.setAttribute("viewBox",[e.min.x,e.min.y,t.x,t.y].join(" ")),this.fire("update")}},_initPath:function(e){var t=e._path=Yi("path");e.options.className&&Et(t,e.options.className),e.options.interactive&&Et(t,"leaflet-interactive"),this._updateStyle(e),this._layers[a(e)]=e},_addPath:function(e){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(e._path),e.addInteractiveTarget(e._path)},_removePath:function(e){ft(e._path),e.removeInteractiveTarget(e._path),delete this._layers[a(e)]},_updatePath:function(e){e._project(),e._update()},_updateStyle:function(e){var t=e._path,n=e.options;t&&(n.stroke?(t.setAttribute("stroke",n.color),t.setAttribute("stroke-opacity",n.opacity),t.setAttribute("stroke-width",n.weight),t.setAttribute("stroke-linecap",n.lineCap),t.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?t.setAttribute("stroke-dasharray",n.dashArray):t.removeAttribute("stroke-dasharray"),n.dashOffset?t.setAttribute("stroke-dashoffset",n.dashOffset):t.removeAttribute("stroke-dashoffset")):t.setAttribute("stroke","none"),n.fill?(t.setAttribute("fill",n.fillColor||n.color),t.setAttribute("fill-opacity",n.fillOpacity),t.setAttribute("fill-rule",n.fillRule||"evenodd")):t.setAttribute("fill","none"))},_updatePoly:function(e,t){this._setPath(e,Q(e._parts,t))},_updateCircle:function(e){var t=e._point,n=Math.max(Math.round(e._radius),1),i="a"+n+","+(Math.max(Math.round(e._radiusY),1)||n)+" 0 1,0 ",o=e._empty()?"M0 0":"M"+(t.x-n)+","+t.y+i+2*n+",0 "+i+2*-n+",0 ";this._setPath(e,o)},_setPath:function(e,t){e._path.setAttribute("d",t)},_bringToFront:function(e){bt(e._path)},_bringToBack:function(e){yt(e._path)}});function Qi(e){return Ne.svg||Ne.vml?new Xi(e):null}Ne.vml&&Xi.include(Ki),rn.include({getRenderer:function(e){var t=e.options.renderer||this._getPaneRenderer(e.options.pane)||this.options.renderer||this._renderer;return t||(t=this._renderer=this._createRenderer()),this.hasLayer(t)||this.addLayer(t),t},_getPaneRenderer:function(e){if("overlayPane"===e||void 0===e)return!1;var t=this._paneRenderers[e];return void 0===t&&(t=this._createRenderer({pane:e}),this._paneRenderers[e]=t),t},_createRenderer:function(e){return this.options.preferCanvas&&Vi(e)||Qi(e)}});var Ji=mi.extend({initialize:function(e,t){mi.prototype.initialize.call(this,this._boundsToLatLngs(e),t)},setBounds:function(e){return this.setLatLngs(this._boundsToLatLngs(e))},_boundsToLatLngs:function(e){return[(e=F(e)).getSouthWest(),e.getNorthWest(),e.getNorthEast(),e.getSouthEast()]}});function eo(e,t){return new Ji(e,t)}Xi.create=Yi,Xi.pointsToPath=Q,pi.geometryToLayer=_i,pi.coordsToLatLng=gi,pi.coordsToLatLngs=bi,pi.latLngToCoords=yi,pi.latLngsToCoords=vi,pi.getFeature=Ei,pi.asFeature=ki,rn.mergeOptions({boxZoom:!0});var to=bn.extend({initialize:function(e){this._map=e,this._container=e._container,this._pane=e._panes.overlayPane,this._resetStateTimeout=0,e.on("unload",this._destroy,this)},addHooks:function(){Ft(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){qt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ft(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(e){if(!e.shiftKey||1!==e.which&&1!==e.button)return!1;this._clearDeferredResetState(),this._resetState(),rt(),Pt(),this._startPoint=this._map.mouseEventToContainerPoint(e),Ft(document,{contextmenu:Yt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(e){this._moved||(this._moved=!0,this._box=_t("div","leaflet-zoom-box",this._container),Et(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(e);var t=new I(this._point,this._startPoint),n=t.getSize();Ot(this._box,t.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(ft(this._box),kt(this._container,"leaflet-crosshair")),at(),Mt(),qt(document,{contextmenu:Yt,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(e){if((1===e.which||1===e.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var t=new N(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(t).fire("boxzoomend",{boxZoomBounds:t})}},_onKeyDown:function(e){27===e.keyCode&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});rn.addInitHook("addHandler","boxZoom",to),rn.mergeOptions({doubleClickZoom:!0});var no=bn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(e){var t=this._map,n=t.getZoom(),i=t.options.zoomDelta,o=e.originalEvent.shiftKey?n-i:n+i;"center"===t.options.doubleClickZoom?t.setZoom(o):t.setZoomAround(e.containerPoint,o)}});rn.addInitHook("addHandler","doubleClickZoom",no),rn.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var io=bn.extend({addHooks:function(){if(!this._draggable){var e=this._map;this._draggable=new En(e._mapPane,e._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),e.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),e.on("zoomend",this._onZoomEnd,this),e.whenReady(this._onZoomEnd,this))}Et(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){kt(this._map._container,"leaflet-grab"),kt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var e=this._map;if(e._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var t=F(this._map.options.maxBounds);this._offsetLimit=B(this._map.latLngToContainerPoint(t.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(t.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;e.fire("movestart").fire("dragstart"),e.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(e){if(this._map.options.inertia){var t=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(t),this._prunePositions(t)}this._map.fire("move",e).fire("drag",e)},_prunePositions:function(e){for(;this._positions.length>1&&e-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var e=this._map.getSize().divideBy(2),t=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=t.subtract(e).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(e,t){return e-(e-t)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var e=this._draggable._newPos.subtract(this._draggable._startPos),t=this._offsetLimit;e.x<t.min.x&&(e.x=this._viscousLimit(e.x,t.min.x)),e.y<t.min.y&&(e.y=this._viscousLimit(e.y,t.min.y)),e.x>t.max.x&&(e.x=this._viscousLimit(e.x,t.max.x)),e.y>t.max.y&&(e.y=this._viscousLimit(e.y,t.max.y)),this._draggable._newPos=this._draggable._startPos.add(e)}},_onPreDragWrap:function(){var e=this._worldWidth,t=Math.round(e/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,o=(i-t+n)%e+t-n,r=(i+t+n)%e-t-n,a=Math.abs(o+n)<Math.abs(r+n)?o:r;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=a},_onDragEnd:function(e){var t=this._map,n=t.options,i=!n.inertia||e.noInertia||this._times.length<2;if(t.fire("dragend",e),i)t.fire("moveend");else{this._prunePositions(+new Date);var o=this._lastPos.subtract(this._positions[0]),r=(this._lastTime-this._times[0])/1e3,a=n.easeLinearity,s=o.multiplyBy(a/r),l=s.distanceTo([0,0]),c=Math.min(n.inertiaMaxSpeed,l),u=s.multiplyBy(c/l),d=c/(n.inertiaDeceleration*a),m=u.multiplyBy(-d/2).round();m.x||m.y?(m=t._limitOffset(m,t.options.maxBounds),w((function(){t.panBy(m,{duration:d,easeLinearity:a,noMoveStart:!0,animate:!0})}))):t.fire("moveend")}}});rn.addInitHook("addHandler","dragging",io),rn.mergeOptions({keyboard:!0,keyboardPanDelta:80});var oo=bn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(e){this._map=e,this._setPanDelta(e.options.keyboardPanDelta),this._setZoomDelta(e.options.zoomDelta)},addHooks:function(){var e=this._map._container;e.tabIndex<=0&&(e.tabIndex="0"),Ft(e,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),qt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var e=document.body,t=document.documentElement,n=e.scrollTop||t.scrollTop,i=e.scrollLeft||t.scrollLeft;this._map._container.focus(),window.scrollTo(i,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(e){var t,n,i=this._panKeys={},o=this.keyCodes;for(t=0,n=o.left.length;t<n;t++)i[o.left[t]]=[-1*e,0];for(t=0,n=o.right.length;t<n;t++)i[o.right[t]]=[e,0];for(t=0,n=o.down.length;t<n;t++)i[o.down[t]]=[0,e];for(t=0,n=o.up.length;t<n;t++)i[o.up[t]]=[0,-1*e]},_setZoomDelta:function(e){var t,n,i=this._zoomKeys={},o=this.keyCodes;for(t=0,n=o.zoomIn.length;t<n;t++)i[o.zoomIn[t]]=e;for(t=0,n=o.zoomOut.length;t<n;t++)i[o.zoomOut[t]]=-e},_addHooks:function(){Ft(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){qt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(e){if(!(e.altKey||e.ctrlKey||e.metaKey)){var t,n=e.keyCode,i=this._map;if(n in this._panKeys){if(!i._panAnim||!i._panAnim._inProgress)if(t=this._panKeys[n],e.shiftKey&&(t=j(t).multiplyBy(3)),i.options.maxBounds&&(t=i._limitOffset(j(t),i.options.maxBounds)),i.options.worldCopyJump){var o=i.wrapLatLng(i.unproject(i.project(i.getCenter()).add(t)));i.panTo(o)}else i.panBy(t)}else if(n in this._zoomKeys)i.setZoom(i.getZoom()+(e.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!i._popup||!i._popup.options.closeOnEscapeKey)return;i.closePopup()}Yt(e)}}});rn.addInitHook("addHandler","keyboard",oo),rn.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ro=bn.extend({addHooks:function(){Ft(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){qt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(e){var t=en(e),n=this._map.options.wheelDebounceTime;this._delta+=t,this._lastMousePos=this._map.mouseEventToContainerPoint(e),this._startTime||(this._startTime=+new Date);var i=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),i),Yt(e)},_performZoom:function(){var e=this._map,t=e.getZoom(),n=this._map.options.zoomSnap||0;e._stop();var i=this._delta/(4*this._map.options.wheelPxPerZoomLevel),o=4*Math.log(2/(1+Math.exp(-Math.abs(i))))/Math.LN2,r=n?Math.ceil(o/n)*n:o,a=e._limitZoom(t+(this._delta>0?r:-r))-t;this._delta=0,this._startTime=null,a&&("center"===e.options.scrollWheelZoom?e.setZoom(t+a):e.setZoomAround(this._lastMousePos,t+a))}});rn.addInitHook("addHandler","scrollWheelZoom",ro);var ao=600;rn.mergeOptions({tapHold:Ne.touchNative&&Ne.safari&&Ne.mobile,tapTolerance:15});var so=bn.extend({addHooks:function(){Ft(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){qt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(e){if(clearTimeout(this._holdTimeout),1===e.touches.length){var t=e.touches[0];this._startPos=this._newPos=new M(t.clientX,t.clientY),this._holdTimeout=setTimeout(o((function(){this._cancel(),this._isTapValid()&&(Ft(document,"touchend",Kt),Ft(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",t))}),this),ao),Ft(document,"touchend touchcancel contextmenu",this._cancel,this),Ft(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function e(){qt(document,"touchend",Kt),qt(document,"touchend touchcancel",e)},_cancel:function(){clearTimeout(this._holdTimeout),qt(document,"touchend touchcancel contextmenu",this._cancel,this),qt(document,"touchmove",this._onMove,this)},_onMove:function(e){var t=e.touches[0];this._newPos=new M(t.clientX,t.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(e,t){var n=new MouseEvent(e,{bubbles:!0,cancelable:!0,view:window,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY});n._simulated=!0,t.target.dispatchEvent(n)}});rn.addInitHook("addHandler","tapHold",so),rn.mergeOptions({touchZoom:Ne.touch,bounceAtZoomLimits:!0});var lo=bn.extend({addHooks:function(){Et(this._map._container,"leaflet-touch-zoom"),Ft(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){kt(this._map._container,"leaflet-touch-zoom"),qt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(e){var t=this._map;if(e.touches&&2===e.touches.length&&!t._animatingZoom&&!this._zooming){var n=t.mouseEventToContainerPoint(e.touches[0]),i=t.mouseEventToContainerPoint(e.touches[1]);this._centerPoint=t.getSize()._divideBy(2),this._startLatLng=t.containerPointToLatLng(this._centerPoint),"center"!==t.options.touchZoom&&(this._pinchStartLatLng=t.containerPointToLatLng(n.add(i)._divideBy(2))),this._startDist=n.distanceTo(i),this._startZoom=t.getZoom(),this._moved=!1,this._zooming=!0,t._stop(),Ft(document,"touchmove",this._onTouchMove,this),Ft(document,"touchend touchcancel",this._onTouchEnd,this),Kt(e)}},_onTouchMove:function(e){if(e.touches&&2===e.touches.length&&this._zooming){var t=this._map,n=t.mouseEventToContainerPoint(e.touches[0]),i=t.mouseEventToContainerPoint(e.touches[1]),r=n.distanceTo(i)/this._startDist;if(this._zoom=t.getScaleZoom(r,this._startZoom),!t.options.bounceAtZoomLimits&&(this._zoom<t.getMinZoom()&&r<1||this._zoom>t.getMaxZoom()&&r>1)&&(this._zoom=t._limitZoom(this._zoom)),"center"===t.options.touchZoom){if(this._center=this._startLatLng,1===r)return}else{var a=n._add(i)._divideBy(2)._subtract(this._centerPoint);if(1===r&&0===a.x&&0===a.y)return;this._center=t.unproject(t.project(this._pinchStartLatLng,this._zoom).subtract(a),this._zoom)}this._moved||(t._moveStart(!0,!1),this._moved=!0),D(this._animRequest);var s=o(t._move,t,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=w(s,this,!0),Kt(e)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,D(this._animRequest),qt(document,"touchmove",this._onTouchMove,this),qt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});rn.addInitHook("addHandler","touchZoom",lo),rn.BoxZoom=to,rn.DoubleClickZoom=no,rn.Drag=io,rn.Keyboard=oo,rn.ScrollWheelZoom=ro,rn.TapHold=so,rn.TouchZoom=lo,e.Bounds=I,e.Browser=Ne,e.CRS=U,e.Canvas=Gi,e.Circle=li,e.CircleMarker=ai,e.Class=O,e.Control=sn,e.DivIcon=Bi,e.DivOverlay=Pi,e.DomEvent=nn,e.DomUtil=Nt,e.Draggable=En,e.Evented=P,e.FeatureGroup=Xn,e.GeoJSON=pi,e.GridLayer=Fi,e.Handler=bn,e.Icon=Jn,e.ImageOverlay=Li,e.LatLng=z,e.LatLngBounds=N,e.Layer=Wn,e.LayerGroup=Kn,e.LineUtil=qn,e.Map=rn,e.Marker=ii,e.Mixin=yn,e.Path=ri,e.Point=M,e.PolyUtil=Ln,e.Polygon=mi,e.Polyline=ui,e.Popup=Mi,e.PosAnimation=on,e.Projection=$n,e.Rectangle=Ji,e.Renderer=Zi,e.SVG=Xi,e.SVGOverlay=Ri,e.TileLayer=qi,e.Tooltip=ji,e.Transformation=V,e.Util=C,e.VideoOverlay=Ci,e.bind=o,e.bounds=B,e.canvas=Vi,e.circle=ci,e.circleMarker=si,e.control=ln,e.divIcon=Ni,e.extend=n,e.featureGroup=Qn,e.geoJSON=Ti,e.geoJson=wi,e.gridLayer=zi,e.icon=ei,e.imageOverlay=Di,e.latLng=q,e.latLngBounds=F,e.layerGroup=Yn,e.map=an,e.marker=oi,e.point=j,e.polygon=hi,e.polyline=di,e.popup=xi,e.rectangle=eo,e.setOptions=h,e.stamp=a,e.svg=Qi,e.svgOverlay=Si,e.tileLayer=Hi,e.tooltip=Ii,e.transformation=W,e.version=t,e.videoOverlay=Oi;var co=window.L;e.noConflict=function(){return window.L=co,this},window.L=e}(t)},62051:(e,t,n)=>{var i=NaN,o="[object Symbol]",r=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt,u="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,d="object"==typeof self&&self&&self.Object===Object&&self,m=u||d||Function("return this")(),h=Object.prototype.toString,p=Math.max,_=Math.min,f=function(){return m.Date.now()};function g(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function b(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&h.call(e)==o}(e))return i;if(g(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=g(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(r,"");var n=s.test(e);return n||l.test(e)?c(e.slice(2),n?2:8):a.test(e)?i:+e}e.exports=function(e,t,n){var i,o,r,a,s,l,c=0,u=!1,d=!1,m=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function h(t){var n=i,r=o;return i=o=void 0,c=t,a=e.apply(r,n)}function y(e){var n=e-l;return void 0===l||n>=t||n<0||d&&e-c>=r}function v(){var e=f();if(y(e))return E(e);s=setTimeout(v,function(e){var n=t-(e-l);return d?_(n,r-(e-c)):n}(e))}function E(e){return s=void 0,m&&i?h(e):(i=o=void 0,a)}function k(){var e=f(),n=y(e);if(i=arguments,o=this,l=e,n){if(void 0===s)return function(e){return c=e,s=setTimeout(v,t),u?h(e):a}(l);if(d)return s=setTimeout(v,t),h(l)}return void 0===s&&(s=setTimeout(v,t)),a}return t=b(t)||0,g(n)&&(u=!!n.leading,r=(d="maxWait"in n)?p(b(n.maxWait)||0,t):r,m="trailing"in n?!!n.trailing:m),k.cancel=function(){void 0!==s&&clearTimeout(s),c=0,i=l=o=s=void 0},k.flush=function(){return void 0===s?a:E(f())},k}},99172:(e,t,n)=>{e=n.nmd(e);var i="__lodash_hash_undefined__",o=1,r=2,a=9007199254740991,s="[object Arguments]",l="[object Array]",c="[object Boolean]",u="[object Date]",d="[object Error]",m="[object Function]",h="[object GeneratorFunction]",p="[object Map]",_="[object Number]",f="[object Object]",g="[object Promise]",b="[object RegExp]",y="[object Set]",v="[object String]",E="[object Symbol]",k="[object WeakMap]",A="[object ArrayBuffer]",T="[object DataView]",w=/^\[object .+?Constructor\]$/,L=/^(?:0|[1-9]\d*)$/,D={};D["[object Float32Array]"]=D["[object Float64Array]"]=D["[object Int8Array]"]=D["[object Int16Array]"]=D["[object Int32Array]"]=D["[object Uint8Array]"]=D["[object Uint8ClampedArray]"]=D["[object Uint16Array]"]=D["[object Uint32Array]"]=!0,D[s]=D[l]=D[A]=D[c]=D[T]=D[u]=D[d]=D[m]=D[p]=D[_]=D[f]=D[b]=D[y]=D[v]=D[k]=!1;var C="object"==typeof n.g&&n.g&&n.g.Object===Object&&n.g,O="object"==typeof self&&self&&self.Object===Object&&self,R=C||O||Function("return this")(),S=t&&!t.nodeType&&t,P=S&&e&&!e.nodeType&&e,M=P&&P.exports===S&&C.process,x=function(){try{return M&&M.binding("util")}catch(e){}}(),j=x&&x.isTypedArray;function I(e,t){for(var n=-1,i=e?e.length:0;++n<i;)if(t(e[n],n,e))return!0;return!1}function B(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}function N(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function F(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var z,q,H,U=Array.prototype,$=Function.prototype,Z=Object.prototype,G=R["__core-js_shared__"],V=(z=/[^.]+$/.exec(G&&G.keys&&G.keys.IE_PROTO||""))?"Symbol(src)_1."+z:"",W=$.toString,K=Z.hasOwnProperty,Y=Z.toString,X=RegExp("^"+W.call(K).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Q=R.Symbol,J=R.Uint8Array,ee=Z.propertyIsEnumerable,te=U.splice,ne=(q=Object.keys,H=Object,function(e){return q(H(e))}),ie=Ce(R,"DataView"),oe=Ce(R,"Map"),re=Ce(R,"Promise"),ae=Ce(R,"Set"),se=Ce(R,"WeakMap"),le=Ce(Object,"create"),ce=Se(ie),ue=Se(oe),de=Se(re),me=Se(ae),he=Se(se),pe=Q?Q.prototype:void 0,_e=pe?pe.valueOf:void 0;function fe(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function ge(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function be(e){var t=-1,n=e?e.length:0;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function ye(e){var t=-1,n=e?e.length:0;for(this.__data__=new be;++t<n;)this.add(e[t])}function ve(e){this.__data__=new ge(e)}function Ee(e,t){var n=Me(e)||function(e){return function(e){return Ne(e)&&xe(e)}(e)&&K.call(e,"callee")&&(!ee.call(e,"callee")||Y.call(e)==s)}(e)?function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}(e.length,String):[],i=n.length,o=!!i;for(var r in e)!t&&!K.call(e,r)||o&&("length"==r||Re(r,i))||n.push(r);return n}function ke(e,t){for(var n=e.length;n--;)if(Pe(e[n][0],t))return n;return-1}function Ae(e,t,n,i,a){return e===t||(null==e||null==t||!Be(e)&&!Ne(t)?e!=e&&t!=t:function(e,t,n,i,a,m){var h=Me(e),g=Me(t),k=l,w=l;h||(k=(k=Oe(e))==s?f:k);g||(w=(w=Oe(t))==s?f:w);var L=k==f&&!B(e),D=w==f&&!B(t),C=k==w;if(C&&!L)return m||(m=new ve),h||Fe(e)?Le(e,t,n,i,a,m):function(e,t,n,i,a,s,l){switch(n){case T:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case A:return!(e.byteLength!=t.byteLength||!i(new J(e),new J(t)));case c:case u:case _:return Pe(+e,+t);case d:return e.name==t.name&&e.message==t.message;case b:case v:return e==t+"";case p:var m=N;case y:var h=s&r;if(m||(m=F),e.size!=t.size&&!h)return!1;var f=l.get(e);if(f)return f==t;s|=o,l.set(e,t);var g=Le(m(e),m(t),i,a,s,l);return l.delete(e),g;case E:if(_e)return _e.call(e)==_e.call(t)}return!1}(e,t,k,n,i,a,m);if(!(a&r)){var O=L&&K.call(e,"__wrapped__"),R=D&&K.call(t,"__wrapped__");if(O||R){var S=O?e.value():e,P=R?t.value():t;return m||(m=new ve),n(S,P,i,a,m)}}if(!C)return!1;return m||(m=new ve),function(e,t,n,i,o,a){var s=o&r,l=ze(e),c=l.length,u=ze(t),d=u.length;if(c!=d&&!s)return!1;var m=c;for(;m--;){var h=l[m];if(!(s?h in t:K.call(t,h)))return!1}var p=a.get(e);if(p&&a.get(t))return p==t;var _=!0;a.set(e,t),a.set(t,e);var f=s;for(;++m<c;){var g=e[h=l[m]],b=t[h];if(i)var y=s?i(b,g,h,t,e,a):i(g,b,h,e,t,a);if(!(void 0===y?g===b||n(g,b,i,o,a):y)){_=!1;break}f||(f="constructor"==h)}if(_&&!f){var v=e.constructor,E=t.constructor;v==E||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof E&&E instanceof E||(_=!1)}return a.delete(e),a.delete(t),_}(e,t,n,i,a,m)}(e,t,Ae,n,i,a))}function Te(e){return!(!Be(e)||function(e){return!!V&&V in e}(e))&&(je(e)||B(e)?X:w).test(Se(e))}function we(e){if(n=(t=e)&&t.constructor,i="function"==typeof n&&n.prototype||Z,t!==i)return ne(e);var t,n,i,o=[];for(var r in Object(e))K.call(e,r)&&"constructor"!=r&&o.push(r);return o}function Le(e,t,n,i,a,s){var l=a&r,c=e.length,u=t.length;if(c!=u&&!(l&&u>c))return!1;var d=s.get(e);if(d&&s.get(t))return d==t;var m=-1,h=!0,p=a&o?new ye:void 0;for(s.set(e,t),s.set(t,e);++m<c;){var _=e[m],f=t[m];if(i)var g=l?i(f,_,m,t,e,s):i(_,f,m,e,t,s);if(void 0!==g){if(g)continue;h=!1;break}if(p){if(!I(t,(function(e,t){if(!p.has(t)&&(_===e||n(_,e,i,a,s)))return p.add(t)}))){h=!1;break}}else if(_!==f&&!n(_,f,i,a,s)){h=!1;break}}return s.delete(e),s.delete(t),h}function De(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function Ce(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Te(n)?n:void 0}fe.prototype.clear=function(){this.__data__=le?le(null):{}},fe.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},fe.prototype.get=function(e){var t=this.__data__;if(le){var n=t[e];return n===i?void 0:n}return K.call(t,e)?t[e]:void 0},fe.prototype.has=function(e){var t=this.__data__;return le?void 0!==t[e]:K.call(t,e)},fe.prototype.set=function(e,t){return this.__data__[e]=le&&void 0===t?i:t,this},ge.prototype.clear=function(){this.__data__=[]},ge.prototype.delete=function(e){var t=this.__data__,n=ke(t,e);return!(n<0)&&(n==t.length-1?t.pop():te.call(t,n,1),!0)},ge.prototype.get=function(e){var t=this.__data__,n=ke(t,e);return n<0?void 0:t[n][1]},ge.prototype.has=function(e){return ke(this.__data__,e)>-1},ge.prototype.set=function(e,t){var n=this.__data__,i=ke(n,e);return i<0?n.push([e,t]):n[i][1]=t,this},be.prototype.clear=function(){this.__data__={hash:new fe,map:new(oe||ge),string:new fe}},be.prototype.delete=function(e){return De(this,e).delete(e)},be.prototype.get=function(e){return De(this,e).get(e)},be.prototype.has=function(e){return De(this,e).has(e)},be.prototype.set=function(e,t){return De(this,e).set(e,t),this},ye.prototype.add=ye.prototype.push=function(e){return this.__data__.set(e,i),this},ye.prototype.has=function(e){return this.__data__.has(e)},ve.prototype.clear=function(){this.__data__=new ge},ve.prototype.delete=function(e){return this.__data__.delete(e)},ve.prototype.get=function(e){return this.__data__.get(e)},ve.prototype.has=function(e){return this.__data__.has(e)},ve.prototype.set=function(e,t){var n=this.__data__;if(n instanceof ge){var i=n.__data__;if(!oe||i.length<199)return i.push([e,t]),this;n=this.__data__=new be(i)}return n.set(e,t),this};var Oe=function(e){return Y.call(e)};function Re(e,t){return!!(t=null==t?a:t)&&("number"==typeof e||L.test(e))&&e>-1&&e%1==0&&e<t}function Se(e){if(null!=e){try{return W.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function Pe(e,t){return e===t||e!=e&&t!=t}(ie&&Oe(new ie(new ArrayBuffer(1)))!=T||oe&&Oe(new oe)!=p||re&&Oe(re.resolve())!=g||ae&&Oe(new ae)!=y||se&&Oe(new se)!=k)&&(Oe=function(e){var t=Y.call(e),n=t==f?e.constructor:void 0,i=n?Se(n):void 0;if(i)switch(i){case ce:return T;case ue:return p;case de:return g;case me:return y;case he:return k}return t});var Me=Array.isArray;function xe(e){return null!=e&&Ie(e.length)&&!je(e)}function je(e){var t=Be(e)?Y.call(e):"";return t==m||t==h}function Ie(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=a}function Be(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function Ne(e){return!!e&&"object"==typeof e}var Fe=j?function(e){return function(t){return e(t)}}(j):function(e){return Ne(e)&&Ie(e.length)&&!!D[Y.call(e)]};function ze(e){return xe(e)?Ee(e):we(e)}e.exports=function(e,t,n){var i=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===i?Ae(e,t,n):!!i}},26663:(e,t,n)=>{var i=n(9142),o=n(29830);e.exports=function(e,t,n){(void 0!==n&&!o(e[t],n)||void 0===n&&!(t in e))&&i(e,t,n)}},90436:(e,t,n)=>{var i=n(92823),o=n(26663),r=n(61311),a=n(56554),s=n(46015),l=n(53435),c=n(54892);e.exports=function e(t,n,u,d,m){t!==n&&r(n,(function(r,l){if(m||(m=new i),s(r))a(t,n,l,u,e,d,m);else{var h=d?d(c(t,l),r,l+"",t,n,m):void 0;void 0===h&&(h=r),o(t,l,h)}}),l)}},56554:(e,t,n)=>{var i=n(26663),o=n(6064),r=n(11671),a=n(28601),s=n(50235),l=n(95962),c=n(64383),u=n(95919),d=n(78098),m=n(94360),h=n(46015),p=n(5229),_=n(63905),f=n(54892),g=n(57774);e.exports=function(e,t,n,b,y,v,E){var k=f(e,n),A=f(t,n),T=E.get(A);if(T)i(e,n,T);else{var w=v?v(k,A,n+"",e,t,E):void 0,L=void 0===w;if(L){var D=c(A),C=!D&&d(A),O=!D&&!C&&_(A);w=A,D||C||O?c(k)?w=k:u(k)?w=a(k):C?(L=!1,w=o(A,!0)):O?(L=!1,w=r(A,!0)):w=[]:p(A)||l(A)?(w=k,l(k)?w=g(k):h(k)&&!m(k)||(w=s(A))):L=!1}L&&(E.set(A,w),y(w,A,b,v,E),E.delete(A)),i(e,n,w)}}},54892:e=>{e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},81285:(e,t,n)=>{var i=n(69557);e.exports=function(e){return i(e,5)}},764:(e,t,n)=>{var i=n(26138),o=n(94207),r=n(35218),a=n(64383);e.exports=function(e,t){return(a(e)?i:r)(e,o(t,3))}},85668:(e,t,n)=>{var i=n(9142),o=n(76895),r=n(94207);e.exports=function(e,t){var n={};return t=r(t,3),o(e,(function(e,o,r){i(n,t(e,o,r),e)})),n}},17156:(e,t,n)=>{var i=n(74321),o=n(4873),r=n(69090);e.exports=function(e){return e&&e.length?i(e,r,o):void 0}},51582:(e,t,n)=>{var i=n(90436),o=n(17921)((function(e,t,n){i(e,t,n)}));e.exports=o},3902:(e,t,n)=>{var i=n(85928);e.exports=function(e,t,n){return null==e?e:i(e,t,n)}},57774:(e,t,n)=>{var i=n(26837),o=n(53435);e.exports=function(e){return i(e,o(e))}},44697:(e,t,n)=>{var i=n(83234),o=n(75580),r=n(43247),a=n(95919),s=o((function(e){return r(i(e,1,a,!0))}));e.exports=s},18623:(e,t,n)=>{"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=We(n(29410)),r=We(n(92774)),a=We(n(59737)),s=We(n(8900)),l=We(n(34278)),c=We(n(21262)),u=We(n(81418)),d=We(n(46299)),m=We(n(28705)),h=We(n(66510)),p=We(n(3246)),_=We(n(1741)),f=We(n(57780)),g=We(n(255)),b=We(n(55894)),y=We(n(9847)),v=We(n(60113)),E=Ve(n(97743)),k=Ve(n(28104)),A=We(n(44564)),T=We(n(85384)),w=We(n(60932)),L=We(n(18782)),D=We(n(23027)),C=We(n(81391)),O=We(n(77956)),R=We(n(93200)),S=We(n(39020)),P=We(n(36519)),M=We(n(85696)),x=We(n(26647)),j=We(n(77345)),I=We(n(40798)),B=Ve(n(30545)),N=We(n(87496)),F=We(n(13836)),z=We(n(83128)),q=We(n(47341)),H=We(n(72035)),U=We(n(34345)),$=We(n(85400)),Z=We(n(52168)),G=Ve(n(44355)),V=We(n(52257)),W=We(n(34783)),K=We(n(16259)),Y=We(n(86546)),X=We(n(49001)),Q=We(n(68926)),J=We(n(5559)),ee=We(n(14189)),te=We(n(73500)),ne=We(n(46274)),ie=We(n(45329)),oe=We(n(3780)),re=We(n(40800)),ae=We(n(40235)),se=We(n(16752)),le=We(n(11307)),ce=We(n(50887)),ue=We(n(78584)),de=We(n(64163)),me=We(n(3106)),he=We(n(53819)),pe=Ve(n(51969)),_e=We(n(1808)),fe=We(n(11172)),ge=We(n(62194)),be=We(n(99415)),ye=We(n(59067)),ve=We(n(70496)),Ee=We(n(78678)),ke=We(n(1242)),Ae=We(n(51772)),Te=We(n(59555)),we=We(n(90331)),Le=We(n(92232)),De=We(n(6297)),Ce=We(n(17663)),Oe=We(n(20267)),Re=We(n(95856)),Se=Ve(n(15877)),Pe=We(n(52187)),Me=We(n(88397)),xe=We(n(44767)),je=We(n(13588)),Ie=We(n(44247)),Be=We(n(39551)),Ne=We(n(75742)),Fe=We(n(42092)),ze=We(n(8963)),qe=We(n(14462)),He=We(n(76068)),Ue=We(n(37634)),$e=We(n(35549)),Ze=We(n(67496));function Ge(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return Ge=function(){return e},e}function Ve(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=Ge();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=o?Object.getOwnPropertyDescriptor(e,r):null;a&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r]}return n.default=e,t&&t.set(e,n),n}function We(e){return e&&e.__esModule?e:{default:e}}var Ke={version:"13.9.0",toDate:o.default,toFloat:r.default,toInt:a.default,toBoolean:s.default,equals:l.default,contains:c.default,matches:u.default,isEmail:d.default,isURL:m.default,isMACAddress:h.default,isIP:p.default,isIPRange:_.default,isFQDN:f.default,isBoolean:y.default,isIBAN:G.default,isBIC:V.default,isAlpha:E.default,isAlphaLocales:E.locales,isAlphanumeric:k.default,isAlphanumericLocales:k.locales,isNumeric:A.default,isPassportNumber:T.default,isPort:w.default,isLowercase:L.default,isUppercase:D.default,isAscii:O.default,isFullWidth:R.default,isHalfWidth:S.default,isVariableWidth:P.default,isMultibyte:M.default,isSemVer:x.default,isSurrogatePair:j.default,isInt:I.default,isIMEI:C.default,isFloat:B.default,isFloatLocales:B.locales,isDecimal:N.default,isHexadecimal:F.default,isOctal:z.default,isDivisibleBy:q.default,isHexColor:H.default,isRgbColor:U.default,isHSL:$.default,isISRC:Z.default,isMD5:W.default,isHash:K.default,isJWT:Y.default,isJSON:X.default,isEmpty:Q.default,isLength:J.default,isLocale:v.default,isByteLength:ee.default,isUUID:te.default,isMongoId:ne.default,isAfter:ie.default,isBefore:oe.default,isIn:re.default,isLuhnNumber:ae.default,isCreditCard:se.default,isIdentityCard:le.default,isEAN:ce.default,isISIN:ue.default,isISBN:de.default,isISSN:me.default,isMobilePhone:pe.default,isMobilePhoneLocales:pe.locales,isPostalCode:Se.default,isPostalCodeLocales:Se.locales,isEthereumAddress:_e.default,isCurrency:fe.default,isBtcAddress:ge.default,isISO6391:be.default,isISO8601:ye.default,isRFC3339:ve.default,isISO31661Alpha2:Ee.default,isISO31661Alpha3:ke.default,isISO4217:Ae.default,isBase32:Te.default,isBase58:we.default,isBase64:Le.default,isDataURI:De.default,isMagnetURI:Ce.default,isMimeType:Oe.default,isLatLong:Re.default,ltrim:Pe.default,rtrim:Me.default,trim:xe.default,escape:je.default,unescape:Ie.default,stripLow:Be.default,whitelist:Ne.default,blacklist:Fe.default,isWhitelisted:ze.default,normalizeEmail:qe.default,toString,isSlug:He.default,isStrongPassword:$e.default,isTaxID:he.default,isDate:g.default,isTime:b.default,isLicensePlate:Ue.default,isVAT:Ze.default,ibanLocales:G.locales};t.default=Ke,e.exports=t.default,e.exports.default=t.default},87735:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.commaDecimal=t.dotDecimal=t.bengaliLocales=t.farsiLocales=t.arabicLocales=t.englishLocales=t.decimal=t.alphanumeric=t.alpha=void 0;var n={"en-US":/^[A-Z]+$/i,"az-AZ":/^[A-VXYZÇƏĞİıÖŞÜ]+$/i,"bg-BG":/^[А-Я]+$/i,"cs-CZ":/^[A-ZÁČĎÉĚÍŇÓŘŠŤÚŮÝŽ]+$/i,"da-DK":/^[A-ZÆØÅ]+$/i,"de-DE":/^[A-ZÄÖÜß]+$/i,"el-GR":/^[Α-ώ]+$/i,"es-ES":/^[A-ZÁÉÍÑÓÚÜ]+$/i,"fa-IR":/^[ابپتثجچحخدذرزژسشصضطظعغفقکگلمنوهی]+$/i,"fi-FI":/^[A-ZÅÄÖ]+$/i,"fr-FR":/^[A-ZÀÂÆÇÉÈÊËÏÎÔŒÙÛÜŸ]+$/i,"it-IT":/^[A-ZÀÉÈÌÎÓÒÙ]+$/i,"ja-JP":/^[ぁ-んァ-ヶｦ-ﾟ一-龠ー・。、]+$/i,"nb-NO":/^[A-ZÆØÅ]+$/i,"nl-NL":/^[A-ZÁÉËÏÓÖÜÚ]+$/i,"nn-NO":/^[A-ZÆØÅ]+$/i,"hu-HU":/^[A-ZÁÉÍÓÖŐÚÜŰ]+$/i,"pl-PL":/^[A-ZĄĆĘŚŁŃÓŻŹ]+$/i,"pt-PT":/^[A-ZÃÁÀÂÄÇÉÊËÍÏÕÓÔÖÚÜ]+$/i,"ru-RU":/^[А-ЯЁ]+$/i,"sl-SI":/^[A-ZČĆĐŠŽ]+$/i,"sk-SK":/^[A-ZÁČĎÉÍŇÓŠŤÚÝŽĹŔĽÄÔ]+$/i,"sr-RS@latin":/^[A-ZČĆŽŠĐ]+$/i,"sr-RS":/^[А-ЯЂЈЉЊЋЏ]+$/i,"sv-SE":/^[A-ZÅÄÖ]+$/i,"th-TH":/^[ก-๐\s]+$/i,"tr-TR":/^[A-ZÇĞİıÖŞÜ]+$/i,"uk-UA":/^[А-ЩЬЮЯЄIЇҐі]+$/i,"vi-VN":/^[A-ZÀÁẠẢÃÂẦẤẬẨẪĂẰẮẶẲẴĐÈÉẸẺẼÊỀẾỆỂỄÌÍỊỈĨÒÓỌỎÕÔỒỐỘỔỖƠỜỚỢỞỠÙÚỤỦŨƯỪỨỰỬỮỲÝỴỶỸ]+$/i,"ko-KR":/^[ㄱ-ㅎㅏ-ㅣ가-힣]*$/,"ku-IQ":/^[ئابپتجچحخدرڕزژسشعغفڤقکگلڵمنوۆھەیێيطؤثآإأكضصةظذ]+$/i,ar:/^[ءآأؤإئابةتثجحخدذرزسشصضطظعغفقكلمنهوىيًٌٍَُِّْٰ]+$/,he:/^[א-ת]+$/,fa:/^['آاءأؤئبپتثجچحخدذرزژسشصضطظعغفقکگلمنوهةی']+$/i,bn:/^['ঀঁংঃঅআইঈউঊঋঌএঐওঔকখগঘঙচছজঝঞটঠডঢণতথদধনপফবভমযরলশষসহ়ঽািীুূৃৄেৈোৌ্ৎৗড়ঢ়য়ৠৡৢৣৰৱ৲৳৴৵৶৷৸৹৺৻']+$/,"hi-IN":/^[\u0900-\u0961]+[\u0972-\u097F]*$/i,"si-LK":/^[\u0D80-\u0DFF]+$/};t.alpha=n;var i={"en-US":/^[0-9A-Z]+$/i,"az-AZ":/^[0-9A-VXYZÇƏĞİıÖŞÜ]+$/i,"bg-BG":/^[0-9А-Я]+$/i,"cs-CZ":/^[0-9A-ZÁČĎÉĚÍŇÓŘŠŤÚŮÝŽ]+$/i,"da-DK":/^[0-9A-ZÆØÅ]+$/i,"de-DE":/^[0-9A-ZÄÖÜß]+$/i,"el-GR":/^[0-9Α-ω]+$/i,"es-ES":/^[0-9A-ZÁÉÍÑÓÚÜ]+$/i,"fi-FI":/^[0-9A-ZÅÄÖ]+$/i,"fr-FR":/^[0-9A-ZÀÂÆÇÉÈÊËÏÎÔŒÙÛÜŸ]+$/i,"it-IT":/^[0-9A-ZÀÉÈÌÎÓÒÙ]+$/i,"ja-JP":/^[0-9０-９ぁ-んァ-ヶｦ-ﾟ一-龠ー・。、]+$/i,"hu-HU":/^[0-9A-ZÁÉÍÓÖŐÚÜŰ]+$/i,"nb-NO":/^[0-9A-ZÆØÅ]+$/i,"nl-NL":/^[0-9A-ZÁÉËÏÓÖÜÚ]+$/i,"nn-NO":/^[0-9A-ZÆØÅ]+$/i,"pl-PL":/^[0-9A-ZĄĆĘŚŁŃÓŻŹ]+$/i,"pt-PT":/^[0-9A-ZÃÁÀÂÄÇÉÊËÍÏÕÓÔÖÚÜ]+$/i,"ru-RU":/^[0-9А-ЯЁ]+$/i,"sl-SI":/^[0-9A-ZČĆĐŠŽ]+$/i,"sk-SK":/^[0-9A-ZÁČĎÉÍŇÓŠŤÚÝŽĹŔĽÄÔ]+$/i,"sr-RS@latin":/^[0-9A-ZČĆŽŠĐ]+$/i,"sr-RS":/^[0-9А-ЯЂЈЉЊЋЏ]+$/i,"sv-SE":/^[0-9A-ZÅÄÖ]+$/i,"th-TH":/^[ก-๙\s]+$/i,"tr-TR":/^[0-9A-ZÇĞİıÖŞÜ]+$/i,"uk-UA":/^[0-9А-ЩЬЮЯЄIЇҐі]+$/i,"ko-KR":/^[0-9ㄱ-ㅎㅏ-ㅣ가-힣]*$/,"ku-IQ":/^[٠١٢٣٤٥٦٧٨٩0-9ئابپتجچحخدرڕزژسشعغفڤقکگلڵمنوۆھەیێيطؤثآإأكضصةظذ]+$/i,"vi-VN":/^[0-9A-ZÀÁẠẢÃÂẦẤẬẨẪĂẰẮẶẲẴĐÈÉẸẺẼÊỀẾỆỂỄÌÍỊỈĨÒÓỌỎÕÔỒỐỘỔỖƠỜỚỢỞỠÙÚỤỦŨƯỪỨỰỬỮỲÝỴỶỸ]+$/i,ar:/^[٠١٢٣٤٥٦٧٨٩0-9ءآأؤإئابةتثجحخدذرزسشصضطظعغفقكلمنهوىيًٌٍَُِّْٰ]+$/,he:/^[0-9א-ת]+$/,fa:/^['0-9آاءأؤئبپتثجچحخدذرزژسشصضطظعغفقکگلمنوهةی۱۲۳۴۵۶۷۸۹۰']+$/i,bn:/^['ঀঁংঃঅআইঈউঊঋঌএঐওঔকখগঘঙচছজঝঞটঠডঢণতথদধনপফবভমযরলশষসহ়ঽািীুূৃৄেৈোৌ্ৎৗড়ঢ়য়ৠৡৢৣ০১২৩৪৫৬৭৮৯ৰৱ৲৳৴৵৶৷৸৹৺৻']+$/,"hi-IN":/^[\u0900-\u0963]+[\u0966-\u097F]*$/i,"si-LK":/^[0-9\u0D80-\u0DFF]+$/};t.alphanumeric=i;var o={"en-US":".",ar:"٫"};t.decimal=o;var r=["AU","GB","HK","IN","NZ","ZA","ZM"];t.englishLocales=r;for(var a,s=0;s<r.length;s++)n[a="en-".concat(r[s])]=n["en-US"],i[a]=i["en-US"],o[a]=o["en-US"];var l=["AE","BH","DZ","EG","IQ","JO","KW","LB","LY","MA","QM","QA","SA","SD","SY","TN","YE"];t.arabicLocales=l;for(var c,u=0;u<l.length;u++)n[c="ar-".concat(l[u])]=n.ar,i[c]=i.ar,o[c]=o.ar;var d=["IR","AF"];t.farsiLocales=d;for(var m,h=0;h<d.length;h++)i[m="fa-".concat(d[h])]=i.fa,o[m]=o.ar;var p=["BD","IN"];t.bengaliLocales=p;for(var _,f=0;f<p.length;f++)n[_="bn-".concat(p[f])]=n.bn,i[_]=i.bn,o[_]=o["en-US"];var g=["ar-EG","ar-LB","ar-LY"];t.dotDecimal=g;var b=["bg-BG","cs-CZ","da-DK","de-DE","el-GR","en-ZM","es-ES","fr-CA","fr-FR","id-ID","it-IT","ku-IQ","hi-IN","hu-HU","nb-NO","nn-NO","nl-NL","pl-PL","pt-PT","ru-RU","si-LK","sl-SI","sr-RS@latin","sr-RS","sv-SE","tr-TR","uk-UA","vi-VN"];t.commaDecimal=b;for(var y=0;y<g.length;y++)o[g[y]]=o["en-US"];for(var v=0;v<b.length;v++)o[b[v]]=",";n["fr-CA"]=n["fr-FR"],i["fr-CA"]=i["fr-FR"],n["pt-BR"]=n["pt-PT"],i["pt-BR"]=i["pt-PT"],o["pt-BR"]=o["pt-PT"],n["pl-Pl"]=n["pl-PL"],i["pl-Pl"]=i["pl-PL"],o["pl-Pl"]=o["pl-PL"],n["fa-AF"]=n.fa},42092:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,o.default)(e),e.replace(new RegExp("[".concat(t,"]+"),"g"),"")};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},21262:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if((0,i.default)(e),(n=(0,r.default)(n,s)).ignoreCase)return e.toLowerCase().split((0,o.default)(t).toLowerCase()).length>n.minOccurrences;return e.split((0,o.default)(t)).length>n.minOccurrences};var i=a(n(76041)),o=a(n(95894)),r=a(n(92372));function a(e){return e&&e.__esModule?e:{default:e}}var s={ignoreCase:!1,minOccurrences:1};e.exports=t.default,e.exports.default=t.default},34278:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,o.default)(e),e===t};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},13588:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),e.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\//g,"&#x2F;").replace(/\\/g,"&#x5C;").replace(/`/g,"&#96;")};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},45329:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=(null==t?void 0:t.comparisonDate)||t||Date().toString(),i=(0,o.default)(n),r=(0,o.default)(e);return!!(r&&i&&r>i)};var i,o=(i=n(29410))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},97743:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,o.default)(e);var i=e,a=n.ignore;if(a)if(a instanceof RegExp)i=i.replace(a,"");else{if("string"!=typeof a)throw new Error("ignore should be instance of a String or RegExp");i=i.replace(new RegExp("[".concat(a.replace(/[-[\]{}()*+?.,\\^$|#\\s]/g,"\\$&"),"]"),"g"),"")}if(t in r.alpha)return r.alpha[t].test(i);throw new Error("Invalid locale '".concat(t,"'"))},t.locales=void 0;var i,o=(i=n(76041))&&i.__esModule?i:{default:i},r=n(87735);var a=Object.keys(r.alpha);t.locales=a},28104:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,o.default)(e);var i=e,a=n.ignore;if(a)if(a instanceof RegExp)i=i.replace(a,"");else{if("string"!=typeof a)throw new Error("ignore should be instance of a String or RegExp");i=i.replace(new RegExp("[".concat(a.replace(/[-[\]{}()*+?.,\\^$|#\\s]/g,"\\$&"),"]"),"g"),"")}if(t in r.alphanumeric)return r.alphanumeric[t].test(i);throw new Error("Invalid locale '".concat(t,"'"))},t.locales=void 0;var i,o=(i=n(76041))&&i.__esModule?i:{default:i},r=n(87735);var a=Object.keys(r.alphanumeric);t.locales=a},77956:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^[\x00-\x7F]+$/;e.exports=t.default,e.exports.default=t.default},52257:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){(0,o.default)(e);var t=e.slice(4,6).toUpperCase();if(!r.CountryCodes.has(t)&&"XK"!==t)return!1;return a.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i},r=n(78678);var a=/^[A-Za-z]{6}[A-Za-z0-9]{2}([A-Za-z0-9]{3})?$/;e.exports=t.default,e.exports.default=t.default},59555:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,i.default)(e),(t=(0,o.default)(t,l)).crockford)return s.test(e);if(e.length%8==0&&a.test(e))return!0;return!1};var i=r(n(76041)),o=r(n(92372));function r(e){return e&&e.__esModule?e:{default:e}}var a=/^[A-Z2-7]+=*$/,s=/^[A-HJKMNP-TV-Z0-9]+$/,l={crockford:!1};e.exports=t.default,e.exports.default=t.default},90331:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if((0,o.default)(e),r.test(e))return!0;return!1};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^[A-HJ-NP-Za-km-z1-9]*$/;e.exports=t.default,e.exports.default=t.default},92232:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,i.default)(e),t=(0,o.default)(t,l);var n=e.length;if(t.urlSafe)return s.test(e);if(n%4!=0||a.test(e))return!1;var r=e.indexOf("=");return-1===r||r===n-1||r===n-2&&"="===e[n-1]};var i=r(n(76041)),o=r(n(92372));function r(e){return e&&e.__esModule?e:{default:e}}var a=/[^A-Z0-9+\/=]/i,s=/^[A-Z0-9_\-]*$/i,l={urlSafe:!1};e.exports=t.default,e.exports.default=t.default},3780:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:String(new Date);(0,i.default)(e);var n=(0,o.default)(t),r=(0,o.default)(e);return!!(r&&n&&r<n)};var i=r(n(76041)),o=r(n(29410));function r(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default,e.exports.default=t.default},9847:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r;if((0,o.default)(e),t.loose)return s.includes(e.toLowerCase());return a.includes(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r={loose:!1},a=["true","false","1","0"],s=[].concat(a,["yes","no"]);e.exports=t.default,e.exports.default=t.default},62194:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.test(e)||a.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^(bc1)[a-z0-9]{25,39}$/,a=/^(1|3)[A-HJ-NP-Za-km-z1-9]{25,39}$/;e.exports=t.default,e.exports.default=t.default},14189:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n,i;(0,o.default)(e),"object"===r(t)?(n=t.min||0,i=t.max):(n=arguments[1],i=arguments[2]);var a=encodeURI(e).split(/%..|./).length-1;return a>=n&&(void 0===i||a<=i)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}e.exports=t.default,e.exports.default=t.default},16752:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,i.default)(e);var n=t.provider,r=e.replace(/[- ]+/g,"");if(n&&n.toLowerCase()in a){if(!a[n.toLowerCase()].test(r))return!1}else{if(n&&!(n.toLowerCase()in a))throw new Error("".concat(n," is not a valid credit card provider."));if(!s.test(r))return!1}return(0,o.default)(e)};var i=r(n(76041)),o=r(n(40235));function r(e){return e&&e.__esModule?e:{default:e}}var a={amex:/^3[47][0-9]{13}$/,dinersclub:/^3(?:0[0-5]|[68][0-9])[0-9]{11}$/,discover:/^6(?:011|5[0-9][0-9])[0-9]{12,15}$/,jcb:/^(?:2131|1800|35\d{3})\d{11}$/,mastercard:/^5[1-5][0-9]{2}|(222[1-9]|22[3-9][0-9]|2[3-6][0-9]{2}|27[01][0-9]|2720)[0-9]{12}$/,unionpay:/^(6[27][0-9]{14}|^(81[0-9]{14,17}))$/,visa:/^(?:4[0-9]{12})(?:[0-9]{3,6})?$/},s=/^(?:4[0-9]{12}(?:[0-9]{3,6})?|5[1-5][0-9]{14}|(222[1-9]|22[3-9][0-9]|2[3-6][0-9]{2}|27[01][0-9]|2720)[0-9]{12}|6(?:011|5[0-9][0-9])[0-9]{12,15}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11}|6[27][0-9]{14}|^(81[0-9]{14,17}))$/;e.exports=t.default,e.exports.default=t.default},11172:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,o.default)(e),function(e){var t="\\d{".concat(e.digits_after_decimal[0],"}");e.digits_after_decimal.forEach((function(e,n){0!==n&&(t="".concat(t,"|\\d{").concat(e,"}"))}));var n="(".concat(e.symbol.replace(/\W/,(function(e){return"\\".concat(e)})),")").concat(e.require_symbol?"":"?"),i="-?",o="[1-9]\\d{0,2}(\\".concat(e.thousands_separator,"\\d{3})*"),r="(".concat(["0","[1-9]\\d*",o].join("|"),")?"),a="(\\".concat(e.decimal_separator,"(").concat(t,"))").concat(e.require_decimal?"":"?"),s=r+(e.allow_decimal||e.require_decimal?a:"");e.allow_negatives&&!e.parens_for_negatives&&(e.negative_sign_after_digits?s+=i:e.negative_sign_before_digits&&(s=i+s));e.allow_negative_sign_placeholder?s="( (?!\\-))?".concat(s):e.allow_space_after_symbol?s=" ?".concat(s):e.allow_space_after_digits&&(s+="( (?!$))?");e.symbol_after_digits?s+=n:s=n+s;e.allow_negatives&&(e.parens_for_negatives?s="(\\(".concat(s,"\\)|").concat(s,")"):e.negative_sign_before_digits||e.negative_sign_after_digits||(s=i+s));return new RegExp("^(?!-? )(?=.*\\d)".concat(s,"$"))}(t=(0,i.default)(t,a)).test(e)};var i=r(n(92372)),o=r(n(76041));function r(e){return e&&e.__esModule?e:{default:e}}var a={symbol:"$",require_symbol:!1,allow_space_after_symbol:!1,symbol_after_digits:!1,allow_negatives:!0,parens_for_negatives:!1,negative_sign_before_digits:!1,negative_sign_after_digits:!1,allow_negative_sign_placeholder:!1,thousands_separator:",",decimal_separator:".",allow_decimal:!0,require_decimal:!1,digits_after_decimal:[2],allow_space_after_digits:!1};e.exports=t.default,e.exports.default=t.default},6297:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){(0,o.default)(e);var t=e.split(",");if(t.length<2)return!1;var n=t.shift().trim().split(";"),i=n.shift();if("data:"!==i.slice(0,5))return!1;var l=i.slice(5);if(""!==l&&!r.test(l))return!1;for(var c=0;c<n.length;c++)if((c!==n.length-1||"base64"!==n[c].toLowerCase())&&!a.test(n[c]))return!1;for(var u=0;u<t.length;u++)if(!s.test(t[u]))return!1;return!0};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^[a-z]+\/[a-z0-9\-\+\._]+$/i,a=/^[a-z\-]+=[a-z0-9\-]+$/i,s=/^[a-z0-9!\$&'\(\)\*\+,;=\-\._~:@\/\?%\s]*$/i;e.exports=t.default,e.exports.default=t.default},255:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){t="string"==typeof t?(0,o.default)({format:t},s):(0,o.default)(t,s);if("string"==typeof e&&(f=t.format,/(^(y{4}|y{2})[.\/-](m{1,2})[.\/-](d{1,2})$)|(^(m{1,2})[.\/-](d{1,2})[.\/-]((y{4}|y{2})$))|(^(d{1,2})[.\/-](m{1,2})[.\/-]((y{4}|y{2})$))/gi.test(f))){var n,i=t.delimiters.find((function(e){return-1!==t.format.indexOf(e)})),a=t.strictMode?i:t.delimiters.find((function(t){return-1!==e.indexOf(t)})),l=function(e,t){for(var n=[],i=Math.min(e.length,t.length),o=0;o<i;o++)n.push([e[o],t[o]]);return n}(e.split(a),t.format.toLowerCase().split(i)),c={},u=function(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}}(l);try{for(u.s();!(n=u.n()).done;){var d=(p=n.value,_=2,function(e){if(Array.isArray(e))return e}(p)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return n}(p,_)||r(p,_)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),m=d[0],h=d[1];if(m.length!==h.length)return!1;c[h.charAt(0)]=m}}catch(e){u.e(e)}finally{u.f()}return new Date("".concat(c.m,"/").concat(c.d,"/").concat(c.y)).getDate()===+c.d}var p,_;var f;if(!t.strictMode)return"[object Date]"===Object.prototype.toString.call(e)&&isFinite(e);return!1};var i,o=(i=n(92372))&&i.__esModule?i:{default:i};function r(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var s={format:"YYYY/MM/DD",delimiters:["/","-"],strictMode:!1};e.exports=t.default,e.exports.default=t.default},87496:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,o.default)(e),(t=(0,i.default)(t,l)).locale in a.decimal)return!(0,r.default)(c,e.replace(/ /g,""))&&function(e){var t=new RegExp("^[-+]?([0-9]+)?(\\".concat(a.decimal[e.locale],"[0-9]{").concat(e.decimal_digits,"})").concat(e.force_decimal?"":"?","$"));return t}(t).test(e);throw new Error("Invalid locale '".concat(t.locale,"'"))};var i=s(n(92372)),o=s(n(76041)),r=s(n(54019)),a=n(87735);function s(e){return e&&e.__esModule?e:{default:e}}var l={force_decimal:!1,decimal_digits:"1,",locale:"en-US"},c=["","-","+"];e.exports=t.default,e.exports.default=t.default},47341:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,i.default)(e),(0,o.default)(e)%parseInt(t,10)==0};var i=r(n(76041)),o=r(n(92774));function r(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default,e.exports.default=t.default},50887:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){(0,o.default)(e);var t=Number(e.slice(-1));return s.test(e)&&t===(n=e,i=10-n.slice(0,-1).split("").map((function(e,t){return Number(e)*function(e,t){return e===r||e===a?t%2==0?3:1:t%2==0?1:3}(n.length,t)})).reduce((function(e,t){return e+t}),0)%10,i<10?i:0);var n,i};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=8,a=14,s=/^(\d{8}|\d{13}|\d{14})$/;e.exports=t.default,e.exports.default=t.default},46299:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,i.default)(e),(t=(0,o.default)(t,c)).require_display_name||t.allow_display_name){var n=e.match(u);if(n){var l=n[1];if(e=e.replace(l,"").replace(/(^<|>$)/g,""),l.endsWith(" ")&&(l=l.slice(0,-1)),!function(e){var t=e.replace(/^"(.+)"$/,"$1");if(!t.trim())return!1;if(/[\.";<>]/.test(t)){if(t===e)return!1;if(!(t.split('"').length===t.split('\\"').length))return!1}return!0}(l))return!1}else if(t.require_display_name)return!1}if(!t.ignore_max_length&&e.length>f)return!1;var g=e.split("@"),b=g.pop(),y=b.toLowerCase();if(t.host_blacklist.includes(y))return!1;if(t.host_whitelist.length>0&&!t.host_whitelist.includes(y))return!1;var v=g.join("@");if(t.domain_specific_validation&&("gmail.com"===y||"googlemail.com"===y)){var E=(v=v.toLowerCase()).split("+")[0];if(!(0,r.default)(E.replace(/\./g,""),{min:6,max:30}))return!1;for(var k=E.split("."),A=0;A<k.length;A++)if(!m.test(k[A]))return!1}if(!(!1!==t.ignore_max_length||(0,r.default)(v,{max:64})&&(0,r.default)(b,{max:254})))return!1;if(!(0,a.default)(b,{require_tld:t.require_tld,ignore_max_length:t.ignore_max_length})){if(!t.allow_ip_domain)return!1;if(!(0,s.default)(b)){if(!b.startsWith("[")||!b.endsWith("]"))return!1;var T=b.slice(1,-1);if(0===T.length||!(0,s.default)(T))return!1}}if('"'===v[0])return v=v.slice(1,v.length-1),t.allow_utf8_local_part?_.test(v):h.test(v);for(var w=t.allow_utf8_local_part?p:d,L=v.split("."),D=0;D<L.length;D++)if(!w.test(L[D]))return!1;if(t.blacklisted_chars&&-1!==v.search(new RegExp("[".concat(t.blacklisted_chars,"]+"),"g")))return!1;return!0};var i=l(n(76041)),o=l(n(92372)),r=l(n(14189)),a=l(n(57780)),s=l(n(3246));function l(e){return e&&e.__esModule?e:{default:e}}var c={allow_display_name:!1,require_display_name:!1,allow_utf8_local_part:!0,require_tld:!0,blacklisted_chars:"",ignore_max_length:!1,host_blacklist:[],host_whitelist:[]},u=/^([^\x00-\x1F\x7F-\x9F\cX]+)</i,d=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~]+$/i,m=/^[a-z\d]+$/,h=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f]))*$/i,p=/^[a-z\d!#\$%&'\*\+\-\/=\?\^_`{\|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+$/i,_=/^([\s\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|(\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*$/i,f=254;e.exports=t.default,e.exports.default=t.default},68926:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,i.default)(e),0===((t=(0,o.default)(t,a)).ignore_whitespace?e.trim().length:e.length)};var i=r(n(76041)),o=r(n(92372));function r(e){return e&&e.__esModule?e:{default:e}}var a={ignore_whitespace:!1};e.exports=t.default,e.exports.default=t.default},1808:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^(0x)[0-9a-f]{40}$/i;e.exports=t.default,e.exports.default=t.default},57780:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,i.default)(e),(t=(0,o.default)(t,a)).allow_trailing_dot&&"."===e[e.length-1]&&(e=e.substring(0,e.length-1));!0===t.allow_wildcard&&0===e.indexOf("*.")&&(e=e.substring(2));var n=e.split("."),r=n[n.length-1];if(t.require_tld){if(n.length<2)return!1;if(!t.allow_numeric_tld&&!/^([a-z\u00A1-\u00A8\u00AA-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}|xn[a-z0-9-]{2,})$/i.test(r))return!1;if(/\s/.test(r))return!1}if(!t.allow_numeric_tld&&/^\d+$/.test(r))return!1;return n.every((function(e){return!(e.length>63&&!t.ignore_max_length)&&(!!/^[a-z_\u00a1-\uffff0-9-]+$/i.test(e)&&(!/[\uff01-\uff5e]/.test(e)&&(!/^-|-$/.test(e)&&!(!t.allow_underscores&&/_/.test(e)))))}))};var i=r(n(76041)),o=r(n(92372));function r(e){return e&&e.__esModule?e:{default:e}}var a={require_tld:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_numeric_tld:!1,allow_wildcard:!1,ignore_max_length:!1};e.exports=t.default,e.exports.default=t.default},30545:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,o.default)(e),t=t||{};var n=new RegExp("^(?:[-+])?(?:[0-9]+)?(?:\\".concat(t.locale?r.decimal[t.locale]:".","[0-9]*)?(?:[eE][\\+\\-]?(?:[0-9]+))?$"));if(""===e||"."===e||","===e||"-"===e||"+"===e)return!1;var i=parseFloat(e.replace(",","."));return n.test(e)&&(!t.hasOwnProperty("min")||i>=t.min)&&(!t.hasOwnProperty("max")||i<=t.max)&&(!t.hasOwnProperty("lt")||i<t.lt)&&(!t.hasOwnProperty("gt")||i>t.gt)},t.locales=void 0;var i,o=(i=n(76041))&&i.__esModule?i:{default:i},r=n(87735);var a=Object.keys(r.decimal);t.locales=a},93200:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.test(e)},t.fullWidth=void 0;var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/[^\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/;t.fullWidth=r},85400:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){(0,o.default)(e);var t=e.replace(/\s+/g," ").replace(/\s?(hsla?\(|\)|,)\s?/gi,"$1");if(-1!==t.indexOf(","))return r.test(t);return a.test(t)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^hsla?\(((\+|\-)?([0-9]+(\.[0-9]+)?(e(\+|\-)?[0-9]+)?|\.[0-9]+(e(\+|\-)?[0-9]+)?))(deg|grad|rad|turn)?(,(\+|\-)?([0-9]+(\.[0-9]+)?(e(\+|\-)?[0-9]+)?|\.[0-9]+(e(\+|\-)?[0-9]+)?)%){2}(,((\+|\-)?([0-9]+(\.[0-9]+)?(e(\+|\-)?[0-9]+)?|\.[0-9]+(e(\+|\-)?[0-9]+)?)%?))?\)$/i,a=/^hsla?\(((\+|\-)?([0-9]+(\.[0-9]+)?(e(\+|\-)?[0-9]+)?|\.[0-9]+(e(\+|\-)?[0-9]+)?))(deg|grad|rad|turn)?(\s(\+|\-)?([0-9]+(\.[0-9]+)?(e(\+|\-)?[0-9]+)?|\.[0-9]+(e(\+|\-)?[0-9]+)?)%){2}\s?(\/\s((\+|\-)?([0-9]+(\.[0-9]+)?(e(\+|\-)?[0-9]+)?|\.[0-9]+(e(\+|\-)?[0-9]+)?)%?)\s?)?\)$/i;e.exports=t.default,e.exports.default=t.default},39020:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.test(e)},t.halfWidth=void 0;var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/[\u0020-\u007E\uFF61-\uFF9F\uFFA0-\uFFDC\uFFE8-\uFFEE0-9a-zA-Z]/;t.halfWidth=r},16259:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,o.default)(e),new RegExp("^[a-fA-F0-9]{".concat(r[t],"}$")).test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r={md5:32,md4:32,sha1:40,sha256:64,sha384:96,sha512:128,ripemd128:32,ripemd160:40,tiger128:32,tiger160:40,tiger192:48,crc32:8,crc32b:8};e.exports=t.default,e.exports.default=t.default},72035:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^#?([0-9A-F]{3}|[0-9A-F]{4}|[0-9A-F]{6}|[0-9A-F]{8})$/i;e.exports=t.default,e.exports.default=t.default},13836:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^(0x|0h)?[0-9A-F]+$/i;e.exports=t.default,e.exports.default=t.default},44355:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),function(e){var t=e.replace(/[\s\-]+/gi,"").toUpperCase(),n=t.slice(0,2).toUpperCase();return n in r&&r[n].test(t)}(e)&&function(e){var t=e.replace(/[^A-Z0-9]+/gi,"").toUpperCase();return 1===(t.slice(4)+t.slice(0,4)).replace(/[A-Z]/g,(function(e){return e.charCodeAt(0)-55})).match(/\d{1,7}/g).reduce((function(e,t){return Number(e+t)%97}),"")}(e)},t.locales=void 0;var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r={AD:/^(AD[0-9]{2})\d{8}[A-Z0-9]{12}$/,AE:/^(AE[0-9]{2})\d{3}\d{16}$/,AL:/^(AL[0-9]{2})\d{8}[A-Z0-9]{16}$/,AT:/^(AT[0-9]{2})\d{16}$/,AZ:/^(AZ[0-9]{2})[A-Z0-9]{4}\d{20}$/,BA:/^(BA[0-9]{2})\d{16}$/,BE:/^(BE[0-9]{2})\d{12}$/,BG:/^(BG[0-9]{2})[A-Z]{4}\d{6}[A-Z0-9]{8}$/,BH:/^(BH[0-9]{2})[A-Z]{4}[A-Z0-9]{14}$/,BR:/^(BR[0-9]{2})\d{23}[A-Z]{1}[A-Z0-9]{1}$/,BY:/^(BY[0-9]{2})[A-Z0-9]{4}\d{20}$/,CH:/^(CH[0-9]{2})\d{5}[A-Z0-9]{12}$/,CR:/^(CR[0-9]{2})\d{18}$/,CY:/^(CY[0-9]{2})\d{8}[A-Z0-9]{16}$/,CZ:/^(CZ[0-9]{2})\d{20}$/,DE:/^(DE[0-9]{2})\d{18}$/,DK:/^(DK[0-9]{2})\d{14}$/,DO:/^(DO[0-9]{2})[A-Z]{4}\d{20}$/,EE:/^(EE[0-9]{2})\d{16}$/,EG:/^(EG[0-9]{2})\d{25}$/,ES:/^(ES[0-9]{2})\d{20}$/,FI:/^(FI[0-9]{2})\d{14}$/,FO:/^(FO[0-9]{2})\d{14}$/,FR:/^(FR[0-9]{2})\d{10}[A-Z0-9]{11}\d{2}$/,GB:/^(GB[0-9]{2})[A-Z]{4}\d{14}$/,GE:/^(GE[0-9]{2})[A-Z0-9]{2}\d{16}$/,GI:/^(GI[0-9]{2})[A-Z]{4}[A-Z0-9]{15}$/,GL:/^(GL[0-9]{2})\d{14}$/,GR:/^(GR[0-9]{2})\d{7}[A-Z0-9]{16}$/,GT:/^(GT[0-9]{2})[A-Z0-9]{4}[A-Z0-9]{20}$/,HR:/^(HR[0-9]{2})\d{17}$/,HU:/^(HU[0-9]{2})\d{24}$/,IE:/^(IE[0-9]{2})[A-Z0-9]{4}\d{14}$/,IL:/^(IL[0-9]{2})\d{19}$/,IQ:/^(IQ[0-9]{2})[A-Z]{4}\d{15}$/,IR:/^(IR[0-9]{2})0\d{2}0\d{18}$/,IS:/^(IS[0-9]{2})\d{22}$/,IT:/^(IT[0-9]{2})[A-Z]{1}\d{10}[A-Z0-9]{12}$/,JO:/^(JO[0-9]{2})[A-Z]{4}\d{22}$/,KW:/^(KW[0-9]{2})[A-Z]{4}[A-Z0-9]{22}$/,KZ:/^(KZ[0-9]{2})\d{3}[A-Z0-9]{13}$/,LB:/^(LB[0-9]{2})\d{4}[A-Z0-9]{20}$/,LC:/^(LC[0-9]{2})[A-Z]{4}[A-Z0-9]{24}$/,LI:/^(LI[0-9]{2})\d{5}[A-Z0-9]{12}$/,LT:/^(LT[0-9]{2})\d{16}$/,LU:/^(LU[0-9]{2})\d{3}[A-Z0-9]{13}$/,LV:/^(LV[0-9]{2})[A-Z]{4}[A-Z0-9]{13}$/,MC:/^(MC[0-9]{2})\d{10}[A-Z0-9]{11}\d{2}$/,MD:/^(MD[0-9]{2})[A-Z0-9]{20}$/,ME:/^(ME[0-9]{2})\d{18}$/,MK:/^(MK[0-9]{2})\d{3}[A-Z0-9]{10}\d{2}$/,MR:/^(MR[0-9]{2})\d{23}$/,MT:/^(MT[0-9]{2})[A-Z]{4}\d{5}[A-Z0-9]{18}$/,MU:/^(MU[0-9]{2})[A-Z]{4}\d{19}[A-Z]{3}$/,MZ:/^(MZ[0-9]{2})\d{21}$/,NL:/^(NL[0-9]{2})[A-Z]{4}\d{10}$/,NO:/^(NO[0-9]{2})\d{11}$/,PK:/^(PK[0-9]{2})[A-Z0-9]{4}\d{16}$/,PL:/^(PL[0-9]{2})\d{24}$/,PS:/^(PS[0-9]{2})[A-Z0-9]{4}\d{21}$/,PT:/^(PT[0-9]{2})\d{21}$/,QA:/^(QA[0-9]{2})[A-Z]{4}[A-Z0-9]{21}$/,RO:/^(RO[0-9]{2})[A-Z]{4}[A-Z0-9]{16}$/,RS:/^(RS[0-9]{2})\d{18}$/,SA:/^(SA[0-9]{2})\d{2}[A-Z0-9]{18}$/,SC:/^(SC[0-9]{2})[A-Z]{4}\d{20}[A-Z]{3}$/,SE:/^(SE[0-9]{2})\d{20}$/,SI:/^(SI[0-9]{2})\d{15}$/,SK:/^(SK[0-9]{2})\d{20}$/,SM:/^(SM[0-9]{2})[A-Z]{1}\d{10}[A-Z0-9]{12}$/,SV:/^(SV[0-9]{2})[A-Z0-9]{4}\d{20}$/,TL:/^(TL[0-9]{2})\d{19}$/,TN:/^(TN[0-9]{2})\d{20}$/,TR:/^(TR[0-9]{2})\d{5}[A-Z0-9]{17}$/,UA:/^(UA[0-9]{2})\d{6}[A-Z0-9]{19}$/,VA:/^(VA[0-9]{2})\d{18}$/,VG:/^(VG[0-9]{2})[A-Z0-9]{4}\d{16}$/,XK:/^(XK[0-9]{2})\d{16}$/};var a=Object.keys(r);t.locales=a},81391:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,o.default)(e);var n=r;(t=t||{}).allow_hyphens&&(n=a);if(!n.test(e))return!1;e=e.replace(/-/g,"");for(var i=0,s=2,l=0;l<14;l++){var c=e.substring(14-l-1,14-l),u=parseInt(c,10)*s;i+=u>=10?u%10+1:u,1===s?s+=1:s-=1}if((10-i%10)%10!==parseInt(e.substring(14,15),10))return!1;return!0};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^[0-9]{15}$/,a=/^\d{2}-\d{6}-\d{6}-\d{1}$/;e.exports=t.default,e.exports.default=t.default},3246:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if((0,o.default)(t),!(n=String(n)))return e(t,4)||e(t,6);if("4"===n)return s.test(t);if("6"===n)return c.test(t);return!1};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",a="(".concat(r,"[.]){3}").concat(r),s=new RegExp("^".concat(a,"$")),l="(?:[0-9a-fA-F]{1,4})",c=new RegExp("^("+"(?:".concat(l,":){7}(?:").concat(l,"|:)|")+"(?:".concat(l,":){6}(?:").concat(a,"|:").concat(l,"|:)|")+"(?:".concat(l,":){5}(?::").concat(a,"|(:").concat(l,"){1,2}|:)|")+"(?:".concat(l,":){4}(?:(:").concat(l,"){0,1}:").concat(a,"|(:").concat(l,"){1,3}|:)|")+"(?:".concat(l,":){3}(?:(:").concat(l,"){0,2}:").concat(a,"|(:").concat(l,"){1,4}|:)|")+"(?:".concat(l,":){2}(?:(:").concat(l,"){0,3}:").concat(a,"|(:").concat(l,"){1,5}|:)|")+"(?:".concat(l,":){1}(?:(:").concat(l,"){0,4}:").concat(a,"|(:").concat(l,"){1,6}|:)|")+"(?::((?::".concat(l,"){0,5}:").concat(a,"|(?::").concat(l,"){1,7}|:))")+")(%[0-9a-zA-Z-.:]{1,})?$");e.exports=t.default,e.exports.default=t.default},1741:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";(0,i.default)(e);var n=e.split("/");if(2!==n.length)return!1;if(!a.test(n[1]))return!1;if(n[1].length>1&&n[1].startsWith("0"))return!1;if(!(0,o.default)(n[0],t))return!1;var r=null;switch(String(t)){case"4":r=s;break;case"6":r=l;break;default:r=(0,o.default)(n[0],"6")?l:s}return n[1]<=r&&n[1]>=0};var i=r(n(76041)),o=r(n(3246));function r(e){return e&&e.__esModule?e:{default:e}}var a=/^\d{1,3}$/,s=32,l=128;e.exports=t.default,e.exports.default=t.default},64163:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){(0,o.default)(t);var i=String((null==n?void 0:n.version)||n);if(!(null!=n&&n.version||n))return e(t,{version:10})||e(t,{version:13});var l=t.replace(/[\s-]+/g,""),c=0;if("10"===i){if(!r.test(l))return!1;for(var u=0;u<i-1;u++)c+=(u+1)*l.charAt(u);if("X"===l.charAt(9)?c+=100:c+=10*l.charAt(9),c%11==0)return!0}else if("13"===i){if(!a.test(l))return!1;for(var d=0;d<12;d++)c+=s[d%2]*l.charAt(d);if(l.charAt(12)-(10-c%10)%10==0)return!0}return!1};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^(?:[0-9]{9}X|[0-9]{10})$/,a=/^(?:[0-9]{13})$/,s=[1,3];e.exports=t.default,e.exports.default=t.default},78584:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if((0,o.default)(e),!r.test(e))return!1;for(var t=!0,n=0,i=e.length-2;i>=0;i--)if(e[i]>="A"&&e[i]<="Z")for(var a=e[i].charCodeAt(0)-55,s=0,l=[a%10,Math.trunc(a/10)];s<l.length;s++){var c=l[s];n+=t?c>=5?1+2*(c-5):2*c:c,t=!t}else{var u=e[i].charCodeAt(0)-"0".charCodeAt(0);n+=t?u>=5?1+2*(u-5):2*u:u,t=!t}var d=10*Math.trunc((n+9)/10)-n;return+e[e.length-1]===d};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^[A-Z]{2}[0-9A-Z]{9}[0-9]$/;e.exports=t.default,e.exports.default=t.default},78678:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.has(e.toUpperCase())},t.CountryCodes=void 0;var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=new Set(["AD","AE","AF","AG","AI","AL","AM","AO","AQ","AR","AS","AT","AU","AW","AX","AZ","BA","BB","BD","BE","BF","BG","BH","BI","BJ","BL","BM","BN","BO","BQ","BR","BS","BT","BV","BW","BY","BZ","CA","CC","CD","CF","CG","CH","CI","CK","CL","CM","CN","CO","CR","CU","CV","CW","CX","CY","CZ","DE","DJ","DK","DM","DO","DZ","EC","EE","EG","EH","ER","ES","ET","FI","FJ","FK","FM","FO","FR","GA","GB","GD","GE","GF","GG","GH","GI","GL","GM","GN","GP","GQ","GR","GS","GT","GU","GW","GY","HK","HM","HN","HR","HT","HU","ID","IE","IL","IM","IN","IO","IQ","IR","IS","IT","JE","JM","JO","JP","KE","KG","KH","KI","KM","KN","KP","KR","KW","KY","KZ","LA","LB","LC","LI","LK","LR","LS","LT","LU","LV","LY","MA","MC","MD","ME","MF","MG","MH","MK","ML","MM","MN","MO","MP","MQ","MR","MS","MT","MU","MV","MW","MX","MY","MZ","NA","NC","NE","NF","NG","NI","NL","NO","NP","NR","NU","NZ","OM","PA","PE","PF","PG","PH","PK","PL","PM","PN","PR","PS","PT","PW","PY","QA","RE","RO","RS","RU","RW","SA","SB","SC","SD","SE","SG","SH","SI","SJ","SK","SL","SM","SN","SO","SR","SS","ST","SV","SX","SY","SZ","TC","TD","TF","TG","TH","TJ","TK","TL","TM","TN","TO","TR","TT","TV","TW","TZ","UA","UG","UM","US","UY","UZ","VA","VC","VE","VG","VI","VN","VU","WF","WS","YE","YT","ZA","ZM","ZW"]);var a=r;t.CountryCodes=a},1242:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.has(e.toUpperCase())};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=new Set(["AFG","ALA","ALB","DZA","ASM","AND","AGO","AIA","ATA","ATG","ARG","ARM","ABW","AUS","AUT","AZE","BHS","BHR","BGD","BRB","BLR","BEL","BLZ","BEN","BMU","BTN","BOL","BES","BIH","BWA","BVT","BRA","IOT","BRN","BGR","BFA","BDI","KHM","CMR","CAN","CPV","CYM","CAF","TCD","CHL","CHN","CXR","CCK","COL","COM","COG","COD","COK","CRI","CIV","HRV","CUB","CUW","CYP","CZE","DNK","DJI","DMA","DOM","ECU","EGY","SLV","GNQ","ERI","EST","ETH","FLK","FRO","FJI","FIN","FRA","GUF","PYF","ATF","GAB","GMB","GEO","DEU","GHA","GIB","GRC","GRL","GRD","GLP","GUM","GTM","GGY","GIN","GNB","GUY","HTI","HMD","VAT","HND","HKG","HUN","ISL","IND","IDN","IRN","IRQ","IRL","IMN","ISR","ITA","JAM","JPN","JEY","JOR","KAZ","KEN","KIR","PRK","KOR","KWT","KGZ","LAO","LVA","LBN","LSO","LBR","LBY","LIE","LTU","LUX","MAC","MKD","MDG","MWI","MYS","MDV","MLI","MLT","MHL","MTQ","MRT","MUS","MYT","MEX","FSM","MDA","MCO","MNG","MNE","MSR","MAR","MOZ","MMR","NAM","NRU","NPL","NLD","NCL","NZL","NIC","NER","NGA","NIU","NFK","MNP","NOR","OMN","PAK","PLW","PSE","PAN","PNG","PRY","PER","PHL","PCN","POL","PRT","PRI","QAT","REU","ROU","RUS","RWA","BLM","SHN","KNA","LCA","MAF","SPM","VCT","WSM","SMR","STP","SAU","SEN","SRB","SYC","SLE","SGP","SXM","SVK","SVN","SLB","SOM","ZAF","SGS","SSD","ESP","LKA","SDN","SUR","SJM","SWZ","SWE","CHE","SYR","TWN","TJK","TZA","THA","TLS","TGO","TKL","TON","TTO","TUN","TUR","TKM","TCA","TUV","UGA","UKR","ARE","GBR","USA","UMI","URY","UZB","VUT","VEN","VNM","VGB","VIR","WLF","ESH","YEM","ZMB","ZWE"]);e.exports=t.default,e.exports.default=t.default},51772:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.has(e.toUpperCase())},t.CurrencyCodes=void 0;var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=new Set(["AED","AFN","ALL","AMD","ANG","AOA","ARS","AUD","AWG","AZN","BAM","BBD","BDT","BGN","BHD","BIF","BMD","BND","BOB","BOV","BRL","BSD","BTN","BWP","BYN","BZD","CAD","CDF","CHE","CHF","CHW","CLF","CLP","CNY","COP","COU","CRC","CUC","CUP","CVE","CZK","DJF","DKK","DOP","DZD","EGP","ERN","ETB","EUR","FJD","FKP","GBP","GEL","GHS","GIP","GMD","GNF","GTQ","GYD","HKD","HNL","HRK","HTG","HUF","IDR","ILS","INR","IQD","IRR","ISK","JMD","JOD","JPY","KES","KGS","KHR","KMF","KPW","KRW","KWD","KYD","KZT","LAK","LBP","LKR","LRD","LSL","LYD","MAD","MDL","MGA","MKD","MMK","MNT","MOP","MRU","MUR","MVR","MWK","MXN","MXV","MYR","MZN","NAD","NGN","NIO","NOK","NPR","NZD","OMR","PAB","PEN","PGK","PHP","PKR","PLN","PYG","QAR","RON","RSD","RUB","RWF","SAR","SBD","SCR","SDG","SEK","SGD","SHP","SLL","SOS","SRD","SSP","STN","SVC","SYP","SZL","THB","TJS","TMT","TND","TOP","TRY","TTD","TWD","TZS","UAH","UGX","USD","USN","UYI","UYU","UYW","UZS","VES","VND","VUV","WST","XAF","XAG","XAU","XBA","XBB","XBC","XBD","XCD","XDR","XOF","XPD","XPF","XPT","XSU","XTS","XUA","XXX","YER","ZAR","ZMW","ZWL"]);var a=r;t.CurrencyCodes=a},99415:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.has(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=new Set(["aa","ab","ae","af","ak","am","an","ar","as","av","ay","az","az","ba","be","bg","bh","bi","bm","bn","bo","br","bs","ca","ce","ch","co","cr","cs","cu","cv","cy","da","de","dv","dz","ee","el","en","eo","es","et","eu","fa","ff","fi","fj","fo","fr","fy","ga","gd","gl","gn","gu","gv","ha","he","hi","ho","hr","ht","hu","hy","hz","ia","id","ie","ig","ii","ik","io","is","it","iu","ja","jv","ka","kg","ki","kj","kk","kl","km","kn","ko","kr","ks","ku","kv","kw","ky","la","lb","lg","li","ln","lo","lt","lu","lv","mg","mh","mi","mk","ml","mn","mr","ms","mt","my","na","nb","nd","ne","ng","nl","nn","no","nr","nv","ny","oc","oj","om","or","os","pa","pi","pl","ps","pt","qu","rm","rn","ro","ru","rw","sa","sc","sd","se","sg","si","sk","sl","sm","sn","so","sq","sr","ss","st","su","sv","sw","ta","te","tg","th","ti","tk","tl","tn","to","tr","ts","tt","tw","ty","ug","uk","ur","uz","ve","vi","vo","wa","wo","xh","yi","yo","za","zh","zu"]);e.exports=t.default,e.exports.default=t.default},59067:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,o.default)(e);var n=t.strictSeparator?a.test(e):r.test(e);return n&&t.strict?s(e):n};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-3])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,a=/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-3])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T]((([01]\d|2[0-3])((:?)[0-5]\d)?|24:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/,s=function(e){var t=e.match(/^(\d{4})-?(\d{3})([ T]{1}\.*|$)/);if(t){var n=Number(t[1]),i=Number(t[2]);return n%4==0&&n%100!=0||n%400==0?i<=366:i<=365}var o=e.match(/(\d{4})-?(\d{0,2})-?(\d*)/).map(Number),r=o[1],a=o[2],s=o[3],l=a?"0".concat(a).slice(-2):a,c=s?"0".concat(s).slice(-2):s,u=new Date("".concat(r,"-").concat(l||"01","-").concat(c||"01"));return!a||!s||u.getUTCFullYear()===r&&u.getUTCMonth()+1===a&&u.getUTCDate()===s};e.exports=t.default,e.exports.default=t.default},52168:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^[A-Z]{2}[0-9A-Z]{3}\d{2}\d{5}$/;e.exports=t.default,e.exports.default=t.default},3106:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,o.default)(e);var n=r;if(n=t.require_hyphen?n.replace("?",""):n,!(n=t.case_sensitive?new RegExp(n):new RegExp(n,"i")).test(e))return!1;for(var i=e.replace("-","").toUpperCase(),a=0,s=0;s<i.length;s++){var l=i[s];a+=("X"===l?10:+l)*(8-s)}return a%11==0};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r="^\\d{4}-?\\d{3}[\\dX]$";e.exports=t.default,e.exports.default=t.default},11307:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,i.default)(e),t in a)return a[t](e);if("any"===t){for(var n in a){if(a.hasOwnProperty(n))if((0,a[n])(e))return!0}return!1}throw new Error("Invalid locale '".concat(t,"'"))};var i=r(n(76041)),o=r(n(40798));function r(e){return e&&e.__esModule?e:{default:e}}var a={PL:function(e){(0,i.default)(e);var t={1:1,2:3,3:7,4:9,5:1,6:3,7:7,8:9,9:1,10:3,11:0};if(null!=e&&11===e.length&&(0,o.default)(e,{allow_leading_zeroes:!0})){var n=e.split("").slice(0,-1).reduce((function(e,n,i){return e+Number(n)*t[i+1]}),0)%10,r=Number(e.charAt(e.length-1));if(0===n&&0===r||r===10-n)return!0}return!1},ES:function(e){(0,i.default)(e);var t={X:0,Y:1,Z:2},n=e.trim().toUpperCase();if(!/^[0-9X-Z][0-9]{7}[TRWAGMYFPDXBNJZSQVHLCKE]$/.test(n))return!1;var o=n.slice(0,-1).replace(/[X,Y,Z]/g,(function(e){return t[e]}));return n.endsWith(["T","R","W","A","G","M","Y","F","P","D","X","B","N","J","Z","S","Q","V","H","L","C","K","E"][o%23])},FI:function(e){if((0,i.default)(e),11!==e.length)return!1;if(!e.match(/^\d{6}[\-A\+]\d{3}[0-9ABCDEFHJKLMNPRSTUVWXY]{1}$/))return!1;return"0123456789ABCDEFHJKLMNPRSTUVWXY"[(1e3*parseInt(e.slice(0,6),10)+parseInt(e.slice(7,10),10))%31]===e.slice(10,11)},IN:function(e){var t=[[0,1,2,3,4,5,6,7,8,9],[1,2,3,4,0,6,7,8,9,5],[2,3,4,0,1,7,8,9,5,6],[3,4,0,1,2,8,9,5,6,7],[4,0,1,2,3,9,5,6,7,8],[5,9,8,7,6,0,4,3,2,1],[6,5,9,8,7,1,0,4,3,2],[7,6,5,9,8,2,1,0,4,3],[8,7,6,5,9,3,2,1,0,4],[9,8,7,6,5,4,3,2,1,0]],n=[[0,1,2,3,4,5,6,7,8,9],[1,5,7,6,2,8,3,0,9,4],[5,8,0,3,7,9,6,1,4,2],[8,9,1,6,0,4,3,5,2,7],[9,4,5,3,1,2,6,8,7,0],[4,2,8,6,5,7,3,9,0,1],[2,7,9,3,8,0,6,4,1,5],[7,0,4,6,9,1,3,2,5,8]],i=e.trim();if(!/^[1-9]\d{3}\s?\d{4}\s?\d{4}$/.test(i))return!1;var o=0;return i.replace(/\s/g,"").split("").map(Number).reverse().forEach((function(e,i){o=t[o][n[i%8][e]]})),0===o},IR:function(e){if(!e.match(/^\d{10}$/))return!1;if(e="0000".concat(e).slice(e.length-6),0===parseInt(e.slice(3,9),10))return!1;for(var t=parseInt(e.slice(9,10),10),n=0,i=0;i<9;i++)n+=parseInt(e.slice(i,i+1),10)*(10-i);return(n%=11)<2&&t===n||n>=2&&t===11-n},IT:function(e){return 9===e.length&&("CA00000AA"!==e&&e.search(/C[A-Z][0-9]{5}[A-Z]{2}/i)>-1)},NO:function(e){var t=e.trim();if(isNaN(Number(t)))return!1;if(11!==t.length)return!1;if("00000000000"===t)return!1;var n=t.split("").map(Number),i=(11-(3*n[0]+7*n[1]+6*n[2]+1*n[3]+8*n[4]+9*n[5]+4*n[6]+5*n[7]+2*n[8])%11)%11,o=(11-(5*n[0]+4*n[1]+3*n[2]+2*n[3]+7*n[4]+6*n[5]+5*n[6]+4*n[7]+3*n[8]+2*i)%11)%11;return i===n[9]&&o===n[10]},TH:function(e){if(!e.match(/^[1-8]\d{12}$/))return!1;for(var t=0,n=0;n<12;n++)t+=parseInt(e[n],10)*(13-n);return e[12]===((11-t%11)%10).toString()},LK:function(e){return!(10!==e.length||!/^[1-9]\d{8}[vx]$/i.test(e))||!(12!==e.length||!/^[1-9]\d{11}$/i.test(e))},"he-IL":function(e){var t=e.trim();if(!/^\d{9}$/.test(t))return!1;for(var n,i=t,o=0,r=0;r<i.length;r++)o+=(n=Number(i[r])*(r%2+1))>9?n-9:n;return o%10==0},"ar-LY":function(e){var t=e.trim();return!!/^(1|2)\d{11}$/.test(t)},"ar-TN":function(e){var t=e.trim();return!!/^\d{8}$/.test(t)},"zh-CN":function(e){var t,n=["11","12","13","14","15","21","22","23","31","32","33","34","35","36","37","41","42","43","44","45","46","50","51","52","53","54","61","62","63","64","65","71","81","82","91"],i=["7","9","10","5","8","4","2","1","6","3","7","9","10","5","8","4","2"],o=["1","0","X","9","8","7","6","5","4","3","2"],r=function(e){return n.includes(e)},a=function(e){var t=parseInt(e.substring(0,4),10),n=parseInt(e.substring(4,6),10),i=parseInt(e.substring(6),10),o=new Date(t,n-1,i);return!(o>new Date)&&(o.getFullYear()===t&&o.getMonth()===n-1&&o.getDate()===i)},s=function(e){return function(e){for(var t=e.substring(0,17),n=0,r=0;r<17;r++)n+=parseInt(t.charAt(r),10)*parseInt(i[r],10);return o[n%11]}(e)===e.charAt(17).toUpperCase()};return!!/^\d{15}|(\d{17}(\d|x|X))$/.test(t=e)&&(15===t.length?function(e){var t=/^[1-9]\d{7}((0[1-9])|(1[0-2]))((0[1-9])|([1-2][0-9])|(3[0-1]))\d{3}$/.test(e);if(!t)return!1;var n=e.substring(0,2);if(!(t=r(n)))return!1;var i="19".concat(e.substring(6,12));return!!(t=a(i))}(t):function(e){var t=/^[1-9]\d{5}[1-9]\d{3}((0[1-9])|(1[0-2]))((0[1-9])|([1-2][0-9])|(3[0-1]))\d{3}(\d|x|X)$/.test(e);if(!t)return!1;var n=e.substring(0,2);if(!(t=r(n)))return!1;var i=e.substring(6,14);return!!(t=a(i))&&s(e)}(t))},"zh-HK":function(e){var t=/^[0-9]$/;if(e=(e=e.trim()).toUpperCase(),!/^[A-Z]{1,2}[0-9]{6}((\([0-9A]\))|(\[[0-9A]\])|([0-9A]))$/.test(e))return!1;8===(e=e.replace(/\[|\]|\(|\)/g,"")).length&&(e="3".concat(e));for(var n=0,i=0;i<=7;i++){n+=(t.test(e[i])?e[i]:(e[i].charCodeAt(0)-55)%11)*(9-i)}return(0===(n%=11)?"0":1===n?"A":String(11-n))===e[e.length-1]},"zh-TW":function(e){var t={A:10,B:11,C:12,D:13,E:14,F:15,G:16,H:17,I:34,J:18,K:19,L:20,M:21,N:22,O:35,P:23,Q:24,R:25,S:26,T:27,U:28,V:29,W:32,X:30,Y:31,Z:33},n=e.trim().toUpperCase();return!!/^[A-Z][0-9]{9}$/.test(n)&&Array.from(n).reduce((function(e,n,i){if(0===i){var o=t[n];return o%10*9+Math.floor(o/10)}return 9===i?(10-e%10-Number(n))%10==0:e+Number(n)*(9-i)}),0)}};e.exports=t.default,e.exports.default=t.default},40800:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n;if((0,i.default)(e),"[object Array]"===Object.prototype.toString.call(t)){var r=[];for(n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=(0,o.default)(t[n]));return r.indexOf(e)>=0}if("object"===a(t))return t.hasOwnProperty(e);if(t&&"function"==typeof t.indexOf)return t.indexOf(e)>=0;return!1};var i=r(n(76041)),o=r(n(95894));function r(e){return e&&e.__esModule?e:{default:e}}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}e.exports=t.default,e.exports.default=t.default},40798:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,o.default)(e);var n=(t=t||{}).hasOwnProperty("allow_leading_zeroes")&&!t.allow_leading_zeroes?r:a,i=!t.hasOwnProperty("min")||e>=t.min,s=!t.hasOwnProperty("max")||e<=t.max,l=!t.hasOwnProperty("lt")||e<t.lt,c=!t.hasOwnProperty("gt")||e>t.gt;return n.test(e)&&i&&s&&l&&c};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^(?:[-+]?(?:0|[1-9][0-9]*))$/,a=/^[-+]?[0-9]+$/;e.exports=t.default,e.exports.default=t.default},49001:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,i.default)(e);try{t=(0,o.default)(t,s);var n=[];t.allow_primitives&&(n=[null,!1,!0]);var r=JSON.parse(e);return n.includes(r)||!!r&&"object"===a(r)}catch(e){}return!1};var i=r(n(76041)),o=r(n(92372));function r(e){return e&&e.__esModule?e:{default:e}}function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}var s={allow_primitives:!1};e.exports=t.default,e.exports.default=t.default},86546:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){(0,i.default)(e);var t=e.split("."),n=t.length;if(n>3||n<2)return!1;return t.reduce((function(e,t){return e&&(0,o.default)(t,{urlSafe:!0})}),!0)};var i=r(n(76041)),o=r(n(92232));function r(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default,e.exports.default=t.default},95856:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,i.default)(e),t=(0,o.default)(t,u),!e.includes(","))return!1;var n=e.split(",");if(n[0].startsWith("(")&&!n[1].endsWith(")")||n[1].endsWith(")")&&!n[0].startsWith("("))return!1;if(t.checkDMS)return l.test(n[0])&&c.test(n[1]);return a.test(n[0])&&s.test(n[1])};var i=r(n(76041)),o=r(n(92372));function r(e){return e&&e.__esModule?e:{default:e}}var a=/^\(?[+-]?(90(\.0+)?|[1-8]?\d(\.\d+)?)$/,s=/^\s?[+-]?(180(\.0+)?|1[0-7]\d(\.\d+)?|\d{1,2}(\.\d+)?)\)?$/,l=/^(([1-8]?\d)\D+([1-5]?\d|60)\D+([1-5]?\d|60)(\.\d+)?|90\D+0\D+0)\D+[NSns]?$/i,c=/^\s*([1-7]?\d{1,2}\D+([1-5]?\d|60)\D+([1-5]?\d|60)(\.\d+)?|180\D+0\D+0)\D+[EWew]?$/i,u={checkDMS:!1};e.exports=t.default,e.exports.default=t.default},5559:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n,i;(0,o.default)(e),"object"===r(t)?(n=t.min||0,i=t.max):(n=arguments[1]||0,i=arguments[2]);var a=e.match(/(\uFE0F|\uFE0E)/g)||[],s=e.match(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g)||[],l=e.length-a.length-s.length;return l>=n&&(void 0===i||l<=i)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}e.exports=t.default,e.exports.default=t.default},37634:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,o.default)(e),t in r)return r[t](e);if("any"===t){for(var n in r){if((0,r[n])(e))return!0}return!1}throw new Error("Invalid locale '".concat(t,"'"))};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r={"cs-CZ":function(e){return/^(([ABCDEFHIJKLMNPRSTUVXYZ]|[0-9])-?){5,8}$/.test(e)},"de-DE":function(e){return/^((A|AA|AB|AC|AE|AH|AK|AM|AN|AÖ|AP|AS|AT|AU|AW|AZ|B|BA|BB|BC|BE|BF|BH|BI|BK|BL|BM|BN|BO|BÖ|BS|BT|BZ|C|CA|CB|CE|CO|CR|CW|D|DA|DD|DE|DH|DI|DL|DM|DN|DO|DU|DW|DZ|E|EA|EB|ED|EE|EF|EG|EH|EI|EL|EM|EN|ER|ES|EU|EW|F|FB|FD|FF|FG|FI|FL|FN|FO|FR|FS|FT|FÜ|FW|FZ|G|GA|GC|GD|GE|GF|GG|GI|GK|GL|GM|GN|GÖ|GP|GR|GS|GT|GÜ|GV|GW|GZ|H|HA|HB|HC|HD|HE|HF|HG|HH|HI|HK|HL|HM|HN|HO|HP|HR|HS|HU|HV|HX|HY|HZ|IK|IL|IN|IZ|J|JE|JL|K|KA|KB|KC|KE|KF|KG|KH|KI|KK|KL|KM|KN|KO|KR|KS|KT|KU|KW|KY|L|LA|LB|LC|LD|LF|LG|LH|LI|LL|LM|LN|LÖ|LP|LR|LU|M|MA|MB|MC|MD|ME|MG|MH|MI|MK|ML|MM|MN|MO|MQ|MR|MS|MÜ|MW|MY|MZ|N|NB|ND|NE|NF|NH|NI|NK|NM|NÖ|NP|NR|NT|NU|NW|NY|NZ|OA|OB|OC|OD|OE|OF|OG|OH|OK|OL|OP|OS|OZ|P|PA|PB|PE|PF|PI|PL|PM|PN|PR|PS|PW|PZ|R|RA|RC|RD|RE|RG|RH|RI|RL|RM|RN|RO|RP|RS|RT|RU|RV|RW|RZ|S|SB|SC|SE|SG|SI|SK|SL|SM|SN|SO|SP|SR|ST|SU|SW|SY|SZ|TE|TF|TG|TO|TP|TR|TS|TT|TÜ|ÜB|UE|UH|UL|UM|UN|V|VB|VG|VK|VR|VS|W|WA|WB|WE|WF|WI|WK|WL|WM|WN|WO|WR|WS|WT|WÜ|WW|WZ|Z|ZE|ZI|ZP|ZR|ZW|ZZ)[- ]?[A-Z]{1,2}[- ]?\d{1,4}|(ABG|ABI|AIB|AIC|ALF|ALZ|ANA|ANG|ANK|APD|ARN|ART|ASL|ASZ|AUR|AZE|BAD|BAR|BBG|BCH|BED|BER|BGD|BGL|BID|BIN|BIR|BIT|BIW|BKS|BLB|BLK|BNA|BOG|BOH|BOR|BOT|BRA|BRB|BRG|BRK|BRL|BRV|BSB|BSK|BTF|BÜD|BUL|BÜR|BÜS|BÜZ|CAS|CHA|CLP|CLZ|COC|COE|CUX|DAH|DAN|DAU|DBR|DEG|DEL|DGF|DIL|DIN|DIZ|DKB|DLG|DON|DUD|DÜW|EBE|EBN|EBS|ECK|EIC|EIL|EIN|EIS|EMD|EMS|ERB|ERH|ERK|ERZ|ESB|ESW|FDB|FDS|FEU|FFB|FKB|FLÖ|FOR|FRG|FRI|FRW|FTL|FÜS|GAN|GAP|GDB|GEL|GEO|GER|GHA|GHC|GLA|GMN|GNT|GOA|GOH|GRA|GRH|GRI|GRM|GRZ|GTH|GUB|GUN|GVM|HAB|HAL|HAM|HAS|HBN|HBS|HCH|HDH|HDL|HEB|HEF|HEI|HER|HET|HGN|HGW|HHM|HIG|HIP|HMÜ|HOG|HOH|HOL|HOM|HOR|HÖS|HOT|HRO|HSK|HST|HVL|HWI|IGB|ILL|JÜL|KEH|KEL|KEM|KIB|KLE|KLZ|KÖN|KÖT|KÖZ|KRU|KÜN|KUS|KYF|LAN|LAU|LBS|LBZ|LDK|LDS|LEO|LER|LEV|LIB|LIF|LIP|LÖB|LOS|LRO|LSZ|LÜN|LUP|LWL|MAB|MAI|MAK|MAL|MED|MEG|MEI|MEK|MEL|MER|MET|MGH|MGN|MHL|MIL|MKK|MOD|MOL|MON|MOS|MSE|MSH|MSP|MST|MTK|MTL|MÜB|MÜR|MYK|MZG|NAB|NAI|NAU|NDH|NEA|NEB|NEC|NEN|NES|NEW|NMB|NMS|NOH|NOL|NOM|NOR|NVP|NWM|OAL|OBB|OBG|OCH|OHA|ÖHR|OHV|OHZ|OPR|OSL|OVI|OVL|OVP|PAF|PAN|PAR|PCH|PEG|PIR|PLÖ|PRÜ|QFT|QLB|RDG|REG|REH|REI|RID|RIE|ROD|ROF|ROK|ROL|ROS|ROT|ROW|RSL|RÜD|RÜG|SAB|SAD|SAN|SAW|SBG|SBK|SCZ|SDH|SDL|SDT|SEB|SEE|SEF|SEL|SFB|SFT|SGH|SHA|SHG|SHK|SHL|SIG|SIM|SLE|SLF|SLK|SLN|SLS|SLÜ|SLZ|SMÜ|SOB|SOG|SOK|SÖM|SON|SPB|SPN|SRB|SRO|STA|STB|STD|STE|STL|SUL|SÜW|SWA|SZB|TBB|TDO|TET|TIR|TÖL|TUT|UEM|UER|UFF|USI|VAI|VEC|VER|VIB|VIE|VIT|VOH|WAF|WAK|WAN|WAR|WAT|WBS|WDA|WEL|WEN|WER|WES|WHV|WIL|WIS|WIT|WIZ|WLG|WMS|WND|WOB|WOH|WOL|WOR|WOS|WRN|WSF|WST|WSW|WTL|WTM|WUG|WÜM|WUN|WUR|WZL|ZEL|ZIG)[- ]?(([A-Z][- ]?\d{1,4})|([A-Z]{2}[- ]?\d{1,3})))[- ]?(E|H)?$/.test(e)},"de-LI":function(e){return/^FL[- ]?\d{1,5}[UZ]?$/.test(e)},"en-IN":function(e){return/^[A-Z]{2}[ -]?[0-9]{1,2}(?:[ -]?[A-Z])(?:[ -]?[A-Z]*)?[ -]?[0-9]{4}$/.test(e)},"es-AR":function(e){return/^(([A-Z]{2} ?[0-9]{3} ?[A-Z]{2})|([A-Z]{3} ?[0-9]{3}))$/.test(e)},"fi-FI":function(e){return/^(?=.{4,7})(([A-Z]{1,3}|[0-9]{1,3})[\s-]?([A-Z]{1,3}|[0-9]{1,5}))$/.test(e)},"hu-HU":function(e){return/^((((?!AAA)(([A-NPRSTVZWXY]{1})([A-PR-Z]{1})([A-HJ-NPR-Z]))|(A[ABC]I)|A[ABC]O|A[A-W]Q|BPI|BPO|UCO|UDO|XAO)-(?!000)\d{3})|(M\d{6})|((CK|DT|CD|HC|H[ABEFIKLMNPRSTVX]|MA|OT|R[A-Z]) \d{2}-\d{2})|(CD \d{3}-\d{3})|(C-(C|X) \d{4})|(X-(A|B|C) \d{4})|(([EPVZ]-\d{5}))|(S A[A-Z]{2} \d{2})|(SP \d{2}-\d{2}))$/.test(e)},"pt-BR":function(e){return/^[A-Z]{3}[ -]?[0-9][A-Z][0-9]{2}|[A-Z]{3}[ -]?[0-9]{4}$/.test(e)},"pt-PT":function(e){return/^([A-Z]{2}|[0-9]{2})[ -·]?([A-Z]{2}|[0-9]{2})[ -·]?([A-Z]{2}|[0-9]{2})$/.test(e)},"sq-AL":function(e){return/^[A-Z]{2}[- ]?((\d{3}[- ]?(([A-Z]{2})|T))|(R[- ]?\d{3}))$/.test(e)},"sv-SE":function(e){return/^[A-HJ-PR-UW-Z]{3} ?[\d]{2}[A-HJ-PR-UW-Z1-9]$|(^[A-ZÅÄÖ ]{2,7}$)/.test(e.trim())}};e.exports=t.default,e.exports.default=t.default},60113:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if((0,o.default)(e),"en_US_POSIX"===e||"ca_ES_VALENCIA"===e)return!0;return r.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^[A-Za-z]{2,4}([_-]([A-Za-z]{4}|[\d]{3}))?([_-]([A-Za-z]{2}|[\d]{3}))?$/;e.exports=t.default,e.exports.default=t.default},18782:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),e===e.toLowerCase()};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},40235:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){(0,o.default)(e);for(var t,n,i,r=e.replace(/[- ]+/g,""),a=0,s=r.length-1;s>=0;s--)t=r.substring(s,s+1),n=parseInt(t,10),a+=i&&(n*=2)>=10?n%10+1:n,i=!i;return!(a%10!=0||!r)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},66510:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function e(t,n){(0,o.default)(t),null!=n&&n.eui&&(n.eui=String(n.eui));if(null!=n&&n.no_colons||null!=n&&n.no_separators)return"48"===n.eui?a.test(t):"64"===n.eui?c.test(t):a.test(t)||c.test(t);if("48"===(null==n?void 0:n.eui))return r.test(t)||s.test(t);if("64"===(null==n?void 0:n.eui))return l.test(t)||u.test(t);return e(t,{eui:"48"})||e(t,{eui:"64"})};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^(?:[0-9a-fA-F]{2}([-:\s]))([0-9a-fA-F]{2}\1){4}([0-9a-fA-F]{2})$/,a=/^([0-9a-fA-F]){12}$/,s=/^([0-9a-fA-F]{4}\.){2}([0-9a-fA-F]{4})$/,l=/^(?:[0-9a-fA-F]{2}([-:\s]))([0-9a-fA-F]{2}\1){6}([0-9a-fA-F]{2})$/,c=/^([0-9a-fA-F]){16}$/,u=/^([0-9a-fA-F]{4}\.){3}([0-9a-fA-F]{4})$/;e.exports=t.default,e.exports.default=t.default},34783:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^[a-f0-9]{32}$/;e.exports=t.default,e.exports.default=t.default},17663:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if((0,o.default)(e),0!==e.indexOf("magnet:?"))return!1;return r.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/(?:^magnet:\?|[^?&]&)xt(?:\.1)?=urn:(?:(?:aich|bitprint|btih|ed2k|ed2khash|kzhash|md5|sha1|tree:tiger):[a-z0-9]{32}(?:[a-z0-9]{8})?|btmh:1220[a-z0-9]{64})(?:$|&)/i;e.exports=t.default,e.exports.default=t.default},20267:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.test(e)||a.test(e)||s.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^(application|audio|font|image|message|model|multipart|text|video)\/[a-zA-Z0-9\.\-\+_]{1,100}$/i,a=/^text\/[a-zA-Z0-9\.\-\+]{1,100};\s?charset=("[a-zA-Z0-9\.\-\+\s]{0,70}"|[a-zA-Z0-9\.\-\+]{0,70})(\s?\([a-zA-Z0-9\.\-\+\s]{1,20}\))?$/i,s=/^multipart\/[a-zA-Z0-9\.\-\+]{1,100}(;\s?(boundary|charset)=("[a-zA-Z0-9\.\-\+\s]{0,70}"|[a-zA-Z0-9\.\-\+]{0,70})(\s?\([a-zA-Z0-9\.\-\+\s]{1,20}\))?){0,2}$/i;e.exports=t.default,e.exports.default=t.default},51969:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){if((0,o.default)(e),n&&n.strictMode&&!e.startsWith("+"))return!1;if(Array.isArray(t))return t.some((function(t){if(r.hasOwnProperty(t)&&r[t].test(e))return!0;return!1}));if(t in r)return r[t].test(e);if(!t||"any"===t){for(var i in r){if(r.hasOwnProperty(i))if(r[i].test(e))return!0}return!1}throw new Error("Invalid locale '".concat(t,"'"))},t.locales=void 0;var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r={"am-AM":/^(\+?374|0)((10|[9|7][0-9])\d{6}$|[2-4]\d{7}$)/,"ar-AE":/^((\+?971)|0)?5[024568]\d{7}$/,"ar-BH":/^(\+?973)?(3|6)\d{7}$/,"ar-DZ":/^(\+?213|0)(5|6|7)\d{8}$/,"ar-LB":/^(\+?961)?((3|81)\d{6}|7\d{7})$/,"ar-EG":/^((\+?20)|0)?1[0125]\d{8}$/,"ar-IQ":/^(\+?964|0)?7[0-9]\d{8}$/,"ar-JO":/^(\+?962|0)?7[789]\d{7}$/,"ar-KW":/^(\+?965)([569]\d{7}|41\d{6})$/,"ar-LY":/^((\+?218)|0)?(9[1-6]\d{7}|[1-8]\d{7,9})$/,"ar-MA":/^(?:(?:\+|00)212|0)[5-7]\d{8}$/,"ar-OM":/^((\+|00)968)?(9[1-9])\d{6}$/,"ar-PS":/^(\+?970|0)5[6|9](\d{7})$/,"ar-SA":/^(!?(\+?966)|0)?5\d{8}$/,"ar-SY":/^(!?(\+?963)|0)?9\d{8}$/,"ar-TN":/^(\+?216)?[2459]\d{7}$/,"az-AZ":/^(\+994|0)(10|5[015]|7[07]|99)\d{7}$/,"bs-BA":/^((((\+|00)3876)|06))((([0-3]|[5-6])\d{6})|(4\d{7}))$/,"be-BY":/^(\+?375)?(24|25|29|33|44)\d{7}$/,"bg-BG":/^(\+?359|0)?8[789]\d{7}$/,"bn-BD":/^(\+?880|0)1[13456789][0-9]{8}$/,"ca-AD":/^(\+376)?[346]\d{5}$/,"cs-CZ":/^(\+?420)? ?[1-9][0-9]{2} ?[0-9]{3} ?[0-9]{3}$/,"da-DK":/^(\+?45)?\s?\d{2}\s?\d{2}\s?\d{2}\s?\d{2}$/,"de-DE":/^((\+49|0)1)(5[0-25-9]\d|6([23]|0\d?)|7([0-57-9]|6\d))\d{7,9}$/,"de-AT":/^(\+43|0)\d{1,4}\d{3,12}$/,"de-CH":/^(\+41|0)([1-9])\d{1,9}$/,"de-LU":/^(\+352)?((6\d1)\d{6})$/,"dv-MV":/^(\+?960)?(7[2-9]|9[1-9])\d{5}$/,"el-GR":/^(\+?30|0)?6(8[5-9]|9(?![26])[0-9])\d{7}$/,"el-CY":/^(\+?357?)?(9(9|6)\d{6})$/,"en-AI":/^(\+?1|0)264(?:2(35|92)|4(?:6[1-2]|76|97)|5(?:3[6-9]|8[1-4])|7(?:2(4|9)|72))\d{4}$/,"en-AU":/^(\+?61|0)4\d{8}$/,"en-AG":/^(?:\+1|1)268(?:464|7(?:1[3-9]|[28]\d|3[0246]|64|7[0-689]))\d{4}$/,"en-BM":/^(\+?1)?441(((3|7)\d{6}$)|(5[0-3][0-9]\d{4}$)|(59\d{5}$))/,"en-BS":/^(\+?1[-\s]?|0)?\(?242\)?[-\s]?\d{3}[-\s]?\d{4}$/,"en-GB":/^(\+?44|0)7\d{9}$/,"en-GG":/^(\+?44|0)1481\d{6}$/,"en-GH":/^(\+233|0)(20|50|24|54|27|57|26|56|23|28|55|59)\d{7}$/,"en-GY":/^(\+592|0)6\d{6}$/,"en-HK":/^(\+?852[-\s]?)?[456789]\d{3}[-\s]?\d{4}$/,"en-MO":/^(\+?853[-\s]?)?[6]\d{3}[-\s]?\d{4}$/,"en-IE":/^(\+?353|0)8[356789]\d{7}$/,"en-IN":/^(\+?91|0)?[6789]\d{9}$/,"en-JM":/^(\+?876)?\d{7}$/,"en-KE":/^(\+?254|0)(7|1)\d{8}$/,"en-SS":/^(\+?211|0)(9[1257])\d{7}$/,"en-KI":/^((\+686|686)?)?( )?((6|7)(2|3|8)[0-9]{6})$/,"en-KN":/^(?:\+1|1)869(?:46\d|48[89]|55[6-8]|66\d|76[02-7])\d{4}$/,"en-LS":/^(\+?266)(22|28|57|58|59|27|52)\d{6}$/,"en-MT":/^(\+?356|0)?(99|79|77|21|27|22|25)[0-9]{6}$/,"en-MU":/^(\+?230|0)?\d{8}$/,"en-NA":/^(\+?264|0)(6|8)\d{7}$/,"en-NG":/^(\+?234|0)?[789]\d{9}$/,"en-NZ":/^(\+?64|0)[28]\d{7,9}$/,"en-PG":/^(\+?675|0)?(7\d|8[18])\d{6}$/,"en-PK":/^((00|\+)?92|0)3[0-6]\d{8}$/,"en-PH":/^(09|\+639)\d{9}$/,"en-RW":/^(\+?250|0)?[7]\d{8}$/,"en-SG":/^(\+65)?[3689]\d{7}$/,"en-SL":/^(\+?232|0)\d{8}$/,"en-TZ":/^(\+?255|0)?[67]\d{8}$/,"en-UG":/^(\+?256|0)?[7]\d{8}$/,"en-US":/^((\+1|1)?( |-)?)?(\([2-9][0-9]{2}\)|[2-9][0-9]{2})( |-)?([2-9][0-9]{2}( |-)?[0-9]{4})$/,"en-ZA":/^(\+?27|0)\d{9}$/,"en-ZM":/^(\+?26)?09[567]\d{7}$/,"en-ZW":/^(\+263)[0-9]{9}$/,"en-BW":/^(\+?267)?(7[1-8]{1})\d{6}$/,"es-AR":/^\+?549(11|[2368]\d)\d{8}$/,"es-BO":/^(\+?591)?(6|7)\d{7}$/,"es-CO":/^(\+?57)?3(0(0|1|2|4|5)|1\d|2[0-4]|5(0|1))\d{7}$/,"es-CL":/^(\+?56|0)[2-9]\d{1}\d{7}$/,"es-CR":/^(\+506)?[2-8]\d{7}$/,"es-CU":/^(\+53|0053)?5\d{7}/,"es-DO":/^(\+?1)?8[024]9\d{7}$/,"es-HN":/^(\+?504)?[9|8|3|2]\d{7}$/,"es-EC":/^(\+?593|0)([2-7]|9[2-9])\d{7}$/,"es-ES":/^(\+?34)?[6|7]\d{8}$/,"es-PE":/^(\+?51)?9\d{8}$/,"es-MX":/^(\+?52)?(1|01)?\d{10,11}$/,"es-NI":/^(\+?505)\d{7,8}$/,"es-PA":/^(\+?507)\d{7,8}$/,"es-PY":/^(\+?595|0)9[9876]\d{7}$/,"es-SV":/^(\+?503)?[67]\d{7}$/,"es-UY":/^(\+598|0)9[1-9][\d]{6}$/,"es-VE":/^(\+?58)?(2|4)\d{9}$/,"et-EE":/^(\+?372)?\s?(5|8[1-4])\s?([0-9]\s?){6,7}$/,"fa-IR":/^(\+?98[\-\s]?|0)9[0-39]\d[\-\s]?\d{3}[\-\s]?\d{4}$/,"fi-FI":/^(\+?358|0)\s?(4[0-6]|50)\s?(\d\s?){4,8}$/,"fj-FJ":/^(\+?679)?\s?\d{3}\s?\d{4}$/,"fo-FO":/^(\+?298)?\s?\d{2}\s?\d{2}\s?\d{2}$/,"fr-BF":/^(\+226|0)[67]\d{7}$/,"fr-BJ":/^(\+229)\d{8}$/,"fr-CD":/^(\+?243|0)?(8|9)\d{8}$/,"fr-CM":/^(\+?237)6[0-9]{8}$/,"fr-FR":/^(\+?33|0)[67]\d{8}$/,"fr-GF":/^(\+?594|0|00594)[67]\d{8}$/,"fr-GP":/^(\+?590|0|00590)[67]\d{8}$/,"fr-MQ":/^(\+?596|0|00596)[67]\d{8}$/,"fr-PF":/^(\+?689)?8[789]\d{6}$/,"fr-RE":/^(\+?262|0|00262)[67]\d{8}$/,"he-IL":/^(\+972|0)([23489]|5[012345689]|77)[1-9]\d{6}$/,"hu-HU":/^(\+?36|06)(20|30|31|50|70)\d{7}$/,"id-ID":/^(\+?62|0)8(1[123456789]|2[1238]|3[1238]|5[12356789]|7[78]|9[56789]|8[123456789])([\s?|\d]{5,11})$/,"ir-IR":/^(\+98|0)?9\d{9}$/,"it-IT":/^(\+?39)?\s?3\d{2} ?\d{6,7}$/,"it-SM":/^((\+378)|(0549)|(\+390549)|(\+3780549))?6\d{5,9}$/,"ja-JP":/^(\+81[ \-]?(\(0\))?|0)[6789]0[ \-]?\d{4}[ \-]?\d{4}$/,"ka-GE":/^(\+?995)?(79\d{7}|5\d{8})$/,"kk-KZ":/^(\+?7|8)?7\d{9}$/,"kl-GL":/^(\+?299)?\s?\d{2}\s?\d{2}\s?\d{2}$/,"ko-KR":/^((\+?82)[ \-]?)?0?1([0|1|6|7|8|9]{1})[ \-]?\d{3,4}[ \-]?\d{4}$/,"ky-KG":/^(\+?7\s?\+?7|0)\s?\d{2}\s?\d{3}\s?\d{4}$/,"lt-LT":/^(\+370|8)\d{8}$/,"lv-LV":/^(\+?371)2\d{7}$/,"mg-MG":/^((\+?261|0)(2|3)\d)?\d{7}$/,"mn-MN":/^(\+|00|011)?976(77|81|88|91|94|95|96|99)\d{6}$/,"my-MM":/^(\+?959|09|9)(2[5-7]|3[1-2]|4[0-5]|6[6-9]|7[5-9]|9[6-9])[0-9]{7}$/,"ms-MY":/^(\+?60|0)1(([0145](-|\s)?\d{7,8})|([236-9](-|\s)?\d{7}))$/,"mz-MZ":/^(\+?258)?8[234567]\d{7}$/,"nb-NO":/^(\+?47)?[49]\d{7}$/,"ne-NP":/^(\+?977)?9[78]\d{8}$/,"nl-BE":/^(\+?32|0)4\d{8}$/,"nl-NL":/^(((\+|00)?31\(0\))|((\+|00)?31)|0)6{1}\d{8}$/,"nl-AW":/^(\+)?297(56|59|64|73|74|99)\d{5}$/,"nn-NO":/^(\+?47)?[49]\d{7}$/,"pl-PL":/^(\+?48)? ?[5-8]\d ?\d{3} ?\d{2} ?\d{2}$/,"pt-BR":/^((\+?55\ ?[1-9]{2}\ ?)|(\+?55\ ?\([1-9]{2}\)\ ?)|(0[1-9]{2}\ ?)|(\([1-9]{2}\)\ ?)|([1-9]{2}\ ?))((\d{4}\-?\d{4})|(9[1-9]{1}\d{3}\-?\d{4}))$/,"pt-PT":/^(\+?351)?9[1236]\d{7}$/,"pt-AO":/^(\+244)\d{9}$/,"ro-MD":/^(\+?373|0)((6(0|1|2|6|7|8|9))|(7(6|7|8|9)))\d{6}$/,"ro-RO":/^(\+?40|0)\s?7\d{2}(\/|\s|\.|-)?\d{3}(\s|\.|-)?\d{3}$/,"ru-RU":/^(\+?7|8)?9\d{9}$/,"si-LK":/^(?:0|94|\+94)?(7(0|1|2|4|5|6|7|8)( |-)?)\d{7}$/,"sl-SI":/^(\+386\s?|0)(\d{1}\s?\d{3}\s?\d{2}\s?\d{2}|\d{2}\s?\d{3}\s?\d{3})$/,"sk-SK":/^(\+?421)? ?[1-9][0-9]{2} ?[0-9]{3} ?[0-9]{3}$/,"sq-AL":/^(\+355|0)6[789]\d{6}$/,"sr-RS":/^(\+3816|06)[- \d]{5,9}$/,"sv-SE":/^(\+?46|0)[\s\-]?7[\s\-]?[02369]([\s\-]?\d){7}$/,"tg-TJ":/^(\+?992)?[5][5]\d{7}$/,"th-TH":/^(\+66|66|0)\d{9}$/,"tr-TR":/^(\+?90|0)?5\d{9}$/,"tk-TM":/^(\+993|993|8)\d{8}$/,"uk-UA":/^(\+?38|8)?0\d{9}$/,"uz-UZ":/^(\+?998)?(6[125-79]|7[1-69]|88|9\d)\d{7}$/,"vi-VN":/^((\+?84)|0)((3([2-9]))|(5([25689]))|(7([0|6-9]))|(8([1-9]))|(9([0-9])))([0-9]{7})$/,"zh-CN":/^((\+|00)86)?(1[3-9]|9[28])\d{9}$/,"zh-TW":/^(\+?886\-?|0)?9\d{8}$/,"dz-BT":/^(\+?975|0)?(17|16|77|02)\d{6}$/,"ar-YE":/^(((\+|00)9677|0?7)[0137]\d{7}|((\+|00)967|0)[1-7]\d{6})$/,"ar-EH":/^(\+?212|0)[\s\-]?(5288|5289)[\s\-]?\d{5}$/,"fa-AF":/^(\+93|0)?(2{1}[0-8]{1}|[3-5]{1}[0-4]{1})(\d{7})$/};r["en-CA"]=r["en-US"],r["fr-CA"]=r["en-CA"],r["fr-BE"]=r["nl-BE"],r["zh-HK"]=r["en-HK"],r["zh-MO"]=r["en-MO"],r["ga-IE"]=r["en-IE"],r["fr-CH"]=r["de-CH"],r["it-CH"]=r["fr-CH"];var a=Object.keys(r);t.locales=a},46274:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)(e),(0,o.default)(e)&&24===e.length};var i=r(n(76041)),o=r(n(13836));function r(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default,e.exports.default=t.default},85696:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/[^\x00-\x7F]/;e.exports=t.default,e.exports.default=t.default},44564:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,o.default)(e),t&&t.no_symbols)return a.test(e);return new RegExp("^[+-]?([0-9]*[".concat((t||{}).locale?r.decimal[t.locale]:".","])?[0-9]+$")).test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i},r=n(87735);var a=/^[0-9]+$/;e.exports=t.default,e.exports.default=t.default},83128:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^(0o)?[0-7]+$/i;e.exports=t.default,e.exports.default=t.default},85384:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,o.default)(e);var n=e.replace(/\s/g,"").toUpperCase();return t.toUpperCase()in r&&r[t].test(n)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r={AM:/^[A-Z]{2}\d{7}$/,AR:/^[A-Z]{3}\d{6}$/,AT:/^[A-Z]\d{7}$/,AU:/^[A-Z]\d{7}$/,AZ:/^[A-Z]{2,3}\d{7,8}$/,BE:/^[A-Z]{2}\d{6}$/,BG:/^\d{9}$/,BR:/^[A-Z]{2}\d{6}$/,BY:/^[A-Z]{2}\d{7}$/,CA:/^[A-Z]{2}\d{6}$/,CH:/^[A-Z]\d{7}$/,CN:/^G\d{8}$|^E(?![IO])[A-Z0-9]\d{7}$/,CY:/^[A-Z](\d{6}|\d{8})$/,CZ:/^\d{8}$/,DE:/^[CFGHJKLMNPRTVWXYZ0-9]{9}$/,DK:/^\d{9}$/,DZ:/^\d{9}$/,EE:/^([A-Z]\d{7}|[A-Z]{2}\d{7})$/,ES:/^[A-Z0-9]{2}([A-Z0-9]?)\d{6}$/,FI:/^[A-Z]{2}\d{7}$/,FR:/^\d{2}[A-Z]{2}\d{5}$/,GB:/^\d{9}$/,GR:/^[A-Z]{2}\d{7}$/,HR:/^\d{9}$/,HU:/^[A-Z]{2}(\d{6}|\d{7})$/,IE:/^[A-Z0-9]{2}\d{7}$/,IN:/^[A-Z]{1}-?\d{7}$/,ID:/^[A-C]\d{7}$/,IR:/^[A-Z]\d{8}$/,IS:/^(A)\d{7}$/,IT:/^[A-Z0-9]{2}\d{7}$/,JM:/^[Aa]\d{7}$/,JP:/^[A-Z]{2}\d{7}$/,KR:/^[MS]\d{8}$/,KZ:/^[a-zA-Z]\d{7}$/,LI:/^[a-zA-Z]\d{5}$/,LT:/^[A-Z0-9]{8}$/,LU:/^[A-Z0-9]{8}$/,LV:/^[A-Z0-9]{2}\d{7}$/,LY:/^[A-Z0-9]{8}$/,MT:/^\d{7}$/,MZ:/^([A-Z]{2}\d{7})|(\d{2}[A-Z]{2}\d{5})$/,MY:/^[AHK]\d{8}$/,MX:/^\d{10,11}$/,NL:/^[A-Z]{2}[A-Z0-9]{6}\d$/,NZ:/^([Ll]([Aa]|[Dd]|[Ff]|[Hh])|[Ee]([Aa]|[Pp])|[Nn])\d{6}$/,PH:/^([A-Z](\d{6}|\d{7}[A-Z]))|([A-Z]{2}(\d{6}|\d{7}))$/,PK:/^[A-Z]{2}\d{7}$/,PL:/^[A-Z]{2}\d{7}$/,PT:/^[A-Z]\d{6}$/,RO:/^\d{8,9}$/,RU:/^\d{9}$/,SE:/^\d{8}$/,SL:/^(P)[A-Z]\d{7}$/,SK:/^[0-9A-Z]\d{7}$/,TH:/^[A-Z]{1,2}\d{6,7}$/,TR:/^[A-Z]\d{8}$/,UA:/^[A-Z]{2}\d{6}$/,US:/^\d{9}$/};e.exports=t.default,e.exports.default=t.default},60932:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e,{min:0,max:65535})};var i,o=(i=n(40798))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},15877:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,o.default)(e),t in c)return c[t].test(e);if("any"===t){for(var n in c){if(c.hasOwnProperty(n))if(c[n].test(e))return!0}return!1}throw new Error("Invalid locale '".concat(t,"'"))},t.locales=void 0;var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^\d{3}$/,a=/^\d{4}$/,s=/^\d{5}$/,l=/^\d{6}$/,c={AD:/^AD\d{3}$/,AT:a,AU:a,AZ:/^AZ\d{4}$/,BA:/^([7-8]\d{4}$)/,BE:a,BG:a,BR:/^\d{5}-\d{3}$/,BY:/^2[1-4]\d{4}$/,CA:/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJ-NPRSTV-Z][\s\-]?\d[ABCEGHJ-NPRSTV-Z]\d$/i,CH:a,CN:/^(0[1-7]|1[012356]|2[0-7]|3[0-6]|4[0-7]|5[1-7]|6[1-7]|7[1-5]|8[1345]|9[09])\d{4}$/,CZ:/^\d{3}\s?\d{2}$/,DE:s,DK:a,DO:s,DZ:s,EE:s,ES:/^(5[0-2]{1}|[0-4]{1}\d{1})\d{3}$/,FI:s,FR:/^\d{2}\s?\d{3}$/,GB:/^(gir\s?0aa|[a-z]{1,2}\d[\da-z]?\s?(\d[a-z]{2})?)$/i,GR:/^\d{3}\s?\d{2}$/,HR:/^([1-5]\d{4}$)/,HT:/^HT\d{4}$/,HU:a,ID:s,IE:/^(?!.*(?:o))[A-Za-z]\d[\dw]\s\w{4}$/i,IL:/^(\d{5}|\d{7})$/,IN:/^((?!10|29|35|54|55|65|66|86|87|88|89)[1-9][0-9]{5})$/,IR:/^(?!(\d)\1{3})[13-9]{4}[1346-9][013-9]{5}$/,IS:r,IT:s,JP:/^\d{3}\-\d{4}$/,KE:s,KR:/^(\d{5}|\d{6})$/,LI:/^(948[5-9]|949[0-7])$/,LT:/^LT\-\d{5}$/,LU:a,LV:/^LV\-\d{4}$/,LK:s,MG:r,MX:s,MT:/^[A-Za-z]{3}\s{0,1}\d{4}$/,MY:s,NL:/^\d{4}\s?[a-z]{2}$/i,NO:a,NP:/^(10|21|22|32|33|34|44|45|56|57)\d{3}$|^(977)$/i,NZ:a,PL:/^\d{2}\-\d{3}$/,PR:/^00[679]\d{2}([ -]\d{4})?$/,PT:/^\d{4}\-\d{3}?$/,RO:l,RU:l,SA:s,SE:/^[1-9]\d{2}\s?\d{2}$/,SG:l,SI:a,SK:/^\d{3}\s?\d{2}$/,TH:s,TN:a,TW:/^\d{3}(\d{2})?$/,UA:s,US:/^\d{5}(-\d{4})?$/,ZA:a,ZM:s},u=Object.keys(c);t.locales=u},70496:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),m.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/([01][0-9]|2[0-3])/,a=/[0-5][0-9]/,s=new RegExp("[-+]".concat(r.source,":").concat(a.source)),l=new RegExp("([zZ]|".concat(s.source,")")),c=new RegExp("".concat(r.source,":").concat(a.source,":").concat(/([0-5][0-9]|60)/.source).concat(/(\.[0-9]+)?/.source)),u=new RegExp("".concat(/[0-9]{4}/.source,"-").concat(/(0[1-9]|1[0-2])/.source,"-").concat(/([12]\d|0[1-9]|3[01])/.source)),d=new RegExp("".concat(c.source).concat(l.source)),m=new RegExp("^".concat(u.source,"[ tT]").concat(d.source,"$"));e.exports=t.default,e.exports.default=t.default},34345:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if((0,o.default)(e),!t)return r.test(e)||a.test(e);return r.test(e)||a.test(e)||s.test(e)||l.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^rgb\((([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]),){2}([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])\)$/,a=/^rgba\((([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5]),){3}(0?\.\d|1(\.0)?|0(\.0)?)\)$/,s=/^rgb\((([0-9]%|[1-9][0-9]%|100%),){2}([0-9]%|[1-9][0-9]%|100%)\)$/,l=/^rgba\((([0-9]%|[1-9][0-9]%|100%),){3}(0?\.\d|1(\.0)?|0(\.0)?)\)$/;e.exports=t.default,e.exports.default=t.default},26647:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,i.default)(e),r.test(e)};var i=o(n(76041));function o(e){return e&&e.__esModule?e:{default:e}}var r=(0,o(n(78756)).default)(["^(0|[1-9]\\d*)\\.(0|[1-9]\\d*)\\.(0|[1-9]\\d*)","(?:-((?:0|[1-9]\\d*|\\d*[a-z-][0-9a-z-]*)(?:\\.(?:0|[1-9]\\d*|\\d*[a-z-][0-9a-z-]*))*))","?(?:\\+([0-9a-z-]+(?:\\.[0-9a-z-]+)*))?$"],"i");e.exports=t.default,e.exports.default=t.default},76068:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/^[^\s-_](?!.*?[-_]{2,})[a-z0-9-\\][^\s]*[^-_\s]$/;e.exports=t.default,e.exports.default=t.default},35549:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;(0,o.default)(e);var n=function(e){var t=function(e){var t={};return Array.from(e).forEach((function(e){t[e]?t[e]+=1:t[e]=1})),t}(e),n={length:e.length,uniqueChars:Object.keys(t).length,uppercaseCount:0,lowercaseCount:0,numberCount:0,symbolCount:0};return Object.keys(t).forEach((function(e){a.test(e)?n.uppercaseCount+=t[e]:s.test(e)?n.lowercaseCount+=t[e]:l.test(e)?n.numberCount+=t[e]:c.test(e)&&(n.symbolCount+=t[e])})),n}(e);if((t=(0,i.default)(t||{},u)).returnScore)return function(e,t){var n=0;n+=e.uniqueChars*t.pointsPerUnique,n+=(e.length-e.uniqueChars)*t.pointsPerRepeat,e.lowercaseCount>0&&(n+=t.pointsForContainingLower);e.uppercaseCount>0&&(n+=t.pointsForContainingUpper);e.numberCount>0&&(n+=t.pointsForContainingNumber);e.symbolCount>0&&(n+=t.pointsForContainingSymbol);return n}(n,t);return n.length>=t.minLength&&n.lowercaseCount>=t.minLowercase&&n.uppercaseCount>=t.minUppercase&&n.numberCount>=t.minNumbers&&n.symbolCount>=t.minSymbols};var i=r(n(92372)),o=r(n(76041));function r(e){return e&&e.__esModule?e:{default:e}}var a=/^[A-Z]$/,s=/^[a-z]$/,l=/^[0-9]$/,c=/^[-#!$@£%^&*()_+|~=`{}\[\]:";'<>?,.\/ ]$/,u={minLength:8,minLowercase:1,minUppercase:1,minNumbers:1,minSymbols:1,returnScore:!1,pointsPerUnique:1,pointsPerRepeat:.5,pointsForContainingLower:10,pointsForContainingUpper:10,pointsForContainingNumber:10,pointsForContainingSymbol:10};e.exports=t.default,e.exports.default=t.default},77345:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r=/[\uD800-\uDBFF][\uDC00-\uDFFF]/;e.exports=t.default,e.exports.default=t.default},53819:(e,t,n)=>{"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US";(0,o.default)(e);var n=e.slice(0);if(t in h)return t in f&&(n=n.replace(f[t],"")),!!h[t].test(n)&&(!(t in p)||p[t](n));throw new Error("Invalid locale '".concat(t,"'"))};var o=l(n(76041)),r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=o?Object.getOwnPropertyDescriptor(e,r):null;a&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r]}n.default=e,t&&t.set(e,n);return n}(n(44032)),a=l(n(255));function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function l(e){return e&&e.__esModule?e:{default:e}}function c(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var d={andover:["10","12"],atlanta:["60","67"],austin:["50","53"],brookhaven:["01","02","03","04","05","06","11","13","14","16","21","22","23","25","34","51","52","54","55","56","57","58","59","65"],cincinnati:["30","32","35","36","37","38","61"],fresno:["15","24"],internet:["20","26","27","45","46","47"],kansas:["40","44"],memphis:["94","95"],ogden:["80","90"],philadelphia:["33","39","41","42","43","46","48","62","63","64","66","68","71","72","73","74","75","76","77","81","82","83","84","85","86","87","88","91","92","93","98","99"],sba:["31"]};function m(e){for(var t=!1,n=!1,i=0;i<3;i++)if(!t&&/[AEIOU]/.test(e[i]))t=!0;else if(!n&&t&&"X"===e[i])n=!0;else if(i>0){if(t&&!n&&!/[AEIOU]/.test(e[i]))return!1;if(n&&!/X/.test(e[i]))return!1}return!0}var h={"bg-BG":/^\d{10}$/,"cs-CZ":/^\d{6}\/{0,1}\d{3,4}$/,"de-AT":/^\d{9}$/,"de-DE":/^[1-9]\d{10}$/,"dk-DK":/^\d{6}-{0,1}\d{4}$/,"el-CY":/^[09]\d{7}[A-Z]$/,"el-GR":/^([0-4]|[7-9])\d{8}$/,"en-CA":/^\d{9}$/,"en-GB":/^\d{10}$|^(?!GB|NK|TN|ZZ)(?![DFIQUV])[A-Z](?![DFIQUVO])[A-Z]\d{6}[ABCD ]$/i,"en-IE":/^\d{7}[A-W][A-IW]{0,1}$/i,"en-US":/^\d{2}[- ]{0,1}\d{7}$/,"es-ES":/^(\d{0,8}|[XYZKLM]\d{7})[A-HJ-NP-TV-Z]$/i,"et-EE":/^[1-6]\d{6}(00[1-9]|0[1-9][0-9]|[1-6][0-9]{2}|70[0-9]|710)\d$/,"fi-FI":/^\d{6}[-+A]\d{3}[0-9A-FHJ-NPR-Y]$/i,"fr-BE":/^\d{11}$/,"fr-FR":/^[0-3]\d{12}$|^[0-3]\d\s\d{2}(\s\d{3}){3}$/,"fr-LU":/^\d{13}$/,"hr-HR":/^\d{11}$/,"hu-HU":/^8\d{9}$/,"it-IT":/^[A-Z]{6}[L-NP-V0-9]{2}[A-EHLMPRST][L-NP-V0-9]{2}[A-ILMZ][L-NP-V0-9]{3}[A-Z]$/i,"lv-LV":/^\d{6}-{0,1}\d{5}$/,"mt-MT":/^\d{3,7}[APMGLHBZ]$|^([1-8])\1\d{7}$/i,"nl-NL":/^\d{9}$/,"pl-PL":/^\d{10,11}$/,"pt-BR":/(?:^\d{11}$)|(?:^\d{14}$)/,"pt-PT":/^\d{9}$/,"ro-RO":/^\d{13}$/,"sk-SK":/^\d{6}\/{0,1}\d{3,4}$/,"sl-SI":/^[1-9]\d{7}$/,"sv-SE":/^(\d{6}[-+]{0,1}\d{4}|(18|19|20)\d{6}[-+]{0,1}\d{4})$/};h["lb-LU"]=h["fr-LU"],h["lt-LT"]=h["et-EE"],h["nl-BE"]=h["fr-BE"],h["fr-CA"]=h["en-CA"];var p={"bg-BG":function(e){var t=e.slice(0,2),n=parseInt(e.slice(2,4),10);n>40?(n-=40,t="20".concat(t)):n>20?(n-=20,t="18".concat(t)):t="19".concat(t),n<10&&(n="0".concat(n));var i="".concat(t,"/").concat(n,"/").concat(e.slice(4,6));if(!(0,a.default)(i,"YYYY/MM/DD"))return!1;for(var o=e.split("").map((function(e){return parseInt(e,10)})),r=[2,4,8,5,10,9,7,3,6],s=0,l=0;l<r.length;l++)s+=o[l]*r[l];return(s=s%11==10?0:s%11)===o[9]},"cs-CZ":function(e){e=e.replace(/\W/,"");var t=parseInt(e.slice(0,2),10);if(10===e.length)t=t<54?"20".concat(t):"19".concat(t);else{if("000"===e.slice(6))return!1;if(!(t<54))return!1;t="19".concat(t)}3===t.length&&(t=[t.slice(0,2),"0",t.slice(2)].join(""));var n=parseInt(e.slice(2,4),10);if(n>50&&(n-=50),n>20){if(parseInt(t,10)<2004)return!1;n-=20}n<10&&(n="0".concat(n));var i="".concat(t,"/").concat(n,"/").concat(e.slice(4,6));if(!(0,a.default)(i,"YYYY/MM/DD"))return!1;if(10===e.length&&parseInt(e,10)%11!=0){var o=parseInt(e.slice(0,9),10)%11;if(!(parseInt(t,10)<1986&&10===o))return!1;if(0!==parseInt(e.slice(9),10))return!1}return!0},"de-AT":function(e){return r.luhnCheck(e)},"de-DE":function(e){for(var t=e.split("").map((function(e){return parseInt(e,10)})),n=[],i=0;i<t.length-1;i++){n.push("");for(var o=0;o<t.length-1;o++)t[i]===t[o]&&(n[i]+=o)}if(2!==(n=n.filter((function(e){return e.length>1}))).length&&3!==n.length)return!1;if(3===n[0].length){for(var a=n[0].split("").map((function(e){return parseInt(e,10)})),s=0,l=0;l<a.length-1;l++)a[l]+1===a[l+1]&&(s+=1);if(2===s)return!1}return r.iso7064Check(e)},"dk-DK":function(e){e=e.replace(/\W/,"");var t=parseInt(e.slice(4,6),10);switch(e.slice(6,7)){case"0":case"1":case"2":case"3":t="19".concat(t);break;case"4":case"9":t=t<37?"20".concat(t):"19".concat(t);break;default:if(t<37)t="20".concat(t);else{if(!(t>58))return!1;t="18".concat(t)}}3===t.length&&(t=[t.slice(0,2),"0",t.slice(2)].join(""));var n="".concat(t,"/").concat(e.slice(2,4),"/").concat(e.slice(0,2));if(!(0,a.default)(n,"YYYY/MM/DD"))return!1;for(var i=e.split("").map((function(e){return parseInt(e,10)})),o=0,r=4,s=0;s<9;s++)o+=i[s]*r,1===(r-=1)&&(r=7);return 1!==(o%=11)&&(0===o?0===i[9]:i[9]===11-o)},"el-CY":function(e){for(var t=e.slice(0,8).split("").map((function(e){return parseInt(e,10)})),n=0,i=1;i<t.length;i+=2)n+=t[i];for(var o=0;o<t.length;o+=2)t[o]<2?n+=1-t[o]:(n+=2*(t[o]-2)+5,t[o]>4&&(n+=2));return String.fromCharCode(n%26+65)===e.charAt(8)},"el-GR":function(e){for(var t=e.split("").map((function(e){return parseInt(e,10)})),n=0,i=0;i<8;i++)n+=t[i]*Math.pow(2,8-i);return n%11%10===t[8]},"en-CA":function(e){var t=e.split(""),n=t.filter((function(e,t){return t%2})).map((function(e){return 2*Number(e)})).join("").split("");return t.filter((function(e,t){return!(t%2)})).concat(n).map((function(e){return Number(e)})).reduce((function(e,t){return e+t}))%10==0},"en-IE":function(e){var t=r.reverseMultiplyAndSum(e.split("").slice(0,7).map((function(e){return parseInt(e,10)})),8);return 9===e.length&&"W"!==e[8]&&(t+=9*(e[8].charCodeAt(0)-64)),0===(t%=23)?"W"===e[7].toUpperCase():e[7].toUpperCase()===String.fromCharCode(64+t)},"en-US":function(e){return-1!==function(){var e=[];for(var t in d)d.hasOwnProperty(t)&&e.push.apply(e,c(d[t]));return e}().indexOf(e.slice(0,2))},"es-ES":function(e){var t=e.toUpperCase().split("");if(isNaN(parseInt(t[0],10))&&t.length>1){var n=0;switch(t[0]){case"Y":n=1;break;case"Z":n=2}t.splice(0,1,n)}else for(;t.length<9;)t.unshift(0);t=t.join("");var i=parseInt(t.slice(0,8),10)%23;return t[8]===["T","R","W","A","G","M","Y","F","P","D","X","B","N","J","Z","S","Q","V","H","L","C","K","E"][i]},"et-EE":function(e){var t=e.slice(1,3);switch(e.slice(0,1)){case"1":case"2":t="18".concat(t);break;case"3":case"4":t="19".concat(t);break;default:t="20".concat(t)}var n="".concat(t,"/").concat(e.slice(3,5),"/").concat(e.slice(5,7));if(!(0,a.default)(n,"YYYY/MM/DD"))return!1;for(var i=e.split("").map((function(e){return parseInt(e,10)})),o=0,r=1,s=0;s<10;s++)o+=i[s]*r,10===(r+=1)&&(r=1);if(o%11==10){o=0,r=3;for(var l=0;l<10;l++)o+=i[l]*r,10===(r+=1)&&(r=1);if(o%11==10)return 0===i[10]}return o%11===i[10]},"fi-FI":function(e){var t=e.slice(4,6);switch(e.slice(6,7)){case"+":t="18".concat(t);break;case"-":t="19".concat(t);break;default:t="20".concat(t)}var n="".concat(t,"/").concat(e.slice(2,4),"/").concat(e.slice(0,2));if(!(0,a.default)(n,"YYYY/MM/DD"))return!1;var i=parseInt(e.slice(0,6)+e.slice(7,10),10)%31;return i<10?i===parseInt(e.slice(10),10):["A","B","C","D","E","F","H","J","K","L","M","N","P","R","S","T","U","V","W","X","Y"][i-=10]===e.slice(10)},"fr-BE":function(e){if("00"!==e.slice(2,4)||"00"!==e.slice(4,6)){var t="".concat(e.slice(0,2),"/").concat(e.slice(2,4),"/").concat(e.slice(4,6));if(!(0,a.default)(t,"YY/MM/DD"))return!1}var n=97-parseInt(e.slice(0,9),10)%97,i=parseInt(e.slice(9,11),10);return n===i||(n=97-parseInt("2".concat(e.slice(0,9)),10)%97)===i},"fr-FR":function(e){return e=e.replace(/\s/g,""),parseInt(e.slice(0,10),10)%511===parseInt(e.slice(10,13),10)},"fr-LU":function(e){var t="".concat(e.slice(0,4),"/").concat(e.slice(4,6),"/").concat(e.slice(6,8));return!!(0,a.default)(t,"YYYY/MM/DD")&&(!!r.luhnCheck(e.slice(0,12))&&r.verhoeffCheck("".concat(e.slice(0,11)).concat(e[12])))},"hr-HR":function(e){return r.iso7064Check(e)},"hu-HU":function(e){for(var t=e.split("").map((function(e){return parseInt(e,10)})),n=8,i=1;i<9;i++)n+=t[i]*(i+1);return n%11===t[9]},"it-IT":function(e){var t=e.toUpperCase().split("");if(!m(t.slice(0,3)))return!1;if(!m(t.slice(3,6)))return!1;for(var n={L:"0",M:"1",N:"2",P:"3",Q:"4",R:"5",S:"6",T:"7",U:"8",V:"9"},i=0,o=[6,7,9,10,12,13,14];i<o.length;i++){var r=o[i];t[r]in n&&t.splice(r,1,n[t[r]])}var s={A:"01",B:"02",C:"03",D:"04",E:"05",H:"06",L:"07",M:"08",P:"09",R:"10",S:"11",T:"12"}[t[8]],l=parseInt(t[9]+t[10],10);l>40&&(l-=40),l<10&&(l="0".concat(l));var c="".concat(t[6]).concat(t[7],"/").concat(s,"/").concat(l);if(!(0,a.default)(c,"YY/MM/DD"))return!1;for(var u=0,d=1;d<t.length-1;d+=2){var h=parseInt(t[d],10);isNaN(h)&&(h=t[d].charCodeAt(0)-65),u+=h}for(var p={A:1,B:0,C:5,D:7,E:9,F:13,G:15,H:17,I:19,J:21,K:2,L:4,M:18,N:20,O:11,P:3,Q:6,R:8,S:12,T:14,U:16,V:10,W:22,X:25,Y:24,Z:23,0:1,1:0},_=0;_<t.length-1;_+=2){var f=0;if(t[_]in p)f=p[t[_]];else{var g=parseInt(t[_],10);f=2*g+1,g>4&&(f+=2)}u+=f}return String.fromCharCode(65+u%26)===t[15]},"lv-LV":function(e){var t=(e=e.replace(/\W/,"")).slice(0,2);if("32"!==t){if("00"!==e.slice(2,4)){var n=e.slice(4,6);switch(e[6]){case"0":n="18".concat(n);break;case"1":n="19".concat(n);break;default:n="20".concat(n)}var i="".concat(n,"/").concat(e.slice(2,4),"/").concat(t);if(!(0,a.default)(i,"YYYY/MM/DD"))return!1}for(var o=1101,r=[1,6,3,7,9,10,5,8,4,2],s=0;s<e.length-1;s++)o-=parseInt(e[s],10)*r[s];return parseInt(e[10],10)===o%11}return!0},"mt-MT":function(e){if(9!==e.length){for(var t=e.toUpperCase().split("");t.length<8;)t.unshift(0);switch(e[7]){case"A":case"P":if(0===parseInt(t[6],10))return!1;break;default:var n=parseInt(t.join("").slice(0,5),10);if(n>32e3)return!1;if(n===parseInt(t.join("").slice(5,7),10))return!1}}return!0},"nl-NL":function(e){return r.reverseMultiplyAndSum(e.split("").slice(0,8).map((function(e){return parseInt(e,10)})),9)%11===parseInt(e[8],10)},"pl-PL":function(e){if(10===e.length){for(var t=[6,5,7,2,3,4,5,6,7],n=0,i=0;i<t.length;i++)n+=parseInt(e[i],10)*t[i];return 10!==(n%=11)&&n===parseInt(e[9],10)}var o=e.slice(0,2),r=parseInt(e.slice(2,4),10);r>80?(o="18".concat(o),r-=80):r>60?(o="22".concat(o),r-=60):r>40?(o="21".concat(o),r-=40):r>20?(o="20".concat(o),r-=20):o="19".concat(o),r<10&&(r="0".concat(r));var s="".concat(o,"/").concat(r,"/").concat(e.slice(4,6));if(!(0,a.default)(s,"YYYY/MM/DD"))return!1;for(var l=0,c=1,u=0;u<e.length-1;u++)l+=parseInt(e[u],10)*c%10,(c+=2)>10?c=1:5===c&&(c+=2);return(l=10-l%10)===parseInt(e[10],10)},"pt-BR":function(e){if(11===e.length){var t,n;if(t=0,"11111111111"===e||"22222222222"===e||"33333333333"===e||"44444444444"===e||"55555555555"===e||"66666666666"===e||"77777777777"===e||"88888888888"===e||"99999999999"===e||"00000000000"===e)return!1;for(var i=1;i<=9;i++)t+=parseInt(e.substring(i-1,i),10)*(11-i);if(10===(n=10*t%11)&&(n=0),n!==parseInt(e.substring(9,10),10))return!1;t=0;for(var o=1;o<=10;o++)t+=parseInt(e.substring(o-1,o),10)*(12-o);return 10===(n=10*t%11)&&(n=0),n===parseInt(e.substring(10,11),10)}if("00000000000000"===e||"11111111111111"===e||"22222222222222"===e||"33333333333333"===e||"44444444444444"===e||"55555555555555"===e||"66666666666666"===e||"77777777777777"===e||"88888888888888"===e||"99999999999999"===e)return!1;for(var r=e.length-2,a=e.substring(0,r),s=e.substring(r),l=0,c=r-7,u=r;u>=1;u--)l+=a.charAt(r-u)*c,(c-=1)<2&&(c=9);var d=l%11<2?0:11-l%11;if(d!==parseInt(s.charAt(0),10))return!1;r+=1,a=e.substring(0,r),l=0,c=r-7;for(var m=r;m>=1;m--)l+=a.charAt(r-m)*c,(c-=1)<2&&(c=9);return(d=l%11<2?0:11-l%11)===parseInt(s.charAt(1),10)},"pt-PT":function(e){var t=11-r.reverseMultiplyAndSum(e.split("").slice(0,8).map((function(e){return parseInt(e,10)})),9)%11;return t>9?0===parseInt(e[8],10):t===parseInt(e[8],10)},"ro-RO":function(e){if("9000"!==e.slice(0,4)){var t=e.slice(1,3);switch(e[0]){case"1":case"2":t="19".concat(t);break;case"3":case"4":t="18".concat(t);break;case"5":case"6":t="20".concat(t)}var n="".concat(t,"/").concat(e.slice(3,5),"/").concat(e.slice(5,7));if(8===n.length){if(!(0,a.default)(n,"YY/MM/DD"))return!1}else if(!(0,a.default)(n,"YYYY/MM/DD"))return!1;for(var i=e.split("").map((function(e){return parseInt(e,10)})),o=[2,7,9,1,4,6,3,5,8,2,7,9],r=0,s=0;s<o.length;s++)r+=i[s]*o[s];return r%11==10?1===i[12]:i[12]===r%11}return!0},"sk-SK":function(e){if(9===e.length){if("000"===(e=e.replace(/\W/,"")).slice(6))return!1;var t=parseInt(e.slice(0,2),10);if(t>53)return!1;t=t<10?"190".concat(t):"19".concat(t);var n=parseInt(e.slice(2,4),10);n>50&&(n-=50),n<10&&(n="0".concat(n));var i="".concat(t,"/").concat(n,"/").concat(e.slice(4,6));if(!(0,a.default)(i,"YYYY/MM/DD"))return!1}return!0},"sl-SI":function(e){var t=11-r.reverseMultiplyAndSum(e.split("").slice(0,7).map((function(e){return parseInt(e,10)})),8)%11;return 10===t?0===parseInt(e[7],10):t===parseInt(e[7],10)},"sv-SE":function(e){var t=e.slice(0);e.length>11&&(t=t.slice(2));var n="",i=t.slice(2,4),o=parseInt(t.slice(4,6),10);if(e.length>11)n=e.slice(0,4);else if(n=e.slice(0,2),11===e.length&&o<60){var s=(new Date).getFullYear().toString(),l=parseInt(s.slice(0,2),10);if(s=parseInt(s,10),"-"===e[6])n=parseInt("".concat(l).concat(n),10)>s?"".concat(l-1).concat(n):"".concat(l).concat(n);else if(n="".concat(l-1).concat(n),s-parseInt(n,10)<100)return!1}o>60&&(o-=60),o<10&&(o="0".concat(o));var c="".concat(n,"/").concat(i,"/").concat(o);if(8===c.length){if(!(0,a.default)(c,"YY/MM/DD"))return!1}else if(!(0,a.default)(c,"YYYY/MM/DD"))return!1;return r.luhnCheck(e.replace(/\W/,""))}};p["lb-LU"]=p["fr-LU"],p["lt-LT"]=p["et-EE"],p["nl-BE"]=p["fr-BE"],p["fr-CA"]=p["en-CA"];var _=/[-\\\/!@#$%\^&\*\(\)\+\=\[\]]+/g,f={"de-AT":_,"de-DE":/[\/\\]/g,"fr-BE":_};f["nl-BE"]=f["fr-BE"],e.exports=t.default,e.exports.default=t.default},55894:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return t=(0,o.default)(t,r),"string"==typeof e&&a[t.hourFormat][t.mode].test(e)};var i,o=(i=n(92372))&&i.__esModule?i:{default:i};var r={hourFormat:"hour24",mode:"default"},a={hour24:{default:/^([01]?[0-9]|2[0-3]):([0-5][0-9])$/,withSeconds:/^([01]?[0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])$/},hour12:{default:/^(0?[1-9]|1[0-2]):([0-5][0-9]) (A|P)M$/,withSeconds:/^(0?[1-9]|1[0-2]):([0-5][0-9]):([0-5][0-9]) (A|P)M$/}};e.exports=t.default,e.exports.default=t.default},28705:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,i.default)(e),!e||/[\s<>]/.test(e))return!1;if(0===e.indexOf("mailto:"))return!1;if((t=(0,a.default)(t,c)).validate_length&&e.length>=2083)return!1;if(!t.allow_fragments&&e.includes("#"))return!1;if(!t.allow_query_components&&(e.includes("?")||e.includes("&")))return!1;var n,s,m,h,p,_,f,g;if(f=e.split("#"),e=f.shift(),f=e.split("?"),e=f.shift(),(f=e.split("://")).length>1){if(n=f.shift().toLowerCase(),t.require_valid_protocol&&-1===t.protocols.indexOf(n))return!1}else{if(t.require_protocol)return!1;if("//"===e.slice(0,2)){if(!t.allow_protocol_relative_urls)return!1;f[0]=e.slice(2)}}if(""===(e=f.join("://")))return!1;if(f=e.split("/"),""===(e=f.shift())&&!t.require_host)return!0;if((f=e.split("@")).length>1){if(t.disallow_auth)return!1;if(""===f[0])return!1;if((s=f.shift()).indexOf(":")>=0&&s.split(":").length>2)return!1;var b=s.split(":"),y=(A=2,function(e){if(Array.isArray(e))return e}(k=b)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],i=!0,o=!1,r=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){o=!0,r=e}finally{try{i||null==s.return||s.return()}finally{if(o)throw r}}return n}}(k,A)||function(e,t){if(e){if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,t):void 0}}(k,A)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),v=y[0],E=y[1];if(""===v&&""===E)return!1}var k,A;h=f.join("@"),_=null,g=null;var T=h.match(u);T?(m="",g=T[1],_=T[2]||null):(m=(f=h.split(":")).shift(),f.length&&(_=f.join(":")));if(null!==_&&_.length>0){if(p=parseInt(_,10),!/^[0-9]+$/.test(_)||p<=0||p>65535)return!1}else if(t.require_port)return!1;if(t.host_whitelist)return d(m,t.host_whitelist);if(""===m&&!t.require_host)return!0;if(!((0,r.default)(m)||(0,o.default)(m,t)||g&&(0,r.default)(g,6)))return!1;if(m=m||g,t.host_blacklist&&d(m,t.host_blacklist))return!1;return!0};var i=s(n(76041)),o=s(n(57780)),r=s(n(3246)),a=s(n(92372));function s(e){return e&&e.__esModule?e:{default:e}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var c={protocols:["http","https","ftp"],require_tld:!0,require_protocol:!1,require_host:!0,require_port:!1,require_valid_protocol:!0,allow_underscores:!1,allow_trailing_dot:!1,allow_protocol_relative_urls:!1,allow_fragments:!0,allow_query_components:!0,validate_length:!0},u=/^\[([^\]]+)\](?::([0-9]+))?$/;function d(e,t){for(var n=0;n<t.length;n++){var i=t[n];if(e===i||(o=i,"[object RegExp]"===Object.prototype.toString.call(o)&&i.test(e)))return!0}var o;return!1}e.exports=t.default,e.exports.default=t.default},73500:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,o.default)(e);var n=r[[void 0,null].includes(t)?"all":t];return!!n&&n.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};var r={1:/^[0-9A-F]{8}-[0-9A-F]{4}-1[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,2:/^[0-9A-F]{8}-[0-9A-F]{4}-2[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,3:/^[0-9A-F]{8}-[0-9A-F]{4}-3[0-9A-F]{3}-[0-9A-F]{4}-[0-9A-F]{12}$/i,4:/^[0-9A-F]{8}-[0-9A-F]{4}-4[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,5:/^[0-9A-F]{8}-[0-9A-F]{4}-5[0-9A-F]{3}-[89AB][0-9A-F]{3}-[0-9A-F]{12}$/i,all:/^[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}$/i};e.exports=t.default,e.exports.default=t.default},23027:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),e===e.toUpperCase()};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},67496:(e,t,n)=>{"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,r.default)(e),(0,r.default)(t),t in l)return l[t](e);throw new Error("Invalid country code: '".concat(t,"'"))},t.vatMatchers=void 0;var o,r=(o=n(76041))&&o.__esModule?o:{default:o},a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var a=o?Object.getOwnPropertyDescriptor(e,r):null;a&&(a.get||a.set)?Object.defineProperty(n,r,a):n[r]=e[r]}n.default=e,t&&t.set(e,n);return n}(n(44032));function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}var l={AT:function(e){return/^(AT)?U\d{8}$/.test(e)},BE:function(e){return/^(BE)?\d{10}$/.test(e)},BG:function(e){return/^(BG)?\d{9,10}$/.test(e)},HR:function(e){return/^(HR)?\d{11}$/.test(e)},CY:function(e){return/^(CY)?\w{9}$/.test(e)},CZ:function(e){return/^(CZ)?\d{8,10}$/.test(e)},DK:function(e){return/^(DK)?\d{8}$/.test(e)},EE:function(e){return/^(EE)?\d{9}$/.test(e)},FI:function(e){return/^(FI)?\d{8}$/.test(e)},FR:function(e){return/^(FR)?\w{2}\d{9}$/.test(e)},DE:function(e){return/^(DE)?\d{9}$/.test(e)},EL:function(e){return/^(EL)?\d{9}$/.test(e)},HU:function(e){return/^(HU)?\d{8}$/.test(e)},IE:function(e){return/^(IE)?\d{7}\w{1}(W)?$/.test(e)},IT:function(e){return/^(IT)?\d{11}$/.test(e)},LV:function(e){return/^(LV)?\d{11}$/.test(e)},LT:function(e){return/^(LT)?\d{9,12}$/.test(e)},LU:function(e){return/^(LU)?\d{8}$/.test(e)},MT:function(e){return/^(MT)?\d{8}$/.test(e)},NL:function(e){return/^(NL)?\d{9}B\d{2}$/.test(e)},PL:function(e){return/^(PL)?(\d{10}|(\d{3}-\d{3}-\d{2}-\d{2})|(\d{3}-\d{2}-\d{2}-\d{3}))$/.test(e)},PT:function(e){var t=e.match(/^(PT)?(\d{9})$/);if(!t)return!1;var n=t[2],i=11-a.reverseMultiplyAndSum(n.split("").slice(0,8).map((function(e){return parseInt(e,10)})),9)%11;return i>9?0===parseInt(n[8],10):i===parseInt(n[8],10)},RO:function(e){return/^(RO)?\d{2,10}$/.test(e)},SK:function(e){return/^(SK)?\d{10}$/.test(e)},SI:function(e){return/^(SI)?\d{8}$/.test(e)},ES:function(e){return/^(ES)?\w\d{7}[A-Z]$/.test(e)},SE:function(e){return/^(SE)?\d{12}$/.test(e)},AL:function(e){return/^(AL)?\w{9}[A-Z]$/.test(e)},MK:function(e){return/^(MK)?\d{13}$/.test(e)},AU:function(e){return/^(AU)?\d{11}$/.test(e)},BY:function(e){return/^(УНП )?\d{9}$/.test(e)},CA:function(e){return/^(CA)?\d{9}$/.test(e)},IS:function(e){return/^(IS)?\d{5,6}$/.test(e)},IN:function(e){return/^(IN)?\d{15}$/.test(e)},ID:function(e){return/^(ID)?(\d{15}|(\d{2}.\d{3}.\d{3}.\d{1}-\d{3}.\d{3}))$/.test(e)},IL:function(e){return/^(IL)?\d{9}$/.test(e)},KZ:function(e){return/^(KZ)?\d{9}$/.test(e)},NZ:function(e){return/^(NZ)?\d{9}$/.test(e)},NG:function(e){return/^(NG)?(\d{12}|(\d{8}-\d{4}))$/.test(e)},NO:function(e){return/^(NO)?\d{9}MVA$/.test(e)},PH:function(e){return/^(PH)?(\d{12}|\d{3} \d{3} \d{3} \d{3})$/.test(e)},RU:function(e){return/^(RU)?(\d{10}|\d{12})$/.test(e)},SM:function(e){return/^(SM)?\d{5}$/.test(e)},SA:function(e){return/^(SA)?\d{15}$/.test(e)},RS:function(e){return/^(RS)?\d{9}$/.test(e)},CH:function(e){return/^(CH)?(\d{6}|\d{9}|(\d{3}.\d{3})|(\d{3}.\d{3}.\d{3}))(TVA|MWST|IVA)$/.test(e)},TR:function(e){return/^(TR)?\d{10}$/.test(e)},UA:function(e){return/^(UA)?\d{12}$/.test(e)},GB:function(e){return/^GB((\d{3} \d{4} ([0-8][0-9]|9[0-6]))|(\d{9} \d{3})|(((GD[0-4])|(HA[5-9]))[0-9]{2}))$/.test(e)},UZ:function(e){return/^(UZ)?\d{9}$/.test(e)},AR:function(e){return/^(AR)?\d{11}$/.test(e)},BO:function(e){return/^(BO)?\d{7}$/.test(e)},BR:function(e){return/^(BR)?((\d{2}.\d{3}.\d{3}\/\d{4}-\d{2})|(\d{3}.\d{3}.\d{3}-\d{2}))$/.test(e)},CL:function(e){return/^(CL)?\d{8}-\d{1}$/.test(e)},CO:function(e){return/^(CO)?\d{10}$/.test(e)},CR:function(e){return/^(CR)?\d{9,12}$/.test(e)},EC:function(e){return/^(EC)?\d{13}$/.test(e)},SV:function(e){return/^(SV)?\d{4}-\d{6}-\d{3}-\d{1}$/.test(e)},GT:function(e){return/^(GT)?\d{7}-\d{1}$/.test(e)},HN:function(e){return/^(HN)?$/.test(e)},MX:function(e){return/^(MX)?\w{3,4}\d{6}\w{3}$/.test(e)},NI:function(e){return/^(NI)?\d{3}-\d{6}-\d{4}\w{1}$/.test(e)},PA:function(e){return/^(PA)?$/.test(e)},PY:function(e){return/^(PY)?\d{6,8}-\d{1}$/.test(e)},PE:function(e){return/^(PE)?\d{11}$/.test(e)},DO:function(e){return/^(DO)?(\d{11}|(\d{3}-\d{7}-\d{1})|[1,4,5]{1}\d{8}|([1,4,5]{1})-\d{2}-\d{5}-\d{1})$/.test(e)},UY:function(e){return/^(UY)?\d{12}$/.test(e)},VE:function(e){return/^(VE)?[J,G,V,E]{1}-(\d{9}|(\d{8}-\d{1}))$/.test(e)}};t.vatMatchers=l},36519:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),r.fullWidth.test(e)&&a.halfWidth.test(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i},r=n(93200),a=n(39020);e.exports=t.default,e.exports.default=t.default},8963:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,o.default)(e);for(var n=e.length-1;n>=0;n--)if(-1===t.indexOf(e[n]))return!1;return!0};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},52187:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,o.default)(e);var n=t?new RegExp("^[".concat(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"]+"),"g"):/^\s+/g;return e.replace(n,"")};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},81418:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){(0,o.default)(e),"[object RegExp]"!==Object.prototype.toString.call(t)&&(t=new RegExp(t,n));return!!e.match(t)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},14462:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){t=(0,o.default)(t,r);var n=e.split("@"),i=n.pop(),d=[n.join("@"),i];if(d[1]=d[1].toLowerCase(),"gmail.com"===d[1]||"googlemail.com"===d[1]){if(t.gmail_remove_subaddress&&(d[0]=d[0].split("+")[0]),t.gmail_remove_dots&&(d[0]=d[0].replace(/\.+/g,u)),!d[0].length)return!1;(t.all_lowercase||t.gmail_lowercase)&&(d[0]=d[0].toLowerCase()),d[1]=t.gmail_convert_googlemaildotcom?"gmail.com":d[1]}else if(a.indexOf(d[1])>=0){if(t.icloud_remove_subaddress&&(d[0]=d[0].split("+")[0]),!d[0].length)return!1;(t.all_lowercase||t.icloud_lowercase)&&(d[0]=d[0].toLowerCase())}else if(s.indexOf(d[1])>=0){if(t.outlookdotcom_remove_subaddress&&(d[0]=d[0].split("+")[0]),!d[0].length)return!1;(t.all_lowercase||t.outlookdotcom_lowercase)&&(d[0]=d[0].toLowerCase())}else if(l.indexOf(d[1])>=0){if(t.yahoo_remove_subaddress){var m=d[0].split("-");d[0]=m.length>1?m.slice(0,-1).join("-"):m[0]}if(!d[0].length)return!1;(t.all_lowercase||t.yahoo_lowercase)&&(d[0]=d[0].toLowerCase())}else c.indexOf(d[1])>=0?((t.all_lowercase||t.yandex_lowercase)&&(d[0]=d[0].toLowerCase()),d[1]="yandex.ru"):t.all_lowercase&&(d[0]=d[0].toLowerCase());return d.join("@")};var i,o=(i=n(92372))&&i.__esModule?i:{default:i};var r={all_lowercase:!0,gmail_lowercase:!0,gmail_remove_dots:!0,gmail_remove_subaddress:!0,gmail_convert_googlemaildotcom:!0,outlookdotcom_lowercase:!0,outlookdotcom_remove_subaddress:!0,yahoo_lowercase:!0,yahoo_remove_subaddress:!0,yandex_lowercase:!0,icloud_lowercase:!0,icloud_remove_subaddress:!0},a=["icloud.com","me.com"],s=["hotmail.at","hotmail.be","hotmail.ca","hotmail.cl","hotmail.co.il","hotmail.co.nz","hotmail.co.th","hotmail.co.uk","hotmail.com","hotmail.com.ar","hotmail.com.au","hotmail.com.br","hotmail.com.gr","hotmail.com.mx","hotmail.com.pe","hotmail.com.tr","hotmail.com.vn","hotmail.cz","hotmail.de","hotmail.dk","hotmail.es","hotmail.fr","hotmail.hu","hotmail.id","hotmail.ie","hotmail.in","hotmail.it","hotmail.jp","hotmail.kr","hotmail.lv","hotmail.my","hotmail.ph","hotmail.pt","hotmail.sa","hotmail.sg","hotmail.sk","live.be","live.co.uk","live.com","live.com.ar","live.com.mx","live.de","live.es","live.eu","live.fr","live.it","live.nl","msn.com","outlook.at","outlook.be","outlook.cl","outlook.co.il","outlook.co.nz","outlook.co.th","outlook.com","outlook.com.ar","outlook.com.au","outlook.com.br","outlook.com.gr","outlook.com.pe","outlook.com.tr","outlook.com.vn","outlook.cz","outlook.de","outlook.dk","outlook.es","outlook.fr","outlook.hu","outlook.id","outlook.ie","outlook.in","outlook.it","outlook.jp","outlook.kr","outlook.lv","outlook.my","outlook.ph","outlook.pt","outlook.sa","outlook.sg","outlook.sk","passport.com"],l=["rocketmail.com","yahoo.ca","yahoo.co.uk","yahoo.com","yahoo.de","yahoo.fr","yahoo.in","yahoo.it","ymail.com"],c=["yandex.ru","yandex.ua","yandex.kz","yandex.com","yandex.by","ya.ru"];function u(e){return e.length>1?e:""}e.exports=t.default,e.exports.default=t.default},88397:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,o.default)(e),t){var n=new RegExp("[".concat(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"]+$"),"g");return e.replace(n,"")}var i=e.length-1;for(;/\s/.test(e.charAt(i));)i-=1;return e.slice(0,i+1)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},39551:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){(0,i.default)(e);var n=t?"\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F":"\\x00-\\x1F\\x7F";return(0,o.default)(e,n)};var i=r(n(76041)),o=r(n(42092));function r(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default,e.exports.default=t.default},8900:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if((0,o.default)(e),t)return"1"===e||/^true$/i.test(e);return"0"!==e&&!/^false$/i.test(e)&&""!==e};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},29410:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),e=Date.parse(e),isNaN(e)?null:new Date(e)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},92774:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e)?parseFloat(e):NaN};var i,o=(i=n(30545))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},59737:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,o.default)(e),parseInt(e,t||10)};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},44767:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,i.default)((0,o.default)(e,t),t)};var i=r(n(88397)),o=r(n(52187));function r(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default,e.exports.default=t.default},44247:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,o.default)(e),e.replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#x2F;/g,"/").replace(/&#x5C;/g,"\\").replace(/&#96;/g,"`").replace(/&amp;/g,"&")};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default},44032:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.iso7064Check=function(e){for(var t=10,n=0;n<e.length-1;n++)t=(parseInt(e[n],10)+t)%10==0?9:(parseInt(e[n],10)+t)%10*2%11;return(t=1===t?0:11-t)===parseInt(e[10],10)},t.luhnCheck=function(e){for(var t=0,n=!1,i=e.length-1;i>=0;i--){if(n){var o=2*parseInt(e[i],10);t+=o>9?o.toString().split("").map((function(e){return parseInt(e,10)})).reduce((function(e,t){return e+t}),0):o}else t+=parseInt(e[i],10);n=!n}return t%10==0},t.reverseMultiplyAndSum=function(e,t){for(var n=0,i=0;i<e.length;i++)n+=e[i]*(t-i);return n},t.verhoeffCheck=function(e){for(var t=[[0,1,2,3,4,5,6,7,8,9],[1,2,3,4,0,6,7,8,9,5],[2,3,4,0,1,7,8,9,5,6],[3,4,0,1,2,8,9,5,6,7],[4,0,1,2,3,9,5,6,7,8],[5,9,8,7,6,0,4,3,2,1],[6,5,9,8,7,1,0,4,3,2],[7,6,5,9,8,2,1,0,4,3],[8,7,6,5,9,3,2,1,0,4],[9,8,7,6,5,4,3,2,1,0]],n=[[0,1,2,3,4,5,6,7,8,9],[1,5,7,6,2,8,3,0,9,4],[5,8,0,3,7,9,6,1,4,2],[8,9,1,6,0,4,3,5,2,7],[9,4,5,3,1,2,6,8,7,0],[4,2,8,6,5,7,3,9,0,1],[2,7,9,3,8,0,6,4,1,5],[7,0,4,6,9,1,3,2,5,8]],i=e.split("").reverse().join(""),o=0,r=0;r<i.length;r++)o=t[o][n[r%8][parseInt(i[r],10)]];return 0===o}},76041:(e,t)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!("string"==typeof e||e instanceof String)){var t=n(e);throw null===e?t="null":"object"===t&&(t=e.constructor.name),new TypeError("Expected a string but received a ".concat(t))}},e.exports=t.default,e.exports.default=t.default},54019:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(e,t){return e.some((function(e){return t===e}))};t.default=n,e.exports=t.default,e.exports.default=t.default},92372:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;for(var n in t)void 0===e[n]&&(e[n]=t[n]);return e},e.exports=t.default,e.exports.default=t.default},78756:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=e.join("");return new RegExp(n,t)},e.exports=t.default,e.exports.default=t.default},95894:(e,t)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){"object"===n(e)&&null!==e?e="function"==typeof e.toString?e.toString():"[object Object]":(null==e||isNaN(e)&&!e.length)&&(e="");return String(e)},e.exports=t.default,e.exports.default=t.default},75742:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){return(0,o.default)(e),e.replace(new RegExp("[^".concat(t,"]+"),"g"),"")};var i,o=(i=n(76041))&&i.__esModule?i:{default:i};e.exports=t.default,e.exports.default=t.default}},e=>{e.O(0,[4644,4394,2076],(()=>{return t=97258,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=module_rb.0e3de61a.bundle.js.map