(self.webpackChunk=self.webpackChunk||[]).push([[8519],{45096:(e,t,a)=>{"use strict";var i=a(86326),n=a(35623),s=a(29079),r=a(58591),l=a(80841),c=a(67599),d=a(23507),o=a(91185),m=a(94440),u=a(68820),y=a(59865),p=a(96478),g=a(44850),_=a(97598),v=a.n(_);function D(e){let{icon:t,label:a,description:n,children:s}=e;return i.createElement("div",{className:"section"},i.createElement("span",{className:`icon icon-${t}`}),i.createElement("div",{className:"text"},i.createElement("div",{className:"label"},a),n),i.createElement("div",{className:"toolbar"},s))}D.propTypes={icon:v().string.isRequired,label:v().oneOfType([v().string,v().node]).isRequired,description:v().oneOfType([v().string,v().node]).isRequired,children:v().node.isRequired};var b=a(36111),f=a(12959),E=a.n(f),h=a(78434),T=a.n(h),A=a(11308),w=a.n(A),C=a(70953),R=a.n(C),S=a(97440),I=a.n(S),k=a(92117),x=a(99323),j=a(56237),N=a(6841),O=a(49528),q=a(24372),F=a(57087);function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function L(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){(0,b.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const U=s.Ay.bind(null,{endpoint:"event_editing.api_assign_editable_self",rules:[{args:["contrib_id","event_id","type"],converters:{contrib_id:"IntegerConverter",event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contrib_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editor",isDynamic:!1},{data:"/",isDynamic:!1},{data:"me",isDynamic:!1}]}]},"/"),M=s.Ay.bind(null,{endpoint:"event_editing.api_file_types",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"file-types",isDynamic:!1}]}]},"/"),z=s.Ay.bind(null,{endpoint:"event_editing.api_filter_editables_by_filetypes",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"list-with-filetypes",isDynamic:!1}]}]},"/");function B(e){let{eventId:t,editableType:a,onClose:n,management:s}=e;const{data:r,loading:l}=(0,y.Ku)(M({event_id:t,type:a}),{camelize:!0});return l?i.createElement(d.A,{active:!0}):r?i.createElement(H,{eventId:t,editableType:a,onClose:n,fileTypes:r,management:s}):null}function H(e){let{eventId:t,editableType:a,onClose:n,fileTypes:s,management:r}=e;const[c,o]=(0,i.useState)(null),[m,y]=(0,i.useState)({}),[_,v]=(0,i.useState)(new Set),[D,b]=(0,i.useState)(null),[f,h]=(0,i.useState)(!0),A=(0,i.useRef)(null),C=(0,l.useHistory)(),S=e=>{v(e),D&&!e.has(D.id)&&b(null)},N=(0,i.useMemo)((()=>[{key:"code",text:p.Translate.string("Program code"),options:R()(null==c?void 0:c.map((e=>e.contributionCode)).filter((e=>e))).map((e=>({value:e,text:e}))),isMatch:(e,t)=>t.includes(e.contributionCode)},{key:"keywords",text:p.Translate.string("Keywords"),options:R()(w()(null==c?void 0:c.map((e=>e.contributionKeywords)))).map((e=>({value:e,text:e}))),isMatch:(e,t)=>e.contributionKeywords.some((e=>t.includes(e)))},...s.map((e=>{let{id:t,name:a,extensions:i}=e;return{key:`filetypes_${t}`,text:a,options:[...i.length>1?i.map((e=>({value:`has_ext_${e}`,text:e}))):[{value:"has_files",text:p.Translate.string("has files"),exclusive:!0}],{value:"has_no_files",text:p.Translate.string("has no files"),exclusive:!0}]}}))]),[c,s]),F=(0,i.useMemo)((()=>E()((null==c?void 0:c.map((e=>L(L({},e),{},{canAssignSelf:!!_.has(e.id)&&e.canAssignSelf}))))||[],"canAssignSelf","desc")),[c,_]);return i.createElement(k.A,{onClose:n,closeOnDimmerClick:!1,open:!0},i.createElement(k.A.Header,null,g.R0[a]),i.createElement(k.A.Content,null,i.createElement("div",{className:"events-editing-client-js-management-editable_type-___NextEditable-module__filetype-list___J16Ux"},i.createElement(u.ListFilter,{name:`get-next-${a}-filter-${t}`,list:c||[],filters:m,filterOptions:N,searchableId:e=>e.contributionFriendlyId,searchableFields:e=>e.editor?[e.contributionTitle,e.contributionCode,e.editor.fullName]:[e.contributionTitle,e.contributionCode],onChangeFilters:async e=>{const i=/^filetypes_(\d+)$/,n=e=>{const t=/^has_ext_(.*)$/,a=Object.keys(e).filter((e=>t.exec(e)));return a.length>0?a.map((e=>t.exec(e)[1])):!e.has_no_files},s=Object.keys(e).filter((e=>i.exec(e))).reduce(((t,a)=>L(L({},t),{},{[+i.exec(a)[1]]:n(e[a])})),{});let r=c;T()(A.current,s)||(h(!0),r=await(async e=>{let i;try{i=await O.indicoAxios.post(z({event_id:t,type:a}),{extensions:I()(e,(e=>Array.isArray(e))),has_files:I()(e,(e=>!Array.isArray(e)))})}catch(e){return void(0,O.handleAxiosError)(e)}return(0,q.camelizeKeys)(i.data)})(s),h(!1),o(r),A.current=s);const l=r.filter((t=>N.every((a=>{let{key:i,isMatch:n}=a;return!e[i]||!n||n(t,Object.keys(e[i]||{}))}))));y(e),S(new Set(l.map((e=>e.id))))},onChangeList:S})),i.createElement(x.A.Dimmable,{className:"events-editing-client-js-management-editable_type-___NextEditable-module__filtered-editables___Tr97R",dimmed:f},i.createElement(V,{filteredEditables:F,selectedEditable:D,setSelectedEditable:b}),i.createElement(x.A,{active:f,inverted:!0},i.createElement(d.A,null)))),i.createElement(k.A.Actions,{style:{display:"flex",justifyContent:"flex-end"}},i.createElement(j.A,{onClick:n},i.createElement(p.Translate,null,"Cancel")),i.createElement(j.A,{color:"blue",onClick:async()=>{try{await O.indicoAxios.put(U({event_id:t,contrib_id:D.contributionId,type:a}))}catch(e){return void(0,O.handleAxiosError)(e)}r?location.href=D.timelineURL:C.push(D.timelineURL)},disabled:null===D},i.createElement(p.Translate,null,"Assign to myself"))))}function V(e){let{filteredEditables:t,selectedEditable:a,setSelectedEditable:n}=e;if(null===t)return null;const s=Object.values(t).some((e=>e.contributionCode));return t.length?i.createElement(N.A,{basic:"very",striped:!0},i.createElement(N.A.Header,null,i.createElement(N.A.Row,null,i.createElement(N.A.HeaderCell,{style:{width:"2%"}}),i.createElement(N.A.HeaderCell,{style:{width:"6%"}},"ID"),s&&i.createElement(N.A.HeaderCell,{style:{width:"10%"}},"Code"),i.createElement(N.A.HeaderCell,null,"Title"),i.createElement(N.A.HeaderCell,{style:{width:"18%"}},"Editor"))),i.createElement(N.A.Body,null,t.map((e=>i.createElement(N.A.Row,{key:e.id,style:e.canAssignSelf?{}:{opacity:"50%"}},i.createElement(N.A.Cell,null,i.createElement(o.A,{radio:!0,disabled:!e.canAssignSelf,value:e.id,checked:(null==a?void 0:a.id)===e.id,onChange:()=>n(e)})),i.createElement(N.A.Cell,null,e.contributionFriendlyId),s&&i.createElement(N.A.Cell,null,e.contributionCode?e.contributionCode:p.Translate.string("n/a")),i.createElement(N.A.Cell,null,i.createElement("a",{href:e.timelineURL,target:"_blank",rel:"noopener noreferrer"},e.contributionTitle)),i.createElement(N.A.Cell,null,e.editor?e.editor.fullName:"")))))):i.createElement("div",{className:"events-editing-client-js-management-editable_type-___NextEditable-module__no-editables-available___04-L+"},i.createElement(p.Translate,null,"There are no editables available."))}B.propTypes={eventId:v().number.isRequired,editableType:v().oneOf(Object.values(g.zl)).isRequired,onClose:v().func.isRequired,management:v().bool.isRequired},H.propTypes={eventId:v().number.isRequired,editableType:v().string.isRequired,onClose:v().func.isRequired,fileTypes:v().arrayOf(v().shape(F.Zh)).isRequired,management:v().bool.isRequired},V.propTypes={filteredEditables:v().array,selectedEditable:v().object,setSelectedEditable:v().func.isRequired},V.defaultProps={filteredEditables:null,selectedEditable:null};var K=a(87597),J=a(89152),$=a(63173);const G=s.Ay.bind(null,{endpoint:"event_editing.api_editable_type_principals",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"principals",isDynamic:!1}]}]},"/");function X(e){let{editableType:t,onClose:a}=e;const n=(0,c.Uf)("event_id"),s=(0,y.EV)(),{data:r,loading:l}=(0,y.Ku)(G({event_id:n,type:t}));return l?i.createElement(d.A,{active:!0}):r?i.createElement($.Sz,{id:"team-manager",size:"small",onSubmit:async(e,i)=>{const s=(0,J.getChangedValues)(e,i);try{await O.indicoAxios.post(G({event_id:n,type:t}),s)}catch(e){return(0,J.handleSubmitError)(e)}a()},onClose:a,header:p.Translate.string("Set editors"),initialValues:{principals:r},initialValuesEqual:T(),unloadPrompt:!0,unloadPromptRouter:!0},i.createElement(K.A,null,i.createElement(u.FinalPrincipalList,{name:"principals",withEventRoles:!0,withCategoryRoles:!0,favoriteUsersController:s,label:p.Translate.string("Editors"),eventId:n}))):null}X.propTypes={editableType:v().string.isRequired,onClose:v().func.isRequired};const Y=s.Ay.bind(null,{endpoint:"event_editing.api_anonymous_team",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editable-assignment",isDynamic:!1},{data:"/",isDynamic:!1},{data:"anonymous-team",isDynamic:!1}]}]},"/"),Z=s.Ay.bind(null,{endpoint:"event_editing.api_contribs_with_no_editables",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"not-submitted",isDynamic:!1}]}]},"/"),Q=s.Ay.bind(null,{endpoint:"event_editing.api_editing_enabled",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing-enabled",isDynamic:!1}]}]},"/"),W=s.Ay.bind(null,{endpoint:"event_editing.api_email_not_submitted_metadata",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"email-not-submitted",isDynamic:!1},{data:"/",isDynamic:!1},{data:"metadata",isDynamic:!1}]}]},"/"),ee=s.Ay.bind(null,{endpoint:"event_editing.api_email_not_submitted_preview",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"email-not-submitted",isDynamic:!1},{data:"/",isDynamic:!1},{data:"preview",isDynamic:!1}]}]},"/"),te=s.Ay.bind(null,{endpoint:"event_editing.api_email_not_submitted_send",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"email-not-submitted",isDynamic:!1},{data:"/",isDynamic:!1},{data:"send",isDynamic:!1}]}]},"/"),ae=s.Ay.bind(null,{endpoint:"event_editing.api_self_assign_enabled",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editable-assignment",isDynamic:!1},{data:"/",isDynamic:!1},{data:"self-assign-enabled",isDynamic:!1}]}]},"/"),ie=s.Ay.bind(null,{endpoint:"event_editing.api_submission_enabled",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"submission-enabled",isDynamic:!1}]}]},"/"),ne=s.Ay.bind(null,{endpoint:"event_editing.contact_team",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"contact-team",isDynamic:!1}]}]},"/"),se=s.Ay.bind(null,{endpoint:"event_editing.dashboard",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),re=s.Ay.bind(null,{endpoint:"event_editing.manage_editable_type_list",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"list",isDynamic:!1}]}]},"/"),le=s.Ay.bind(null,{endpoint:"event_editing.manage_file_types",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"types",isDynamic:!1}]}]},"/"),ce=s.Ay.bind(null,{endpoint:"event_editing.manage_review_conditions",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"review-conditions",isDynamic:!1}]}]},"/");function de(){const e=(0,c.Uf)("event_id"),{type:t}=(0,l.useParams)(),[a,n]=(0,i.useState)(!1),[s,_]=(0,i.useState)(!1),[v,b,f,E]=(0,y.ib)(ae({event_id:e,type:t})),[h,T,A,w]=(0,y.ib)(Y({event_id:e,type:t})),[C,R,S]=(0,y.ib)(ie({event_id:e,type:t})),[I,k,x]=(0,y.ib)(Q({event_id:e,type:t})),j={paper:p.Translate.string("Assign an editor to papers"),poster:p.Translate.string("Assign an editor to posters"),slides:p.Translate.string("Assign an editor to slides")}[t],{data:N}=(0,y.Ku)(Z({event_id:e,type:t})),O=(null==N?void 0:N.count)||0;return i.createElement(i.Fragment,null,i.createElement(u.ManagementPageSubTitle,{title:g.SN[t]}),i.createElement(u.ManagementPageBackButton,{url:se({event_id:e})}),f||A||S||x?i.createElement(d.A,{active:!0}):i.createElement(i.Fragment,null,i.createElement("div",{className:"action-box"},i.createElement(D,{icon:"file",label:C?p.Translate.string("Submission is open"):p.Translate.string("Submission is not open"),description:p.Translate.string("Toggle whether users can submit new editables")},i.createElement("button",{className:"i-button highlight",onClick:R,type:"button"},C?p.Translate.string("Close now"):p.Translate.string("Start now"))),i.createElement(D,{icon:"edit",label:I?p.Translate.string("Editing is open"):p.Translate.string("Editing is not open"),description:p.Translate.string("Toggle whether editors can review submissions")},i.createElement("button",{className:"i-button highlight",onClick:k,type:"button"},I?p.Translate.string("Close now"):p.Translate.string("Start now"))),i.createElement(D,{icon:"bell",label:p.Translate.string("Remind submitters"),description:p.Translate.string("Send an email to authors who have not submitted any files of this editable type")},i.createElement("span",{className:"i-label",title:p.Translate.string("Contributions without editables")},O),i.createElement(m.L,{objectContext:"contributions",metadataURL:W({event_id:e,type:t}),previewURL:ee({event_id:e,type:t}),sendURL:te({event_id:e,type:t}),className:O>0?"":"disabled"}))),i.createElement("div",{className:"action-box"},i.createElement(D,{icon:"file",label:p.Translate.string("File types"),description:p.Translate.string("Configure file types")},i.createElement(r.Link,{className:"i-button icon-settings",to:le({event_id:e,type:t})},i.createElement(p.Translate,null,"Configure"))),i.createElement(D,{icon:"equalizer",label:p.Translate.string("Ready for review conditions"),description:p.Translate.string("Configure conditions for reviewing")},i.createElement(r.Link,{className:"i-button icon-settings",to:ce({event_id:e,type:t})},i.createElement(p.Translate,null,"Configure"))),i.createElement(D,{icon:"users",label:p.Translate.string("Editing team"),description:p.Translate.string("Configure editing team")},i.createElement(o.A,{className:"events-editing-client-js-management-editable_type-___EditableTypeDashboard-module__toolbar-checkbox___in161",toggle:!0,checked:h,onClick:w?null:T,label:p.Translate.string("Keep editing team members anonymous")}),i.createElement("button",{className:"i-button icon-mail",onClick:()=>{ajaxDialog({url:ne({event_id:e,type:t}),title:p.Translate.string("Send emails to the editing team")})},type:"button"},i.createElement(p.Translate,null,"Contact")),i.createElement("button",{className:"i-button icon-users",onClick:()=>n(!0),type:"button"},i.createElement(p.Translate,null,"Manage team")),a&&i.createElement(X,{editableType:t,onClose:()=>n(!1)})),i.createElement(D,{icon:"copy1",label:p.Translate.string("Editor assignment"),description:j},i.createElement(o.A,{className:"events-editing-client-js-management-editable_type-___EditableTypeDashboard-module__toolbar-checkbox___in161",toggle:!0,checked:v,onClick:E?null:b,label:p.Translate.string("Allow editors to self-assign editables")}),i.createElement(r.Link,{className:"i-button icon-list",to:re({event_id:e,type:t})},i.createElement(p.Translate,null,"List")),i.createElement("a",{className:"i-button icon-arrow-right-sparse",onClick:()=>_(!0)},g.R0[t]),s&&i.createElement(B,{eventId:e,editableType:t,onClose:()=>_(!1),management:!0})))))}const oe=s.Ay.bind(null,{endpoint:"event_editing.manage_editable_type",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1}]}]},"/");function me(e){let{title:t}=e;const a=(0,c.Uf)("event_id"),{type:n}=(0,l.useParams)();return i.createElement(i.Fragment,null,i.createElement(u.ManagementPageTitle,{title:p.Translate.string("Editing ({type})",{type:g.SN[n]})}),i.createElement(u.ManagementPageSubTitle,{title:t}),i.createElement(u.ManagementPageBackButton,{url:oe({event_id:a,type:n})}))}me.propTypes={title:v().string.isRequired};var ue=a(47279),ye=a(57427),pe=a(54219),ge=a(16520),_e=a(45423),ve=a(49138);function De(e){let{value:t,disabled:a,onChange:n,onFocus:s,onBlur:r}=e;return i.createElement(ve.A,{options:t.map((e=>({text:e,value:e}))),value:t,disabled:a,search:!0,selection:!0,multiple:!0,allowAdditions:!0,fluid:!0,icon:null,closeOnChange:!0,noResultsMessage:p.Translate.string("Enter an extension"),additionLabel:p.Translate.string("Add extension")+" ",onChange:(e,t)=>{let{value:a}=t;n(R()(a.map((e=>e.trim().replace(/^[*.]+/,""))))),s(),r()}})}function be(e){let{onClose:t,onSubmit:a,fileType:n,header:s}=e;const{name:r,filenameTemplate:l,extensions:c,required:d,allowMultipleFiles:o,publishable:m}=n;return i.createElement($.Sz,{id:"file-type",onSubmit:async(e,i)=>{const n=await a(e,i);if(n)return n;t()},onClose:t,header:s,initialValues:{name:r,extensions:c,required:d,publishable:m,filename_template:l,allow_multiple_files:o}},n.isUsed&&i.createElement(K.A,{visible:!0,warning:!0},i.createElement(K.A.Content,null,i.createElement(ue.A,{name:"warning",size:"large"}),i.createElement(p.Translate,null,"Take into account that this file type has files attached to it."))),i.createElement(J.FinalInput,{name:"name",label:p.Translate.string("Name"),required:!0}),i.createElement(J.FinalInput,{name:"filename_template",label:p.Translate.string("Filename template"),description:i.createElement(p.Translate,null,"Glob-style filename template that all files of this type have to conform to (e.g."," ",i.createElement(p.Param,{name:"example",value:"*_paper",wrapper:i.createElement("code",null)}),"). No dots allowed. It is possible to use"," ",i.createElement(p.Param,{name:"placeholder",value:"{code}",wrapper:i.createElement("code",null)})," as a placeholder for the contribution program code."),pattern:"^[^.]*$",nullIfEmpty:!0}),i.createElement(J.FinalField,{name:"extensions",component:De,label:p.Translate.string("Extensions"),isEqual:J.unsortedArraysEqual,description:i.createElement(p.Translate,null,"Allowed file extensions. If left empty, there are no extension restrictions")}),i.createElement(_e.A,null,"Options"),i.createElement(J.FinalCheckbox,{name:"required",label:p.Translate.string("File required"),description:i.createElement(p.Translate,null,"Whether the file type is mandatory")}),i.createElement(J.FinalCheckbox,{name:"allow_multiple_files",label:p.Translate.string("Multiple files"),description:i.createElement(p.Translate,null,"Whether the file type allows uploading multiple files")}),i.createElement(J.FinalCheckbox,{name:"publishable",label:p.Translate.string("Publishable"),description:i.createElement(p.Translate,null,"Whether the files of this type can be published")}))}De.propTypes={value:v().arrayOf(v().string).isRequired,disabled:v().bool.isRequired,onChange:v().func.isRequired,onFocus:v().func.isRequired,onBlur:v().func.isRequired},be.propTypes={onClose:v().func,onSubmit:v().func.isRequired,header:v().string.isRequired,fileType:v().object},be.defaultProps={fileType:{name:null,extensions:[],required:!1,allowMultipleFiles:!1,publishable:!1,isUsed:!1,filenameTemplate:null},onClose:null};function fe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}const Ee=s.Ay.bind(null,{endpoint:"event_editing.api_add_file_type",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"file-types",isDynamic:!1}]}]},"/"),he=s.Ay.bind(null,{endpoint:"event_editing.api_edit_file_type",rules:[{args:["event_id","file_type_id","type"],converters:{event_id:"IntegerConverter",file_type_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"file-types",isDynamic:!1},{data:"/",isDynamic:!1},{data:"file_type_id",isDynamic:!0}]}]},"/"),Te=s.Ay.bind(null,{endpoint:"event_editing.api_file_types",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"file-types",isDynamic:!1}]}]},"/"),Ae={fileType:null,operation:null};function we(e,t){switch(t.type){case"ADD_FILE_TYPE":return{operation:"add",fileType:null};case"EDIT_FILE_TYPE":return{operation:"edit",fileType:t.fileType};case"DELETE_FILE_TYPE":return{operation:"delete",fileType:t.fileType};case"CLEAR":return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(a),!0).forEach((function(t){(0,b.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):fe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},Ae);default:return e}}function Ce(e){let{active:t,icon:a,text:n}=e;return i.createElement(ue.A,{size:"small",color:t?"blue":"grey",name:a,title:t?n:""})}function Re(e){let{eventId:t,editableType:a}=e;const[n,s]=(0,i.useReducer)(we,Ae),{data:r,loading:l,reFetch:c,lastData:o}=(0,y.Ku)(Te({event_id:t,type:a}),{camelize:!0}),m=r||o;if(l&&!o)return i.createElement(d.A,{inline:"centered",active:!0});if(!m)return null;const g=e=>!e.isUsedInCondition&&!e.isUsed&&!(e=>{const t=m.filter((e=>e.publishable));return 1===t.length&&t[0].id===e})(e.id),_=e=>g(e)?null:e.isUsed?i.createElement(p.Translate,null,"This type has files attached"):e.isUsedInCondition?i.createElement(p.Translate,null,"This type is used in a review condition"):i.createElement(p.Translate,null,"Cannot delete the only publishable type"),{operation:v,fileType:D}=n;return i.createElement("div",{className:"events-editing-client-js-management-editable_type-file_types-___FileTypeManager-module__file-types-container___s-HOQ"},0===m.length&&i.createElement(K.A,{info:!0},i.createElement(p.Translate,null,"There are no file types defined for this event")),m.map((e=>i.createElement(ye.A,{key:e.id,className:"events-editing-client-js-management-editable_type-file_types-___FileTypeManager-module__filetype-segment___iMrIy"},i.createElement(pe.A,{ribbon:!0},i.createElement(Ce,{active:e.required,icon:"asterisk",text:p.Translate.string("File required")}),i.createElement(Ce,{active:e.allowMultipleFiles,icon:"copy outline",text:p.Translate.string("Multiple files allowed")}),i.createElement(Ce,{active:e.publishable,icon:"eye",text:p.Translate.string("File publishable")})),i.createElement(ge.A,{on:"hover",disabled:g(e),position:"right center",content:_(e),trigger:i.createElement(ue.A,{style:g(e)?{cursor:"pointer"}:{},color:"red",name:"trash",corner:"top right",disabled:!g(e),onClick:()=>g(e)&&s({type:"DELETE_FILE_TYPE",fileType:e})})}),i.createElement(ue.A,{style:{cursor:"pointer"},color:"blue",name:"pencil",corner:"top right",onClick:()=>s({type:"EDIT_FILE_TYPE",fileType:e})}),i.createElement("div",{className:"events-editing-client-js-management-editable_type-file_types-___FileTypeManager-module__filetype-header___nb5mO"},i.createElement("h3",null,i.createElement(u.TooltipIfTruncated,null,i.createElement("span",{className:"events-editing-client-js-management-editable_type-file_types-___FileTypeManager-module__name___MUhcW"},e.name))),i.createElement("ul",{className:"events-editing-client-js-management-editable_type-file_types-___FileTypeManager-module__file-extensions___zQKeu"},0!==e.extensions.length?e.extensions.map((e=>i.createElement("li",{key:e},e))):p.Translate.string("(no extension restrictions)")))))),i.createElement(j.A,{primary:!0,floated:"right",onClick:()=>s({type:"ADD_FILE_TYPE"})},i.createElement(ue.A,{name:"plus"}),i.createElement(p.Translate,null,"Add a new file type")),["add","edit"].includes(v)&&i.createElement(be,{header:"edit"===v?p.Translate.string("Edit file type"):p.Translate.string("Create a new file type"),onSubmit:async(e,i)=>"edit"===v?await(async(e,i)=>{const n=he({event_id:t,file_type_id:e,type:a});try{await O.indicoAxios.patch(n,i),c()}catch(e){return(0,J.handleSubmitError)(e)}})(D.id,(0,J.getChangedValues)(e,i)):await(async e=>{try{await O.indicoAxios.post(Ee({event_id:t,type:a}),e),c()}catch(e){return(0,J.handleSubmitError)(e)}})(e),fileType:D||void 0,onClose:()=>s({type:"CLEAR"})}),i.createElement(u.RequestConfirmDelete,{onClose:()=>s({type:"CLEAR"}),requestFunc:()=>(async e=>{const i=he({event_id:t,file_type_id:e,type:a});try{await O.indicoAxios.delete(i),c()}catch(e){return(0,O.handleAxiosError)(e),!0}})(D.id),open:"delete"===v},D&&i.createElement(p.Translate,null,"Are you sure you want to delete the file type"," ",i.createElement(p.Param,{name:"fileType",value:D.name,wrapper:i.createElement("strong",null)}),"?")))}function Se(){const e=(0,c.Uf)("event_id"),{type:t}=(0,l.useParams)();return i.createElement(i.Fragment,null,i.createElement(me,{title:p.Translate.string("File types")}),i.createElement(Re,{eventId:e,editableType:t}))}Ce.propTypes={active:v().bool.isRequired,icon:v().string.isRequired,text:v().string.isRequired},Re.propTypes={eventId:v().number.isRequired,editableType:v().oneOf(Object.values(g.zl)).isRequired};const Ie=i.createContext(null);var ke=a(503),xe=a(42430),je=a(6423);function Ne(e){let{types:t,onSubmit:a,onDismiss:n}=e;const{fileTypes:s}=(0,i.useContext)(Ie),r=s.map((e=>({text:e.name,value:e.id})));return i.createElement("div",{className:"events-editing-client-js-management-editable_type-review_conditions-___ReviewConditionForm-module__condition-form___lQhOw"},i.createElement(xe.Form,{onSubmit:a,initialValues:{file_types:t},subscription:{submitting:!0}},(e=>{let{handleSubmit:t,submitting:a}=e;return i.createElement(je.A,{onSubmit:t},i.createElement("div",{className:"events-editing-client-js-management-editable_type-review_conditions-___ReviewConditionForm-module__file-types-dropdown___yxmGj"},i.createElement(J.FinalDropdown,{placeholder:p.Translate.string("Select filetypes to create a condition"),name:"file_types",options:r,hideValidationError:!0,required:!0,selection:!0,multiple:!0,search:!0})),i.createElement("div",{className:"events-editing-client-js-management-editable_type-review_conditions-___ReviewConditionForm-module__action-buttons___-mika"},i.createElement(J.FinalSubmitButton,{icon:"checkmark",size:"mini",circular:!0,primary:!0}),i.createElement(j.A,{icon:"cancel",size:"mini",onClick:n,disabled:a,circular:!0})))})))}Ne.propTypes={types:v().arrayOf(v().number),onSubmit:v().func.isRequired,onDismiss:v().func.isRequired},Ne.defaultProps={types:[]};const Oe=s.Ay.bind(null,{endpoint:"event_editing.api_edit_review_condition",rules:[{args:["condition_id","event_id","type"],converters:{condition_id:"IntegerConverter",event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"review-conditions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"condition_id",isDynamic:!0}]}]},"/");function qe(e){let{fileTypes:t,condId:a,editableType:n,onUpdate:s,disableActions:r}=e;const[l,c]=(0,i.useState)(!1),[d,o]=(0,i.useState)(!1),{eventId:m}=(0,i.useContext)(Ie),y=Oe({event_id:m,condition_id:a,type:n});return l?i.createElement(Ne,{types:t.map((e=>e.id)),onDismiss:()=>c(!1),onSubmit:async e=>{try{await O.indicoAxios.patch(y,e)}catch(e){return(0,J.handleSubmitError)(e)}s&&s(),c(!1)}}):i.createElement(i.Fragment,null,i.createElement("div",{className:"events-editing-client-js-management-editable_type-review_conditions-___ConditionInfo-module__types-list___iKqRf"},t.map(((e,a)=>i.createElement(i.Fragment,{key:e.id},i.createElement(u.TooltipIfTruncated,null,i.createElement(pe.A,{basic:!0},e.name)),a!==t.length-1&&i.createElement(pe.A,{as:"span",color:"orange",size:"small",circular:!0},i.createElement(p.Translate,null,"AND")))))),i.createElement("div",{className:"events-editing-client-js-management-editable_type-review_conditions-___ConditionInfo-module__condition-actions___zPyeq"},i.createElement(ue.A,{color:"blue",name:"pencil",onClick:()=>c(!0),disabled:r}),i.createElement(ue.A,{color:"red",name:"trash",onClick:()=>o(!0),disabled:r})),i.createElement(u.RequestConfirmDelete,{onClose:()=>o(!1),requestFunc:async()=>{try{await O.indicoAxios.delete(y)}catch(e){return(0,O.handleAxiosError)(e),!0}s&&s()},open:d},i.createElement(p.Translate,null,"Are you sure you want to delete this condition?")))}qe.propTypes={fileTypes:v().array.isRequired,condId:v().number.isRequired,editableType:v().oneOf(Object.values(g.zl)).isRequired,onUpdate:v().func,disableActions:v().bool},qe.defaultProps={onUpdate:null,disableActions:!1};const Fe=s.Ay.bind(null,{endpoint:"event_editing.api_review_conditions",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"review-conditions",isDynamic:!1}]}]},"/");function Pe(){const{eventId:e,fileTypes:t,editableType:a}=(0,i.useContext)(Ie),[n,s]=(0,i.useState)(!1),{loading:r,reFetch:l,data:c,lastData:o}=(0,y.Ku)(Fe({event_id:e,type:a})),m=c||o;if(r&&!o)return i.createElement(d.A,{inline:"centered",active:!0});if(!m)return null;const u=m.map((e=>{let[a,i]=e;return[a,i.map((e=>t.find((t=>{let{id:a}=t;return a===e}))))]}));return i.createElement("div",{className:"events-editing-client-js-management-editable_type-review_conditions-___ReviewConditionsManager-module__conditions-container___i4GxF"},i.createElement(K.A,{info:!0},i.createElement(p.Translate,null,"Here you can define what filetype-related conditions have to be met for a submission to be eligible for review. In order to start the review process, uploaded files must meet one of the specified criteria.")),0===m.length&&i.createElement(K.A,{info:!0},i.createElement(p.Translate,null,"No reviewing conditions have been defined")),i.createElement("div",null,u.map(((e,t)=>{let[n,s]=e;return i.createElement(i.Fragment,{key:n},i.createElement("div",{className:"events-editing-client-js-management-editable_type-review_conditions-___ReviewConditionsManager-module__condition-row___uSZ0H"},i.createElement(qe,{fileTypes:s,condId:n,editableType:a,onUpdate:()=>l(),disableActions:r})),t!==Object.keys(u).length-1&&i.createElement(ke.A,{horizontal:!0},i.createElement(p.Translate,null,"OR")))})),u.length>0&&i.createElement(ke.A,{horizontal:!0},i.createElement(p.Translate,null,"Or")),n?i.createElement("div",{className:"events-editing-client-js-management-editable_type-review_conditions-___ReviewConditionsManager-module__condition-row___uSZ0H"},i.createElement(Ne,{onSubmit:async t=>{try{await O.indicoAxios.post(Fe({event_id:e,type:a}),t),s(!1),l()}catch(e){return(0,J.handleSubmitError)(e)}},onDismiss:()=>s(!1)})):i.createElement(j.A,{onClick:()=>s(!0),disabled:n||r,floated:"right",primary:!0},i.createElement(p.Translate,null,"Create new filetype condition"))))}const Le=s.Ay.bind(null,{endpoint:"event_editing.api_file_types",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"file-types",isDynamic:!1}]}]},"/");function Ue(){const e=(0,c.Uf)("event_id"),{type:t}=(0,l.useParams)(),{data:a}=(0,y.Ku)(Le({event_id:e,type:t}),{camelize:!0});return i.createElement(i.Fragment,null,i.createElement(me,{title:p.Translate.string("Review conditions")}),null!==a&&i.createElement(Ie.Provider,{value:{eventId:e,editableType:t,fileTypes:a}},i.createElement(Pe,null)))}var Me=a(77940),ze=a(32004),Be=a.n(ze),He=a(87493),Ve=a.n(He),Ke=a(98502),Je=a(78905),$e=a(90013),Ge=a(24720);const Xe={replaced:"orange",needs_submitter_confirmation:"yellow",rejected:"black",accepted:"green",needs_submitter_changes:"red",ready_for_review:"grey"},Ye={replaced:$e.A.orange,needs_submitter_confirmation:$e.A.yellow,rejected:$e.A.black,accepted:$e.A.green,needs_submitter_changes:$e.A.red,not_submitted:$e.A.black,ready_for_review:$e.A.blue};function Ze(e){let{label:t,circular:a,basic:n,tooltip:s,state:r,monochrome:l}=e;const c=Ye[r]||$e.A.black,d=i.createElement(pe.A,{size:"tiny",color:l?"grey":Xe[r],circular:a,basic:n});return i.createElement(i.Fragment,null,i.createElement(ge.A,{position:"bottom center",trigger:d,content:s,on:"hover",disabled:!s}),t&&i.createElement("div",{className:"events-editing-client-js-editing-timeline-___StateIndicator-module__label-text___1APey",style:{color:l?$e.A.gray:c}},g.r8[r]||p.Translate.string("Unknown")))}function Qe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function We(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(a),!0).forEach((function(t){(0,b.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Qe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}Ze.propTypes={label:v().bool,circular:v().bool,basic:v().bool,tooltip:v().string,state:v().string.isRequired,monochrome:v().bool},Ze.defaultProps={label:!1,circular:!1,basic:!1,tooltip:null,monochrome:!1};const et={[g.ek.needs_submitter_confirmation]:e=>p.Translate.string("{editorName} (editor) has made some changes to the paper",{editorName:e.user.fullName}),[g.ek.changes_acceptance]:p.Translate.string("Submitter has accepted proposed changes"),[g.ek.changes_rejection]:p.Translate.string("Submitter has rejected proposed changes"),[g.ek.needs_submitter_changes]:p.Translate.string("Submitter has been asked to make some changes"),[g.ek.acceptance]:e=>e.files.length?p.Translate.string("{editorName} (editor) has accepted after making some changes",{editorName:e.user.fullName}):p.Translate.string("{editorName} (editor) has accepted this revision",{editorName:e.user.fullName}),[g.ek.rejection]:e=>p.Translate.string("{editorName} (editor) has rejected this revision",{editorName:e.user.fullName}),[g.ek.replacement]:p.Translate.string("Revision has been replaced"),[g.ek.reset]:p.Translate.string("This editable's state has been reset")};function tt(e,t){const a=et[t.type.name];return"function"==typeof a?a(t):a}const at={fullName:"Indico Bot"},it={identifier:v().string.isRequired,fullName:v().string.isRequired,avatarURL:v().string.isRequired,id:v().number.isRequired},nt={name:v().string.isRequired},st={id:v().oneOfType([v().number,v().string]).isRequired,revisionId:v().number.isRequired,createdDt:v().string,modifiedDt:v().string,canModify:v().bool,user:v().shape(it),header:v().string,text:v().string,html:v().string,internal:v().bool,system:v().bool,isUndone:v().bool,isEditorRevision:v().bool,modifyCommentURL:v().string},rt={id:v().number.isRequired,user:v().shape(it).isRequired,createdDt:v().string.isRequired,modifiedDt:v().string,type:v().shape(nt).isRequired,isUndone:v().bool,isEditorRevision:v().bool,comment:v().string.isRequired,commentHtml:v().string.isRequired,files:v().arrayOf(v().shape(F.d7)).isRequired,items:v().arrayOf(v().shape(st)).isRequired,customActions:v().array.isRequired,customActionURL:v().string,downloadFilesURL:v().string};function lt(e){let{onSubmit:t,loading:a,disabled:n}=e;const[s,r]=(0,i.useState)(!1);return i.createElement(i.Fragment,null,i.createElement(j.A,{content:p.Translate.string("Comment"),loading:a,disabled:n,onClick:()=>r(!0)}),s&&i.createElement(ct,{onSubmit:async(e,a)=>{await t(e,a)||r(!1)},onClose:()=>r(!1)}))}function ct(e){let{onSubmit:t,onClose:a}=e;return i.createElement($.Sz,{id:"comment-form",header:p.Translate.string("Comment"),onSubmit:t,onClose:a},i.createElement(J.FinalTextArea,{name:"text",placeholder:p.Translate.string("Leave a comment..."),hideValidationError:!0,autoFocus:!0,required:!0}),i.createElement(J.FinalCheckbox,{label:p.Translate.string("Restrict visibility of this comment to other editors only"),name:"internal",toggle:!0}))}lt.propTypes={onSubmit:v().func.isRequired,loading:v().bool.isRequired,disabled:v().bool.isRequired},ct.propTypes={onSubmit:v().func.isRequired,onClose:v().func.isRequired};function dt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function ot(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(a),!0).forEach((function(t){(0,b.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):dt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const mt=s.Ay.bind(null,{endpoint:"event_editing.api_apply_judgment",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editables",isDynamic:!1},{data:"/",isDynamic:!1},{data:"judge",isDynamic:!1}]}]},"/"),ut=s.Ay.bind(null,{endpoint:"event_editing.api_assign_editor",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editables",isDynamic:!1},{data:"/",isDynamic:!1},{data:"assign",isDynamic:!1}]}]},"/"),yt=s.Ay.bind(null,{endpoint:"event_editing.api_assign_myself",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editables",isDynamic:!1},{data:"/",isDynamic:!1},{data:"assign",isDynamic:!1},{data:"/",isDynamic:!1},{data:"me",isDynamic:!1}]}]},"/"),pt=s.Ay.bind(null,{endpoint:"event_editing.api_create_comment",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editables",isDynamic:!1},{data:"/",isDynamic:!1},{data:"comment",isDynamic:!1}]}]},"/"),gt=s.Ay.bind(null,{endpoint:"event_editing.api_editable_list",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"list",isDynamic:!1}]}]},"/"),_t=s.Ay.bind(null,{endpoint:"event_editing.api_editable_type_editors",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editors",isDynamic:!1}]}]},"/"),vt=s.Ay.bind(null,{endpoint:"event_editing.api_editor_self_assign_allowed",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editables",isDynamic:!1},{data:"/",isDynamic:!1},{data:"self-assign-allowed",isDynamic:!1}]}]},"/"),Dt=s.Ay.bind(null,{endpoint:"event_editing.api_prepare_editables_archive",rules:[{args:["archive_type","event_id","type"],converters:{archive_type:"AnyConverter",event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editables",isDynamic:!1},{data:"/",isDynamic:!1},{data:"prepare-",isDynamic:!1},{data:"archive_type",isDynamic:!0}]}]},"/"),bt=s.Ay.bind(null,{endpoint:"event_editing.api_unassign_editor",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editables",isDynamic:!1},{data:"/",isDynamic:!1},{data:"unassign",isDynamic:!1}]}]},"/"),ft=s.Ay.bind(null,{endpoint:"event_editing.manage_editable_type",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1}]}]},"/");function Et(e){let{management:t}=e;const a=(0,c.Uf)("event_id"),{type:n}=(0,l.useParams)(),{data:s,loading:r}=(0,y.Ku)(gt({event_id:a,type:n}),{camelize:!0}),{data:o,loading:m}=(0,y.Ku)(_t({event_id:a,type:n}),{camelize:!0,manual:!t}),{data:u,loading:p}=(0,y.Ku)(vt({event_id:a,type:n}),{manual:t});if(r||m||p)return i.createElement(d.A,{inline:"centered",active:!0});if(!s||t&&!o)return null;const g=Object.values(s).some((e=>e.code));return i.createElement(ht,{initialContribList:s,codePresent:g,editableType:n,eventId:a,editors:t?o:[],management:t,canAssignSelf:!t&&u})}function ht(e){let{initialContribList:t,codePresent:a,editableType:n,eventId:s,editors:l,management:c,canAssignSelf:d}=e;const[m,y]=(0,i.useState)("friendly_id"),[_,v]=(0,i.useState)("ASC"),[D,b]=(0,i.useState)(t),[f,E]=(0,i.useState)(D),h=D.filter((e=>e.editable)),T=new Set(h.map((e=>e.id))),[A,C]=(0,i.useState)(new Set(D.map((e=>e.id)))),[S,I]=(0,i.useState)(!1),[k,x]=(0,i.useState)([]),N=k.length>0,F=new Set(k),P=h.filter((e=>F.has(e.editable.id))),L=Object.fromEntries(P.filter((e=>e.editable.editor)).map((e=>[e.editable.id,e.editable.editor.identifier]))),[U,M]=(0,i.useState)(null),[z,H]=(0,i.useState)(null),[V,J]=(0,i.useState)(0),$=(0,i.useMemo)((()=>Ve()(l,"fullName").map((e=>({key:e.identifier,icon:"user",text:e.fullName,value:e.identifier})))),[l]),G=[{key:"accept",value:"accept",text:p.Translate.string("Accept"),label:{color:"green",empty:!0,circular:!0}},{key:"reject",value:"reject",text:p.Translate.string("Reject"),label:{color:"black",empty:!0,circular:!0}}],X=(0,i.useMemo)((()=>[{key:"state",text:p.Translate.string("Status"),options:[{value:"not_submitted",text:p.Translate.string("Not submitted"),color:"default"},{value:"ready_for_review",text:p.Translate.string("Ready for review"),color:"grey"},{value:"accepted",text:p.Translate.string("Accepted"),exclusive:!0,color:"green"},{value:"rejected",text:p.Translate.string("Rejected"),exclusive:!0,color:"black"},{value:"needs_submitter_changes",text:p.Translate.string("Needs submitter changes"),exclusive:!0,color:"red"},{value:"needs_submitter_confirmation",text:p.Translate.string("Needs submitter confirmation"),exclusive:!0,color:"yellow"}],isMatch:(e,t)=>e.c.editable&&t.includes(e.c.editable.state)||t.includes("not_submitted")&&!e.c.editable},{key:"editor",text:p.Translate.string("Editor"),options:Be()(h.map((e=>e.editable.editor)).filter((e=>e)),"id").map((e=>{let{identifier:t,fullName:a}=e;return{value:t,text:a}})),isMatch:(e,t)=>e.c.editable&&e.c.editable.editor&&t.includes(e.c.editable.editor.identifier)},{key:"code",text:p.Translate.string("Program code"),options:R()(D.map((e=>e.code)).filter((e=>e))).map((e=>({value:e,text:e}))),isMatch:(e,t)=>t.includes(e.c.code)},{key:"keywords",text:p.Translate.string("Keywords"),options:R()(w()(D.map((e=>e.keywords)))).map((e=>({value:e,text:e}))),isMatch:(e,t)=>e.c.keywords.some((e=>t.includes(e)))},{key:"tags",text:p.Translate.string("Tags"),options:Be()(h.map((e=>e.editable.tags)).filter((e=>e.length)).reduce(((e,t)=>e.concat(t)),[]),"code").map((e=>({value:e.code,text:e.code,color:e.color}))),isMatch:(e,t)=>{var a;return(null===(a=e.c.editable)||void 0===a?void 0:a.tags)&&t.some((t=>e.c.editable.tags.map((e=>e.code)).includes(t)))}}]),[D,h]),Y={[g.zl.paper]:p.Translate.string("List of papers"),[g.zl.slides]:p.Translate.string("List of slides"),[g.zl.poster]:p.Translate.string("List of posters")}[n],Z={[g.zl.paper]:p.PluralTranslate.string("{count} paper was skipped because of its current status.","{count} papers were skipped because of their current status.",V,{count:V}),[g.zl.slides]:p.PluralTranslate.string("{count} slide was skipped because of its current status.","{count} slides were skipped because of their current status.",V,{count:V}),[g.zl.poster]:p.PluralTranslate.string("{count} poster was skipped because of its current status.","{count} posters were skipped because of their current status.",V,{count:V})}[n],Q=[["friendlyId",p.Translate.string("ID"),60],...a?[["code",p.Translate.string("Code"),110]]:[],["title",p.Translate.string("Title"),600],["revision",p.Translate.string("Rev."),80],["status",p.Translate.string("Status"),200],["editor",p.Translate.string("Editor"),400]],W={code:e=>e.code,title:e=>e.title.toLowerCase(),revision:e=>e.editable&&e.editable.revisionCount,status:e=>e.editable&&e.editable.state.toLowerCase(),editor:e=>e.editable&&e.editable.editor&&e.editable.editor.fullName.toLowerCase()},ee={code:(e,t)=>[...e].sort(((e,a)=>(0,Ge.v)(t(e),t(a))))},te=(e,t,a)=>{const i=(ee[e]||((e,t)=>Ve()(e,t)))(D,W[e]||(t=>t[e]));t===Ke.UE.DESC&&i.reverse();return[...i.filter((e=>a.has(e.id))),...i.filter((e=>!a.has(e.id)))]},ae=e=>{let{sortBy:t,sortDirection:a}=e;y(t),v(a),E(te(t,a,A))},ie=(0,i.useMemo)((()=>D.map((e=>({id:e.id,searchableId:e.friendlyId,searchableFields:e.editable&&e.editable.editor?[e.title,e.code,e.editable.editor.fullName]:[e.title,e.code],c:e})))),[D]),ne={title:(e,t)=>f[t].editable?c?i.createElement("a",{href:f[t].editable.timelineURL},e):i.createElement(r.Link,{to:f[t].editable.timelineURL},e):i.createElement("div",null,e),code:e=>e||p.Translate.string("n/a"),revision:e=>e?e.revisionCount:"",status:(e,t)=>i.createElement(Ze,{state:e?e.state:"not_submitted",circular:!0,label:!0,monochrome:!A.has(f[t].id)}),editor:e=>e&&e.editor?i.createElement("div",null,i.createElement(ue.A,{name:"user outline"}),e.editor.fullName):i.createElement("div",null)},se=e=>{let{dataKey:t,rowIndex:a}=e,n=f[a][t];["editor","revision","status"].includes(t)&&(n=f[a].editable);const s=ne[t]||(e=>e);return i.createElement(u.TooltipIfTruncated,null,i.createElement("div",{className:"events-editing-client-js-management-editable_type-___EditableList-module__rowcolumn-tooltip___sVHzJ",role:"gridcell",style:"title"===t?{display:"block"}:{}},s(n,a)))},re=async function(e){let t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{t=await O.indicoAxios.post(e(ot({event_id:s,type:n},i)),ot({editables:k},a)),M(null)}catch(t){var r;return 409===(null===(r=t.response)||void 0===r?void 0:r.status)&&t.response.data.editor_conflict?(H([e,ot(ot({},a),{},{force:!0})]),null):((0,O.handleAxiosError)(t),M(null),null)}return(0,q.camelizeKeys)(t.data)},le=async function(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};M(e);const i=await re(t,a);return i&&(e=>{e=new Map(e.map((e=>[e.id,e])));const t=t=>t.editable&&e.has(t.editable.id)?ot(ot({},t),{},{editable:e.get(t.editable.id)}):t;b((e=>e.map(t))),E((e=>e.map(t)))})(i),i},ce=async function(e,t){return le(e,t,ot(ot({},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),{},{editor_assignments:L}))};return(0,i.useEffect)((()=>(document.body.classList.add("full-width-content-wrapper"),()=>{document.body.classList.remove("full-width-content-wrapper")})),[]),i.createElement(i.Fragment,null,c&&i.createElement(u.ManagementPageSubTitle,{title:Y}),c&&i.createElement(u.ManagementPageBackButton,{url:ft({event_id:s,type:n})}),i.createElement("div",{className:"events-editing-client-js-management-editable_type-___EditableList-module__editable-topbar___YKzRy"},i.createElement("div",{className:"events-editing-client-js-management-editable_type-___EditableList-module__editable-actions___Vv0Ve"},d&&i.createElement(j.A,{content:g.R0[n],onClick:()=>I(!0)}),S&&i.createElement(B,{eventId:s,editableType:n,onClose:()=>I(!1),management:c}),c&&i.createElement(i.Fragment,null,i.createElement(j.A.Group,null,i.createElement(ve.A,{disabled:!N||!l.length||!!U,options:$,scrolling:!0,icon:null,value:null,selectOnBlur:!1,selectOnNavigation:!1,onChange:(e,t)=>{let{value:a}=t;ce("assign",ut,{editor:a})},trigger:i.createElement(j.A,{icon:!0,loading:"assign"===U},i.createElement(p.Translate,null,"Assign"),i.createElement(ue.A,{name:"caret down"}))}),i.createElement(j.A,{disabled:!N||!!U,color:"blue",content:p.Translate.string("Assign to myself"),onClick:()=>{ce("assign-self",yt)},loading:"assign-self"===U}),i.createElement(j.A,{disabled:!P.some((e=>e.editable.editor))||!!U,content:p.Translate.string("Unassign"),onClick:async()=>{ce("unassign",bt)},loading:"unassign"===U})),i.createElement(lt,{disabled:!N||!!U,onSubmit:e=>{M("comment"),re(pt,e)},loading:"comment"===U}),i.createElement(ve.A,{disabled:!N||!!U,options:G,scrolling:!0,icon:null,value:null,selectOnBlur:!1,selectOnNavigation:!1,onChange:(e,t)=>{let{value:a}=t;return(async e=>{const t=await le("judgment",mt,{action:e});t&&J(k.length-t.length)})(a)},trigger:i.createElement(j.A,{icon:!0,loading:"judgment"===U},i.createElement(p.Translate,null,"Judge"),i.createElement(ue.A,{name:"caret down"}))}),i.createElement(j.A.Group,null,i.createElement(j.A,{disabled:!N||!!U,content:p.Translate.string("Download all files"),onClick:async()=>{M("download");const e=await re(Dt,{},{archive_type:"archive"});e&&(location.href=e.downloadURL)},loading:"download"===U}),i.createElement(j.A,{disabled:!N||!!U,content:p.Translate.string("Export as JSON"),onClick:async()=>{M("json");const e=await re(Dt,{},{archive_type:"json"});e&&(location.href=e.downloadURL)},loading:"json"===U})))),i.createElement(u.ListFilter,{name:`${n}-list-filter-${s}`,list:ie||[],filterOptions:X,searchableId:e=>e.searchableId,searchableFields:e=>e.searchableFields,onChangeList:e=>{C(e),E(te(m,_,e)),x(h.filter((t=>F.has(t.editable.id)&&e.has(t.id))).map((e=>e.editable.id)))}})),!!V&&i.createElement(K.A,{warning:!0},i.createElement(ue.A,{name:"warning sign"}),Z),f.length?i.createElement("div",{className:"events-editing-client-js-management-editable_type-___EditableList-module__editable-list___oixcq"},i.createElement(Ke.PG,null,(e=>{let{height:t,isScrolling:a,onChildScroll:n,scrollTop:s}=e;return i.createElement(Ke.XI,{autoHeight:!0,width:1e3,className:"events-editing-client-js-management-editable_type-___EditableList-module__table___kveRk",height:t,isScrolling:a,onScroll:n,headerHeight:30,rowHeight:40,sort:ae,sortBy:m,sortDirection:_,rowCount:f.length,scrollTop:s,rowGetter:e=>{let{index:t}=e;return f[t]},rowStyle:e=>{let{index:t}=e;return-1===t||A.has(f[t].id)?{}:{backgroundColor:$e.A.pastelGray,opacity:"60%"}}},c&&i.createElement(Ke.VP,{disableSort:!0,dataKey:"checkbox",width:30,headerRenderer:()=>i.createElement(o.A,{indeterminate:k.length>0&&k.length<[...A].filter((e=>T.has(e))).length,checked:k.length>0&&k.length===[...A].filter((e=>T.has(e))).length,onChange:(e,t)=>{return a=t.checked,void x(a?h.filter((e=>A.has(e.id))).map((e=>e.editable.id)):[]);var a},disabled:!!U}),cellRenderer:e=>{let{rowIndex:t}=e;return f[t].editable&&i.createElement(o.A,{disabled:!!U||!A.has(f[t].id),checked:!!f[t].editable&&F.has(f[t].editable.id),onChange:(e,t)=>(e=>{const t=f[e].editable.id;F.has(t)?x((e=>e.filter((e=>e!==t)))):x((e=>[...e,t]))})(t.index),index:t})}}),Q.map((e=>{let[t,a,n,s]=e;return i.createElement(Ke.VP,(0,Me.A)({key:t,dataKey:t,label:a,width:n},s,{cellRenderer:se}))})))}))):i.createElement(K.A,{info:!0},i.createElement(p.Translate,null,"There are no editables yet.")),i.createElement(Je.A,{open:!!z,header:p.Translate.string("Assignment conflict"),content:p.Translate.string("Some editor assignments for the current selection have been changed externally. Are you sure you want to proceed?"),confirmButton:i.createElement(j.A,{content:p.Translate.string("Force assignments"),negative:!0}),cancelButton:p.Translate.string("Cancel"),onCancel:()=>{M(null),H(null)},onConfirm:()=>{le(U,...z),H(null)}}))}Et.propTypes={management:v().bool},Et.defaultProps={management:!0},ht.propTypes={initialContribList:v().arrayOf(v().shape({id:v().number.isRequired,friendlyId:v().number.isRequired,title:v().string.isRequired,code:v().string.isRequired,editable:v().shape({id:v().number,editor:v().shape(it),state:v().string,type:v().oneOf(Object.values(g.zl)),timelineURL:v().string}),keywords:v().arrayOf(v().string).isRequired})).isRequired,editors:v().arrayOf(v().shape(it)).isRequired,codePresent:v().bool.isRequired,editableType:v().oneOf(Object.values(g.zl)).isRequired,eventId:v().number.isRequired,management:v().bool.isRequired,canAssignSelf:v().bool.isRequired};const Tt=s.Ay.bind(null,{endpoint:"event_editing.api_enabled_editable_types",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"enabled-editable-types",isDynamic:!1}]}]},"/"),At=s.Ay.bind(null,{endpoint:"event_editing.manage_editable_type",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1}]}]},"/"),wt=s.Ay.bind(null,{endpoint:"event_editing.manage_editable_type_list",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"list",isDynamic:!1}]}]},"/");function Ct(e){let{eventId:t}=e;const[a,n]=(0,i.useState)(!1),{data:s,loading:l,reFetch:c}=(0,y.Ku)(Tt({event_id:t}),{camelize:!0});if(l)return i.createElement(d.A,{inline:"centered",active:!0});if(!s)return null;const m=async e=>{const a=Tt({event_id:t}),i=Object.keys(e).filter((t=>e[t]));try{await O.indicoAxios.post(a,{editable_types:i})}catch(e){return(0,J.handleSubmitError)(e)}c(),n(!1)};return i.createElement("div",{className:"events-editing-client-js-management-___EditableTypeList-module__editable-list___ypQO7"},i.createElement("div",{className:"events-editing-client-js-management-___EditableTypeList-module__header___rFrl5"},i.createElement("h3",null,i.createElement(p.Translate,null,"List of editable types")),i.createElement(ge.A,{content:p.Translate.string("Toggle editable types"),trigger:i.createElement(o.A,{checked:a,toggle:!0,onClick:()=>n(!a)})})),a?i.createElement(xe.Form,{onSubmit:m,subscription:{submitting:!0},initialValues:Object.assign(...g.ry.map((e=>({[e]:s.includes(e)}))))},(e=>i.createElement(i.Fragment,null,i.createElement(je.A,{id:"editable-type-form",onSubmit:e.handleSubmit},i.createElement("div",{className:"action-box"},g.ry.map((e=>i.createElement("div",{key:e,className:"section"},i.createElement("span",{className:"icon icon-file"}),i.createElement("div",{className:"text"},i.createElement("div",{className:"label"},g.SN[e])),i.createElement("div",{className:"toolbar events-editing-client-js-management-___EditableTypeList-module__switch-toolbar___w3tO7"},i.createElement(J.FinalCheckbox,{name:e,toggle:!0,label:"",className:"events-editing-client-js-management-___EditableTypeList-module__type-switch___3h83P"}))))))),i.createElement("div",{className:"toolbar f-j-end"},i.createElement(j.A,{onClick:()=>n(!1),disabled:e.submitting},i.createElement(p.Translate,null,"Cancel")),i.createElement(J.FinalSubmitButton,{form:"editable-type-form",label:p.Translate.string("Save")}))))):0===s.length?i.createElement("span",{className:"events-editing-client-js-management-___EditableTypeList-module__disabled___b9Cu3"},i.createElement(p.Translate,null,"No editable types enabled yet. Click the toggle to enable any editable types.")):i.createElement("div",{className:"action-box"},s.map((e=>i.createElement("div",{key:e,className:"section"},i.createElement("span",{className:"icon icon-file"}),i.createElement("div",{className:"text"},i.createElement("div",{className:"label"},g.SN[e])),i.createElement("div",{className:"toolbar"},i.createElement(r.Link,{className:"i-button icon-list",to:wt({event_id:t,type:e})},i.createElement(p.Translate,null,"List")),i.createElement(r.Link,{className:"i-button icon-settings",to:At({event_id:t,type:e})},i.createElement(p.Translate,null,"Manage"))))))))}Ct.propTypes={eventId:v().number.isRequired};var Rt=a(79858),St=a(98727);const It=s.Ay.bind(null,{endpoint:"event_editing.api_check_service_url",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"service",isDynamic:!1},{data:"/",isDynamic:!1},{data:"check-url",isDynamic:!1}]}]},"/"),kt=s.Ay.bind(null,{endpoint:"event_editing.api_service_connect",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"service",isDynamic:!1},{data:"/",isDynamic:!1},{data:"connect",isDynamic:!1}]}]},"/"),xt=s.Ay.bind(null,{endpoint:"event_editing.api_service_disconnect",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"service",isDynamic:!1},{data:"/",isDynamic:!1},{data:"disconnect",isDynamic:!1}]}]},"/"),jt=s.Ay.bind(null,{endpoint:"event_editing.api_service_status",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"service",isDynamic:!1},{data:"/",isDynamic:!1},{data:"status",isDynamic:!1}]}]},"/"),Nt=(0,St.q)(250);function Ot(e){let{eventId:t}=e;const[a,n]=(0,i.useState)(!1),[s,r]=(0,i.useState)(!1),[l,c]=(0,i.useState)(!1),{data:o,error:m,loading:u,reFetch:g}=(0,y.Ku)(jt({event_id:t}),{camelize:!0}),_=u||null===o&&null===m;let v,b=p.Translate.string("Custom editing workflow"),f=!1,E=!1,h=!1;_?v=p.Translate.string("Checking custom editing workflow status"):m||o.error?(v=p.Translate.string("Workflow service unavailable: {error}",{error:m||o.error}),null===m&&(E=!0,h=!0)):o.connected?(b=i.createElement(p.Translate,null,"Custom editing workflow: ",i.createElement(p.Param,{name:"name",value:o.status.service.name})," (",i.createElement(p.Param,{name:"version",value:o.status.service.version}),")"),v=p.Translate.string("Connected to a custom editing workflow service"),E=o.status.canDisconnect):(v=p.Translate.string("Use a custom editing workflow provided by an external service"),f=!0),E&&(v=i.createElement(i.Fragment,null,v," (",i.createElement("a",{onClick:()=>c(!0)},i.createElement(p.Translate,null,"disconnect")),")"));const T=()=>{n(null),r(!1)};return i.createElement(D,{icon:"puzzle",label:b,description:v},f&&i.createElement("button",{type:"button",className:"i-button icon-puzzle",onClick:()=>r(!0)},i.createElement(p.Translate,null,"Connect")),u&&i.createElement(d.A,{active:!0,inline:!0}),i.createElement(Je.A,{size:"tiny",open:l,onCancel:()=>c(!1),onConfirm:async()=>{try{await O.indicoAxios.post(xt({event_id:t}),{force:h})}catch(e){return void(0,O.handleAxiosError)(e)}c(!1),g()},confirmButton:i.createElement(j.A,{content:p.Translate.string("Disconnect"),negative:!0}),header:p.Translate.string("Disconnect editing workflow service"),content:i.createElement(k.A.Content,null,h?i.createElement(p.Translate,null,"Disconnecting the editing workflow service while it is unavailable may leave your editing process in an inconsistent state. Do not perform this action if you plan to continue using the workflow service later."," ",i.createElement(p.Param,{name:"strong",wrapper:i.createElement("strong",null)},"The current error with the workflow service is most likely temporary. Attempting to disconnect and reconnect will most likely not fix it.")):i.createElement(p.Translate,null,"Do you really want to disconnect from the editing workflow service? If your editing process has already started (e.g. people submitted content to be edited), disconnecting is most likely not a good idea and should only be done if you do not plan to enable the service again for this event."))}),i.createElement(k.A,{size:"small",open:s,onClose:T},i.createElement(xe.Form,{onSubmit:async e=>{let{url:a}=e;try{await O.indicoAxios.post(kt({event_id:t}),{url:a})}catch(e){return(0,J.handleSubmitError)(e)}T(),g()},subscription:{}},(e=>i.createElement(i.Fragment,null,i.createElement(k.A.Header,{content:p.Translate.string("Connect to editing workflow service")}),i.createElement(k.A.Content,null,i.createElement(K.A,{warning:!0},"This feature is still ",i.createElement("strong",null,"experimental"),". Especially if you are not the administrator of this Indico instance be aware that even minor Indico upgrades may contain backwards-incompatible changes to the API between Indico and the service."),i.createElement(je.A,{id:"connect-service-form",onSubmit:e.handleSubmit},i.createElement(J.FinalInput,{name:"url",label:p.Translate.string("Service URL"),description:i.createElement(p.Translate,null,"Provide the URL for the service implementing your custom editing workflow."),autoFocus:!0,required:!0,validate:async e=>{n(null);const a=J.validators.required(e)||J.validators.url(e);if(a)return a;let i;try{i=await Nt((()=>O.indicoAxios.get(It({event_id:t}),{params:{url:e}})))}catch(e){const t=(0,J.handleSubmitError)(e);return t.url||t[Rt.FORM_ERROR]}if(i.data.error)return i.data.error;n(i.data.info)}}),a?i.createElement(K.A,{info:!0},i.createElement(p.Translate,null,"Your editing workflow will be managed by"," ",i.createElement(p.Param,{name:"service",value:a.name,wrapper:i.createElement("strong",null)})," (",i.createElement(p.Param,{name:"version",value:a.version}),")."),i.createElement("br",null),i.createElement(p.Translate,null,"Please note that connecting to this service may immediately update your editing settings and create e.g. new tags and file types. Only connect if you intend to use this workflow in your event!")):i.createElement(K.A,{info:!0},i.createElement(p.Translate,null,"If you are a developer looking to implement a custom workflow, head over to the"," ",i.createElement(p.Param,{name:"link",wrapper:i.createElement("a",{href:"https://github.com/indico/openreferee/",target:"_blank",rel:"noopener noreferrer",style:{fontWeight:"bold"}})},"reference implementation of the OpenReferee spec on GitHub"),".")))),i.createElement(k.A.Actions,{style:{display:"flex",justifyContent:"flex-end"}},i.createElement(J.FinalSubmitButton,{form:"connect-service-form",label:p.Translate.string("Connect")}),i.createElement(j.A,{onClick:T},i.createElement(p.Translate,null,"Cancel"))))))))}Ot.propTypes={eventId:v().number.isRequired};const qt=s.Ay.bind(null,{endpoint:"event_editing.manage_tags",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"tags",isDynamic:!1}]}]},"/");function Ft(){const e=(0,c.Uf)("event_id");return i.createElement(i.Fragment,null,i.createElement("div",{className:"action-box"},i.createElement(D,{icon:"tag",label:p.Translate.string("Tags"),description:p.Translate.string("Configure the tags that can be assigned to revisions")},i.createElement(r.Link,{to:qt({event_id:e}),className:"i-button icon-settings"},i.createElement(p.Translate,null,"Configure"))),Indico.ExperimentalEditingService&&i.createElement(Ot,{eventId:e})),i.createElement(Ct,{eventId:e}))}const Pt=e=>i.createElement("div",{style:{display:"flex",alignItems:"center"}},i.createElement(pe.A,{color:e})," ",i.createElement("span",{style:{marginLeft:10}},$e.h[e])),Lt=Object.keys($e.h).map((e=>({text:Pt(e),value:e})));function Ut(e){let{header:t,onSubmit:a,tag:n,onClose:s}=e;return i.createElement($.Sz,{id:"tag-form",onSubmit:async(e,t)=>{const i=await a(e,t);if(i)return i;s()},onClose:s,initialValues:n,header:t},i.createElement(J.FinalInput,{name:"code",label:p.Translate.string("Code"),required:!0,autoFocus:!0}),i.createElement(J.FinalInput,{name:"title",label:p.Translate.string("Title"),required:!0}),i.createElement(J.FinalDropdown,{name:"color",label:p.Translate.string("Color"),options:Lt,selection:!0,required:!0}))}Ut.propTypes={header:v().string.isRequired,onSubmit:v().func.isRequired,tag:v().object,onClose:v().func},Ut.defaultProps={tag:{code:null,title:null,color:null},onClose:null};function Mt(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}const zt=s.Ay.bind(null,{endpoint:"event_editing.api_create_tag",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"tags",isDynamic:!1}]}]},"/"),Bt=s.Ay.bind(null,{endpoint:"event_editing.api_edit_tag",rules:[{args:["event_id","tag_id"],converters:{event_id:"IntegerConverter",tag_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"tag",isDynamic:!1},{data:"/",isDynamic:!1},{data:"tag_id",isDynamic:!0}]}]},"/"),Ht=s.Ay.bind(null,{endpoint:"event_editing.api_tags",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"tags",isDynamic:!1}]}]},"/"),Vt={tag:null,operation:null};function Kt(e,t){switch(t.type){case"ADD_TAG":return{operation:"add",tag:null};case"EDIT_TAG":return{operation:"edit",tag:t.tag};case"DELETE_TAG":return{operation:"delete",tag:t.tag};case"CLEAR":return function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Mt(Object(a),!0).forEach((function(t){(0,b.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Mt(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},Vt);default:return e}}function Jt(e){let{eventId:t}=e;const[a,n]=(0,i.useReducer)(Kt,Vt),{data:s,loading:r,reFetch:l,lastData:c}=(0,y.Ku)(Ht({event_id:t}),{camelize:!0}),o=s||c;if(r&&!c)return i.createElement(d.A,{inline:"centered",active:!0});if(!o)return null;const{operation:m,tag:g}=a;return i.createElement("div",{className:"events-editing-client-js-management-tags-___TagManager-module__tags-container___I8fMI"},o.map((e=>i.createElement(ye.A,{key:e.id,className:"events-editing-client-js-management-tags-___TagManager-module__tag-segment___zkIhl"},i.createElement(pe.A,{color:e.color},e.verboseTitle),i.createElement("div",{className:"events-editing-client-js-management-tags-___TagManager-module__tag-actions___U5SW2"},i.createElement(ge.A,{on:"hover",position:"right center",disabled:!e.system,trigger:i.createElement("span",null,i.createElement(ue.A,{name:"pencil",color:"grey",size:"small",title:p.Translate.string("Edit tag"),onClick:()=>n({type:"EDIT_TAG",tag:e}),disabled:e.system,circular:!0,inverted:!0})," ",i.createElement(ue.A,{name:"remove",color:"red",size:"small",title:p.Translate.string("Delete tag"),onClick:()=>n({type:"DELETE_TAG",tag:e}),disabled:e.system,circular:!0,inverted:!0}))},i.createElement(p.Translate,null,"System tags are managed by the editing workflow service and cannot be modified.")))))),0===o.length&&i.createElement(K.A,{info:!0},i.createElement(p.Translate,null,"There are no tags defined for this event")),i.createElement(j.A,{onClick:()=>n({type:"ADD_TAG"}),disabled:!!m,floated:"right",icon:!0,primary:!0},i.createElement(ue.A,{name:"plus"})," ",i.createElement(p.Translate,null,"Add new tag")),["add","edit"].includes(m)&&i.createElement(Ut,{header:"edit"===m?p.Translate.string("Edit tag"):p.Translate.string("Create a new tag"),onSubmit:async(e,a)=>"edit"===m?await(async(e,a)=>{const i=Bt({event_id:t,tag_id:e});try{await O.indicoAxios.patch(i,a),l()}catch(e){return(0,J.handleSubmitError)(e)}})(g.id,(0,J.getChangedValues)(e,a)):await(async e=>{try{await O.indicoAxios.post(zt({event_id:t}),e),l()}catch(e){return(0,J.handleSubmitError)(e)}})(e),tag:g,onClose:()=>n({type:"CLEAR"})}),i.createElement(u.RequestConfirmDelete,{onClose:()=>n({type:"CLEAR"}),requestFunc:()=>(async e=>{const a=Bt({event_id:t,tag_id:e});try{await O.indicoAxios.delete(a),l()}catch(e){return(0,O.handleAxiosError)(e),!0}})(g.id),open:"delete"===m},g&&i.createElement(p.Translate,null,"Are you sure you want to delete the tag"," ",i.createElement(p.Param,{name:"tag",value:g.verboseTitle,wrapper:i.createElement("strong",null)}),"?")))}Jt.propTypes={eventId:v().number.isRequired};const $t=s.Ay.bind(null,{endpoint:"event_editing.dashboard",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/");function Gt(){const e=(0,c.Uf)("event_id");return i.createElement(i.Fragment,null,i.createElement(u.ManagementPageBackButton,{url:$t({event_id:e})}),i.createElement(u.ManagementPageSubTitle,{title:p.Translate.string("Tags")}),i.createElement(Jt,{eventId:e}))}const Xt=s.Ay.bind(null,{endpoint:"event_editing.dashboard",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/"),Yt=s.Ay.bind(null,{endpoint:"event_editing.manage_editable_type",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1}]}]},"/"),Zt=s.Ay.bind(null,{endpoint:"event_editing.manage_editable_type_list",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"list",isDynamic:!1}]}]},"/"),Qt=s.Ay.bind(null,{endpoint:"event_editing.manage_file_types",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"types",isDynamic:!1}]}]},"/"),Wt=s.Ay.bind(null,{endpoint:"event_editing.manage_review_conditions",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"review-conditions",isDynamic:!1}]}]},"/"),ea=s.Ay.bind(null,{endpoint:"event_editing.manage_tags",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"tags",isDynamic:!1}]}]},"/");function ta(){return i.createElement(r.BrowserRouter,null,i.createElement(l.Switch,null,i.createElement(l.Route,{exact:!0,path:(0,c.kA)(Xt,["event_id"]),component:Ft}),i.createElement(l.Route,{exact:!0,path:(0,c.kA)(ea,["event_id"]),component:Gt}),i.createElement(l.Route,{exact:!0,path:(0,c.kA)(Yt,["event_id","type"]),component:de}),i.createElement(l.Route,{exact:!0,path:(0,c.kA)(Qt,["event_id","type"]),component:Se}),i.createElement(l.Route,{exact:!0,path:(0,c.kA)(Wt,["event_id","type"]),component:Ue}),i.createElement(l.Route,{exact:!0,path:(0,c.kA)(Zt,["event_id","type"]),component:Et})))}document.addEventListener("DOMContentLoaded",(async()=>{const e=document.querySelector("#editing-management");e&&n.render(i.createElement(ta,null),e)}));var aa=a(35813);const ia=s.Ay.bind(null,{endpoint:"contributions.display_contribution",rules:[{args:["contrib_id","event_id"],converters:{contrib_id:"IntegerConverter",event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contrib_id",isDynamic:!0},{data:"/",isDynamic:!1}]}]},"/"),na=s.Ay.bind(null,{endpoint:"event_editing.editable_type_list",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"list",isDynamic:!1}]}]},"/"),sa=s.Ay.bind(null,{endpoint:"event_editing.manage_editable_type",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"manage",isDynamic:!1},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1}]}]},"/"),ra=s.Ay.bind(null,{endpoint:"events.display",rules:[{args:["event_id"],converters:{},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1}]}]},"/");function la(e){let{eventId:t,editableType:a}=e;return location.pathname===na({event_id:t,type:a})?i.createElement(aa.A,{vertical:!0},i.createElement(aa.A.Item,{active:!0},i.createElement(p.Translate,null,"Editable list"))):i.createElement(aa.A,{vertical:!0},i.createElement(aa.A.Item,{as:r.Link,to:na({event_id:t,type:a})},i.createElement("span",{style:{color:$e.A.blue}},i.createElement(p.Translate,null,"Editable list"))))}function ca(e){let{eventId:t,menuData:a,editableType:n,contribId:s}=e;const r=null===s?ra({event_id:t}):ia({event_id:t,contrib_id:s}),l=sa({event_id:t,type:n}),{items:c,showManagementLink:d,showEditableList:o}=a;return i.createElement("div",{className:"events-editing-client-js-editing-page_layout-___MenuBar-module__menu-bar___F7zKi"},i.createElement(_e.A,{as:"h2",className:"events-editing-client-js-editing-page_layout-___MenuBar-module__header___1UePu"},g.AT[n]),o[n]&&i.createElement(la,{eventId:t,editableType:n}),!!c.length&&i.createElement(aa.A,{vertical:!0},i.createElement(aa.A.Item,{header:!0},i.createElement("span",{className:"events-editing-client-js-editing-page_layout-___MenuBar-module__capitalized___3SkJ9",style:{color:$e.A.black}},i.createElement(p.Translate,null,"other modules"))),c.map((e=>i.createElement(aa.A.Item,{key:e.name,name:e.name,as:"a",href:e.url},i.createElement("span",{style:{color:$e.A.blue}},e.icon&&i.createElement(ue.A,{name:e.icon.replace("icon-","")}),e.title))))),i.createElement(aa.A,{vertical:!0},i.createElement(aa.A.Item,{header:!0},i.createElement("span",{className:"events-editing-client-js-editing-page_layout-___MenuBar-module__capitalized___3SkJ9",style:{color:$e.A.black}},i.createElement(p.Translate,null,"other views"))),i.createElement(aa.A.Item,{name:"display",as:"a",href:r},i.createElement("span",{style:{color:$e.A.blue}},i.createElement(ue.A,{name:"tv"})," ",i.createElement(p.Translate,null,"Display"))),d&&i.createElement(aa.A.Item,{name:"management",as:"a",href:l},i.createElement("span",{style:{color:$e.A.blue}},i.createElement(ue.A,{name:"pencil"})," ",i.createElement(p.Translate,null,"Management")))))}la.propTypes={eventId:v().number.isRequired,editableType:v().oneOf(Object.values(g.zl)).isRequired};const da={name:v().string.isRequired,title:v().string.isRequired,url:v().string.isRequired,icon:v().string};ca.propTypes={eventId:v().number.isRequired,contribId:v().number,menuData:v().shape({items:v().arrayOf(v().shape(da)).isRequired,showManagementLink:v().bool.isRequired,showEditableList:v().shape({paper:v().bool.isRequired,slides:v().bool.isRequired,poster:v().bool.isRequired}).isRequired}).isRequired,editableType:v().oneOf(Object.values(g.zl)).isRequired},ca.defaultProps={contribId:null};const oa=s.Ay.bind(null,{endpoint:"event_editing.api_menu_entries",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"menu-entries",isDynamic:!1}]}]},"/");function ma(e){let{eventTitle:t,children:a}=e;const n=(0,c.Uf)("event_id"),s=(0,c.Uf)("contrib_id"),{type:r}=(0,l.useParams)(),{data:d,lastData:o}=(0,y.Ku)(oa({event_id:n}),{camelize:!0}),m=d||o;return m?i.createElement("div",{className:"events-editing-client-js-editing-page_layout-___EditingView-module__editing-view___hznyV"},i.createElement(ca,{eventId:n,menuData:m,editableType:r,contribId:s}),i.createElement("div",{className:"events-editing-client-js-editing-page_layout-___EditingView-module__contents___Nqnqb"},i.createElement("div",{className:"events-editing-client-js-editing-page_layout-___EditingView-module__timeline___mtBpq"},i.createElement(_e.A,{as:"h2",className:"events-editing-client-js-editing-page_layout-___EditingView-module__header___djqbH"},t),a))):null}ma.propTypes={eventTitle:v().string.isRequired,children:v().node.isRequired};var ua=a(44515),ya=a(88996),pa=a(45675);const ga="SET_LOADING",_a="SET_DETAILS",va="SET_NEW_DETAILS";function Da(){return async(e,t)=>{const{editableDetailsURL:a}=(0,pa.X5)(t());return await(0,ya.P$)((()=>O.indicoAxios.get(a)),ga,_a)(e)}}const ba=s.Ay.bind(null,{endpoint:"event_editing.api_delete_editable",rules:[{args:["contrib_id","event_id","type"],converters:{contrib_id:"IntegerConverter",event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contrib_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0}]}]},"/"),fa=s.Ay.bind(null,{endpoint:"event_editing.editable_type_list",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"list",isDynamic:!1}]}]},"/");function Ea(){const{eventId:e,contributionId:t,editableType:a}=(0,ua.useSelector)(pa.X5),n=(0,ua.useSelector)(pa.we),[s,r]=(0,i.useState)(!1),c=(0,l.useHistory)(),d={[g.zl.paper]:p.Translate.string("Delete paper"),[g.zl.slides]:p.Translate.string("Delete slide"),[g.zl.poster]:p.Translate.string("Delete poster")}[a];if(!n)return null;return i.createElement(i.Fragment,null,i.createElement(ge.A,{content:d,trigger:i.createElement(ue.A,{name:"trash",onClick:()=>r(!0),color:"grey",link:!0})}),i.createElement(u.RequestConfirmDelete,{header:d,onClose:()=>r(!1),requestFunc:async()=>{try{await O.indicoAxios.delete(ba({event_id:e,contrib_id:t,type:a}))}catch(e){return(0,O.handleAxiosError)(e),!0}c.push(fa({event_id:e,type:a}))},open:s,persistent:!0},i.createElement(p.Translate,null,"This operation is not reversible. Are you sure you want to procceed?")))}const ha=s.Ay.bind(null,{endpoint:"contributions.display_contribution",rules:[{args:["contrib_id","event_id"],converters:{contrib_id:"IntegerConverter",event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contrib_id",isDynamic:!0},{data:"/",isDynamic:!1}]}]},"/"),Ta=s.Ay.bind(null,{endpoint:"event_editing.api_assign_editable_self",rules:[{args:["contrib_id","event_id","type"],converters:{contrib_id:"IntegerConverter",event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contrib_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editor",isDynamic:!1},{data:"/",isDynamic:!1},{data:"me",isDynamic:!1}]}]},"/"),Aa=s.Ay.bind(null,{endpoint:"event_editing.api_unassign_editable",rules:[{args:["contrib_id","event_id","type"],converters:{contrib_id:"IntegerConverter",event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contrib_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editor",isDynamic:!1},{data:"/",isDynamic:!1}]}]},"/");function wa(e){let{children:t,contribution:a,state:n,submitter:s,eventId:r}=e;const{canAssignSelf:l,canUnassign:c,canPerformEditorActions:d,type:o,editor:m,editingEnabled:y,reviewConditionsValid:g}=(0,ua.useSelector)(pa.Dq),_=(0,ua.useDispatch)();return i.createElement(i.Fragment,null,i.createElement("div",{className:"submission-title flexrow"},i.createElement(u.MathJax,null,i.createElement("h3",{className:"f-self-strech"},a.title," ",i.createElement("span",{className:"submission-id"},"#",a.friendlyId),a.code&&i.createElement("span",{className:"submission-code"},a.code))),i.createElement("div",{style:{marginLeft:"auto"}},i.createElement(Ea,null))),i.createElement("div",{className:"editable-public"},i.createElement("div",{className:"review-summary flexrow f-a-center"},i.createElement("div",{className:"review-summary-badge"},g?i.createElement("div",{className:`i-tag ${n.cssClass}`},n.title):i.createElement("div",{className:"i-tag"},i.createElement(p.Translate,null,"Not Ready"))),i.createElement("div",{className:"review-summary-content f-self-stretch"},i.createElement("div",null,i.createElement(p.Translate,null,i.createElement(p.Param,{name:"submitterName",value:s.fullName,wrapper:i.createElement("strong",null)})," ","submitted for the contribution"," ",i.createElement(p.Param,{name:"contributionLink",value:a.title,wrapper:i.createElement("a",{href:ha({event_id:r,contrib_id:a.id})})})),i.createElement("br",null),m?i.createElement(i.Fragment,null,i.createElement(p.Translate,null,i.createElement(p.Param,{name:"editorName",value:m.fullName,wrapper:i.createElement("strong",null)})," is the assigned editor"),c&&i.createElement(i.Fragment,null," (",i.createElement("a",{onClick:async()=>{try{await O.indicoAxios.delete(Aa({event_id:r,contrib_id:a.id,type:o}))}catch(e){return(0,O.handleAxiosError)(e)}_(Da())}},i.createElement(p.Translate,null,"unassign")),")")):i.createElement(i.Fragment,null,i.createElement(p.Translate,null,"No editor assigned"),l&&i.createElement(i.Fragment,null," (",i.createElement("a",{onClick:async()=>{try{await O.indicoAxios.put(Ta({event_id:r,contrib_id:a.id,type:o}))}catch(e){return(0,O.handleAxiosError)(e)}_(Da())}},i.createElement(p.Translate,null,"assign myself")),")"))))),!g&&i.createElement(K.A,{warning:!0},i.createElement(ue.A,{name:"warning sign"}),i.createElement(p.Translate,null,"This editable is not fulfilling reviewing conditions.")),!y&&i.createElement(K.A,{warning:!0},i.createElement(ue.A,{name:"warning sign"}),i.createElement(p.Translate,null,"The Editing period hasn't started yet."),d&&i.createElement(i.Fragment,null," ",i.createElement(p.Translate,null,"Since you are a manager you can edit anyway."))),t&&i.createElement("div",{className:"review-item-content"},t)))}wa.propTypes={contribution:v().shape({id:v().number.isRequired,friendlyId:v().number.isRequired,title:v().string.isRequired,code:v().string.isRequired}).isRequired,state:v().shape({cssClass:v().string.isRequired,title:v().string.isRequired}).isRequired,submitter:v().shape({fullName:v().string.isRequired}).isRequired,eventId:v().number.isRequired,children:v().node.isRequired};var Ca=a(31109),Ra=a(64771),Sa=a(94900);const Ia={"./FileDisplay.module.scss":{"file-display-wrapper":"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__file-display-wrapper___+tJbp",outdated:"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__outdated___jJ99z","file-display":"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__file-display___fP19U","file-type-display":"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__file-type-display___hA+87","file-list-display":"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__file-list-display___nQG1e","file-row":"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__file-row___rfFnk","file-name":"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__file-name___crVch","no-files":"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__no-files___OS-B6","download-tag-wrapper":"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__download-tag-wrapper___7tItK","tag-display":"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__tag-display___jIME2","download-button":"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__download-button___JhgX2"}};function ka(e){let{files:t}=e;const a={modified:{icon:"dot circle",color:"yellow",tooltip:p.Translate.string("This file was modified since the last revision.")},added:{icon:"add circle",color:"green",tooltip:p.Translate.string("This file was added since the last revision.")}};return i.createElement("ul",{className:"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__file-list-display___nQG1e"},t.map((e=>{let{filename:t,uuid:n,downloadURL:s,state:r}=e;return i.createElement("li",{key:n,className:"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__file-row___rfFnk"},i.createElement(u.TooltipIfTruncated,null,i.createElement("span",{className:"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__file-name___crVch"},r&&i.createElement(ge.A,{trigger:i.createElement(ue.A,{name:a[r].icon,color:a[r].color}),content:a[r].tooltip}),i.createElement("a",{href:s,target:"_blank",rel:"noopener noreferrer"},t))))})),!t.length&&i.createElement("span",{className:"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__no-files___OS-B6"},i.createElement(p.Translate,null,"No files uploaded")))}function xa(e){let{fileType:t}=e;return i.createElement("div",{className:"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__file-type-display___hA+87"},i.createElement("h3",null,t.name),i.createElement(ka,{files:t.files}))}function ja(e){let{downloadURL:t,fileTypes:a,files:n,tags:s,outdated:r}=e;return i.createElement("div",{className:(0,Ra.A)((0,Sa.toClasses)({"file-display-wrapper":!0,outdated:r&&n.length>0}),Ia,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})},0!==n.length&&i.createElement("div",{className:"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__file-display___fP19U"},(0,F.yE)(a,n).map((e=>i.createElement(xa,{key:e.id,fileType:e})))),i.createElement("div",{className:"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__download-tag-wrapper___7tItK"},i.createElement("div",{className:"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__tag-display___jIME2"},s.map((e=>i.createElement(pe.A,{color:e.color,key:e.id},e.verboseTitle)))),0!==n.length&&i.createElement("div",null,i.createElement(j.A,{as:"a",href:t,floated:"right",className:"events-editing-client-js-editing-timeline-FileDisplay-___FileDisplay-module__download-button___JhgX2",icon:!0,primary:!0},i.createElement(ue.A,{name:"download"})," ",i.createElement(p.Translate,null,"Download ZIP")))))}ka.propTypes={files:v().arrayOf(v().shape(F.d7)).isRequired},xa.propTypes={fileType:v().shape(F.Zh).isRequired},ja.propTypes={downloadURL:v().string.isRequired,fileTypes:v().arrayOf(v().shape(F.Zh)).isRequired,files:v().arrayOf(v().shape(F.d7)).isRequired,tags:v().arrayOf(v().shape({color:v().string.isRequired,id:v().number.isRequired,verboseTitle:v().string.isRequired})).isRequired,outdated:v().bool},ja.defaultProps={outdated:!1};var Na=a(1419),Oa=a(88931);const qa=s.Ay.bind(null,{endpoint:"event_editing.api_create_submitter_revision",rules:[{args:["contrib_id","event_id","revision_id","type"],converters:{contrib_id:"IntegerConverter",event_id:"IntegerConverter",revision_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contrib_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"revision_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"new",isDynamic:!1}]}]},"/"),Fa=s.Ay.bind(null,{endpoint:"event_editing.api_upload",rules:[{args:["contrib_id","event_id","type"],converters:{contrib_id:"IntegerConverter",event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contrib_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"upload",isDynamic:!1}]}]},"/");function Pa(){const{eventId:e,contributionId:t,editableType:a}=(0,ua.useSelector)(pa.X5),n=(0,ua.useSelector)(pa.yN),s=(0,ua.useSelector)(pa.O$),r=(0,ua.useSelector)(pa.Hv),l=(0,ua.useDispatch)(),c={fullName:Indico.User.name,avatarURL:Indico.User.avatarURL},d=(0,F.F$)(n,r);return i.createElement(xe.Form,{initialValues:{files:d},initialValuesEqual:T(),subscription:{},onSubmit:async i=>{const n=await l(function(e,t){return(0,ya.P$)((()=>O.indicoAxios.post(e,t)),null,(()=>Da()))}(qa({event_id:e,contrib_id:t,type:a,revision_id:s.id}),i));if(n.error)return n.error}},(s=>{let{handleSubmit:l}=s;return i.createElement(je.A,{onSubmit:l},i.createElement("div",{className:"i-timeline"},i.createElement("div",{className:"i-timeline-item"},i.createElement(Na.A,{user:c}),i.createElement("div",{className:"i-timeline-item-box header-indicator-left"},i.createElement("div",{className:"i-box-header flexrow"},i.createElement(p.Translate,null,"Upload corrected revision")),i.createElement("div",{className:"i-box-content"},i.createElement(Oa.qe,{name:"files",fileTypes:n,files:r.files,uploadURL:Fa({event_id:e,contrib_id:t,type:a}),mustChange:!0}),i.createElement(J.FinalSubmitButton,{label:p.Translate.string("Submit new revision")}))))))}))}var La=a(14867),Ua=a.n(La),Ma=a(11052);function za(){const e=(0,ua.useSelector)(pa.O$),t=(0,ua.useDispatch)();return i.createElement("div",null,i.createElement(ke.A,null),i.createElement(xe.Form,{onSubmit:async a=>{const i=await t(function(e,t){return(0,ya.HX)((()=>O.indicoAxios.post(e.confirmURL,t)),null,(()=>Da()))}(e,a));if(i.error)return i.error},initialValues:{comment:""},subscription:{}},(e=>i.createElement(je.A,{onSubmit:e.handleSubmit},i.createElement(K.A,{info:!0,size:"tiny",icon:"exclamation circle",header:p.Translate.string("Confirmation required"),content:i.createElement("p",null,i.createElement(p.Translate,null,"Editor uploaded changes to your paper. Please download the updated files and verify their changes. If you reject them, you can upload a new version afterwards."))}),i.createElement(J.FinalTextArea,{name:"comment",placeholder:p.Translate.string("You can leave a comment if you wish")}),i.createElement(je.A.Group,{className:"events-editing-client-js-editing-timeline-___ChangesConfirmation-module__submit-buttons___wXZR0"},i.createElement(xe.Field,{name:"action",subscription:{value:!0}},(t=>{let{input:{value:a}}=t;return i.createElement(i.Fragment,null,i.createElement(J.FinalSubmitButton,{label:p.Translate.string("Accept"),color:"green",icon:"check",onClick:()=>{e.form.change("action","accept")},disabledUntilChange:!1,activeSubmitButton:"accept"===a}),i.createElement(J.FinalSubmitButton,{label:p.Translate.string("Reject"),color:"red",icon:"times",onClick:()=>{e.form.change("action","reject")},disabledUntilChange:!1,activeSubmitButton:"reject"===a}))})))))))}function Ba(e){let{url:t,actions:a}=e;const[n,s]=(0,i.useState)(null),[r,l]=(0,i.useState)(null),c=(0,ua.useDispatch)(),d=async e=>{let a;s(null),l(e);try{a=await O.indicoAxios.post(t,{action:e})}catch(e){return l(null),void(0,O.handleAxiosError)(e)}a.data.redirect?location.href=a.data.redirect:(await c(Da()),l(null))};return i.createElement(i.Fragment,null,i.createElement(ke.A,{horizontal:!0,className:"events-editing-client-js-editing-timeline-___CustomActions-module__divider___DwDBp"},i.createElement(p.Translate,null,"Actions")),i.createElement(j.A.Group,{floated:"right"},a.map((e=>i.createElement(j.A,{key:e.name,content:e.title,color:e.color,icon:e.icon,onClick:()=>{var t;(t=e).confirm?s(t):d(t.name)},disabled:!!r,loading:r===e.name})))),n&&i.createElement(Je.A,{size:"mini",onCancel:()=>s(null),onConfirm:()=>d(n.name),header:p.Translate.string("Confirm action: {action}",{action:n.title}),content:n.confirm,confirmButton:p.Translate.string("OK"),cancelButton:p.Translate.string("Cancel"),open:!0}))}function Ha(e){let{reviewURL:t}=e;const[a,n]=(0,i.useState)(!1),[s,r]=(0,i.useState)(!1),l=(0,ua.useDispatch)();return i.createElement(i.Fragment,null,i.createElement(ge.A,{content:p.Translate.string("Undo review"),trigger:i.createElement(ue.A,{name:"undo",disabled:a,onClick:()=>r(!0),color:"grey",size:"large",link:!0})}),i.createElement(u.RequestConfirm,{header:p.Translate.string("Reset review"),confirmText:p.Translate.string("Reset"),onClose:()=>r(!1),requestFunc:async()=>{var e;n(!0),await l((e=t,(0,ya.P$)((()=>O.indicoAxios.delete(e)),null,(()=>Da())))),n(!1)},open:s,negative:!0},i.createElement(p.Translate,null,"Are you sure you want to reset the review?")))}Ba.propTypes={url:v().string.isRequired,actions:v().arrayOf(v().shape({name:v().string.isRequired,title:v().string.isRequired,color:v().string,icon:v().string,confirm:v().string})).isRequired},Ha.propTypes={reviewURL:v().string.isRequired};function Va(e){let{block:t,canEdit:a}=e;const[n,s]=(0,i.useState)(!1),r=(0,ua.useDispatch)();return i.createElement("div",{className:"events-editing-client-js-editing-timeline-___ReviewComment-module__review-comment___lxTAV"},n?i.createElement("div",{className:"f-self-stretch"},i.createElement(xe.Form,{onSubmit:async e=>{const a=await r(function(e,t){return(0,ya.HX)((()=>O.indicoAxios.patch(e.reviewURL,t)),null,(()=>Da()))}(t,e));if(a.error)return a.error;s(!1)},initialValues:{text:t.comment},subscription:{submitting:!0}},(e=>i.createElement(je.A,{onSubmit:e.handleSubmit},i.createElement(J.FinalTextArea,{name:"text",placeholder:p.Translate.string("Leave a comment..."),autoFocus:!0,required:"accepted"!==g.Ak[t.type.name],hideValidationError:!0}),i.createElement(je.A.Group,{className:"events-editing-client-js-editing-timeline-___ReviewComment-module__submit-buttons___9nNdy",inline:!0},i.createElement(J.FinalSubmitButton,{label:p.Translate.string("Save changes")}),i.createElement(j.A,{disabled:e.submitting,content:p.Translate.string("Cancel"),onClick:()=>{s(!1)}})))))):i.createElement("div",{className:"markdown-text",dangerouslySetInnerHTML:{__html:t.commentHtml}}),i.createElement("div",{className:"events-editing-client-js-editing-timeline-___ReviewComment-module__action-buttons___ym3Lh"},a&&i.createElement("a",{onClick:()=>s(!n),className:"i-link icon-edit",title:p.Translate.string("Edit review comment")})))}Va.propTypes={block:v().shape(rt).isRequired,canEdit:v().bool.isRequired};var Ka=a(18757),Ja=a.n(Ka),$a=a(89995);function Ga(e){let{onSubmit:t,onToggleExpand:a,initialValues:n,expanded:s}=e;const{canCreateInternalComments:r}=(0,ua.useSelector)(pa.Dq),[l,c]=(0,i.useState)(s),d=l?J.FinalTextArea:J.FinalInput,o=l?{autoFocus:!0}:{},m=()=>{l||(c(!0),a(!0))};return i.createElement("div",{className:"f-self-stretch"},i.createElement(xe.Form,{onSubmit:async(e,i)=>{await t(e,i)||(c(!1),a(!1))},initialValues:n,subscription:{submitting:!0}},(e=>i.createElement(je.A,{onSubmit:e.handleSubmit},i.createElement(d,(0,Me.A)({},o,{onFocus:m,name:"text",placeholder:p.Translate.string("Leave a comment..."),hideValidationError:!0,required:!0})),l&&i.createElement(i.Fragment,null,r&&i.createElement(J.FinalCheckbox,{label:p.Translate.string("Restrict visibility of this comment to other editors only"),name:"internal",toggle:!0}),i.createElement(je.A.Group,{className:"events-editing-client-js-editing-timeline-___CommentForm-module__submit-buttons___wY8Zx",inline:!0},i.createElement(J.FinalSubmitButton,{label:p.Translate.string("Comment")}),i.createElement(j.A,{disabled:e.submitting,content:p.Translate.string("Cancel"),onClick:()=>{c(!1),a(!1),e.form.reset()}})))))))}Ga.propTypes={onSubmit:v().func.isRequired,onToggleExpand:v().func.isRequired,initialValues:v().shape({text:v().string,internal:v().bool}),expanded:v().bool},Ga.defaultProps={initialValues:{text:"",internal:!1},expanded:!1};const Xa={"./JudgmentDropdownItems.module.scss":{"disabled-item":"events-editing-client-js-editing-timeline-judgment-___JudgmentDropdownItems-module__disabled-item___ppRjC"}};function Ya(e){let{options:t,judgmentType:a,setJudgmentType:n}=e;const s=(0,ua.useSelector)(pa.jZ);return t.map((e=>{let{value:t,text:r,color:l}=e;return i.createElement(ge.A,{content:p.Translate.string("You cannot accept an editable that does not contain any publishable files."),trigger:i.createElement(ve.A.Item,{text:r,label:{color:l,empty:!0,circular:!0},key:t,selected:t===a,onClick:e=>{s||"accept"!==t?n(t):e.stopPropagation()},className:(0,Ra.A)(!s&&"accept"===t&&"disabled-item",Xa,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})}),position:"right center",key:t,disabled:s||"accept"!==t})}))}Ya.propTypes={options:v().arrayOf(v().shape({value:v().string,text:v().any,color:v().string,class:v().string})).isRequired,judgmentType:v().string,setJudgmentType:v().func.isRequired},Ya.defaultProps={judgmentType:null};function Za(e){let{judgmentType:t,setJudgmentType:a,options:n,loading:s}=e;const r=n.find((e=>e.value===t));return i.createElement("div",{className:"events-editing-client-js-editing-timeline-judgment-___JudgmentBoxHeader-module__choice-bar___0I+tH"},i.createElement("h3",null,i.createElement(p.Translate,null,"Your decision")),i.createElement("div",null,i.createElement(ve.A,{value:t,trigger:i.createElement(ve.A.Text,{className:"text"},i.createElement("div",{className:`ui empty circular ${r.color} label`,style:{marginRight:"0.5em",verticalAlign:"-10%"}}),r.text),direction:"left",disabled:s,button:!0,floating:!0},i.createElement(ve.A.Menu,null,i.createElement(Ya,{options:n,judgmentType:t,setJudgmentType:a}))),i.createElement(j.A,{icon:"delete",disabled:s,onClick:()=>a(null)})))}Za.propTypes={judgmentType:v().string.isRequired,setJudgmentType:v().func.isRequired,options:v().arrayOf(v().shape({value:v().string,text:v().string,class:v().string,color:v().string})).isRequired,loading:v().bool.isRequired};var Qa=a(43057);const Wa=["name"],ei=v().shape({id:v().number.isRequired,code:v().string.isRequired,title:v().string.isRequired,verboseTitle:v().string.isRequired,color:v().string.isRequired});function ti(e){let{onChange:t,value:a,placeholder:n,options:s}=e;return i.createElement(ve.A,{placeholder:n,className:"events-editing-client-js-editing-timeline-judgment-___TagInput-module__tag-input___29n1x",fluid:!0,multiple:!0,search:!0,selection:!0,value:a,options:s.map((e=>{let{id:t,verboseTitle:a,color:i}=e;return{value:t,text:a,key:t,color:i}})),onChange:(e,a)=>{let{value:i}=a;return t(i)},closeOnChange:!0,renderLabel:e=>{let{color:t,text:a}=e;return{color:t,content:a}}})}function ai(e){let{name:t}=e,a=(0,Qa.A)(e,Wa);return i.createElement(J.FinalField,(0,Me.A)({name:t,component:ti,format:e=>e,parse:e=>e,undefinedValue:[],isEqual:J.unsortedArraysEqual},a))}ti.propTypes={onChange:v().func.isRequired,value:v().arrayOf(v().number).isRequired,placeholder:v().string,options:v().arrayOf(ei).isRequired},ti.defaultProps={placeholder:p.Translate.string("Tag code or title...")},ai.propTypes={name:v().string.isRequired,options:v().arrayOf(ei).isRequired};const ii=s.Ay.bind(null,{endpoint:"event_editing.api_upload",rules:[{args:["contrib_id","event_id","type"],converters:{contrib_id:"IntegerConverter",event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contrib_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"upload",isDynamic:!1}]}]},"/");function ni(e){let{visible:t,mustChange:a,requirePublishable:n}=e;const s=(0,ua.useSelector)(pa.Hv),r=(0,ua.useSelector)(pa.X5),{eventId:l,contributionId:c,editableType:d}=r,o=(0,ua.useSelector)(pa.yN),m=(0,ua.useSelector)(pa.vJ);return i.createElement(je.A.Field,{style:{display:t?void 0:"none"}},i.createElement(Oa.qe,{name:"files",fileTypes:o,files:s.files,uploadURL:ii({event_id:l,contrib_id:c,type:d}),mustChange:a}),i.createElement(xe.Field,{name:"files",subscription:{value:!0}},(e=>{let{input:{value:t}}=e;return!n||m.some((e=>e.id in t))?null:i.createElement(i.Fragment,null,i.createElement(K.A,{visible:!0,warning:!0},i.createElement(p.PluralTranslate,{count:m.length},i.createElement(p.Singular,null,"There are no publishable files. Please upload a"," ",i.createElement(p.Param,{name:"types",wrapper:i.createElement("strong",null),value:m.map((e=>e.name)).join(", ")})," ","file."),i.createElement(p.Plural,null,"There are no publishable files. Please upload a file in at least one of the following types:"," ",i.createElement(p.Param,{name:"types",wrapper:i.createElement("strong",null),value:m.map((e=>e.name)).join(", ")})))),i.createElement(xe.Field,{name:"_nopublishables",validate:()=>p.Translate.string("There is no publishable file uploaded."),render:()=>null}))})))}ni.propTypes={visible:v().bool.isRequired,mustChange:v().bool.isRequired,requirePublishable:v().bool.isRequired};function si(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function ri(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?si(Object(a),!0).forEach((function(t){(0,b.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):si(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const li=s.Ay.bind(null,{endpoint:"event_editing.api_create_submitter_revision",rules:[{args:["contrib_id","event_id","revision_id","type"],converters:{contrib_id:"IntegerConverter",event_id:"IntegerConverter",revision_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contrib_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"revision_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"new",isDynamic:!1}]}]},"/"),ci=[{value:g.b5.accept,text:p.Translate.string("Accept"),color:"green",class:"accepted"},{value:g.b5.reject,text:p.Translate.string("Reject"),color:"black",class:"rejected"},{value:g.b5.update,text:p.Translate.string("Request approval"),color:"yellow",class:"needs-submitter-confirmation"},{value:g.b5.requestUpdate,text:p.Translate.string("Request changes"),color:"red",class:"needs-submitter-changes"}];function di(){const e=(0,ua.useDispatch)(),t=(0,ua.useSelector)(pa.O$),a=(0,ua.useSelector)(pa.Hv),n=(0,ua.useSelector)(pa.zJ),s=(0,ua.useSelector)(pa.YH),{canPerformSubmitterActions:r,contribution:l,editor:c}=(0,ua.useSelector)(pa.Dq),{eventId:d,editableType:o,fileTypes:m}=(0,ua.useSelector)(pa.X5),u=(0,ua.useSelector)(pa.mt),y={fullName:Indico.User.fullName,avatarURL:Indico.User.avatarURL},[_,v]=(0,i.useState)(!1),[D,b]=(0,i.useState)(null),[f,E]=(0,i.useState)(!1),h=(0,F.F$)(m,a),A=i.createElement("div",{className:"flexrow f-a-center events-editing-client-js-editing-timeline-___ReviewForm-module__judgment-form___Ni3Z8"},i.createElement(Ga,{onSubmit:async(a,i)=>{const n=await e(function(e,t){return(0,ya.HX)((()=>O.indicoAxios.post(e,t)),null,(()=>Da()))}(t.createCommentURL,a));if(n.error)return n.error;setTimeout((()=>i.reset()),0)},onToggleExpand:v}),r&&s&&!c&&i.createElement(i.Fragment,null,i.createElement("span",{className:"comment-or-review"},i.createElement(p.Translate,null,"or")),i.createElement($a.A,{eventId:d,contributionId:l.id,contributionCode:l.code,fileTypes:{[o]:m},uploadableFiles:a.files,text:p.Translate.string("Submit files"),onSubmit:(e,a)=>O.indicoAxios.post(li({event_id:d,contrib_id:l.id,type:e,revision_id:t.id}),a)})),!_&&n&&i.createElement("div",{className:"review-trigger flexrow"},i.createElement("span",{className:"comment-or-review"},i.createElement(p.Translate,null,"or")),i.createElement(ve.A,{className:"judgment-btn",text:p.Translate.string("Judge"),direction:"left",button:!0,floating:!0},i.createElement(ve.A.Menu,null,i.createElement(Ya,{options:ci,setJudgmentType:b})))));return i.createElement("div",{className:"i-timeline-item review-timeline-input"},i.createElement(Na.A,{user:y}),i.createElement("div",{className:"i-timeline-item-box footer-only header-indicator-left"},i.createElement("div",{className:"i-box-footer",style:{overflow:"visible"}},!D&&A,i.createElement(xe.Form,{initialValues:{comment:"",tags:t.tags.filter((e=>!e.system)).map((e=>e.id)).sort(),files:h,upload_changes:!1},initialValuesEqual:T(),subscription:{},onSubmit:async a=>{E(!0);const i=Ja()(a,["upload_changes",...D===g.b5.reject||[g.b5.accept,g.b5.requestUpdate].includes(D)&&!a.upload_changes?["files"]:[]]),n=await e(function(e,t){return(0,ya.HX)((()=>O.indicoAxios.post(e.reviewURL,t)),null,(()=>Da()))}(t,ri(ri({},i),{},{action:D})));if(E(!1),n.error)return n.error;b(null)}},(e=>{let{handleSubmit:t}=e;return D&&i.createElement(je.A,{id:"judgment-form",onSubmit:t},i.createElement(Za,{judgmentType:D,setJudgmentType:b,options:ci,loading:f}),i.createElement(J.FinalTextArea,{name:"comment",placeholder:p.Translate.string("Leave a comment..."),hideValidationError:!0,autoFocus:!0,required:D!==g.b5.accept,key:D}),[g.b5.accept,g.b5.requestUpdate].includes(D)&&i.createElement(J.FinalCheckbox,{name:"upload_changes",label:p.Translate.string("Upload files"),toggle:!0}),i.createElement(xe.Field,{name:"upload_changes",subscription:{value:!0}},(e=>{let{input:{value:t}}=e;return i.createElement(ni,{visible:D===g.b5.update||[g.b5.accept,g.b5.requestUpdate].includes(D)&&t,mustChange:D===g.b5.update||t,requirePublishable:[g.b5.accept,g.b5.update].includes(D)})})),i.createElement(ai,{name:"tags",options:u}),i.createElement("div",{className:"events-editing-client-js-editing-timeline-___ReviewForm-module__judgment-submit-button___5t1G-"},i.createElement(J.FinalSubmitButton,{label:p.Translate.string("Judge"),disabledUntilChange:D!==g.b5.accept})))})))))}function oi(e){let{revisionId:t,user:a,createdDt:n,modifiedDt:s,html:r,text:l,internal:c,system:d,canModify:o,modifyCommentURL:m}=e;const[u,y]=(0,i.useState)(!1),[g,_]=(0,i.useState)(!1),[v,D]=(0,i.useState)(!1),b=(0,ua.useSelector)(pa.O$),f=(0,ua.useDispatch)(),E=d?at:a;return i.createElement("div",{className:"i-timeline-item"},i.createElement(Na.A,{user:E}),i.createElement("div",{className:"flexrow i-timeline-item-content"},i.createElement("div",{className:"i-timeline-item-box header-indicator-left"},i.createElement("div",{className:"i-box-header flexrow"},i.createElement("div",{className:"f-self-stretch"},i.createElement(p.Translate,null,i.createElement(p.Param,{name:"userName",value:E.fullName,wrapper:i.createElement("strong",null)})," left a comment")," ",c&&i.createElement("i",{className:"review-comment-visibility internal icon-shield",title:p.Translate.string("Visible only to editors")}),i.createElement("time",{dateTime:(0,Ma.serializeDate)(n,Ua().HTML5_FMT.DATETIME_LOCAL_SECONDS)},(0,Ma.serializeDate)(n,"LLL"))," ",s&&i.createElement("time",{dateTime:(0,Ma.serializeDate)(s,Ua().HTML5_FMT.DATETIME_LOCAL_SECONDS),title:(0,Ma.serializeDate)(s,"LLL")},i.createElement("span",{className:"review-comment-edited"},i.createElement(p.Translate,null,"edited")))),o&&b.id===t&&i.createElement("div",{className:"review-comment-action"},i.createElement("a",{onClick:()=>D(!v),className:"i-link icon-edit",title:p.Translate.string("Edit comment")})," ",i.createElement("a",{onClick:()=>_(!0),className:"i-link icon-cross",title:p.Translate.string("Remove comment")}),i.createElement(Je.A,{size:"tiny",header:p.Translate.string("Remove comment"),open:g,content:p.Translate.string("Are you sure you want to remove this comment?"),closeOnDimmerClick:!u,closeOnEscape:!u,onCancel:()=>_(!1),onConfirm:async()=>{y(!0);var e;(await f((e=m,(0,ya.P$)((()=>O.indicoAxios.delete(e)),null,(()=>Da()))))).error||_(!1),y(!1)},cancelButton:i.createElement(j.A,{content:p.Translate.string("Cancel"),disabled:u}),confirmButton:i.createElement(j.A,{content:p.Translate.string("Remove comment"),loading:u,disabled:u,negative:!0}),closeIcon:!u}))),i.createElement("div",{className:"i-box-content js-form-container"},v?i.createElement(Ga,{onSubmit:async e=>{const t=await f((a=m,i=e,(0,ya.P$)((()=>O.indicoAxios.patch(a,i)),null,(()=>Da()))));var a,i;if(t.error)return t.error},onToggleExpand:D,initialValues:{text:l,internal:c},expanded:!0}):i.createElement("div",{className:"markdown-text",dangerouslySetInnerHTML:{__html:r}})))))}function mi(e){let{items:t,children:a,separator:n}=e;return i.createElement("div",{className:"i-timeline"},i.createElement("div",{className:"i-timeline with-line"},i.createElement("div",{className:"i-timeline-connect-up"}),t.map((e=>i.createElement(oi,(0,Me.A)({key:e.id},e)))),a),n&&i.createElement(i.Fragment,null,i.createElement("div",{className:"i-timeline to-separator-wrapper"},i.createElement("div",{className:"i-timeline-connect-down to-separator"})),i.createElement("div",{className:"i-timeline-separator"})))}oi.propTypes=st,mi.propTypes={items:v().arrayOf(v().shape(st)).isRequired,children:v().node,separator:v().bool},mi.defaultProps={children:null,separator:!1};const ui={"../../../styles/timeline.module.scss":{"undone-item":"events-editing-client-styles-___timeline-module__undone-item___z9JZG","undone-indicator":"events-editing-client-styles-___timeline-module__undone-indicator___OIQ+U","item-header":"events-editing-client-styles-___timeline-module__item-header___4uYJq"},"./TimelineItem.module.scss":{"item-index":"events-editing-client-js-editing-timeline-___TimelineItem-module__item-index___UgRjx","item-visibility-toggle":"events-editing-client-js-editing-timeline-___TimelineItem-module__item-visibility-toggle___F7PCd"}};function yi(e){let{block:t,index:a}=e;const{createdDt:n,modifiedDt:s,isUndone:r}=t,l=(0,ua.useSelector)(pa.Pb),c=(0,ua.useSelector)(pa.R4),d=(0,ua.useSelector)(pa.oL),o=(0,ua.useSelector)(pa.YF),m=(0,ua.useSelector)(pa.C0),u=(0,ua.useSelector)(pa.wd),{canComment:y}=(0,ua.useSelector)(pa.Dq),{fileTypes:_}=(0,ua.useSelector)(pa.X5),v=l.id===t.id,D=c.id===t.id,b=d.id===t.id,f=D&&u,E=t.commentHtml||!!t.files.length||!!t.tags.length||!!t.customActions.length,h=D||b,[T,A]=(0,i.useState)(!1),w=T||h,C=t.type.name===g.ek.replacement?at:t.user;return i.createElement(i.Fragment,null,i.createElement("div",{className:"i-timeline"},i.createElement("div",{className:"i-timeline-item "+(0,Ra.A)(r?"undone-item":void 0,ui,{autoResolveMultipleImports:!0,handleMissingStyleName:"throw"})},i.createElement(Na.A,{user:C}),i.createElement("div",{className:"i-timeline-item-box header-indicator-left "+(w&&E?"":"header-only"),id:`block-info-${t.id}`},i.createElement("div",{className:"i-box-header flexrow"},i.createElement("div",{className:"f-self-stretch events-editing-client-styles-___timeline-module__item-header___4uYJq"},!!t.files.length&&i.createElement("span",{className:"events-editing-client-js-editing-timeline-___TimelineItem-module__item-index___UgRjx"},"#",a)," ",i.createElement("span",null,t.header?i.createElement("strong",null,t.header):i.createElement(p.Translate,null,i.createElement(p.Param,{name:"submitterName",value:C.fullName,wrapper:i.createElement("strong",null)})," has submitted files"))," ",i.createElement("time",{dateTime:(0,Ma.serializeDate)(n,Ua().HTML5_FMT.DATETIME_LOCAL_SECONDS)},(0,Ma.serializeDate)(n,"LLL"))," ",s&&i.createElement("time",{dateTime:(0,Ma.serializeDate)(s,Ua().HTML5_FMT.DATETIME_LOCAL_SECONDS),title:(0,Ma.serializeDate)(s,"LLL")},i.createElement("span",{className:"review-comment-edited"},i.createElement(p.Translate,null,"edited")))," ",r&&i.createElement(p.Translate,{as:"span",className:"events-editing-client-styles-___timeline-module__undone-indicator___OIQ+U"},"Retracted")),w&&f&&i.createElement(Ha,{reviewURL:t.reviewURL}),!h&&(E||!!t.items.length)&&i.createElement("a",{className:"i-link events-editing-client-js-editing-timeline-___TimelineItem-module__item-visibility-toggle___F7PCd",onClick:()=>A(!w)},w?i.createElement(p.Translate,null,"Hide"):i.createElement(p.Translate,null,"Show details")),i.createElement(Ze,{state:g.Ak[t.type.name],circular:!0})),w&&E&&i.createElement("div",{className:"i-box-content"},r&&i.createElement(K.A,{warning:!0},i.createElement(ue.A,{name:"warning sign"}),i.createElement(p.Translate,null,"This revision has been retracted by the editor.")),t.commentHtml&&i.createElement(Va,{block:t,canEdit:f}),t.commentHtml&&!(!t.files.length&&!t.tags.length)&&i.createElement(ke.A,null),i.createElement(ja,{fileTypes:_,files:t.files,downloadURL:t.downloadFilesURL,tags:t.tags,outdated:!b}),m&&o&&D&&i.createElement(za,null),!!t.customActions.length&&i.createElement(Ba,{url:t.customActionURL,actions:t.customActions}))))),w&&(!!t.items.length||v||D)&&i.createElement(mi,{items:t.items,separator:v},D&&y&&i.createElement(di,null)))}yi.propTypes={block:v().shape(rt).isRequired,index:v().number.isRequired};const pi=10;function gi(){const e=(0,ua.useDispatch)(),t=(0,ua.useSelector)(pa.Dq),a=(0,ua.useSelector)(pa.fR),n=(0,ua.useSelector)(pa.iX),s=(0,ua.useSelector)(pa.C0),r=(0,ua.useSelector)(pa.O$),l=(0,ua.useSelector)(pa.Hv),c=(0,ua.useSelector)(pa.ut),{eventId:o,contributionId:m,editableType:u,fileTypes:y}=(0,ua.useSelector)(pa.X5),g=(0,ua.useSelector)(pa.MM);(0,i.useEffect)((()=>{e(Da())}),[m,o,u,e]),(0,i.useEffect)((()=>{const t=setInterval((async()=>{e((async(e,t)=>{const{editableDetailsURL:a}=(0,pa.X5)(t());return await(0,ya.P$)((()=>O.indicoAxios.get(a)),null,va)(e)}))}),1e3*pi);return()=>{clearInterval(t)}}),[e]);return a?i.createElement(d.A,{active:!0}):t?i.createElement(i.Fragment,null,g&&i.createElement(K.A,{warning:!0,header:p.Translate.string("This revision has been updated"),content:i.createElement(p.Translate,null,i.createElement(p.Param,{name:"link",wrapper:i.createElement("a",{onClick:()=>{e(((e,t)=>{e({type:_a,data:(0,pa.v8)(t())})}))}})},"Click here to refresh")," ","and see the most recent version.")}),i.createElement(wa,{contribution:t.contribution,state:t.state,submitter:c[0].user,eventId:o},t.hasPublishedRevision&&i.createElement(ja,{fileTypes:y,files:l.files,downloadURL:l.downloadFilesURL,tags:r.tags})),i.createElement(Ca.A,{blocks:c,itemComponent:yi}),s&&n&&i.createElement(Pa,null)):null}function _i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function vi(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?_i(Object(a),!0).forEach((function(t){(0,b.A)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):_i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}const Di={details:null,newDetails:null,timelineBlocks:null,loading:!1};function bi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Di,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ga:return vi(vi({},e),{},{loading:!0});case _a:{const i=(0,q.camelizeKeys)(t.data);return vi(vi({},e),{},{details:i,newDetails:i,loading:!1,timelineBlocks:(a=i.revisions,a.map(((e,t)=>{var i,n,s;const r=function(e,t){return e.slice(0,t).reverse().find((e=>{var t;return!e.isUndone&&(null===(t=e.files)||void 0===t?void 0:t.length)}))}(a,t);let l=e.files;if(r&&null!==(i=l)&&void 0!==i&&i.length){const e=new Set(r.files.map((e=>e.uuid))),t=new Set(r.files.map((e=>e.filename)));l=l.map((a=>e.has(a.uuid)?a:t.has(a.filename)?We(We({},a),{},{state:"modified"}):We(We({},a),{},{state:"added"})))}let c=e.tags;if(null!==(n=l)&&void 0!==n&&n.length&&(null===(s=c)||void 0===s||!s.length)){const e=a.slice(t+1).find((e=>!e.isUndone));null!=e&&e.isEditorRevision&&(c=e.tags)}return We(We({},e),{},{header:tt(0,e)||e.header,items:Ve()(e.comments,"createdDt"),files:l,tags:c})})))})}case va:{const a=(0,q.camelizeKeys)(t.data);return vi(vi({},e),{},{newDetails:a})}default:return e}var a}const fi=s.Ay.bind(null,{endpoint:"event_editing.api_editable",rules:[{args:["contrib_id","event_id","type"],converters:{contrib_id:"IntegerConverter",event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contrib_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0}]}]},"/"),Ei=s.Ay.bind(null,{endpoint:"event_editing.api_file_types",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"file-types",isDynamic:!1}]}]},"/"),hi=s.Ay.bind(null,{endpoint:"event_editing.api_tags",rules:[{args:["event_id"],converters:{event_id:"IntegerConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"api",isDynamic:!1},{data:"/",isDynamic:!1},{data:"tags",isDynamic:!1}]}]},"/");function Ti(){const e=(0,c.Uf)("event_id"),t=(0,c.Uf)("contrib_id"),{type:a}=(0,l.useParams)(),{data:n,loading:s}=(0,y.Ku)(Ei({event_id:e,type:a}),{camelize:!0}),{data:r,loading:o}=(0,y.Ku)(hi({event_id:e}),{camelize:!0});if(s||o)return i.createElement(d.A,{inline:"centered",active:!0});if(!n||!r)return null;const m=(0,ya.Ay)("editing-timeline",{timeline:bi},{staticData:{eventId:e,contributionId:t,editableType:a,fileTypes:n,tags:r,editableDetailsURL:fi({event_id:e,contrib_id:t,type:a})}});return i.createElement(ua.Provider,{store:m},i.createElement(gi,null))}const Ai=s.Ay.bind(null,{endpoint:"event_editing.editable",rules:[{args:["contrib_id","event_id","type"],converters:{contrib_id:"IntegerConverter",event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"contributions",isDynamic:!1},{data:"/",isDynamic:!1},{data:"contrib_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0}]}]},"/"),wi=s.Ay.bind(null,{endpoint:"event_editing.editable_type_list",rules:[{args:["event_id","type"],converters:{event_id:"IntegerConverter",type:"AnyConverter"},defaults:{},trace:[{data:"|",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event",isDynamic:!1},{data:"/",isDynamic:!1},{data:"event_id",isDynamic:!0},{data:"/",isDynamic:!1},{data:"editing",isDynamic:!1},{data:"/",isDynamic:!1},{data:"type",isDynamic:!0},{data:"/",isDynamic:!1},{data:"list",isDynamic:!1}]}]},"/");document.addEventListener("DOMContentLoaded",(async()=>{const e=document.querySelector("#editing-view");if(!e)return;const t=document.querySelector("div.header").getBoundingClientRect().height+document.querySelector("div.main-breadcrumb").getBoundingClientRect().height;document.body.style.setProperty("--header-height",t);const a=e.dataset.eventTitle;n.render(i.createElement(r.BrowserRouter,null,i.createElement(l.Route,{path:[(0,c.kA)(Ai,["event_id","contrib_id","type"]),(0,c.kA)(wi,["event_id","type"])]},i.createElement(ma,{eventTitle:a},i.createElement(l.Switch,null,i.createElement(l.Route,{exact:!0,path:(0,c.kA)(Ai,["event_id","contrib_id","type"]),component:Ti}),i.createElement(l.Route,{exact:!0,path:(0,c.kA)(wi,["event_id","type"])},i.createElement(Et,{management:!1})))))),e)}))},32004:(e,t,a)=>{var i=a(94207),n=a(43247);e.exports=function(e,t){return e&&e.length?n(e,i(t,2)):[]}}},e=>{e.O(0,[4644,4394,2076],(()=>{return t=45096,e(e.s=t);var t}));e.O()}]);
//# sourceMappingURL=module_events.editing.35a09a95.bundle.js.map